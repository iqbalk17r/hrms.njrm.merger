define("vendor/domReady",[],function(){"use strict";function e(e){var t;for(t=0;t<e.length;t+=1)e[t](c)}function t(){var t=u;l&&t.length&&(u=[],e(t))}function n(){l||(l=!0,a&&clearInterval(a),t())}function i(e){return l?e(c):u.push(e),i}var r,o,a,s="undefined"!=typeof window&&window.document,l=!s,c=s?document:null,u=[];if(s){if(document.addEventListener)document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1);else if(window.attachEvent){window.attachEvent("onload",n),o=document.createElement("div");try{r=null===window.frameElement}catch(e){}o.doScroll&&r&&window.external&&(a=setInterval(function(){try{o.doScroll(),n()}catch(e){}},30))}"complete"===document.readyState&&n()}return i.version="2.0.1",i.load=function(e,t,n,r){r.isBuild?n(null):i(n)},i}),define("ts/modules/createsend/antiforgery.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="__RequestVerificationToken",i=function(){function e(e,t){var i=this;this.get=function(){return{key:n,value:i.$cookies.get(i.tokenCookie)}},this.tokenCookie=e.defaults.xsrfCookieName,e.defaults.xsrfHeaderName=n,this.$cookies=t}return e}();t.AntiforgeryService=i}),define("ts/modules/createsend/antiforgery-retry.factory",["require","exports"],function(e,t){"use strict";function n(e,t){return{responseError:function(n){if(449===n.status){var i=n.config,r=i.retries||0;if(++r>3)return e.reject(n);i.retries=r;return t.get("$http")(n.config)}return e.reject(n)}}}Object.defineProperty(t,"__esModule",{value:!0}),t.AntiforgeryRetryFactory=n}),define("ts/modules/createsend/auth.factory",["require","exports"],function(e,t){"use strict";function n(e,t,n,i){return{responseError:function(r){if(401===r.status){i.mode.publicCanvas||(t.showLoginForm=!0);e.get("RetryRequestService").store(r)}return n.reject(r)}}}Object.defineProperty(t,"__esModule",{value:!0}),t.AuthFactory=n}),define("ts/modules/createsend/retry-request.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){var t=this;this.store=function(e){t.response=e},this.retry=function(){t.$http(t.response.config)},this.$http=e,this.response={}}return e}();t.RetryRequestService=n}),define("ts/modules/createsend/time-zone.service",["require","exports"],function(e,t){"use strict";function n(e){for(var t=new Date,n=[],i=!1,r=0;r<e.length;r++){var o=e[r];if(o.DaylightSavingTimeStartDate||t.getTimezoneOffset()!==-o.UtcOffset||i){var a=new Date(o.DaylightSavingTimeStartDate),s=new Date(o.DaylightSavingTimeEndDate),l=new Date(o.DaylightSavingTimeStartDate),c=new Date(o.DaylightSavingTimeStartDate),u=new Date(o.DaylightSavingTimeEndDate),d=new Date(o.DaylightSavingTimeEndDate);l.setDate(a.getDate()-1),c.setDate(a.getDate()+1),u.setDate(s.getDate()-1),d.setDate(s.getDate()+1),l.getTimezoneOffset()===-o.StandardTimeOffset&&c.getTimezoneOffset()===-o.DaylightSavingTimeOffset&&u.getTimezoneOffset()===-o.DaylightSavingTimeOffset&&d.getTimezoneOffset()===-o.StandardTimeOffset&&(i=!0,n.push(o))}else n.push(o)}if(i)for(var r=0;r<n.length;r++)n[r].DaylightSavingTimeStartDate||(n.splice(r,1),r--);return n}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this.detect=function(e){if(e){var t=n(e);if(t.length>0)return t[0].DisplayName}return null}}return e}();t.TimeZoneService=i});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/createsend/createsend.module",["require","exports","angular","./antiforgery.service","./antiforgery-retry.factory","./auth.factory","./retry-request.service","./time-zone.service","vendor/angular-cookies"],function(e,t,n,i,r,o,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=__importDefault(n);var l=n.default.module("createsend",["ngCookies"]);t.module=l,l.service("AntiforgeryService",["$http","$cookies",i.AntiforgeryService]),l.config(["$httpProvider",function(e){e.interceptors.push(["$q","$injector",r.AntiforgeryRetryFactory])}]),l.config(["$httpProvider",function(e){e.defaults.headers.common["X-Requested-With"]="XMLHttpRequest"}]),l.service("RetryRequestService",["$http",a.RetryRequestService]),l.config(["$httpProvider",function(e){e.interceptors.push(["$injector","$rootScope","$q","EmailBuilderConfig",o.AuthFactory])}]),l.service("TimeZoneService",[s.TimeZoneService])}),function(){var e=this,t=e._,n={},i=Array.prototype,r=Object.prototype,o=Function.prototype,a=i.push,s=i.slice,l=i.concat,c=r.toString,u=r.hasOwnProperty,d=i.forEach,h=i.map,p=i.reduce,f=i.reduceRight,m=i.filter,g=i.every,v=i.some,b=i.indexOf,y=i.lastIndexOf,w=Array.isArray,_=Object.keys,S=o.bind,k=function(e){return e instanceof k?e:this instanceof k?void(this._wrapped=e):new k(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=k),exports._=k):e._=k,k.VERSION="1.5.2";var x=k.each=k.forEach=function(e,t,i){if(null!=e)if(d&&e.forEach===d)e.forEach(t,i);else if(e.length===+e.length){for(var r=0,o=e.length;o>r;r++)if(t.call(i,e[r],r,e)===n)return}else for(var a=k.keys(e),r=0,o=a.length;o>r;r++)if(t.call(i,e[a[r]],a[r],e)===n)return};k.map=k.collect=function(e,t,n){var i=[];return null==e?i:h&&e.map===h?e.map(t,n):(x(e,function(e,r,o){i.push(t.call(n,e,r,o))}),i)};var C="Reduce of empty array with no initial value";k.reduce=k.foldl=k.inject=function(e,t,n,i){var r=arguments.length>2;if(null==e&&(e=[]),p&&e.reduce===p)return i&&(t=k.bind(t,i)),r?e.reduce(t,n):e.reduce(t);if(x(e,function(e,o,a){r?n=t.call(i,n,e,o,a):(n=e,r=!0)}),!r)throw new TypeError(C);return n},k.reduceRight=k.foldr=function(e,t,n,i){var r=arguments.length>2;if(null==e&&(e=[]),f&&e.reduceRight===f)return i&&(t=k.bind(t,i)),r?e.reduceRight(t,n):e.reduceRight(t);var o=e.length;if(o!==+o){var a=k.keys(e);o=a.length}if(x(e,function(s,l,c){l=a?a[--o]:--o,r?n=t.call(i,n,e[l],l,c):(n=e[l],r=!0)}),!r)throw new TypeError(C);return n},k.find=k.detect=function(e,t,n){var i;return I(e,function(e,r,o){return t.call(n,e,r,o)?(i=e,!0):void 0}),i},k.filter=k.select=function(e,t,n){var i=[];return null==e?i:m&&e.filter===m?e.filter(t,n):(x(e,function(e,r,o){t.call(n,e,r,o)&&i.push(e)}),i)},k.reject=function(e,t,n){return k.filter(e,function(e,i,r){return!t.call(n,e,i,r)},n)},k.every=k.all=function(e,t,i){t||(t=k.identity);var r=!0;return null==e?r:g&&e.every===g?e.every(t,i):(x(e,function(e,o,a){return(r=r&&t.call(i,e,o,a))?void 0:n}),!!r)};var I=k.some=k.any=function(e,t,i){t||(t=k.identity);var r=!1;return null==e?r:v&&e.some===v?e.some(t,i):(x(e,function(e,o,a){return r||(r=t.call(i,e,o,a))?n:void 0}),!!r)};k.contains=k.include=function(e,t){return null!=e&&(b&&e.indexOf===b?-1!=e.indexOf(t):I(e,function(e){return e===t}))},k.invoke=function(e,t){var n=s.call(arguments,2),i=k.isFunction(t);return k.map(e,function(e){return(i?t:e[t]).apply(e,n)})},k.pluck=function(e,t){return k.map(e,function(e){return e[t]})},k.where=function(e,t,n){return k.isEmpty(t)?n?void 0:[]:k[n?"find":"filter"](e,function(e){for(var n in t)if(t[n]!==e[n])return!1;return!0})},k.findWhere=function(e,t){return k.where(e,t,!0)},k.max=function(e,t,n){if(!t&&k.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);if(!t&&k.isEmpty(e))return-1/0;var i={computed:-1/0,value:-1/0};return x(e,function(e,r,o){var a=t?t.call(n,e,r,o):e;a>i.computed&&(i={value:e,computed:a})}),i.value},k.min=function(e,t,n){if(!t&&k.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);if(!t&&k.isEmpty(e))return 1/0;var i={computed:1/0,value:1/0};return x(e,function(e,r,o){var a=t?t.call(n,e,r,o):e;a<i.computed&&(i={value:e,computed:a})}),i.value},k.shuffle=function(e){var t,n=0,i=[];return x(e,function(e){t=k.random(n++),i[n-1]=i[t],i[t]=e}),i},k.sample=function(e,t,n){return arguments.length<2||n?e[k.random(e.length-1)]:k.shuffle(e).slice(0,Math.max(0,t))};var P=function(e){return k.isFunction(e)?e:function(t){return t[e]}};k.sortBy=function(e,t,n){var i=P(t);return k.pluck(k.map(e,function(e,t,r){return{value:e,index:t,criteria:i.call(n,e,t,r)}}).sort(function(e,t){var n=e.criteria,i=t.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(i>n||void 0===i)return-1}return e.index-t.index}),"value")};var T=function(e){return function(t,n,i){var r={},o=null==n?k.identity:P(n);return x(t,function(n,a){var s=o.call(i,n,a,t);e(r,s,n)}),r}};k.groupBy=T(function(e,t,n){(k.has(e,t)?e[t]:e[t]=[]).push(n)}),k.indexBy=T(function(e,t,n){e[t]=n}),k.countBy=T(function(e,t){k.has(e,t)?e[t]++:e[t]=1}),k.sortedIndex=function(e,t,n,i){n=null==n?k.identity:P(n);for(var r=n.call(i,t),o=0,a=e.length;a>o;){var s=o+a>>>1;n.call(i,e[s])<r?o=s+1:a=s}return o},k.toArray=function(e){return e?k.isArray(e)?s.call(e):e.length===+e.length?k.map(e,k.identity):k.values(e):[]},k.size=function(e){return null==e?0:e.length===+e.length?e.length:k.keys(e).length},k.first=k.head=k.take=function(e,t,n){return null==e?void 0:null==t||n?e[0]:s.call(e,0,t)},k.initial=function(e,t,n){return s.call(e,0,e.length-(null==t||n?1:t))},k.last=function(e,t,n){return null==e?void 0:null==t||n?e[e.length-1]:s.call(e,Math.max(e.length-t,0))},k.rest=k.tail=k.drop=function(e,t,n){return s.call(e,null==t||n?1:t)},k.compact=function(e){return k.filter(e,k.identity)};var E=function(e,t,n){return t&&k.every(e,k.isArray)?l.apply(n,e):(x(e,function(e){k.isArray(e)||k.isArguments(e)?t?a.apply(n,e):E(e,t,n):n.push(e)}),n)};k.flatten=function(e,t){return E(e,t,[])},k.without=function(e){return k.difference(e,s.call(arguments,1))},k.uniq=k.unique=function(e,t,n,i){k.isFunction(t)&&(i=n,n=t,t=!1);var r=n?k.map(e,n,i):e,o=[],a=[];return x(r,function(n,i){(t?i&&a[a.length-1]===n:k.contains(a,n))||(a.push(n),o.push(e[i]))}),o},k.union=function(){return k.uniq(k.flatten(arguments,!0))},k.intersection=function(e){var t=s.call(arguments,1);return k.filter(k.uniq(e),function(e){return k.every(t,function(t){return k.indexOf(t,e)>=0})})},k.difference=function(e){var t=l.apply(i,s.call(arguments,1));return k.filter(e,function(e){return!k.contains(t,e)})},k.zip=function(){for(var e=k.max(k.pluck(arguments,"length").concat(0)),t=new Array(e),n=0;e>n;n++)t[n]=k.pluck(arguments,""+n);return t},k.object=function(e,t){if(null==e)return{};for(var n={},i=0,r=e.length;r>i;i++)t?n[e[i]]=t[i]:n[e[i][0]]=e[i][1];return n},k.indexOf=function(e,t,n){if(null==e)return-1;var i=0,r=e.length;if(n){if("number"!=typeof n)return i=k.sortedIndex(e,t),e[i]===t?i:-1;i=0>n?Math.max(0,r+n):n}if(b&&e.indexOf===b)return e.indexOf(t,n);for(;r>i;i++)if(e[i]===t)return i;return-1},k.lastIndexOf=function(e,t,n){if(null==e)return-1;var i=null!=n;if(y&&e.lastIndexOf===y)return i?e.lastIndexOf(t,n):e.lastIndexOf(t);for(var r=i?n:e.length;r--;)if(e[r]===t)return r;return-1},k.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;for(var i=Math.max(Math.ceil((t-e)/n),0),r=0,o=new Array(i);i>r;)o[r++]=e,e+=n;return o};var M=function(){};k.bind=function(e,t){var n,i;if(S&&e.bind===S)return S.apply(e,s.call(arguments,1));if(!k.isFunction(e))throw new TypeError;return n=s.call(arguments,2),i=function(){if(!(this instanceof i))return e.apply(t,n.concat(s.call(arguments)));M.prototype=e.prototype;var r=new M;M.prototype=null;var o=e.apply(r,n.concat(s.call(arguments)));return Object(o)===o?o:r}},k.partial=function(e){var t=s.call(arguments,1);return function(){return e.apply(this,t.concat(s.call(arguments)))}},k.bindAll=function(e){var t=s.call(arguments,1);if(0===t.length)throw new Error("bindAll must be passed function names");return x(t,function(t){e[t]=k.bind(e[t],e)}),e},k.memoize=function(e,t){var n={};return t||(t=k.identity),function(){var i=t.apply(this,arguments);return k.has(n,i)?n[i]:n[i]=e.apply(this,arguments)}},k.delay=function(e,t){var n=s.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},k.defer=function(e){return k.delay.apply(k,[e,1].concat(s.call(arguments,1)))},k.throttle=function(e,t,n){var i,r,o,a=null,s=0;n||(n={});var l=function(){s=!1===n.leading?0:new Date,a=null,o=e.apply(i,r)};return function(){var c=new Date;s||!1!==n.leading||(s=c);var u=t-(c-s);return i=this,r=arguments,0>=u?(clearTimeout(a),a=null,s=c,o=e.apply(i,r)):a||!1===n.trailing||(a=setTimeout(l,u)),o}},k.debounce=function(e,t,n){var i,r,o,a,s;return function(){o=this,r=arguments,a=new Date;var l=function(){var c=new Date-a;t>c?i=setTimeout(l,t-c):(i=null,n||(s=e.apply(o,r)))},c=n&&!i;return i||(i=setTimeout(l,t)),c&&(s=e.apply(o,r)),s}},k.once=function(e){var t,n=!1;return function(){return n?t:(n=!0,t=e.apply(this,arguments),e=null,t)}},k.wrap=function(e,t){return function(){var n=[e];return a.apply(n,arguments),t.apply(this,n)}},k.compose=function(){var e=arguments;return function(){for(var t=arguments,n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},k.after=function(e,t){return function(){return--e<1?t.apply(this,arguments):void 0}},k.keys=_||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)k.has(e,n)&&t.push(n);return t},k.values=function(e){for(var t=k.keys(e),n=t.length,i=new Array(n),r=0;n>r;r++)i[r]=e[t[r]];return i},k.pairs=function(e){for(var t=k.keys(e),n=t.length,i=new Array(n),r=0;n>r;r++)i[r]=[t[r],e[t[r]]];return i},k.invert=function(e){for(var t={},n=k.keys(e),i=0,r=n.length;r>i;i++)t[e[n[i]]]=n[i];return t},k.functions=k.methods=function(e){var t=[];for(var n in e)k.isFunction(e[n])&&t.push(n);return t.sort()},k.extend=function(e){return x(s.call(arguments,1),function(t){if(t)for(var n in t)e[n]=t[n]}),e},k.pick=function(e){var t={},n=l.apply(i,s.call(arguments,1));return x(n,function(n){n in e&&(t[n]=e[n])}),t},k.omit=function(e){var t={},n=l.apply(i,s.call(arguments,1));for(var r in e)k.contains(n,r)||(t[r]=e[r]);return t},k.defaults=function(e){return x(s.call(arguments,1),function(t){if(t)for(var n in t)void 0===e[n]&&(e[n]=t[n])}),e},k.clone=function(e){return k.isObject(e)?k.isArray(e)?e.slice():k.extend({},e):e},k.tap=function(e,t){return t(e),e};var D=function(e,t,n,i){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof k&&(e=e._wrapped),t instanceof k&&(t=t._wrapped);var r=c.call(e);if(r!=c.call(t))return!1;switch(r){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var o=n.length;o--;)if(n[o]==e)return i[o]==t;var a=e.constructor,s=t.constructor;if(a!==s&&!(k.isFunction(a)&&a instanceof a&&k.isFunction(s)&&s instanceof s))return!1;n.push(e),i.push(t);var l=0,u=!0;if("[object Array]"==r){if(l=e.length,u=l==t.length)for(;l--&&(u=D(e[l],t[l],n,i)););}else{for(var d in e)if(k.has(e,d)&&(l++,!(u=k.has(t,d)&&D(e[d],t[d],n,i))))break;if(u){for(d in t)if(k.has(t,d)&&!l--)break;u=!l}}return n.pop(),i.pop(),u};k.isEqual=function(e,t){return D(e,t,[],[])},k.isEmpty=function(e){if(null==e)return!0;if(k.isArray(e)||k.isString(e))return 0===e.length;for(var t in e)if(k.has(e,t))return!1;return!0},k.isElement=function(e){return!(!e||1!==e.nodeType)},k.isArray=w||function(e){return"[object Array]"==c.call(e)},k.isObject=function(e){return e===Object(e)},x(["Arguments","Function","String","Number","Date","RegExp"],function(e){k["is"+e]=function(t){return c.call(t)=="[object "+e+"]"}}),k.isArguments(arguments)||(k.isArguments=function(e){return!(!e||!k.has(e,"callee"))}),"function"!=typeof/./&&(k.isFunction=function(e){return"function"==typeof e}),k.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},k.isNaN=function(e){return k.isNumber(e)&&e!=+e},k.isBoolean=function(e){return!0===e||!1===e||"[object Boolean]"==c.call(e)},k.isNull=function(e){return null===e},k.isUndefined=function(e){return void 0===e},k.has=function(e,t){return u.call(e,t)},k.noConflict=function(){return e._=t,this},k.identity=function(e){return e},k.times=function(e,t,n){for(var i=Array(Math.max(0,e)),r=0;e>r;r++)i[r]=t.call(n,r);return i},k.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))};var $={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};$.unescape=k.invert($.escape);var B={escape:new RegExp("["+k.keys($.escape).join("")+"]","g"),unescape:new RegExp("("+k.keys($.unescape).join("|")+")","g")};k.each(["escape","unescape"],function(e){k[e]=function(t){return null==t?"":(""+t).replace(B[e],function(t){return $[e][t]})}}),k.result=function(e,t){if(null!=e){var n=e[t];return k.isFunction(n)?n.call(e):n}},k.mixin=function(e){x(k.functions(e),function(t){var n=k[t]=e[t];k.prototype[t]=function(){var e=[this._wrapped];return a.apply(e,arguments),j.call(this,n.apply(k,e))}})};var A=0;k.uniqueId=function(e){var t=++A+"";return e?e+t:t},k.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var L=/(.)^/,O={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},F=/\\|'|\r|\n|\t|\u2028|\u2029/g;k.template=function(e,t,n){var i;n=k.defaults({},n,k.templateSettings);var r=new RegExp([(n.escape||L).source,(n.interpolate||L).source,(n.evaluate||L).source].join("|")+"|$","g"),o=0,a="__p+='";e.replace(r,function(t,n,i,r,s){return a+=e.slice(o,s).replace(F,function(e){return"\\"+O[e]}),n&&(a+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),i&&(a+="'+\n((__t=("+i+"))==null?'':__t)+\n'"),r&&(a+="';\n"+r+"\n__p+='"),o=s+t.length,t}),a+="';\n",n.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{i=new Function(n.variable||"obj","_",a)}catch(e){throw e.source=a,e}if(t)return i(t,k);var s=function(e){return i.call(this,e,k)};return s.source="function("+(n.variable||"obj")+"){\n"+a+"}",s},k.chain=function(e){return k(e).chain()};var j=function(e){return this._chain?k(e).chain():e};k.mixin(k),x(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=i[e];k.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!=e&&"splice"!=e||0!==n.length||delete n[0],j.call(this,n)}}),x(["concat","join","slice"],function(e){var t=i[e];k.prototype[e]=function(){return j.call(this,t.apply(this._wrapped,arguments))}}),k.extend(k.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),define("underscore",function(e){return function(){return e._}}(this));var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/content-blocks/content-editable.directive",["require","exports","vendor/ckeditor/ckeditor","underscore"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=__importDefault(i);var r=function(){function e(e,t){var r=this;this.require=["ngModel","^embTextBlock"],this.link=function(e,t,o,a){var s=a[0],l=a[1],c=n.inline(t[0],l.getCKConfig()),u=!1;c.on("instanceReady",function(e){e.editor.setReadOnly(!1)}),c.on("change",i.default.throttle(function(){r.$timeout(function(){u?(s.$setViewValue(c.getData()),r.modelActivityService.contentUpdated()):u=!0})},3e3)),t.on("blur",function(){r.$timeout(function(){u=!1,s.$setViewValue(c.getData()),r.modelActivityService.contentUpdated()})}),t.on("focus",function(){u=!0}),s.$render=function(){"ready"!==c.status&&t.html(s.$modelValue),c.setData(s.$modelValue)},e.$on("$destroy",function(){c.destroy()}),l.setCK(c)},this.modelActivityService=e,this.$timeout=t}return e.factory=function(t,n){return new e(t,n)},e}();t.ContentEditable=r}),define("ts/modules/emailbuilder/content-blocks/divider.directive",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.restrict="A",this.link=function(e,t){t.attr("id",function(){var t=e.block.tempContainer;return["emb-js-divider-",t.sectionIndex,"-",t.columnIndex].join("")}())}}return e.factory=function(){return new e},e}();t.Divider=n}),define("vendor/text",["module"],function(e){"use strict";var t,n,i,r,o,a=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],s=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,l=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,c="undefined"!=typeof location&&location.href,u=c&&location.protocol&&location.protocol.replace(/\:/,""),d=c&&location.hostname,h=c&&(location.port||void 0),p={},f=e.config&&e.config()||{};return t={version:"2.0.10",strip:function(e){if(e){e=e.replace(s,"");var t=e.match(l);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:f.createXhr||function(){var e,t,n;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;t<3;t+=1){n=a[t];try{e=new ActiveXObject(n)}catch(e){}if(e){a=[n];break}}return e},parseName:function(e){var t,n,i,r=!1,o=e.indexOf("."),a=0===e.indexOf("./")||0===e.indexOf("../");return-1!==o&&(!a||o>1)?(t=e.substring(0,o),n=e.substring(o+1,e.length)):t=e,i=n||t,o=i.indexOf("!"),-1!==o&&(r="strip"===i.substring(o+1),i=i.substring(0,o),n?n=i:t=i),{moduleName:t,ext:n,strip:r}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,i,r){var o,a,s,l=t.xdRegExp.exec(e);return!l||(o=l[2],a=l[3],a=a.split(":"),s=a[1],a=a[0],!(o&&o!==n||a&&a.toLowerCase()!==i.toLowerCase()||(s||a)&&s!==r))},finishLoad:function(e,n,i,r){i=n?t.strip(i):i,f.isBuild&&(p[e]=i),r(i)},load:function(e,n,i,r){if(r.isBuild&&!r.inlineText)return void i();f.isBuild=r.isBuild;var o=t.parseName(e),a=o.moduleName+(o.ext?"."+o.ext:""),s=n.toUrl(a),l=f.useXhr||t.useXhr;if(0===s.indexOf("empty:"))return void i();!c||l(s,u,d,h)?t.get(s,function(n){t.finishLoad(e,o.strip,n,i)},function(e){i.error&&i.error(e)}):n([a],function(e){t.finishLoad(o.moduleName+"."+o.ext,o.strip,e,i)})},write:function(e,n,i,r){if(p.hasOwnProperty(n)){var o=t.jsEscape(p[n]);i.asModule(e+"!"+n,"define(function () { return '"+o+"';});\n")}},writeFile:function(e,n,i,r,o){var a=t.parseName(n),s=a.ext?"."+a.ext:"",l=a.moduleName+s,c=i.toUrl(a.moduleName+s)+".js";t.load(l,i,function(n){var i=function(e){return r(c,e)};i.asModule=function(e,t){return r.asModule(e,c,t)},t.write(e,l,i,o)},o)}},"node"===f.env||!f.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]?(n=require.nodeRequire("fs"),t.get=function(e,t,i){try{var r=n.readFileSync(e,"utf8");0===r.indexOf("\ufeff")&&(r=r.substring(1)),t(r)}catch(e){i(e)}}):"xhr"===f.env||!f.env&&t.createXhr()?t.get=function(e,n,i,r){var o,a=t.createXhr();if(a.open("GET",e,!0),r)for(o in r)r.hasOwnProperty(o)&&a.setRequestHeader(o.toLowerCase(),r[o]);f.onXhr&&f.onXhr(a,e),a.onreadystatechange=function(t){var r,o;4===a.readyState&&(r=a.status,r>399&&r<600?(o=new Error(e+" HTTP status: "+r),o.xhr=a,i(o)):n(a.responseText),f.onXhrComplete&&f.onXhrComplete(a,e))},a.send(null)}:"rhino"===f.env||!f.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?t.get=function(e,t){var n,i,r=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),a=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(r),"utf-8")),s="";try{for(n=new java.lang.StringBuffer,i=a.readLine(),i&&i.length()&&65279===i.charAt(0)&&(i=i.substring(1)),null!==i&&n.append(i);null!==(i=a.readLine());)n.append(o),n.append(i);s=String(n.toString())}finally{a.close()}t(s)}:("xpconnect"===f.env||!f.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(i=Components.classes,r=Components.interfaces,Components.utils.import("resource://gre/modules/FileUtils.jsm"),o="@mozilla.org/windows-registry-key;1"in i,t.get=function(e,t){var n,a,s,l={};o&&(e=e.replace(/\//g,"\\")),s=new FileUtils.File(e);try{n=i["@mozilla.org/network/file-input-stream;1"].createInstance(r.nsIFileInputStream),n.init(s,1,0,!1),a=i["@mozilla.org/intl/converter-input-stream;1"].createInstance(r.nsIConverterInputStream),a.init(n,"utf-8",n.available(),r.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),a.readString(n.available(),l),a.close(),n.close(),t(l.value)}catch(e){throw new Error((s&&s.path||"")+": "+e)}}),t}),define("vendor/text!ts/modules/emailbuilder/content-blocks/event-code.directive.html",[],function(){return'<div class="qa-code-block">\r\n    <emb-content-toolbar block="block"></emb-content-toolbar>\r\n    <div class="emb-content-inner u-enable-select"\r\n         ng-class="{ \'emb-active\' : block.isActive, \'emb-hoverable\' : !block.isActive }">\r\n        <div class="emb-handle emb-js-content-handle emb-code-handle">&nbsp;</div>\r\n        <div class="code-content-placeholder"></div>\r\n    </div>\r\n</div>'}),define("ts/modules/emailbuilder/content-blocks/event-code.directive",["require","exports","vendor/text!ts/modules/emailbuilder/content-blocks/event-code.directive.html","vendor/codemirror/lib/codemirror","vendor/codemirror/mode/htmlmixed/htmlmixed","vendor/codemirror/addon/selection/active-line"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){var t=this;this.template=n,this.restrict="E",this.scope={block:"=block"},this.link=function(e,n,r,o){e.block.contents=e.block.contents||"";var a=$(".code-content-placeholder",n)[0];if(a){var s={lineNumbers:!0,mode:"htmlmixed",theme:"dracula",viewportMargin:1/0,value:e.block.contents,lineWrapping:!0,styleActiveLine:!0},l=i(function(e){a.parentNode.replaceChild(e,a)},s);l.on("change",function(){e.$apply(function(){e.block.contents=l.getValue(),t.modelActivityService.contentUpdated()})}),l.on("focus",function(e){e.setOption("styleActiveLine",!0)}),l.on("blur",function(e){e.setOption("styleActiveLine",!1)})}},this.modelActivityService=e}return e.factory=function(t){return new e(t)},e}();t.EventCode=r}),define("vendor/text!ts/modules/emailbuilder/content-blocks/image-block.directive.html",[],function(){return'<div>\r\n    <div class="c-toolbar-container">\r\n        <div class="c-toolbar" ng-if="!dragging && block.isActive && block.state.hasSrc && !preview">\r\n            <div class="c-toolbar__item" ng-if="(!block.state.uploading && block.state.fileUploaded) && imageBlockCropEnabled && !deleteConfirmation">\r\n                <button class="c-toolbar__button" ng-click="launchCrop(); $event.stopPropagation();">Crop</button>\r\n            </div>\r\n            <div class="c-toolbar__item" ng-if="block.state.fileUploaded && !deleteConfirmation">\r\n                <div class="c-toolbar__button" ng-click="$emit(\'toolbarItemActivated\')">\r\n                    <form>\r\n                        <label class="u-visually-hide" for="editor-image-chooser-figure">Upload image</label>\r\n                        <input emb-file-upload file="block" class="c-toolbar__upload-area emb-invisible-input" name="file" type="file" id="editor-image-chooser-figure" accepts="image/*">\r\n                    </form>\r\n                    Replace\r\n                </div>\r\n            </div>\r\n            <div class="c-toolbar__item" ng-if="canDelete">\r\n                <div emb-item-controls\r\n                        item-type="content"\r\n                        item="block"\r\n                        section-index="sectionIndex"\r\n                        content-index="column"\r\n                        item-hovered="hovered"\r\n                        narrow-controls="false"\r\n                        image-controls="true"\r\n                        closer="toggleDisplay"></div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <emb-validation-messages model="block" clear-on-inactive="1"></emb-validation-messages>\r\n    <div id="emb-js-image-{{block.tempContainer.sectionIndex}}-{{block.tempContainer.columnIndex}}" class="emb-content-inner emb-js-content-inner emb-js-content-handle emb-handle"\r\n         ng-class="{ \'emb-active\' :!dragging && block.isActive, \'emb-hoverable\' : !dragging && !block.isActive, \'emb-img-showing-dropzone\' :  !block.state.hasSrc }"\r\n         ng-mouseover="hovered = true; $event.stopPropagation()"\r\n         ng-mouseout="hovered = false;">\r\n        <div emb-item-controls item-type="content" item="block" section-index="sectionIndex" content-index="column" item-hovered="hovered"></div>\r\n        <div ng-show="!block.state.hasSrc && !(block.state.uploading || block.state.reloading)">\r\n            <div class="emb-js-img-container emb-img-dropzone emb-reset"\r\n                 ng-class="{ \'emb-error\' : !block.tempIsValid && block.isActive, \'emb-hovered\': hovered }">\r\n                <div class="emb-dropzone-container emb-js-dropzone-container">\r\n                    <div ng-class="{ \'emb-img-dropzone--is-interactive\' : !block.state.thirdPartyUrlTyping}" ng-if="!block.state.uploading">\r\n                        <form ng-hide="thirdPartyImagesEnabled">\r\n                            <input name="file" class="emb-invisible-input emb-handle js-image-upload" type="file" accepts="image/*" />\r\n                        </form>\r\n                        <div class="emb-drop-icon" style="display:inline-block" ng-if="!block.state.uploading">\r\n                            <span class="emb-image-well">Upload Image</span>\r\n                        </div>\r\n                        <div class="emb-image-text" ng-show="block.state.thirdPartyUrlTyping">\r\n                            <abbr cs-truncate="block.thirdPartyUrl"\r\n                                  side="{{truncateUrlSide}}"\r\n                                  max-width="{{truncateMaxWidth}}"\r\n                                  title="{{block.thirdPartyUrl}}"></abbr>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div ng-show="!block.state.hasSrc && (block.state.uploading || block.state.reloading) && !preview" ng-style="getContainerStyle()">\r\n            <div class="emb-js-img-container emb-img-dropzone emb-reset emb-image-loading" ng-style="getReloadStyle()">\r\n                <div class="loading-animation">\r\n                    <span></span>\r\n                    <span></span>\r\n                    <span></span>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div ng-show="block.state.hasSrc && !block.state.thirdPartyUrlError && !preview">\r\n            <div class="loading loading--stand-out" ng-show="block.tempDownloadingImg">\r\n                <div class="loading__inner">\r\n                    <span class="loading__inner__dot"></span>\r\n                    <span class="loading__inner__dot"></span>\r\n                    <span class="loading__inner__dot"></span>\r\n                </div>\r\n            </div>\r\n            <div ng-transclude\r\n                 class="emb-js-img-container emb-img-container qa-email-image-thumbnail-container"\r\n                 ng-class="{ \'emb-error\' : !block.tempIsValid && block.isActive }">\r\n            </div>\r\n        </div>\r\n        <div ng-if="preview" ng-style="getContainerStyle()">\r\n            <div ng-style="getPreviewStyle()"></div>\r\n        </div>\r\n        <div ng-show="block.state.thirdPartyUrlError">\r\n            <div class="emb-js-img-container emb-img-dropzone emb-img-error emb-reset">\r\n                <div class="emb-dropzone-container emb-js-dropzone-container">\r\n                    <div class="emb-drop-icon">\r\n                        <div class="emb-image-error"></div>\r\n                        <div class="emb-image-error-text">Unable to load image</div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n'}),
define("ts/modules/emailbuilder/content-blocks/image-block.controller",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n){var i=this;this.configureResizeHandling=function(){var e=i.scope,t=i.itemWidthService.getBlockWidth(e.block),n=e.block.tempContainerWidth;e.block.displayWidth||(e.block.displayWidth=t);var r=void 0===e.block.tempContainerWidth,o=e.block.displayWidth===t;r&&!o&&(e.block.tempManuallySetWidth=e.block.displayWidth,e.block.tempHasManuallySetWidth=!0);var a=n<t,s=e.block.displayWidth===n;a&&s&&(e.block.displayWidth=e.block.tempHasManuallySetWidth?e.block.tempManuallySetWidth:t),e.block.displayWidth&&e.block.displayWidth>t&&(e.block.displayWidth=t),e.block.tempContainerWidth=t},this.handleDisplayWidthChange=function(e,t){var n=i.scope;if(e!==t){var r=n.block.tempContainerWidth;if(!(e===r&&t>r)){e===n.block.tempContainerWidth?(n.block.tempManuallySetWidth=0,n.block.tempHasManuallySetWidth=!1):(n.block.tempManuallySetWidth=e,n.block.tempHasManuallySetWidth=!0)}}},this.handleNewImage=function(e,t){if(e!==t){i.scope.block.displayWidth===t&&(i.scope.block.displayWidth=Math.min(e,i.scope.block.tempContainerWidth))}},this.scope=e,this.emailBuilderConfig=t,this.itemWidthService=n,this.emailBuilderConfig.email.isBlueprint?this.configureResizeHandling():e.block.displayWidth=void 0}return e}();t.ImageBlockController=n});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/content-blocks/image-block.directive",["require","exports","vendor/text!ts/modules/emailbuilder/content-blocks/image-block.directive.html","angular","underscore","./image-block.controller"],function(e,t,n,i,r,o){"use strict";function a(e){return e<300}Object.defineProperty(t,"__esModule",{value:!0}),i=__importDefault(i),r=__importDefault(r);var s=function(){function e(e,t,s,l,c,u,d,h,p,f,m,g){var v=this;this.restrict="A",this.template=n,this.transclude=!0,this.scope=!0,this.controller=["$scope","EmailBuilderConfig","ItemWidthService",o.ImageBlockController],this.link=function(e,t,n,o){v.emailBuilderConfig.email.isBlueprint&&(e.$watch("block.displayWidth",o.handleDisplayWidthChange),e.$watch("block.tempWidth",o.handleNewImage));var s=v.emailBuilderConfig.email.isBlueprint;s&&e.$watch("block.src",o.handleNewImage),e.deleteConfirmation=!1,e.imageBlockCropEnabled=s;var l=function(t){var n=v.lockLevelService.getLocks(t);e.canDelete=n.canDeleteContentItems};l(e.section.permissions),e.$on("permissionsChanged:section-"+e.section.uiId,function(e,t){l(t)});v.$document.find(".emb-js-image-upload");e.thirdPartyImagesEnabled=v.emailBuilderConfig.canvasThirdPartyImageUrlEnabled,e.truncateUrlSide=a(e.width)?"left":"center",e.truncateMaxWidth=t[0].clientWidth-30,e.launchCrop=function(){v.$rootScope.$emit("imageBlock:cropStaged",e.block)},e.getContainerStyle=function(){return{display:"flex","justify-content":{left:"flex-start",right:"flex-end",center:"center"}[e.block.halign]}},e.getPreviewStyle=function(){var t=e.block.crop||{width:e.block.originalWidth,height:e.block.originalHeight,x:0,y:0},n=e.block.tempPreviousCrop?e.block.tempPreviousCrop.width:e.block.originalWidth,i=e.block.displayWidth===n?e.block.tempContainerWidth:e.block.displayWidth,r=Math.min(t.width,i),o=Math.min(r/t.width,1);return{width:r+"px",height:t.height*o+"px","background-image":"url("+(v.emailBuilderConfig.urls.imagePrefix+e.block.fileName)+")","background-position":-t.x*o+"px "+-t.y*o+"px","background-size":e.block.originalWidth*o+"px "+e.block.originalHeight*o+"px"}},e.getReloadStyle=function(){return e.block.state.reloading?{height:e.block.tempHeight,width:e.block.tempWidth}:{}},e.$on("imageBlock:cropperReady",function(t,n){n===e.block&&(e.preview=!0)});var c={},u=function(t){if(!c[e.block.src]){v.$rootScope.$broadcast("image:reloading",{block:t});var n=new Image;n.onload=function(){v.$timeout(function(){v.$rootScope.$emit("image:reloaded",{block:t})})},n.src=e.block.src}},d=function(e){return v.contentBlockService.getBlockSrc(e.block)},h=function(){e.preview=!1,e.block.src=d(e),u(e.block),v.modelActivityService.contentUpdated(),v.imageBuilderService.resize(e.block);var t=e.block.tempPreviousCrop?e.block.tempPreviousCrop.width:void 0,n=e.block.crop?e.block.crop.width:e.block.originalWidth;o.handleNewImage(n,t)};e.$on("imageBlock:closeCropStage",function(t,n){n===e.block&&h()}),e.$on("undo:modelChanged",function(){if(e.block.fileName)return v.$rootScope.$broadcast("image:redoSetFilename",{block:e.block}),void(s&&(e.block.src=d(e),v.imageBuilderService.resize(e.block)));e.block.thirdPartyUrl||(e.block.src="",e.block.tempThirdPartyUrl="",v.$rootScope.$broadcast("image:deleted",{block:e.block}))}),e.block.state=v.imageUiStateService.current(e.block),e.block.src=v.personalisationService.replaceWithFallback(v.contentBlockService.getBlockSrc(e.block)),e.$watch(d,function(t,n){e.block.thirdPartyUrl&&t!==n&&v.$rootScope.$broadcast("thirdPartyImage:typing",{block:e.block})});var p,f=function(){var e=t.find('input[type="file"]');e.length>0&&e.parent()[0].reset()},m=function(e){if(p&&(p(),p=null),e&&!c[e]){var t=new Image;t.onload=function(){v.$timeout(function(){c[e]=!0})},t.src=e,p=function(){t.src=""}}};e.$watch(d,r.default.debounce(function(t,n){if(f(),e.allowReplace=!t,e.block.src=v.personalisationService.replaceWithFallback(t),m(e.block.src),e.block.thirdPartyUrl){var i=t!==n;v.thirdPartyImageDownloaderService.retrieveImage(e.block,i)}},500)),v.$rootScope.$$postDigest(function(){v.$rootScope.$$postDigest(function(){t.find(".emb-img-dropzone").css({position:"static"}).css({position:"relative"})})}),e.$on("content:showConfirmation",function(){e.deleteConfirmation=!0}),e.$on("content:hideConfirmation",function(){e.deleteConfirmation=!1});var g=v;t.on({change:function(){if(""!==i.default.element(this).val()){var t=this.files[0];g.imageManagerService.uploadAsync({file:t,block:function(){return e.block}})}}},".js-image-upload")},this.imageManagerService=e,this.imageUiStateService=t,this.thirdPartyImageDownloaderService=s,this.personalisationService=l,this.$rootScope=c,this.$document=u,this.lockLevelService=d,this.contentBlockService=h,this.emailBuilderConfig=p,this.$timeout=f,this.imageBuilderService=m,this.modelActivityService=g}return e.factory=function(t,n,i,r,o,a,s,l,c,u,d,h){return new e(t,n,i,r,o,a,s,l,c,u,d,h)},e}();t.ImageBlock=s}),define("vendor/text!ts/modules/emailbuilder/content-blocks/preview-text.directive.html",[],function(){return'<div ng-show="email.previewText.contents !== \'\'">\r\n    <div class="emb-hoverable emb-content-inner" ng-show="email.previewText.showInPreheader">\r\n        {{email.previewText.contents}}\r\n    </div>\r\n</div>'}),define("ts/modules/emailbuilder/content-blocks/preview-text.directive",["require","exports","vendor/text!ts/modules/emailbuilder/content-blocks/preview-text.directive.html"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this.restrict="A",this.scope=!0,this.template=n}return e.prototype.link=function(e,t){t.on("click",function(e){setTimeout(function(){var e=$(".c-sidebar__settings"),t=e.scrollTop(),n=$("#inbox-preview-settings").position().top;e.animate({scrollTop:t+n},300),$(".c-sidebar__form-textarea").focus()},400)})},e.factory=function(){return new e},e}();t.PreviewText=i}),define("vendor/text!ts/modules/emailbuilder/content-blocks/text-block.directive.html",[],function(){return'<div class="emb-content-inner emb-js-text-container"\r\n     ng-class="{ \'emb-text-content-inner\': inSection, \'emb-active\' : activeNotDragged(), \'emb-hoverable\' : notActive() && canEdit}"\r\n     ng-mouseover="hovered = true; $event.stopPropagation()"\r\n     ng-mouseout="hovered = false"\r\n     style="position:relative">\r\n    <div ng-if="::inSection" class="emb-handle emb-js-content-handle emb-text-handle">&nbsp;</div>\r\n    <div class="emb-text-editor emb-js-text-content" contenteditable ng-style="editorStyle" ng-model="block.contents" ng-show="canEdit"></div>\r\n    <div class="emb-content-placeholder" ng-bind-html="ckData()" ng-show="!canEdit"></div>\r\n    <div class="c-toolbar-outer-container emb-texttools emb-reset" ng-if="inSection && block.isActive && !dragging" ng-class="{\'c-toolbar-outer-container--fixed\' : offScreen, \'emb-narrow-controls\' : toolbar.narrowControls}">\r\n        <div class="c-toolbar-container emb-toolbar" ng-class="{\'emb-narrow-toolbar\' : toolbar.narrowControls }">\r\n            <div class="c-toolbar qa-toolbar">\r\n                <div class="c-toolbar__item" ng-show="!toolbar.deleteConfirmation">\r\n                    <button class="c-toolbar__button has-dropdown qa-textstyle" ng-class="{ \'emb-selected\': toolbar.display === \'styles\' }" ng-click="toolbar.toggleDisplay(\'styles\')">{{ toolbar.currentStyle.display || \'Styles\' }}</button>\r\n                    <nav class="l-toolbar-dropdown-container emb-toolbar-context-box emb-context-style emb-style-list" ng-show="toolbar.display === \'styles\'" ng-click="toolbar.display = false;">\r\n\r\n                        <ol class="emb-context-list emb-context-top-level emb-reset">\r\n                            <li class="emb-style emb-context-list-item emb-h1 emb-unreset" emb-text-command="h1">\r\n                                <span>Heading 1</span>\r\n                            </li>\r\n                            <li class="emb-style emb-context-list-item emb-h2 emb-unreset" emb-text-command="h2">\r\n                                <span>Heading 2</span>\r\n                            </li>\r\n                            <li class="emb-style emb-context-list-item emb-h3 emb-unreset" emb-text-command="h3">\r\n                                <span>Heading 3</span>\r\n                            </li>\r\n                            <li class="emb-style emb-context-list-item emb-p emb-unreset" emb-text-command="p">\r\n                                <span>Normal text</span>\r\n                            </li>\r\n                            <li class="emb-style emb-context-list-item emb-ol emb-unreset" emb-text-command="numberedlist">\r\n                                <ol>\r\n                                    <li>Numbered list</li>\r\n                                </ol>\r\n                            </li>\r\n                            <li class="emb-style emb-context-list-item emb-ul emb-unreset" emb-text-command="bulletedlist">\r\n                                <ul>\r\n                                    <li>Bulleted list</li>\r\n                                </ul>\r\n                            </li>\r\n                            <li class="emb-style emb-context-list-item emb-p emb-blockquote emb-unreset" emb-text-command="blockquote">\r\n                                <span>Quote</span>\r\n                            </li>\r\n                        </ol>\r\n                    </nav>\r\n                </div>\r\n                <div class="c-toolbar__item"\r\n                     ng-show="!toolbar.deleteConfirmation && !toolbar.restrictedTextStyles">\r\n                    <button class="c-toolbar__button has-dropdown qa-textfont" ng-class="{ \'emb-selected\': toolbar.display === \'font\' }" ng-click="toolbar.toggleDisplay(\'font\')">{{ toolbar.currentFont || \'Font\' }}</button>\r\n                    <nav class="l-toolbar-dropdown-container emb-toolbar-context-box emb-font-family-dropdown emb-context-style emb-style-list qa-textfont-options" ng-show="toolbar.display === \'font\'" ng-click="toolbar.display = false;">\r\n                        <div class="toolbar__inner-overflow" cs-custom-scroll>\r\n                            <ol class="emb-context-list emb-context-top-level emb-reset">\r\n                                <li class="emb-style emb-context-list-item emb-unreset" ng-repeat="font in ::toolbar.fonts" data-value="{{::font.value}}" data-display="{{::font.display}}" ng-click="toolbar.setFont(font.value)" ng-class="{ \'emb-selected\': font.display === toolbar.currentFont }">\r\n                                    <span ng-style="font.cssValues" class="emb-font-family">{{::font.display}}</span>\r\n                                </li>\r\n                            </ol>\r\n                        </div>\r\n                    </nav>\r\n                </div>\r\n                <div class="c-toolbar__item"\r\n                     ng-show="!toolbar.deleteConfirmation && !toolbar.restrictedTextStyles">\r\n                    <button class="c-toolbar__button has-dropdown emb-font-size qa-fontsize" ng-class="{ \'emb-selected\': toolbar.display === \'fontSize\' }" ng-click="toolbar.toggleDisplay(\'fontSize\')">{{ toolbar.currentFontSize || \'14\' }}</button>\r\n                    <nav class="l-toolbar-dropdown-container emb-toolbar-context-box emb-font-family-dropdown emb-context-style emb-style-list emb-font-size-dropdown" ng-show="toolbar.display === \'fontSize\'" ng-click="toolbar.display = false;">\r\n                        <div class="toolbar__inner-overflow" cs-custom-scroll>\r\n                            <ol class="emb-context-list emb-context-top-level emb-reset">\r\n                                <li class="emb-style emb-context-list-item emb-unreset" ng-repeat="size in ::toolbar.fontSizes" ng-click="toolbar.setFontSize(size[0], size[1])" ng-class="{ \'emb-selected\': size[0] == toolbar.currentFontSize }">\r\n                                    <span class="emb-font-value">{{::size[0]}}</span>\r\n                                </li>\r\n                            </ol>\r\n                        </div>\r\n                    </nav>\r\n                </div>\r\n                <div class="c-toolbar__item" ng-show="!toolbar.deleteConfirmation">\r\n                    <button class="c-toolbar__button c-toolbar__button--has-icon" emb-text-command="bold">\r\n                        <span class="c-toolbar__button-icon c-toolbar__button-icon--bold"></span>\r\n                        Bold\r\n                    </button>\r\n                </div>\r\n                <div class="c-toolbar__item" ng-show="!toolbar.deleteConfirmation">\r\n                    <button class="c-toolbar__button c-toolbar__button--has-icon" emb-text-command="italic">\r\n                        <span class="c-toolbar__button-icon c-toolbar__button-icon--italics"></span>\r\n                        Italics\r\n                    </button>\r\n                </div>\r\n                <div class="c-toolbar__item"\r\n                     ng-show="!toolbar.deleteConfirmation && !toolbar.restrictedTextStyles">\r\n                    <button class="c-toolbar__button c-toolbar__button--has-icon emb-text-color qa-textcolor" ng-class="{ \'emb-selected\': toolbar.display === \'textColor\' }" emb-text-command="showTextColor">\r\n                        <span class="c-toolbar__button-icon c-toolbar__button-icon--text-color"></span>\r\n                        <span class="c-toolbar__button-icon c-toolbar__button-icon--text-color-base">\r\n                        </span>\r\n                        Text Color\r\n                    </button>\r\n                    <div class="c-colorpicker c-colorpicker--toolbar c-colorpicker--dark ff-colorpicker--recent" ng-show="toolbar.display === \'textColor\'">\r\n                        <div cs-color-picker cs-color-picker-color-changed="toolbar.setTextColor()" cs-color-picker-validate-on-blur="false" cs-color-picker-always-open="true" cs-viewport="" ng-model="toolbar.textColor"></div>\r\n                    </div>\r\n                </div>\r\n                <div class="c-toolbar__item" ng-show="!toolbar.deleteConfirmation">\r\n                    <button class="c-toolbar__button c-toolbar__button--has-icon" ng-class="{ \'emb-selected\': toolbar.display === \'link\' }" emb-text-command="showLink">\r\n                        <span class="c-toolbar__button-icon c-toolbar__button-icon--link"></span>\r\n                        Link\r\n                    </button>\r\n                    <div class="l-toolbar-dropdown-container emb-toolbar-context-box emb-context-link" ng-show="toolbar.display === \'link\'">\r\n                        <form novalidate ng-submit="toolbar.addLink(\'addLink\', $event)">\r\n                            <fieldset class="emb-toolbar-input">\r\n                                <input type="text" class="emb-js-link-field" ng-model="toolbar.url" required cs-valid-url placeholder="{{toolbar.linkPlaceholderText}}" />\r\n                                <button type="submit" class="emb-tick"></button>\r\n                            </fieldset>\r\n                            <p class="emb-remove-link" emb-text-command="unlink">Remove link</p>\r\n                        </form>\r\n                    </div>\r\n                </div>\r\n                <div class="c-toolbar__item"\r\n                     ng-show="!toolbar.deleteConfirmation && !toolbar.restrictedTextStyles">\r\n                    <button class="c-toolbar__button c-toolbar__button--has-icon c-toolbar__button--has-alignment-icon emb-selected" safe-command="true" emb-text-command="justifyleft" ng-click="toolbar.toggleDisplay(\'alignment\')" ng-class="{\'is-closed\' : toolbar.display !== \'alignment\'}">\r\n                        <span class="c-toolbar__button-icon c-toolbar__button-icon--justify-left"></span>\r\n                        Justify Left\r\n                    </button>\r\n                    <button class="c-toolbar__button c-toolbar__button--has-icon c-toolbar__button--has-alignment-icon" safe-command="true" emb-text-command="justifycenter" ng-click="toolbar.toggleDisplay(\'alignment\')" ng-class="{\'is-closed\' : toolbar.display !== \'alignment\'}">\r\n                        <span class="c-toolbar__button-icon c-toolbar__button-icon--justify-center"></span>\r\n                        Justify Center\r\n                    </button>\r\n                    <button class="c-toolbar__button c-toolbar__button--has-icon c-toolbar__button--has-alignment-icon" safe-command="true" emb-text-command="justifyright" ng-click="toolbar.toggleDisplay(\'alignment\')" ng-class="{\'is-closed\' : toolbar.display !== \'alignment\'}">\r\n                        <span class="c-toolbar__button-icon c-toolbar__button-icon--justify-right"></span>\r\n                        Justify Right\r\n                    </button>\r\n                    <nav class="l-toolbar-dropdown-container c-toolbar__alignment-container emb-toolbar-context-box emb-context-alignment" ng-show="toolbar.display === \'alignment\'" ng-click="toolbar.display = false">\r\n                        <ol class="c-toolbar__alignment-list emb-context-top-level emb-reset">\r\n                            <li class="emb-style c-toolbar__button c-toolbar__button--has-icon emb-justify-left emb-unreset" add-unselected-class="true" emb-text-command="justifyleft">\r\n                                <span class="c-toolbar__button-icon c-toolbar__button-icon--justify-left"></span>\r\n                                <span>Justify Left</span>\r\n                            </li>\r\n                            <li class="emb-style c-toolbar__button c-toolbar__button--has-icon emb-justify-center emb-unreset" add-unselected-class="true" emb-text-command="justifycenter">\r\n                                <span class="c-toolbar__button-icon c-toolbar__button-icon--justify-center"></span>\r\n                                <span>Justify Center</span>\r\n                            </li>\r\n                            <li class="emb-style c-toolbar__button c-toolbar__button--has-icon emb-justify-right emb-unreset" add-unselected-class="true" emb-text-command="justifyright">\r\n                                <span class="c-toolbar__button-icon c-toolbar__button-icon--justify-right"></span>\r\n                                <span>Justify Right</span>\r\n                            </li>\r\n                        </ol>\r\n                    </nav>\r\n                </div>\r\n                <div class="c-toolbar__item" ng-show="!toolbar.deleteConfirmation">\r\n                    <button class="c-toolbar__button has-dropdown" ng-class="{ \'emb-selected\': toolbar.display === \'insert\' }" ng-click="toolbar.toggleDisplay(\'insert\')">Insert</button>\r\n                    <div class="l-toolbar-dropdown-container emb-toolbar-context-box emb-context-insert"\r\n                         ng-show="toolbar.display === \'insert\'"\r\n                         ng-class="\'emb-showing-level-\' + toolbar.displayLevel">\r\n                        <div class="emb-heirarchy-container">\r\n                            <div class="emb-levels-container">\r\n                                <ol class="emb-context-list emb-context-top-level emb-level emb-level-1">\r\n                                    <li class=\'emb-context-list-item emb-context-parent\' ng-hide="::toolbar.isTransactional" ng-click="toolbar.toggleLevel(\'personal\', 2)">Personalization</li>\r\n                                    <li class=\'emb-context-list-item\' ng-show="::toolbar.isTransactional" emb-text-command="emailvariable">Email variable</li>\r\n                                    <li class=\'emb-context-list-item emb-context-parent\' ng-click="toolbar.toggleLevel(\'date\', 2)">Dates</li>\r\n                                    <li class=\'emb-context-list-item emb-context-parent\' ng-if="::!toolbar.isTransactional && toolbar.hasCustomFields" ng-click="toolbar.toggleLevel(\'custom\', 2)">Custom fields</li>\r\n                                    <li class=\'emb-context-list-item emb-context-parent\' ng-click="toolbar.toggleLevel(\'social\', 2)">Social sharing</li>\r\n                                </ol>\r\n                                <div class="emb-level emb-level-2" ng-show="toolbar.subDisplay === \'personal\'" ng-click="toolbar.toggleLevel(\'\', 1)">\r\n                                    <header class="emb-context-item emb-context-header">\r\n                                        <h5>Personalization</h5>\r\n                                    </header>\r\n                                    <ol class="emb-context-list" ng-click="toolbar.display = false">\r\n                                        <li class="emb-context-list-item" emb-text-command="firstname">First name</li>\r\n                                        <li class="emb-context-list-item" emb-text-command="lastname">Last name</li>\r\n                                        <li class="emb-context-list-item" emb-text-command="fullname">Full name</li>\r\n                                        <li class="emb-context-list-item" emb-text-command="email">Email</li>\r\n                                    </ol>\r\n                                </div>\r\n                                <div class="emb-level emb-level-2" ng-if="::!toolbar.isTransactional && toolbar.hasCustomFields" ng-show="toolbar.subDisplay === \'custom\'">\r\n                                    <header class="emb-context-item emb-context-header" ng-click="toolbar.toggleLevel(\'\', 1)">\r\n                                        <h5>Custom fields</h5>\r\n                                    </header>\r\n                                    <ol class="emb-context-list">\r\n                                        <li class="emb-context-list-item emb-context-parent" ng-repeat="list in ::toolbar.lists" ng-click="toolbar.toggleLevel(\'custom\', 3, list)" cs-truncate="list.title" max-width="151" side="center"></li>\r\n                                    </ol>\r\n                                </div>\r\n                                <div class="emb-level emb-level-3" ng-if="::!toolbar.isTransactional && toolbar.hasCustomFields" ng-show="toolbar.subDisplay === \'custom\'" ng-click="toolbar.toggleLevel(\'\', 1)">\r\n                                    <header class="emb-context-item emb-context-header" ng-click="toolbar.toggleLevel(\'custom\', 2)">\r\n                                        <h5 cs-truncate="toolbar.menuItem.title" max-width="151" side="center"></h5>\r\n                                    </header>\r\n                                    <ol class="emb-context-list" ng-click="toolbar.display = false">\r\n                                        <li class="emb-context-list-item" ng-repeat="field in toolbar.menuItem.fields" emb-text-command="{{::field.tag }}" cs-truncate="field.title" max-width="151" side="center"></li>\r\n                                    </ol>\r\n                                </div>\r\n                                <div class="emb-level emb-level-2" ng-show="toolbar.subDisplay === \'date\'" ng-click="toolbar.toggleLevel(\'\', 1)">\r\n                                    <header class="emb-context-item emb-context-header">\r\n                                        <h5>Dates</h5>\r\n                                    </header>\r\n                                    <ol class="emb-context-list" ng-click="toolbar.display = false">\r\n                                        <li class="emb-context-list-item" emb-text-command="currentday">Current day</li>\r\n                                        <li class="emb-context-list-item" emb-text-command="currentdayname">Current day name</li>\r\n                                        <li class="emb-context-list-item" emb-text-command="currentmonth">Current month</li>\r\n                                        <li class="emb-context-list-item" emb-text-command="currentmonthname">Current month name</li>\r\n                                        <li class="emb-context-list-item" emb-text-command="currentyear">Current year</li>\r\n                                    </ol>\r\n                                </div>\r\n                                <div class="emb-level emb-level-2" ng-show="toolbar.subDisplay === \'social\'">\r\n                                    <header class="emb-context-item emb-context-header" ng-click="toolbar.toggleLevel(\'\', 1)">\r\n                                        <h5>Social sharing</h5>\r\n                                    </header>\r\n                                    <ol class="emb-context-list">\r\n                                        <li class="emb-context-list-item" emb-text-command="tweet">Tweet</li>\r\n                                        <li class="emb-context-list-item" emb-text-command="like">Like this email on Facebook</li>\r\n                                        <li class="emb-context-list-item emb-context-parent" ng-click="toolbar.toggleLevel(\'social\', 3)">Like a page on Facebook</li>\r\n                                    </ol>\r\n                                </div>\r\n                                <div class="emb-level emb-level-3" ng-show="toolbar.subDisplay === \'social\'">\r\n                                    <header class="emb-context-item emb-context-header" ng-click="toolbar.toggleLevel(\'social\', 2)">\r\n                                        <h5>Like a page on Facebook</h5>\r\n                                    </header>\r\n                                    <form novalidate ng-submit="toolbar.addLink(\'like\', $event)">\r\n                                        <fieldset class="emb-toolbar-input">\r\n                                            <input type="text" class="emb-js-href-field" ng-model="toolbar.url" required cs-valid-url />\r\n                                            <button type="submit" class="emb-tick"></button>\r\n                                        </fieldset>\r\n                                    </form>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class="c-toolbar__item"\r\n                     ng-if="toolbar.canDelete">\r\n                    <div emb-item-controls\r\n                            item-type="content"\r\n                            item="block"\r\n                            section-index="sectionIndex"\r\n                            content-index="column"\r\n                            item-hovered="hovered"\r\n                            narrow-controls="toolbar.narrowControls"\r\n                            text-controls="true"\r\n                            closer="toolbar.toggleDisplay"></div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class="js-delete-controls emb-content-controls emb-reset" ng-show="showTrashcan && hovered && toolbar.canDelete">\r\n        <div id="content-confirm-optional-text"\r\n              class="c-button-delete emb-js-animation-allowed"\r\n              ng-click="showConfirmationForTrashcan()"\r\n              ng-class="{ \'is-selected\' : confirmation,  \'is-active\' : activeNotDragged(), \'is-inactive\' : !(activeNotDragged()) }">\r\n            <button id="content-delete-optional-text" class="c-button-delete__confirm" ng-click="remove(); $event.stopPropagation();">Delete</button>\r\n            <button class="c-button-delete__cancel" ng-click="hideConfirmation(); $event.stopPropagation()">Cancel</button>\r\n        </div>\r\n    </div>\r\n</div>\r\n'}),define("ts/modules/emailbuilder/constants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.FALLBACK_LANGUAGE="English";t.EMAIL_BODY_SELECTOR="#emb-js-email-body";t.LINK_PLACEHOLDER_TEXT="http(s):// or mailto: or tel: or sms:"});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/content-blocks/text-block.controller",["require","exports","vendor/ckeditor/ckeditor","angular","../constants"],function(e,t,n,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=__importDefault(i);var o=/<style([\S\s]*?)>([\S\s]*?)<\/style>|<xml([\S\s]*?)>([\S\s]*?)<\/xml>|<span([\S\s]*?)>|<\/span>|<!--([\S\s]*?)\-->/gi,a=function(){function e(e,t,a,s,l,c){var u=this;this.initCK=function(e){function t(e){for(var t=0;t<a.toolbar.fonts.length;t++)if(a.toolbar.fonts[t].value===e)return a.toolbar.fonts[t].display;return""}function i(t){return!(!e.element||!t.focusNode)&&(e.element.$===t.focusNode.parentElement||!(!t.focusNode.parentElement||e.element.$!==t.focusNode.parentElement.parentElement))}var r=u,a=u.$scope,s=function(){"<p></p>"===r.$scope.block.contents&&r.setCursor()};e.on("focus",function(e){a.skipFocus||r.$timeout(function(){a.makeActive(),s(),a.toolbar.toggleDisplay(),r.resetPlaceholder()})}),e.on("blur",function(e){r.setPlaceholder();var t=window.getSelection();i(t)&&t.removeAllRanges()}),e.on("link",function(e){r.$timeout(function(){a.toolbar.url=e.data?r.linkModelProviderService.getModelFor(e.data.data("cke-saved-href")):"",a.toolbar.toggleDisplay("link")})}),e.on("pluginsLoaded",function(e){e.editor.dataProcessor.dataFilter.addRules({comment:function(){return!1}})}),e.on("paste",function(e){var t=/(class=\"?Mso|style=\"[^\"]*\bmso\-|w:WordDocument)/gm,i=e.data.dataValue;if(t.test(i)&&(i=i.replace(o,""),e.data.dataValue=i),a.toolbar.restrictedTextStyles&&e.data.dataTransfer.sourceEditor!==e.editor){var r=new n.filter("p h1 h2 h3 ul ol li blockquote strong em br");r.allow("a img[*](*)");var s=n.htmlParser.fragment.fromHtml(e.data.dataValue),l=new n.htmlParser.basicWriter;r.applyTo(s),s.writeHtml(l),e.data.dataValue=l.getHtml(!1)}}),e.on("textColor",function(e){r.$timeout(function(){a.toolbar.textColor=e.data,"textColor"===a.toolbar.display&&r.recentColorService.addRecentColor(a.toolbar.textColor),a.toolbar.toggleDisplay("textColor"),a.originalColor=a.toolbar.textColor})}),e.on("textBgColor",function(e){r.$timeout(function(){a.textBgColor=e.data,"textBgColor"===a.toolbar.display&&r.recentColorService.addRecentColor(a.textBgColor),a.toolbar.toggleDisplay("textBgColor"),a.originalBgColor=a.textBgColor})}),e.on("fontSize",function(e){r.$timeout(function(){a.fontSize=e.data,
a.toolbar.toggleDisplay("fontSize"),a.toolbar.currentFontSize=a.fontSize.replace("px","")})}),e.on("currentFontSize",function(e){r.$timeout(function(){a.toolbar.currentFontSize=e.data.replace("px","")})});var l={p:u.emailBuilderConfig.email.styles.p.fontFamily,h1:u.emailBuilderConfig.email.styles.h1.fontFamily,h2:u.emailBuilderConfig.email.styles.h2.fontFamily,h3:u.emailBuilderConfig.email.styles.h3.fontFamily};e.on("font",function(e){r.$timeout(function(){var n=t(e.data);if(!n&&a.toolbar.currentStyle){n=t(l[a.toolbar.currentStyle.value])}a.toolbar.currentFont=n})}),e.on("style",function(e){var t={h1:"Heading 1",h2:"Heading 2",h3:"Heading 3"};r.$timeout(function(){a.toolbar.currentStyle={value:e.data,display:t[e.data]||"Normal text"}})}),a.singleline&&e.on("key",function(e){13===e.data.keyCode&&e.cancel()})},this.emptyText="&nbsp;",this.resetPlaceholder=function(){var e=u.$scope.block;e.isPlaceholder&&(e.isPlaceholder=!1,u.setCursor(),u.$timeout(function(){e.contents=u.emptyText},100))},this.setCursor=function(){var e=u.ck.createRange();e.moveToElementEditEnd(e.root),e.collapse(!0),e.select()},this.setPlaceholder=function(){var e=u.$scope.block,t=u.$scope.placeholder;e||(u.$scope.block={isPlaceholder:!0,contents:t}),!t||e.contents&&e.contents!==u.emptyText||u.$timeout(function(){e.isPlaceholder=!0,e.contents=t})},this.setCK=function(e){u.ck=e,u.usesCkEditorCallbacks.forEach(function(t){t(e)})},this.usesCK=function(e){u.ck?e(u.ck):u.usesCkEditorCallbacks.push(e)},this.getCKConfig=function(){var e=u.editorConfiguration;return("br"===u.$scope.enterMode||u.$scope.singleline)&&(e=i.default.copy(u.editorConfiguration),e.enterMode=n.ENTER_BR,e.forcePasteAsPlainText=!0),e},this.$scope=e,this.$timeout=t,this.linkModelProviderService=a,this.recentColorService=s,this.emailBuilderConfig=l,this.usesCkEditorCallbacks=[function(e){u.initCK(e)}];var d=i.default.copy(l.listsWithCustomFields);this.$scope.toolbar={narrowControls:!1,deleteConfirmation:!1,display:!1,subDisplay:!1,displayLevel:1,currentStyle:null,toggleDisplay:function(t){"textColor"===e.toolbar.display&&e.originalColor!==e.toolbar.textColor&&u.recentColorService.addRecentColor(e.toolbar.textColor),"textBgColor"===e.toolbar.display&&e.originalBgColor!==e.textBgColor&&u.recentColorService.addRecentColor(e.textBgColor),t&&c.$emit("text:command"),t&&e.toolbar.display!==t||(t=!1),e.toolbar.displayLevel=1,e.toolbar.display=t,e.toolbar.subDisplay=""},restrictedTextStyles:!1,toggleLevel:function(t,n,i){e.toolbar.displayLevel=n||1,e.toolbar.subDisplay=t||!1,e.toolbar.menuItem=i||e.toolbar.menuItem,3===n&&"social"===t&&setTimeout(function(){e.selectFbLink()},450)},isTransactional:l.mode.isTransactional,lists:d,hasCustomFields:!!d.length,fonts:i.default.copy(l.fonts),fontSizes:[[8,14],[9,16],[10,18],[11,19],[12,19],[13,21],[14,21],[15,23],[16,24],[17,26],[18,26],[20,28],[22,31],[24,32],[26,34],[28,36],[30,38],[32,40],[34,43],[36,43],[40,47],[44,50],[48,54],[56,60],[64,63]],currentFont:"",currentFontSize:"",setFontSize:function(e,t){u.$timeout(function(){u.usesCK(function(n){n.execCommand("setFontSize",{fontSize:e+"px",lineHeight:t+"px"})})},0)},setFont:function(e){u.$timeout(function(){u.usesCK(function(t){t.execCommand("setFont",e)})},0)},menuItem:null,addLink:function(t,n){i.default.element(n.target).is(".ng-invalid")||(e.toolbar.display=!1,u.usesCK(function(r){r.execCommand(t,e.toolbar.url),i.default.element(n.target).val(""),e.toolbar.url=""}))},canDelete:!0,textColor:"",setTextColor:function(){},url:"",linkPlaceholderText:l.phoneLinkEnabled?r.LINK_PLACEHOLDER_TEXT:"Web address or email"};var h=["p{text-align};","h1{text-align};","h2{text-align};","h3{text-align};","li{text-align};","span{color};","p{font-family};","h1{font-family};","h2{font-family};","h3{font-family};","li{font-family};","p{font-size,line-height};","h1{font-size,line-height};","h2{font-size,line-height};","h3{font-size,line-height};","li{font-size,line-height};"];this.emailBuilderConfig.textBgColorEnabled&&h.push("span{background-color};"),this.editorConfiguration={customConfig:"",removePlugins:"toolbar",extraPlugins:"customtoolbar,link,justifylight,textColor,textBgColor,font,fontSize",disableNativeSpellChecker:!1,toolbar:["Bold","Italic","Link","NumberedList","BulletedList","Blockquote"],title:!1,stylesSet:!1,extraAllowedContent:h.join(" ")}}return e}();t.TextBlockController=a}),define("modules/emailbuilder/ckeditor-plugins/link",["config","vendor/ckeditor/ckeditor"],function(e,t){function n(){}function i(){}function r(){}function o(){}function a(){}function s(){}t.editor.prototype.getSelectedLink=function(e){var n,i,r,o;try{return e&&this.focus(),(n=this.getSelection(),n.getType()==t.SELECTION_ELEMENT&&(i=n.getSelectedElement(),i.is("a")))?i:(r=n.getRanges(!0)[0],r.shrink(t.SHRINK_TEXT),o=r.getCommonAncestor(),o.getAscendant("a",!0))}catch(e){return null}},n.prototype.refresh=function(e,t){var n=t.lastElement&&t.lastElement.getAscendant("a",!0),i=n&&"a"===n.getName()&&n.getAttribute("href")&&n.getAttribute("data-cke-saved-href");this.setState(i)},i.prototype=new n,i.prototype.editorFocus=!1,i.prototype.exec=function(e,t){e.fire("link","link"!==t?e.getSelectedLink(!0):null)},r.prototype=new n,r.prototype.style=new t.style({element:"a",type:t.STYLE_INLINE,alwaysRemoveElement:1}),r.prototype.exec=function(e){e.removeStyle(this.style)},o.prototype.getAttributes=function(e){return{href:e.href,"data-cke-saved-href":e.href,"data-emb-href-display":e.display}},o.prototype.getContent=function(e){return e.display},o.prototype.exec=function(e,n){var i,r,o,a,s,l,c=e.getSelectedLink(),u=this.getContent(n),d=this.getAttributes(n);c?(i=c.data("emb-href-display"),r=c.getHtml(),c.setAttributes(d),(i===r||n&&n.isEmail&&-1!==r.indexOf("@")||c.$.querySelectorAll(".cs_editor_default_social").length)&&c.setHtml(u)):(o=e.getSelection(),a=o?o.getRanges(!0)[0]:{collapsed:!0},a.collapsed&&(s=t.dom.element.createFromHtml(u),a.insertNode(s),a.selectNodeContents(s)),l=new t.style({element:"a",attributes:d}),l.type=t.STYLE_INLINE,l.applyToRange(a),a.offset+=2,a.collapse(),a.select(),e.getCommand("unlink").exec())},a.prototype=new o,a.prototype.getContent=function(){return['<img data-emb-textblock-img width="51" height="20" border="0" title="Like this on Facebook" src="',e.urls.systemImages,'/img/social/facebook.png" class="cs_editor_default_social" alt="Facebook Like Button">'].join("")},a.prototype.getAttributes=function(t){var n={href:e.urls.facebook,class:"cs-editor-fblike"};return t&&t.isValid&&!t.isEmail&&(n["data-likeurl"]=t.href,n["data-cke-saved-href"]=t.href,n["data-emb-href-display"]=t.display),n},s.prototype=new o,s.prototype.getContent=function(){return['<img data-emb-textblock-img width="55" height="20" border="0" title="Share via Twitter" src="',e.urls.systemImages,'/img/social/twitter.png" class="cs_editor_default_social" alt="Tweet Button">'].join("")},s.prototype.getAttributes=function(){return{href:e.urls.twitter,class:"cs-editor-tweet"}},t.plugins.add("link",{init:function(e){e.addCommand("showLink",new i),e.addCommand("unlink",new r),e.addCommand("addLink",new o),e.addCommand("tweet",new s),e.addCommand("like",new a),e.ui.addButton("Link",{label:"",command:"showlink"}),e.filter.allow("img[!src,!data-emb-textblock-img,alt,width,height,border,title](cs_editor_default_social)","link"),e.filter.allow("a[href,data-cke-saved-href,data-emb-href-display,data-likeurl](*)","link"),e.on("selectionChange",function(n){var i=n.data.path.lastElement&&n.data.path.lastElement.getAscendant("a",!0),r=i&&"a"==i.getName()&&i.getAttribute("href")&&i.getAttribute("data-cke-saved-href"),o=r?t.TRISTATE_ON:t.TRISTATE_OFF;e.getCommand("showLink").setState(o),e.getCommand("unlink").setState(o)})}})}),define("modules/emailbuilder/ckeditor-plugins/justifylight",["vendor/ckeditor/ckeditor"],function(e){function t(e){return e.getComputedStyle("text-align")}function n(e,t,n){this.editor=e,this.name=t,this.value=n,this.context="p"}n.prototype={exec:function(t){var n=t.getSelection(),i=t.config.enterMode;if(n){for(var r,o,a=n.getRanges(),s=a.length-1;s>=0;s--)for(r=a[s].createIterator(),r.enlargeBr=i!=e.ENTER_BR;o=r.getNextParagraph(i==e.ENTER_P?"p":"div");)o.isReadOnly()||(o.removeAttribute("align"),o.removeStyle("text-align"),o.setStyle("text-align",this.value));t.forceNextSelectionCheck(),t.getSelection().selectRanges(a)}},refresh:function(n,i){var r=i.block||i.blockLimit,o=t(r)===this.value||"left"===this.value&&""===t(r);this.setState(o?e.TRISTATE_ON:e.TRISTATE_OFF)}},e.plugins.add("justifylight",{init:function(e){var t=new n(e,"justifyleft","left"),i=new n(e,"justifycenter","center"),r=new n(e,"justifyright","right");e.addCommand("justifyleft",t),e.addCommand("justifycenter",i),e.addCommand("justifyright",r)}})}),define("modules/emailbuilder/ckeditor-plugins/textcolor",["vendor/ckeditor/ckeditor"],function(e){function t(){}function n(){}t.prototype.editorFocus=!1,t.prototype.exec=function(t,n){var i=t.getSelection().getStartElement().getComputedStyle("color"),r=e.tools.convertRgbToHex(i);t.fire("textColor",r)},n.prototype.editorFocus=!1,n.prototype.exec=function(t,n){if(!t.getSelection().getRanges()[0].collapsed&&(t.removeStyle(new e.style({element:"span",styles:{color:"inherit"}})),n)){var i=function(e){return!(e.is("a")||e.getElementsByTag("a").count())||"false"==e.getAttribute("contentEditable")||e.getAttribute("data-nostyle")};t.applyStyle(new e.style({element:"span",styles:{color:"#"+n},childRule:i}))}},e.plugins.add("textColor",{init:function(e){e.addCommand("showTextColor",new t),e.addCommand("setTextColor",new n)}})}),define("modules/emailbuilder/ckeditor-plugins/textbgcolor",["vendor/ckeditor/ckeditor"],function(e){function t(){}function n(){}t.prototype.editorFocus=!1,t.prototype.exec=function(t,n){var i=t.getSelection().getStartElement().getComputedStyle("background-color"),r=e.tools.convertRgbToHex(i);t.fire("textBgColor",r)},n.prototype.editorFocus=!1,n.prototype.exec=function(t,n){if(!t.getSelection().getRanges()[0].collapsed&&(t.removeStyle(new e.style({element:"span",styles:{"background-color":"inherit"}})),n)){var i=function(e){return!(e.is("a")||e.getElementsByTag("a").count())||"false"==e.getAttribute("contentEditable")||e.getAttribute("data-nostyle")};t.applyStyle(new e.style({element:"span",styles:{"background-color":"#"+n},childRule:i}))}},e.plugins.add("textBgColor",{init:function(e){e.addCommand("showTextBgColor",new t),e.addCommand("setTextBgColor",new n)}})}),define("modules/emailbuilder/ckeditor-plugins/font",["config","vendor/ckeditor/ckeditor"],function(e,t){function n(){}for(var i={},r=0;r<e.fonts.length;r++){var o=e.fonts[r];i[o.value]=o.cssValues["font-family"]}n.prototype.editorFocus=!1,n.prototype.exec=function(e,n){var r=e.getSelection(),o=e.config.enterMode;if(r){for(var a,s,l=r.getRanges(),c=l.length-1;c>=0;c--)for(a=l[c].createIterator(),a.enlargeBr=o!=t.ENTER_BR;s=a.getNextParagraph(o==t.ENTER_P?"p":"div");)s.isReadOnly()||(s.removeStyle("font-family"),s.setStyle("font-family",i[n]));e.forceNextSelectionCheck(),e.getSelection().selectRanges(l)}},t.plugins.add("font",{init:function(e){e.addCommand("setFont",new n),e.on("selectionChange",function(n){for(var r,o=n.data.path,a=o.elements,s=0;s<a.length;s++){r=a[s];for(var l in i)if(i.hasOwnProperty(l)){var c=new t.style({element:{p:1,h1:1,h2:1,h3:1,li:1},styles:{"font-family":i[l]}});if(c.checkElementMatch(r,!0))return void e.fire("font",l)}}e.fire("font","")})}})}),define("modules/emailbuilder/ckeditor-plugins/fontsize",["vendor/ckeditor/ckeditor"],function(e){function t(){}function n(){}t.prototype.editorFocus=!1,t.prototype.exec=function(e,t){var n=e.getSelection().getStartElement().getComputedStyle("font-size");e.fire("fontSize",n)},n.prototype.editorFocus=!1,n.prototype.exec=function(t,n){var i=t.getSelection(),r=t.config.enterMode;if(i){for(var o,a,s=i.getRanges(),l=s.length-1;l>=0;l--)for(o=s[l].createIterator(),o.enlargeBr=r!=e.ENTER_BR;a=o.getNextParagraph(r==e.ENTER_P?"p":"div");)a.isReadOnly()||(a.removeStyle("font-size"),a.removeStyle("line-height"),a.setStyle("font-size",n.fontSize),a.setStyle("line-height",n.lineHeight));t.forceNextSelectionCheck(),t.getSelection().selectRanges(s)}},e.plugins.add("fontSize",{init:function(e){e.addCommand("showFontSize",new t),e.addCommand("setFontSize",new n),e.on("selectionChange",function(t){var n=t.data.selection.getStartElement().getComputedStyle("font-size");e.fire("currentFontSize",n)})}})});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/content-blocks/text-block.directive",["require","exports","vendor/ckeditor/ckeditor","vendor/text!ts/modules/emailbuilder/content-blocks/text-block.directive.html","angular","./text-block.controller","modules/emailbuilder/ckeditor-plugins/link","modules/emailbuilder/ckeditor-plugins/justifylight","modules/emailbuilder/ckeditor-plugins/textcolor","modules/emailbuilder/ckeditor-plugins/textbgcolor","modules/emailbuilder/ckeditor-plugins/font","modules/emailbuilder/ckeditor-plugins/fontsize"],function(e,t,n,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=__importDefault(r);var a=120,s=function(){function e(e){var t=this;this.exec=function(e){var i=new n.dom.text(t.tag),r=e.getSelection(),o=r.getRanges()[0];return o.collapsed||o.extractContents(),o.insertNode(i),o.selectNodeContents(i),t.setCaret&&o.setEnd(o.endContainer,o.endOffset-1),o.collapse(),o.select(),!0},this.tag=e.tag,this.setCaret=e.setCaret}return e}(),l=function(){function e(e,t,l,c,u,d,h,p){var f=this;this.transclude=!1,this.scope={block:"=",editableTextKey:"@",inSection:"@",singleline:"@",enterMode:"@",placeholder:"@",showTrashcan:"@",optionalTextKey:"@",section:"=",inFooter:"@",footer:"=",inHeader:"@",header:"="},this.template=i,this.controller=["$scope","$timeout","LinkModelProviderService","RecentColorService","EmailBuilderConfig","$rootScope",o.TextBlockController],this.require="embTextBlock",this.link=function(e,t,n,i){function o(e,t){t?e.element.$.blur():(e.focus(),e.selectionChange())}e.toolbar.deleteConfirmation=!1,f.$rootScope.$on("content:showConfirmation",function(){e.toolbar.deleteConfirmation=!0}),f.$rootScope.$on("content:hideConfirmation",function(){e.toolbar.deleteConfirmation=!1}),e.selectFbLink=function(){t.find(".emb-js-href-field").select()},i.setPlaceholder(),e.ckData=function(){return f.$sce.trustAsHtml(e.block.contents)},t.on("click",function(e){e.stopPropagation()}),e.isHeading=t.hasClass("emb-js-header"),e.dragging=!1,e.singleline=!!e.singleline,e.inSection=!!e.inSection,e.inFooter=!!e.inFooter,e.editorStyle={},e.confirmation=!1,e.singleline&&"middle"===t.css("verticalAlign")&&(e.editorStyle={lineHeight:t.height()+"px"}),e.block.editableTextKey=e.editableTextKey,e.textBgColorEnabled=f.emailBuilderConfig.textBgColorEnabled,e.canEdit=!0,e.toolbar.restrictedTextStyles=!1;var s=function(t){var n=f.lockLevelService.getLocks(t);e.canEdit=n.canEditContentItems,e.toolbar.restrictedTextStyles=n.restrictedTextStyles,e.toolbar.canDelete=n.canDeleteContentItems};e.inSection?(s(e.section.permissions),e.$on("permissionsChanged:section-"+e.section.uiId,function(e,t){s(t)})):e.inFooter?(s(e.footer.permissions),e.$on("permissionsChanged:footer",function(e,t){s(t)})):e.inHeader&&(s(e.header.permissions),e.$on("permissionsChanged:header",function(e,t){s(t)}));t.attr("id",function(){if(e.inSection){var t=e.block.tempContainer;return["emb-js-text-",t.sectionIndex,"-",t.columnIndex].join("")}return["emb-js-text-",n.block].join("")}());!function(t){if(!0===e.showTrashcan&&t.offset().top<65){var n=r.default.element(".js-delete-controls",t);n&&n.css("top","8px")}}(t);var l=function(){var n=f.viewPortService.isOffScreen(t);n!==e.offScreen&&e.$evalAsync(function(){e.offScreen=n})},c=$("#emb-js-email-body"),u=function(){var e=f.viewPortService.getElementTopRelativeToEmail(t);return Math.max(0,a-e)};e.$watch("block.isActive",function(n,r){if(n||r){n?(l(),c.on("scroll",l)):c.off("scroll",l);t.closest(".emb-content-wrapper").css("padding-top",n?u():0),i.usesCK(function(e){var t=function(){o(e,!n&&r)};"ready"===e.status?f.$timeout(function(){t()},0):e.on("instanceReady",t)}),e.toolbar.toggleDisplay()}}),e.$watch(function(e){return e.toolbar.display},function(e){"link"===e&&f.$timeout(function(){t.find(".emb-js-link-field").select()})}),e.toolbar.setTextColor=function(){i.usesCK(function(t){e.skipFocus=!0,t.execCommand("setTextColor",e.toolbar.textColor),o(t,!0),e.skipFocus=!1})},e.setTextBgColor=function(){i.usesCK(function(t){e.skipFocus=!0,t.execCommand("setTextBgColor",e.textBgColor),o(t,!0),e.skipFocus=!1})},e.$on("colorPicker:confirm",function(){e.toolbar.toggleDisplay()}),e.activeNotDragged=function(){return!e.dragging&&e.block&&e.block.isActive},e.notActive=function(){return!e.dragging&&e.block&&!e.block.isActive},e.toolbar.narrowControls=e.inSection&&f.itemWidthService.getBlockWidth(e.block)<600,e.makeActive=function(){e.block.isActive||f.$rootScope.$emit("content:activate",{block:e.block})},e.showConfirmationForTrashcan=function(){e.confirmation=!0},e.hideConfirmation=function(){e.confirmation=!1},e.remove=function(){e.confirmation=!1,f.$rootScope.$emit("optionalText:removed",e.optionalTextKey),f.modelActivityService.contentUpdated()}},this.itemWidthService=e,this.$rootScope=t,this.$timeout=l,this.modelActivityService=c,this.$sce=u,this.lockLevelService=d,this.emailBuilderConfig=h,this.viewPortService=p;var m=[{key:"firstname",tag:"[firstname,fallback=]",setCaret:!0},{key:"lastname",tag:"[lastname,fallback=]",setCaret:!0},{key:"fullname",tag:"[fullname,fallback=]",setCaret:!0},{key:"email",tag:"[email]",setCaret:!1},{key:"currentday",tag:"<currentday>",setCaret:!1},{key:"currentdayname",tag:"<currentdayname>",setCaret:!1},{key:"currentmonth",tag:"<currentmonth>",setCaret:!1},{key:"currentmonthname",tag:"<currentmonthname>",setCaret:!1},{key:"currentyear",tag:"<currentyear>",setCaret:!1},{key:"emailvariable",tag:"[variableName, fallback=]",setCaret:!1}],g=function(){var e={};return h.listsWithCustomFields.forEach(function(t){t.fields.forEach(function(t){e[t.tag]=1})}),Object.keys(e).map(function(e){return{key:e,tag:["[",e,",fallback=]"].join(""),setCaret:!0}})};n.disableAutoInline=!0,n.plugins.add("customtoolbar",{init:function(e){e.config.toolbar.forEach(function(t){var n=e.ui.create(t);e.addFeature(n)}),m.push.apply(m,g()),m.forEach(function(t){e.addCommand(t.key,new s(t))}),["h1","h2","h3","p"].forEach(function(t){var i=new n.style({element:t},{}),r=e.addCommand(t,new n.styleCommand(i,{contentForms:[i]}));e.addFeature(r),e.attachStyleStateChange(i,function(t){r.setState(t),n.TRISTATE_ON===t&&e.fire("style",r.name)}),e.ui.addButton(t,{command:t})})}})}return e.factory=function(t,n,i,r,o,a,s,l){return new e(t,n,i,r,o,a,s,l)},e}();t.TextBlock=l}),define("ts/modules/emailbuilder/content-blocks/text-command.directive",["require","exports","vendor/ckeditor/ckeditor"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){var i=this;this.require="^embTextBlock",this.scope={safeCommand:"=safeCommand",addUnselectedClass:"=addUnselectedClass"},this.link=function(e,t,r,o){function a(i){function o(){t.toggleClass("emb-selected",c.state===n.TRISTATE_ON),e.addUnselectedClass&&t.toggleClass("emb-unselected",c.state===n.TRISTATE_OFF)}var a,l=r.embTextCommand,c=i.getCommand(l);switch(l){case"p":a=null;break;case"h1":case"h2":case"h3":a=i.getCommand("p");break;default:a=c}c.on("state",o),o(),t.on("click",function(){if(!e.safeCommand){s.$rootScope.$emit("text:command");var t=c.state===n.TRISTATE_ON?a:c;t&&(t.exec(),i.fire("change"))}})}var s=i;o.usesCK(function(e){"ready"===e.status?i.$timeout(function(){a(e)},0):e.on("instanceReady",function(){a(e)})})},this.$rootScope=e,this.$timeout=t}return e.factory=function(t,n){return new e(t,n)},e}();t.TextCommand=i}),define("ts/modules/emailbuilder/content-blocks/image-ui-state.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.Initial=0]="Initial",e[e.Uploading=1]="Uploading",e[e.FileUploaded=2]="FileUploaded",e[e.ThirdPartyUrl=3]="ThirdPartyUrl",e[e.ThirdPartyUrlTyping=4]="ThirdPartyUrlTyping",e[e.ThirdPartyUrlError=5]="ThirdPartyUrlError",e[e.Reloading=6]="Reloading"}(n||(n={})),t.UiStateValues=n;var i=function(){function e(e){this.initial=e===n.Initial,this.uploading=e===n.Uploading,this.fileUploaded=e===n.FileUploaded,this.thirdPartyUrl=e===n.ThirdPartyUrl,this.thirdPartyUrlTyping=e===n.ThirdPartyUrlTyping,this.thirdPartyUrlError=e===n.ThirdPartyUrlError,this.reloading=e===n.Reloading,this.hasSrc=e===n.FileUploaded||e===n.ThirdPartyUrl||e===n.ThirdPartyUrlError}return e}();t.UiState=i;var r=function(){function e(e){var t=this;this.current=function(e){return e.state?e.state:new i(e.fileName?n.FileUploaded:e.thirdPartyUrl?n.ThirdPartyUrl:n.Initial)},e.$on("upload:start",function(e,t){t.block.state=new i(n.Uploading)}),e.$on("upload:end",function(e,t){t.block.state=new i(n.FileUploaded)}),e.$on("upload:error",function(e,n){n.block.state=null,n.block.state=t.current(n.block)}),e.$on("download:start",function(e,t){t.block.tempDownloadingImg=!0}),e.$on("download:end",function(e,t){t.block.tempDownloadingImg=!1}),e.$on("download:error",function(e,t){t.block.tempDownloadingImg=!1}),e.$on("image:deleted",function(e,t){t.block.state=new i(n.Initial)}),e.$on("thirdPartyImage:success",function(e,t){t.block.state=new i(n.ThirdPartyUrl)}),e.$on("thirdPartyImage:typing",function(e,t){t.block.state=new i(n.ThirdPartyUrlTyping)}),e.$on("thirdPartyImage:failed",function(e,t){t.block.state=new i(n.ThirdPartyUrlError)}),e.$on("image:reloading",function(e,t){t.block.state=new i(n.Reloading)}),e.$on("image:reloaded",function(e,t){t.block.state=new i(n.FileUploaded)}),e.$on("image:redoSetFilename",function(e,t){t.block.state=new i(n.FileUploaded)})}return e}();t.ImageUiStateService=r}),define("ts/modules/emailbuilder/content-blocks/scroll-content-block.directive",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){var t=this;this.restrict="A",this.link=function(e,n){e.block.isActive&&t.viewPortService.ensureElementInViewPort(n)},this.viewPortService=e}return e.factory=function(t){return new e(t)},e}();t.ScrollContentBlock=n}),define("vendor/text!ts/modules/emailbuilder/content-blocks/countdown-block.directive.html",[],function(){return'<div ng-style="{ \'background-color\': vm.backgroundColor }">\r\n    <img ng-src="{{vm.getPlaceholderSrc()}}" unselectable="on" draggable="false" />\r\n    <img ng-src="{{vm.getLabelSrc()}}" unselectable="on" draggable="false" />\r\n</div>'});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/sections/section-background.directive",["require","exports","angular"],function(e,t,n){"use strict";function i(e,t){return""===e.backgroundColor||void 0===e.backgroundColor||null===e.backgroundColor?t.backgroundColor:e.backgroundColor}Object.defineProperty(t,"__esModule",{value:!0}),n=__importDefault(n),t.GetBackgroundColor=i;var r=function(){function e(e,t,r,o){var a=this;this.restrict="A",this.scope=!0,this.getBackgroundDivs=function(e){var t=-1!==e.id.indexOf("gutter")?n.default.element("#"+e.uiId+" .column__background"):n.default.element("#"+e.uiId+"  *[emb-section-background]");return t&&t.length>0?t:null},this.isImage=function(e){var t=a.$q.defer(),n=new Image;return n.onerror=function(){t.resolve(!1)},n.onload=function(){t.resolve(!0)},n.src=e,t.promise},this.link=function(e,t){var r=function(){var t=a.getBackgroundDivs(e.section);if(null!==t){var r=e.section.style,o=i(r,a.emailService.model.styles.section),s={"background-color":"#"+o};n.default.element(t).css(s),o&&e.$broadcast("backgroundChanged",o)}},o=function(){var t=e.section,i=a.getBackgroundDivs(t);if(null!==i){var r=t.style,o={};if(r&&r.backgroundLayoutImage&&a.contentBlockService.hasBlockSrc(r.backgroundLayoutImage)&&r.backgroundLayoutImage.href){a.isImage(r.backgroundLayoutImage.href).then(function(e){t.hasMissingBackground=!e}),o["background-image"]="url("+r.backgroundLayoutImage.href+")",o["background-repeat"]=r.backgroundLayoutImage.backgroundRepeat||"no-repeat";if(a.emailBuilderConfig.sectionBackgroundImageRenderingEnabled&&"no-repeat"===r.backgroundLayoutImage.backgroundRepeat&&r.backgroundLayoutImage.position){var s=r.backgroundLayoutImage.position;o["background-position"]=s.xPercent+"% "+s.yPercent+"%"}else o["background-position"]="0 0";var l=a.emailBuilderConfig.sectionBackgroundImageRenderingEnabled&&"cover"===r.backgroundLayoutImage.size;o["background-size"]=l?"cover":"auto auto"}else t.hasMissingBackground=!1,o["background-image"]="none";n.default.element(i).css(o)}};e.$watch("section.style.backgroundLayoutImage",function(){o()},!0),e.$watch("section.style.backgroundColor",function(){r()}),e.$watch(function(){return a.emailService.model.styles.section.backgroundColor},function(){r()})},this.emailService=e,this.$q=t,this.contentBlockService=r,this.emailBuilderConfig=o}return e.factory=function(t,n,i,r){return new e(t,n,i,r)},e}();t.SectionBackground=r}),define("ts/modules/emailbuilder/content-blocks/countdown-block.controller",["require","exports","../constants","../sections/section-background.directive"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="ffffff",o=function(){function e(e,t,o){var a=this;this.updateBackgroundColor=function(e){var t=null===e||""===e?r:e;a.backgroundColor="#"+t,a.block.useDarkText=!a.colorService.isDark(t)},this.getColorVariant=function(){return a.block.useDarkText?"dark":"light"},this.$onInit=function(){var e=i.GetBackgroundColor(a.section.style,a.emailBuilderConfig.email.styles.section);a.updateBackgroundColor(e)},this.getLabelSrc=function(){var e=a.slugLookup[a.emailBuilderConfig.email.language]||a.slugLookup[n.FALLBACK_LANGUAGE];return a.emailBuilderConfig.urls.countdownLabelsBaseUrl+"countdown-labels-"+a.getColorVariant()+"-"+e+".png"},this.getPlaceholderSrc=function(){return a.emailBuilderConfig.urls.staticResourceBase+"/img/emailbuilder/countdown/placeholder-"+a.getColorVariant()+".png"},this.emailBuilderConfig=t,this.colorService=o,this.slugLookup=this.emailBuilderConfig.languages.reduce(function(e,t){return e[t.value]=t.filenameSlug,e},{}),e.$on("backgroundChanged",function(e,t){a.updateBackgroundColor(t)})}return e}();t.CountdownBlockController=o}),define("ts/modules/emailbuilder/content-blocks/countdown-block.directive",["require","exports","vendor/text!ts/modules/emailbuilder/content-blocks/countdown-block.directive.html","./countdown-block.controller"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this.restrict="E",this.bindToController={section:"=",block:"="},this.template=n,this.controller=["$scope","EmailBuilderConfig","ColorService",i.CountdownBlockController],this.controllerAs="vm"}return e.factory=function(){return new e},e}();t.CountdownBlock=r}),define("ts/modules/emailbuilder/content-blocks/countdown-date.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=14,i=90,r=function(){function e(e){var t=this;this.GetDefaultExpiry=function(){var e=new Date;return e.setDate(e.getDate()+n),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e},this.GetMaxExpiry=function(){var e=new Date;return e.setDate(e.getDate()+i),e},this.GetMinExpiry=function(){return new Date},this.stringToDate=function(e){var t=e.split(" "),n=t[0],i=t[1],r=n.split("-").map(Number),o=r[0],a=r[1],s=r[2],l=i.split(":").map(Number),c=l[0],u=l[1];return new Date(o,a-1,s,c,u)},this.dateToString=function(e,n){var i=new Date(e.getTime());return i.setHours(n.getHours()),i.setMinutes(n.getMinutes()),t.$filter("date")(i,"yyyy-MM-dd HH:mm")},this.isSameDay=function(e,t){return e.toDateString()===t.toDateString()},this.$filter=e}return e}();t.CountdownDateService=r}),define("vendor/text!ts/modules/emailbuilder/content-blocks/validation-messages.directive.html",[],function(){return'<div>\r\n    <div ng-show="message && !model.tempIsNew" class="emb-reset emb-js-validation-msg emb-validation-msg emb-reset">\r\n        <header ng-show="message.title">\r\n            <h2>{{message.title}}</h2>\r\n        </header>\r\n        <p>{{message.message}}</p>\r\n    </div>\r\n</div>'}),define("ts/modules/emailbuilder/messages",["require","exports"],function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0});var i=(n={},n.invalidType={title:"Please upload an image",message:"Only image files can be uploaded. Please select a JPG, PNG or GIF file."},n.invalidSize={title:"Image file too big",message:"That image wasn't added because it's too big to use in an email. Please keep images less than 20MB in size."},n.uploadError={title:"Server Error",message:"Unable to upload file."},n.btnNoText={title:"Your button is missing text",message:"Buttons need to contain text in order to display correctly in your email."},n.btnNoLink={title:"Your button is missing a link",message:"Where would you like recipients to be directed when they click this button?"},n.btnInvalidLink={title:"Invalid URL",message:"Your button needs to contain a valid URL."},n.btnNoLinkNoText={title:"Missing content",message:"Your button needs to contain some text and a link."},n.surveyNoText={title:"Your button is missing text",message:"Buttons need to contain text in order to display correctly in your email."},n.surveyNoLink={title:"Your survey is missing",message:"You need to select a GetFeedback survey which this button links to."},n.surveyNoLinkNoText={title:"Missing content",message:"Your button needs to contain some text and a GetFeedback survey link."},n.videoNoLink={title:"Your video is missing a link",message:"Please enter a Vimeo or YouTube URL for your video"},n.videoInvalidLink={title:"Invalid URL",message:"Please enter a valid Vimeo or YouTube URL, e.g. https://www.vimeo.com/0123 or https://www.youtube.com/watch?v=sWYV_qO9Uxw"},n.videoNotFoundLink={title:"Video not found",message:"Please ensure the URL is typed correctly, e.g. https://www.vimeo.com/0123 or https://www.youtube.com/watch?v=sWYV_qO9Uxw"},n.videoNotSupportedLink={title:"Invalid Format",message:"Please enter a valid Vimeo or YouTube URL, e.g. https://www.vimeo.com/0123 or https://www.youtube.com/watch?v=sWYV_qO9Uxw"},n.videoProviderDown={title:"Vimeo not responsive",message:"Vimeo is not responding right now, so we are not able to load the thumbnail. Please try again in a minute."},n.countdownExpiredDate={title:"Your countdown has already expired",message:"Please select a date that is in the future."},n.countdownInvalidDate={title:"Your countdown has an invalid date",message:"Please select a valid date and time."},n.countdownExcessDate={title:"Your countdown is too far into the future",message:"Please select a date within the next 90 days."},n);t.VALIDATION_MESSAGES=i}),define("ts/modules/emailbuilder/content-blocks/validation-messages.directive",["require","exports","vendor/text!ts/modules/emailbuilder/content-blocks/validation-messages.directive.html","../messages"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this.restrict="E",this.template=n,this.scope={model:"="},this.link=function(e,t,n){var r=!!n.clearOnInactive;e.$watch("model.tempValidation",function(t){e.message=t?i.VALIDATION_MESSAGES[t[0]]:null,e.model.tempIsValid=!e.message}),e.$watch("model.isActive",function(t){e.model.tempIsNew=t&&!!e.model.tempIsNew,r&&!t&&delete e.model.tempValidation})}}return e.factory=function(){return new e},e}();t.ValidationMessages=r}),define("ts/modules/emailbuilder/content-blocks/third-party-image-downloader.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})
;var n=function(){function e(e,t){var n=this;this.retrieveImage=function(e,t){var i=new Image;i.onload=function(){e.originalWidth=i.width,e.originalHeight=i.height,n.imageBuilderService.resize(e),n.$rootScope.$broadcast("thirdPartyImage:success",{block:e,isUploadAction:t})},i.onerror=function(){delete e.originalWidth,delete e.originalHeight,delete e.tempWidth,delete e.tempHeight,delete e.halign,n.$rootScope.$broadcast("thirdPartyImage:failed",{block:e})},i.src=e.src},this.$rootScope=e,this.imageBuilderService=t}return e}();t.ThirdPartyImageDownloaderService=n});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/content-blocks/button-block.directive",["require","exports","angular"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=__importDefault(n);var i=function(){function e(e,t,i,r,o){var a=this;this.calculateFontStyleMap=function(){for(var e={},t=0;t<a.emailBuildConfig.fonts.length;t+=1){var n=a.emailBuildConfig.fonts[t],i=n.cssValues["font-family"];e[n.value]=i}return e},this.migrateButtonColorsOnFirstUse=function(e){var t=a.emailBuildConfig.template.name.toLowerCase();if(!a.emailBuildConfig.runOnceButtonColorMigrationKey&&("broadsheet"===t||"tint"===t)){if(a.emailBuildConfig.email.styles.button.backgroundColor&&a.emailBuildConfig.email.styles.button.color&&a.emailBuildConfig.email.styles.button.backgroundColor.toLowerCase()!==a.emailBuildConfig.email.styles.button.color.toLowerCase())return void(a.emailBuildConfig.runOnceButtonColorMigrationKey=!0);"broadsheet"===t&&(a.emailBuildConfig.email.styles.button.color="FEFEFE"),"tint"===t&&(a.emailBuildConfig.email.styles.button.color="FFFFFF"),a.dynamicStylesService.update({"@button-color":a.emailBuildConfig.email.styles.button.color}),a.emailBuildConfig.runOnceButtonColorMigrationKey=!0}},this.restrict="A",this.link=function(e,t){var i=t[0].style;t.attr("id",function(){var t=e.block.tempContainer;return["emb-js-button-",null==t?null:t.sectionIndex,"-",null==t?null:t.columnIndex].join("")}()),null!==e.block.halign&&""!==e.block.halign||(e.block.halign=t.parent().css("text-align"));var r=function(n){if(n){var i=t.parent();"full"===n?(i.addClass("fullwidth"),t.css("display","block"),a.$timeout(function(){e.block.vmlWidth=Math.round(t.innerWidth())},0)):(i.removeClass("fullwidth"),t.css("width",""),t.css("display","inline-block"),e.block.vmlWidth=Math.round(t.innerWidth()))}},o=function(){e.block.height=Math.round(t.outerHeight()),e.block.lines=a.textCalcService.getLines(t),r(e.block.halign)};if(e.$watch("block.text",function(e,t){e!==t&&o()}),e.$watch("block.halign",r),a.emailBuildConfig.email.isBlueprint){e.block.fontFamily?i.fontFamily=a.fontStyleMap[e.block.fontFamily]:(e.block.fontFamily=a.emailBuildConfig.email.styles.p.fontFamily,i.fontFamily=a.fontStyleMap[a.emailBuildConfig.email.styles.p.fontFamily]),null!==e.block.borderRadius?i.borderRadius=e.block.borderRadius:(e.block.borderRadius=a.emailBuildConfig.settings.borderRadiusForRoundedButtonCorners,i.borderRadius=a.emailBuildConfig.settings.borderRadiusForRoundedButtonCorners),e.$watch("block.borderRadius",function(e){e&&(i.borderRadius=e,a.$timeout(o,0))}),e.$watch("block.fontFamily",function(e){i.fontFamily=a.fontStyleMap[e],a.$timeout(o,0)}),e.$watch("block.buttonStyleAppearance",function(e,t){"ghost"===e?(i.borderColor=i.backgroundColor,i.backgroundColor=a.reinitializeInlineStyleValue):"ghost"===t&&(i.backgroundColor=i.borderColor,i.borderColor=a.reinitializeInlineStyleValue),a.$timeout(o,0)});var s=function(n){e.block.buttonSize=n,"small"===n&&(t.parent().addClass("btn--small"),t.parent().removeClass("btn--medium"),t.parent().removeClass("btn--large")),"medium"===n&&(t.parent().addClass("btn--medium"),t.parent().removeClass("btn--small"),t.parent().removeClass("btn--large")),"large"===n&&(t.parent().addClass("btn--large"),t.parent().removeClass("btn--small"),t.parent().removeClass("btn--medium")),a.$timeout(o,0),e.block.vmlWidth=Math.round(t.innerWidth())};e.$watch("block.buttonSize",s),s(e.block.buttonSize||"large")}a.migrateButtonColorsOnFirstUse(e),null===e.block.backgroundColor&&(e.block.backgroundColor=a.reinitializeInlineStyleValue),null===e.block.color&&(e.block.color=a.reinitializeInlineStyleValue),e.block.tempBackgroundColor=e.block.backgroundColor||a.emailBuildConfig.email.styles.button.backgroundColor,e.block.tempTextColor=e.block.color||a.emailBuildConfig.email.styles.button.color,e.$watch("block.tempBackgroundColor",function(){var n=t[0].style,i=a.emailBuildConfig.email.styles.button.backgroundColor,r=e.block.tempBackgroundColor;r&&(r!==i?(e.block.backgroundColor=r,"ghost"===e.block.buttonStyleAppearance?n.borderColor="#"+r:n.backgroundColor="#"+r):(e.block.backgroundColor=a.reinitializeInlineStyleValue,n.backgroundColor=a.reinitializeInlineStyleValue,n.borderColor=a.reinitializeInlineStyleValue))}),e.$watch(function(){return a.emailBuildConfig.email.styles.button.backgroundColor},function(){var t=a.emailBuildConfig.email.styles.button.backgroundColor;e.block.backgroundColor||(e.block.tempBackgroundColor=t)}),e.$watch("block.tempTextColor",function(){var n=t[0].style,i=a.emailBuildConfig.email.styles.button.color,r=e.block.tempTextColor;r&&(r!==i?(e.block.color=r,n.setProperty?n.setProperty("color","#"+r,"important"):n.color="#"+r):(e.block.color=a.reinitializeInlineStyleValue,n.color=a.reinitializeInlineStyleValue))}),e.$watch(function(){return a.emailBuildConfig.email.styles.button.color},function(){var t=a.emailBuildConfig.email.styles.button.color;e.block.color||(e.block.tempTextColor=t)}),a.$timeout(function(){r(e.block.halign)},100),a.nextButtonStyleService.setNextButtonStyle(e.block,!0),e.$watch(function(){return{text:e.block.text,href:e.block.href,backgroundColor:e.block.backgroundColor,color:e.block.color,fontFamily:e.block.fontFamily,halign:e.block.halign,borderRadius:e.block.borderRadius,buttonStyleAppearance:e.block.buttonStyleAppearance,buttonSize:e.block.buttonSize}},function(e,t){n.default.equals(e,t)||a.nextButtonStyleService.setNextButtonStyle(e,!1)},!0),e.$on("undo:modelChanged",function(){e.block.tempBackgroundColor=e.block.backgroundColor||a.emailBuildConfig.email.styles.button.backgroundColor,e.block.tempTextColor=e.block.color||a.emailBuildConfig.email.styles.button.color})},this.$timeout=e,this.emailBuildConfig=t,this.dynamicStylesService=i,this.textCalcService=r,this.nextButtonStyleService=o,this.reinitializeInlineStyleValue="",this.fontStyleMap=this.calculateFontStyleMap()}return e.factory=function(t,n,i,r,o){return new e(t,n,i,r,o)},e}();t.ButtonBlock=i}),define("ts/modules/emailbuilder/content-blocks/button-text-calc.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){var t=this;this.wordSpanIdentifierClass="js-detect-height",this.getStyleFromElement=function(e){var t=e.get(0),n={};if(t.ownerDocument.defaultView.getComputedStyle)for(var i=function(e,t){return t.toUpperCase()},r=t.ownerDocument.defaultView.getComputedStyle(t,null),o=0;o<r.length;o++){var a=r[o],s=a.replace(/\-([a-z])/g,i),l=r.getPropertyValue(a);n[s]=l}return n},this.getRoundedWidth=function(e){if(!e)return"";if(e.length<3)return e;if("px"!==e.substr(e.length-2,e.length).toLowerCase())return e;var t=e.replace(/px/i,"");return Math.ceil(Number(t))+"px"},this.cloneText=function(e){var n=e.text().split(" "),i=t.getStyleFromElement.call(t,e),r=$("<span></span>").addClass(t.wordSpanIdentifierClass),o=$("<div></div>");i.position="absolute",i.top="-900px",i.overflow="auto",i.width=e.css("width"),o.css(i),o.css("width",t.getRoundedWidth(i.width)),o.empty(),$(t.doc.body).append(o);for(var a=0;a<n.length;a++){var s=r.clone();s.text(n[a]),o.append(s).append(" ")}return o},this.getLines=function(e){var n,i=t.cloneText.call(t,e),r=i.find("."+t.wordSpanIdentifierClass),o=[],a=[];return r.each(function(e,t){var i=$(t);if(""!==i.text()){var s=i.offset().top,l=i.outerHeight(),c=s+l;void 0===n||c===n?o.push(i.text()):(a.push(o.join(" ")),o=[i.text()]),n=c,e===r.length-1&&a.push(o.join(" "))}}),i.remove(),a},this.doc=e[0]}return e}();t.ButtonTextCalcService=n}),define("vendor/text!ts/modules/emailbuilder/content-blocks/spacer.directive.html",[],function(){return'<div id="emb-js-spacer-{{block.tempContainer.sectionIndex}}-{{block.tempContainer.columnIndex}}"\r\n    class="emb-spacer-measurement qa-email-spacer" ng-style="{ \'height\': block.height }">\r\n    <span class="emb-spacer-handle" ng-show="block.isActive && canResize" ng-style="{ \'top\': block.height - handleOffset }">{{block.height}}px</span>\r\n</div>'}),function(e,t){function n(t,n){var r,o,a,s=t.nodeName.toLowerCase();return"area"===s?(r=t.parentNode,o=r.name,!(!t.href||!o||"map"!==r.nodeName.toLowerCase())&&(!!(a=e("img[usemap=#"+o+"]")[0])&&i(a))):(/input|select|textarea|button|object/.test(s)?!t.disabled:"a"===s?t.href||n:n)&&i(t)}function i(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}var r=0,o=/^ui-id-\d+$/;e.ui=e.ui||{},e.extend(e.ui,{version:"1.10.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({focus:function(t){return function(n,i){return"number"==typeof n?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),i&&i.call(t)},n)}):t.apply(this,arguments)}}(e.fn.focus),scrollParent:function(){var t;return t=e.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.css(this,"position"))&&/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!t.length?e(document):t},zIndex:function(t){if(void 0!==t)return this.css("zIndex",t);if(this.length)for(var n,i,r=e(this[0]);r.length&&r[0]!==document;){if(("absolute"===(n=r.css("position"))||"relative"===n||"fixed"===n)&&(i=parseInt(r.css("zIndex"),10),!isNaN(i)&&0!==i))return i;r=r.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++r)})},removeUniqueId:function(){return this.each(function(){o.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(n){return!!e.data(n,t)}}):function(t,n,i){return!!e.data(t,i[3])},focusable:function(t){return n(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var i=e.attr(t,"tabindex"),r=isNaN(i);return(r||i>=0)&&n(t,!r)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(t,n){function i(t,n,i,o){return e.each(r,function(){n-=parseFloat(e.css(t,"padding"+this))||0,i&&(n-=parseFloat(e.css(t,"border"+this+"Width"))||0),o&&(n-=parseFloat(e.css(t,"margin"+this))||0)}),n}var r="Width"===n?["Left","Right"]:["Top","Bottom"],o=n.toLowerCase(),a={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+n]=function(t){return void 0===t?a["inner"+n].call(this):this.each(function(){e(this).css(o,i(this,t)+"px")})},e.fn["outer"+n]=function(t,r){return"number"!=typeof t?a["outer"+n].call(this,t):this.each(function(){e(this).css(o,i(this,t,!0,r)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(n){return arguments.length?t.call(this,e.camelCase(n)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.support.selectstart="onselectstart"in document.createElement("div"),e.fn.extend({disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),e.extend(e.ui,{plugin:{add:function(t,n,i){var r,o=e.ui[t].prototype;for(r in i)o.plugins[r]=o.plugins[r]||[],o.plugins[r].push([n,i[r]])},call:function(e,t,n){var i,r=e.plugins[t];if(r&&e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType)for(i=0;i<r.length;i++)e.options[r[i][0]]&&r[i][1].apply(e.element,n)}},hasScroll:function(t,n){if("hidden"===e(t).css("overflow"))return!1;var i=n&&"left"===n?"scrollLeft":"scrollTop",r=!1;return t[i]>0||(t[i]=1,r=t[i]>0,t[i]=0,r)}})}(jQuery),function(e,t){var n=0,i=Array.prototype.slice,r=e.cleanData;e.cleanData=function(t){for(var n,i=0;null!=(n=t[i]);i++)try{e(n).triggerHandler("remove")}catch(e){}r(t)},e.widget=function(t,n,i){var r,o,a,s,l={},c=t.split(".")[0];t=t.split(".")[1],r=c+"-"+t,i||(i=n,n=e.Widget),e.expr[":"][r.toLowerCase()]=function(t){return!!e.data(t,r)},e[c]=e[c]||{},o=e[c][t],a=e[c][t]=function(e,t){if(!this._createWidget)return new a(e,t);arguments.length&&this._createWidget(e,t)},e.extend(a,o,{version:i.version,_proto:e.extend({},i),_childConstructors:[]}),s=new n,s.options=e.widget.extend({},s.options),e.each(i,function(t,i){if(!e.isFunction(i))return void(l[t]=i);l[t]=function(){var e=function(){return n.prototype[t].apply(this,arguments)},r=function(e){return n.prototype[t].apply(this,e)};return function(){var t,n=this._super,o=this._superApply;return this._super=e,this._superApply=r,t=i.apply(this,arguments),this._super=n,this._superApply=o,t}}()}),a.prototype=e.widget.extend(s,{widgetEventPrefix:o?s.widgetEventPrefix||t:t},l,{constructor:a,namespace:c,widgetName:t,widgetFullName:r}),o?(e.each(o._childConstructors,function(t,n){var i=n.prototype;e.widget(i.namespace+"."+i.widgetName,a,n._proto)}),delete o._childConstructors):n._childConstructors.push(a),e.widget.bridge(t,a)},e.widget.extend=function(t){for(var n,r,o=i.call(arguments,1),a=0,s=o.length;a<s;a++)for(n in o[a])r=o[a][n],o[a].hasOwnProperty(n)&&void 0!==r&&(e.isPlainObject(r)?t[n]=e.isPlainObject(t[n])?e.widget.extend({},t[n],r):e.widget.extend({},r):t[n]=r);return t},e.widget.bridge=function(t,n){var r=n.prototype.widgetFullName||t;e.fn[t]=function(o){var a="string"==typeof o,s=i.call(arguments,1),l=this;return o=!a&&s.length?e.widget.extend.apply(null,[o].concat(s)):o,a?this.each(function(){var n,i=e.data(this,r);return i?e.isFunction(i[o])&&"_"!==o.charAt(0)?(n=i[o].apply(i,s),n!==i&&void 0!==n?(l=n&&n.jquery?l.pushStack(n.get()):n,!1):void 0):e.error("no such method '"+o+"' for "+t+" widget instance"):e.error("cannot call methods on "+t+" prior to initialization; attempted to call method '"+o+"'")}):this.each(function(){var t=e.data(this,r);t?t.option(o||{})._init():e.data(this,r,new n(o,this))}),l}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,i){i=e(i||this.defaultElement||this)[0],this.element=e(i),this.uuid=n++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),i!==this&&(e.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===i&&this.destroy()}}),this.document=e(i.style?i.ownerDocument:i.document||i),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(t,n){var i,r,o,a=t;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof t)if(a={},i=t.split("."),t=i.shift(),i.length){for(r=a[t]=e.widget.extend({},this.options[t]),o=0;o<i.length-1;o++)r[i[o]]=r[i[o]]||{},r=r[i[o]];if(t=i.pop(),1===arguments.length)return void 0===r[t]?null:r[t];r[t]=n}else{if(1===arguments.length)return void 0===this.options[t]?null:this.options[t];a[t]=n}return this._setOptions(a),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(t,n,i){var r,o=this;"boolean"!=typeof t&&(i=n,n=t,t=!1),i?(n=r=e(n),this.bindings=this.bindings.add(n)):(i=n,n=this.element,r=this.widget()),e.each(i,function(i,a){function s(){if(t||!0!==o.options.disabled&&!e(this).hasClass("ui-state-disabled"))return("string"==typeof a?o[a]:a).apply(o,arguments)}"string"!=typeof a&&(s.guid=a.guid=a.guid||s.guid||e.guid++);var l=i.match(/^(\w+)\s*(.*)$/),c=l[1]+o.eventNamespace,u=l[2];u?r.delegate(u,c,s):n.bind(c,s)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function n(){return("string"==typeof e?i[e]:e).apply(i,arguments)}var i=this;return setTimeout(n,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,n,i){var r,o,a=this.options[t];if(i=i||{},n=e.Event(n),n.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),n.target=this.element[0],o=n.originalEvent)for(r in o)r in n||(n[r]=o[r]);return this.element.trigger(n,i),!(e.isFunction(a)&&!1===a.apply(this.element[0],[n].concat(i))||n.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,n){e.Widget.prototype["_"+t]=function(i,r,o){"string"==typeof r&&(r={effect:r});var a,s=r?!0===r||"number"==typeof r?n:r.effect||n:t;r=r||{},"number"==typeof r&&(r={duration:r}),a=!e.isEmptyObject(r),r.complete=o,r.delay&&i.delay(r.delay),a&&e.effects&&e.effects.effect[s]?i[t](r):s!==t&&i[s]?i[s](r.duration,r.easing,o):i.queue(function(n){e(this)[t](),o&&o.call(i[0]),n()})}})}(jQuery),function(e,t){var n=!1;e(document).mouseup(function(){n=!1}),e.widget("ui.mouse",{version:"1.10.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(n){if(!0===e.data(n.target,t.widgetName+".preventClickEvent"))return e.removeData(n.target,t.widgetName+".preventClickEvent"),n.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(t){if(!n){this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var i=this,r=1===t.which,o=!("string"!=typeof this.options.cancel||!t.target.nodeName)&&e(t.target).closest(this.options.cancel).length;return!(r&&!o&&this._mouseCapture(t))||(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){i.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=!1!==this._mouseStart(t),!this._mouseStarted)?(t.preventDefault(),!0):(!0===e.data(t.target,this.widgetName+".preventClickEvent")&&e.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return i._mouseMove(e)},this._mouseUpDelegate=function(e){return i._mouseUp(e)},e(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),n=!0,!0))}},_mouseMove:function(t){return e.ui.ie&&(!document.documentMode||document.documentMode<9)&&!t.button?this._mouseUp(t):this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,t),this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){return e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery),function(e,t){e.widget("ui.draggable",e.ui.mouse,{version:"1.10.4",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(t){var n=this.options;return!(this.helper||n.disabled||e(t.target).closest(".ui-resizable-handle").length>0)&&(this.handle=this._getHandle(t),!!this.handle&&(e(!0===n.iframeFix?"iframe":n.iframeFix).each(function(){e("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(e(this).offset()).appendTo("body")}),!0))},_mouseStart:function(t){var n=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,n.cursorAt&&this._adjustOffsetFromHelper(n.cursorAt),this._setContainment(),!1===this._trigger("start",t)?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_mouseDrag:function(t,n){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),!n){var i=this._uiHash();if(!1===this._trigger("drag",t,i))return this._mouseUp({}),!1;this.position=i.position}return this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var n=this,i=!1;return e.ui.ddmanager&&!this.options.dropBehaviour&&(i=e.ui.ddmanager.drop(this,t)),this.dropped&&(i=this.dropped,this.dropped=!1),!("original"===this.options.helper&&!e.contains(this.element[0].ownerDocument,this.element[0]))&&("invalid"===this.options.revert&&!i||"valid"===this.options.revert&&i||!0===this.options.revert||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,i)?e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){!1!==n._trigger("stop",t)&&n._clear()}):!1!==this._trigger("stop",t)&&this._clear(),!1)},_mouseUp:function(t){return e("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){return!this.options.handle||!!e(t.target).closest(this.element.find(this.options.handle)).length},_createHelper:function(t){var n=this.options,i=e.isFunction(n.helper)?e(n.helper.apply(this.element[0],[t])):"clone"===n.helper?this.element.clone().removeAttr("id"):this.element;return i.parents("body").length||i.appendTo("parent"===n.appendTo?this.element[0].parentNode:n.appendTo),i[0]===this.element[0]||/(fixed|absolute)/.test(i.css("position"))||i.css("position","absolute"),i},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.element.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,n,i,r=this.options;return r.containment?"window"===r.containment?void(this.containment=[e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,e(window).scrollLeft()+e(window).width()-this.helperProportions.width-this.margins.left,e(window).scrollTop()+(e(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===r.containment?void(this.containment=[0,0,e(document).width()-this.helperProportions.width-this.margins.left,(e(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):r.containment.constructor===Array?void(this.containment=r.containment):("parent"===r.containment&&(r.containment=this.helper[0].parentNode),n=e(r.containment),void((i=n[0])&&(t="hidden"!==n.css("overflow"),this.containment=[(parseInt(n.css("borderLeftWidth"),10)||0)+(parseInt(n.css("paddingLeft"),10)||0),(parseInt(n.css("borderTopWidth"),10)||0)+(parseInt(n.css("paddingTop"),10)||0),(t?Math.max(i.scrollWidth,i.offsetWidth):i.offsetWidth)-(parseInt(n.css("borderRightWidth"),10)||0)-(parseInt(n.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(i.scrollHeight,i.offsetHeight):i.offsetHeight)-(parseInt(n.css("borderBottomWidth"),10)||0)-(parseInt(n.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=n))):void(this.containment=null)},_convertPositionTo:function(t,n){n||(n=this.position);var i="absolute"===t?1:-1,r="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent;return this.offset.scroll||(this.offset.scroll={top:r.scrollTop(),left:r.scrollLeft()}),{top:n.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top)*i,left:n.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)*i}},_generatePosition:function(t){var n,i,r,o,a=this.options,s="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,l=t.pageX,c=t.pageY;return this.offset.scroll||(this.offset.scroll={top:s.scrollTop(),left:s.scrollLeft()}),this.originalPosition&&(this.containment&&(this.relative_container?(i=this.relative_container.offset(),n=[this.containment[0]+i.left,this.containment[1]+i.top,this.containment[2]+i.left,this.containment[3]+i.top]):n=this.containment,t.pageX-this.offset.click.left<n[0]&&(l=n[0]+this.offset.click.left),t.pageY-this.offset.click.top<n[1]&&(c=n[1]+this.offset.click.top),t.pageX-this.offset.click.left>n[2]&&(l=n[2]+this.offset.click.left),t.pageY-this.offset.click.top>n[3]&&(c=n[3]+this.offset.click.top)),a.grid&&(r=a.grid[1]?this.originalPageY+Math.round((c-this.originalPageY)/a.grid[1])*a.grid[1]:this.originalPageY,c=n?r-this.offset.click.top>=n[1]||r-this.offset.click.top>n[3]?r:r-this.offset.click.top>=n[1]?r-a.grid[1]:r+a.grid[1]:r,o=a.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/a.grid[0])*a.grid[0]:this.originalPageX,l=n?o-this.offset.click.left>=n[0]||o-this.offset.click.left>n[2]?o:o-this.offset.click.left>=n[0]?o-a.grid[0]:o+a.grid[0]:o)),{top:c-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)}},_clear:function(){
this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(t,n,i){return i=i||this._uiHash(),e.ui.plugin.call(this,t,[n,i]),"drag"===t&&(this.positionAbs=this._convertPositionTo("absolute")),e.Widget.prototype._trigger.call(this,t,n,i)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,n){var i=e(this).data("ui-draggable"),r=i.options,o=e.extend({},n,{item:i.element});i.sortables=[],e(r.connectToSortable).each(function(){var n=e.data(this,"ui-sortable");n&&!n.options.disabled&&(i.sortables.push({instance:n,shouldRevert:n.options.revert}),n.refreshPositions(),n._trigger("activate",t,o))})},stop:function(t,n){var i=e(this).data("ui-draggable"),r=e.extend({},n,{item:i.element});e.each(i.sortables,function(){this.instance.isOver?(this.instance.isOver=0,i.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(t),this.instance.options.helper=this.instance.options._helper,"original"===i.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",t,r))})},drag:function(t,n){var i=e(this).data("ui-draggable"),r=this;e.each(i.sortables,function(){var o=!1,a=this;this.instance.positionAbs=i.positionAbs,this.instance.helperProportions=i.helperProportions,this.instance.offset.click=i.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(o=!0,e.each(i.sortables,function(){return this.instance.positionAbs=i.positionAbs,this.instance.helperProportions=i.helperProportions,this.instance.offset.click=i.offset.click,this!==a&&this.instance._intersectsWith(this.instance.containerCache)&&e.contains(a.instance.element[0],this.instance.element[0])&&(o=!1),o})),o?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=e(r).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return n.helper[0]},t.target=this.instance.currentItem[0],this.instance._mouseCapture(t,!0),this.instance._mouseStart(t,!0,!0),this.instance.offset.click.top=i.offset.click.top,this.instance.offset.click.left=i.offset.click.left,this.instance.offset.parent.left-=i.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=i.offset.parent.top-this.instance.offset.parent.top,i._trigger("toSortable",t),i.dropped=this.instance.element,i.currentItem=i.element,this.instance.fromOutside=i),this.instance.currentItem&&this.instance._mouseDrag(t)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",t,this.instance._uiHash(this.instance)),this.instance._mouseStop(t,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),i._trigger("fromSortable",t),i.dropped=!1)})}}),e.ui.plugin.add("draggable","cursor",{start:function(){var t=e("body"),n=e(this).data("ui-draggable").options;t.css("cursor")&&(n._cursor=t.css("cursor")),t.css("cursor",n.cursor)},stop:function(){var t=e(this).data("ui-draggable").options;t._cursor&&e("body").css("cursor",t._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,n){var i=e(n.helper),r=e(this).data("ui-draggable").options;i.css("opacity")&&(r._opacity=i.css("opacity")),i.css("opacity",r.opacity)},stop:function(t,n){var i=e(this).data("ui-draggable").options;i._opacity&&e(n.helper).css("opacity",i._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(){var t=e(this).data("ui-draggable");t.scrollParent[0]!==document&&"HTML"!==t.scrollParent[0].tagName&&(t.overflowOffset=t.scrollParent.offset())},drag:function(t){var n=e(this).data("ui-draggable"),i=n.options,r=!1;n.scrollParent[0]!==document&&"HTML"!==n.scrollParent[0].tagName?(i.axis&&"x"===i.axis||(n.overflowOffset.top+n.scrollParent[0].offsetHeight-t.pageY<i.scrollSensitivity?n.scrollParent[0].scrollTop=r=n.scrollParent[0].scrollTop+i.scrollSpeed:t.pageY-n.overflowOffset.top<i.scrollSensitivity&&(n.scrollParent[0].scrollTop=r=n.scrollParent[0].scrollTop-i.scrollSpeed)),i.axis&&"y"===i.axis||(n.overflowOffset.left+n.scrollParent[0].offsetWidth-t.pageX<i.scrollSensitivity?n.scrollParent[0].scrollLeft=r=n.scrollParent[0].scrollLeft+i.scrollSpeed:t.pageX-n.overflowOffset.left<i.scrollSensitivity&&(n.scrollParent[0].scrollLeft=r=n.scrollParent[0].scrollLeft-i.scrollSpeed))):(i.axis&&"x"===i.axis||(t.pageY-e(document).scrollTop()<i.scrollSensitivity?r=e(document).scrollTop(e(document).scrollTop()-i.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<i.scrollSensitivity&&(r=e(document).scrollTop(e(document).scrollTop()+i.scrollSpeed))),i.axis&&"y"===i.axis||(t.pageX-e(document).scrollLeft()<i.scrollSensitivity?r=e(document).scrollLeft(e(document).scrollLeft()-i.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<i.scrollSensitivity&&(r=e(document).scrollLeft(e(document).scrollLeft()+i.scrollSpeed)))),!1!==r&&e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(n,t)}}),e.ui.plugin.add("draggable","snap",{start:function(){var t=e(this).data("ui-draggable"),n=t.options;t.snapElements=[],e(n.snap.constructor!==String?n.snap.items||":data(ui-draggable)":n.snap).each(function(){var n=e(this),i=n.offset();this!==t.element[0]&&t.snapElements.push({item:this,width:n.outerWidth(),height:n.outerHeight(),top:i.top,left:i.left})})},drag:function(t,n){var i,r,o,a,s,l,c,u,d,h,p=e(this).data("ui-draggable"),f=p.options,m=f.snapTolerance,g=n.offset.left,v=g+p.helperProportions.width,b=n.offset.top,y=b+p.helperProportions.height;for(d=p.snapElements.length-1;d>=0;d--)s=p.snapElements[d].left,l=s+p.snapElements[d].width,c=p.snapElements[d].top,u=c+p.snapElements[d].height,v<s-m||g>l+m||y<c-m||b>u+m||!e.contains(p.snapElements[d].item.ownerDocument,p.snapElements[d].item)?(p.snapElements[d].snapping&&p.options.snap.release&&p.options.snap.release.call(p.element,t,e.extend(p._uiHash(),{snapItem:p.snapElements[d].item})),p.snapElements[d].snapping=!1):("inner"!==f.snapMode&&(i=Math.abs(c-y)<=m,r=Math.abs(u-b)<=m,o=Math.abs(s-v)<=m,a=Math.abs(l-g)<=m,i&&(n.position.top=p._convertPositionTo("relative",{top:c-p.helperProportions.height,left:0}).top-p.margins.top),r&&(n.position.top=p._convertPositionTo("relative",{top:u,left:0}).top-p.margins.top),o&&(n.position.left=p._convertPositionTo("relative",{top:0,left:s-p.helperProportions.width}).left-p.margins.left),a&&(n.position.left=p._convertPositionTo("relative",{top:0,left:l}).left-p.margins.left)),h=i||r||o||a,"outer"!==f.snapMode&&(i=Math.abs(c-b)<=m,r=Math.abs(u-y)<=m,o=Math.abs(s-g)<=m,a=Math.abs(l-v)<=m,i&&(n.position.top=p._convertPositionTo("relative",{top:c,left:0}).top-p.margins.top),r&&(n.position.top=p._convertPositionTo("relative",{top:u-p.helperProportions.height,left:0}).top-p.margins.top),o&&(n.position.left=p._convertPositionTo("relative",{top:0,left:s}).left-p.margins.left),a&&(n.position.left=p._convertPositionTo("relative",{top:0,left:l-p.helperProportions.width}).left-p.margins.left)),!p.snapElements[d].snapping&&(i||r||o||a||h)&&p.options.snap.snap&&p.options.snap.snap.call(p.element,t,e.extend(p._uiHash(),{snapItem:p.snapElements[d].item})),p.snapElements[d].snapping=i||r||o||a||h)}}),e.ui.plugin.add("draggable","stack",{start:function(){var t,n=this.data("ui-draggable").options,i=e.makeArray(e(n.stack)).sort(function(t,n){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(n).css("zIndex"),10)||0)});i.length&&(t=parseInt(e(i[0]).css("zIndex"),10)||0,e(i).each(function(n){e(this).css("zIndex",t+n)}),this.css("zIndex",t+i.length))}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,n){var i=e(n.helper),r=e(this).data("ui-draggable").options;i.css("zIndex")&&(r._zIndex=i.css("zIndex")),i.css("zIndex",r.zIndex)},stop:function(t,n){var i=e(this).data("ui-draggable").options;i._zIndex&&e(n.helper).css("zIndex",i._zIndex)}})}(jQuery),function(e,t){function n(e,t,n){return e>t&&e<t+n}function i(e){return/left|right/.test(e.css("float"))||/inline|table-cell/.test(e.css("display"))}e.widget("ui.sortable",e.ui.mouse,{version:"1.10.4",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_create:function(){var e=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=!!this.items.length&&("x"===e.axis||i(this.items[0].item)),this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData(this.widgetName+"-item");return this},_setOption:function(t,n){"disabled"===t?(this.options[t]=n,this.widget().toggleClass("ui-sortable-disabled",!!n)):e.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(t,n){var i=null,r=!1,o=this;return!this.reverting&&(!this.options.disabled&&"static"!==this.options.type&&(this._refreshItems(t),e(t.target).parents().each(function(){if(e.data(this,o.widgetName+"-item")===o)return i=e(this),!1}),e.data(t.target,o.widgetName+"-item")===o&&(i=e(t.target)),!!i&&(!(this.options.handle&&!n&&(e(this.options.handle,i).find("*").addBack().each(function(){this===t.target&&(r=!0)}),!r))&&(this.currentItem=i,this._removeCurrentsFromItems(),!0))))},_mouseStart:function(t,n,i){var r,o,a=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,a.cursorAt&&this._adjustOffsetFromHelper(a.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),a.containment&&this._setContainment(),a.cursor&&"auto"!==a.cursor&&(o=this.document.find("body"),this.storedCursor=o.css("cursor"),o.css("cursor",a.cursor),this.storedStylesheet=e("<style>*{ cursor: "+a.cursor+" !important; }</style>").appendTo(o)),a.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",a.opacity)),a.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",a.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!i)for(r=this.containers.length-1;r>=0;r--)this.containers[r]._trigger("activate",t,this._uiHash(this));return e.ui.ddmanager&&(e.ui.ddmanager.current=this),e.ui.ddmanager&&!a.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(t),!0},_mouseDrag:function(t){var n,i,r,o,a=this.options,s=!1;for(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<a.scrollSensitivity?this.scrollParent[0].scrollTop=s=this.scrollParent[0].scrollTop+a.scrollSpeed:t.pageY-this.overflowOffset.top<a.scrollSensitivity&&(this.scrollParent[0].scrollTop=s=this.scrollParent[0].scrollTop-a.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<a.scrollSensitivity?this.scrollParent[0].scrollLeft=s=this.scrollParent[0].scrollLeft+a.scrollSpeed:t.pageX-this.overflowOffset.left<a.scrollSensitivity&&(this.scrollParent[0].scrollLeft=s=this.scrollParent[0].scrollLeft-a.scrollSpeed)):(t.pageY-e(document).scrollTop()<a.scrollSensitivity?s=e(document).scrollTop(e(document).scrollTop()-a.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<a.scrollSensitivity&&(s=e(document).scrollTop(e(document).scrollTop()+a.scrollSpeed)),t.pageX-e(document).scrollLeft()<a.scrollSensitivity?s=e(document).scrollLeft(e(document).scrollLeft()-a.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<a.scrollSensitivity&&(s=e(document).scrollLeft(e(document).scrollLeft()+a.scrollSpeed))),!1!==s&&e.ui.ddmanager&&!a.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),n=this.items.length-1;n>=0;n--)if(i=this.items[n],r=i.item[0],(o=this._intersectsWithPointer(i))&&i.instance===this.currentContainer&&!(r===this.currentItem[0]||this.placeholder[1===o?"next":"prev"]()[0]===r||e.contains(this.placeholder[0],r)||"semi-dynamic"===this.options.type&&e.contains(this.element[0],r))){if(this.direction=1===o?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(i))break;this._rearrange(t,i),this._trigger("change",t,this._uiHash());break}return this._contactContainers(t),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,n){if(t){if(e.ui.ddmanager&&!this.options.dropBehaviour&&e.ui.ddmanager.drop(this,t),this.options.revert){var i=this,r=this.placeholder.offset(),o=this.options.axis,a={};o&&"x"!==o||(a.left=r.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)),o&&"y"!==o||(a.top=r.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,e(this.helper).animate(a,parseInt(this.options.revert,10)||500,function(){i._clear(t)})}else this._clear(t,n);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var t=this.containers.length-1;t>=0;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?e(this.domPosition.prev).after(this.currentItem):e(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var n=this._getItemsAsjQuery(t&&t.connected),i=[];return t=t||{},e(n).each(function(){var n=(e(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[\-=_](.+)/);n&&i.push((t.key||n[1]+"[]")+"="+(t.key&&t.expression?n[1]:n[2]))}),!i.length&&t.key&&i.push(t.key+"="),i.join("&")},toArray:function(t){var n=this._getItemsAsjQuery(t&&t.connected),i=[];return t=t||{},n.each(function(){i.push(e(t.item||this).attr(t.attribute||"id")||"")}),i},_intersectsWith:function(e){var t=this.positionAbs.left,n=t+this.helperProportions.width,i=this.positionAbs.top,r=i+this.helperProportions.height,o=e.left,a=o+e.width,s=e.top,l=s+e.height,c=this.offset.click.top,u=this.offset.click.left,d="x"===this.options.axis||i+c>s&&i+c<l,h="y"===this.options.axis||t+u>o&&t+u<a,p=d&&h;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?p:o<t+this.helperProportions.width/2&&n-this.helperProportions.width/2<a&&s<i+this.helperProportions.height/2&&r-this.helperProportions.height/2<l},_intersectsWithPointer:function(e){var t="x"===this.options.axis||n(this.positionAbs.top+this.offset.click.top,e.top,e.height),i="y"===this.options.axis||n(this.positionAbs.left+this.offset.click.left,e.left,e.width),r=t&&i,o=this._getDragVerticalDirection(),a=this._getDragHorizontalDirection();return!!r&&(this.floating?a&&"right"===a||"down"===o?2:1:o&&("down"===o?2:1))},_intersectsWithSides:function(e){var t=n(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height),i=n(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),r=this._getDragVerticalDirection(),o=this._getDragHorizontalDirection();return this.floating&&o?"right"===o&&i||"left"===o&&!i:r&&("down"===r&&t||"up"===r&&!t)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return 0!==e&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return 0!==e&&(e>0?"right":"left")},refresh:function(e){return this._refreshItems(e),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor===String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(t){function n(){s.push(this)}var i,r,o,a,s=[],l=[],c=this._connectWith();if(c&&t)for(i=c.length-1;i>=0;i--)for(o=e(c[i]),r=o.length-1;r>=0;r--)(a=e.data(o[r],this.widgetFullName))&&a!==this&&!a.options.disabled&&l.push([e.isFunction(a.options.items)?a.options.items.call(a.element):e(a.options.items,a.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),a]);for(l.push([e.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),i=l.length-1;i>=0;i--)l[i][0].each(n);return e(s)},_removeCurrentsFromItems:function(){var t=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=e.grep(this.items,function(e){for(var n=0;n<t.length;n++)if(t[n]===e.item[0])return!1;return!0})},_refreshItems:function(t){this.items=[],this.containers=[this];var n,i,r,o,a,s,l,c,u=this.items,d=[[e.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):e(this.options.items,this.element),this]],h=this._connectWith();if(h&&this.ready)for(n=h.length-1;n>=0;n--)for(r=e(h[n]),i=r.length-1;i>=0;i--)(o=e.data(r[i],this.widgetFullName))&&o!==this&&!o.options.disabled&&(d.push([e.isFunction(o.options.items)?o.options.items.call(o.element[0],t,{item:this.currentItem}):e(o.options.items,o.element),o]),this.containers.push(o));for(n=d.length-1;n>=0;n--)for(a=d[n][1],s=d[n][0],i=0,c=s.length;i<c;i++)l=e(s[i]),l.data(this.widgetName+"-item",a),u.push({item:l,instance:a,width:0,height:0,left:0,top:0})},refreshPositions:function(t){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var n,i,r,o;for(n=this.items.length-1;n>=0;n--)i=this.items[n],i.instance!==this.currentContainer&&this.currentContainer&&i.item[0]!==this.currentItem[0]||(r=this.options.toleranceElement?e(this.options.toleranceElement,i.item):i.item,t||(i.width=r.outerWidth(),i.height=r.outerHeight()),o=r.offset(),i.left=o.left,i.top=o.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(n=this.containers.length-1;n>=0;n--)o=this.containers[n].element.offset(),this.containers[n].containerCache.left=o.left,this.containers[n].containerCache.top=o.top,this.containers[n].containerCache.width=this.containers[n].element.outerWidth(),this.containers[n].containerCache.height=this.containers[n].element.outerHeight();return this},_createPlaceholder:function(t){t=t||this;var n,i=t.options;i.placeholder&&i.placeholder.constructor!==String||(n=i.placeholder,i.placeholder={element:function(){var i=t.currentItem[0].nodeName.toLowerCase(),r=e("<"+i+">",t.document[0]).addClass(n||t.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===i?t.currentItem.children().each(function(){e("<td>&#160;</td>",t.document[0]).attr("colspan",e(this).attr("colspan")||1).appendTo(r)}):"img"===i&&r.attr("src",t.currentItem.attr("src")),n||r.css("visibility","hidden"),r},update:function(e,r){n&&!i.forcePlaceholderSize||(r.height()||r.height(t.currentItem.innerHeight()-parseInt(t.currentItem.css("paddingTop")||0,10)-parseInt(t.currentItem.css("paddingBottom")||0,10)),r.width()||r.width(t.currentItem.innerWidth()-parseInt(t.currentItem.css("paddingLeft")||0,10)-parseInt(t.currentItem.css("paddingRight")||0,10)))}}),t.placeholder=e(i.placeholder.element.call(t.element,t.currentItem)),t.currentItem.after(t.placeholder),i.placeholder.update(t,t.placeholder)},_contactContainers:function(t){var r,o,a,s,l,c,u,d,h,p,f=null,m=null;for(r=this.containers.length-1;r>=0;r--)if(!e.contains(this.currentItem[0],this.containers[r].element[0]))if(this._intersectsWith(this.containers[r].containerCache)){if(f&&e.contains(this.containers[r].element[0],f.element[0]))continue;f=this.containers[r],m=r}else this.containers[r].containerCache.over&&(this.containers[r]._trigger("out",t,this._uiHash(this)),this.containers[r].containerCache.over=0);if(f)if(1===this.containers.length)this.containers[m].containerCache.over||(this.containers[m]._trigger("over",t,this._uiHash(this)),this.containers[m].containerCache.over=1);else{for(a=1e4,s=null,p=f.floating||i(this.currentItem),l=p?"left":"top",c=p?"width":"height",u=this.positionAbs[l]+this.offset.click[l],o=this.items.length-1;o>=0;o--)e.contains(this.containers[m].element[0],this.items[o].item[0])&&this.items[o].item[0]!==this.currentItem[0]&&(p&&!n(this.positionAbs.top+this.offset.click.top,this.items[o].top,this.items[o].height)||(d=this.items[o].item.offset()[l],h=!1,Math.abs(d-u)>Math.abs(d+this.items[o][c]-u)&&(h=!0,d+=this.items[o][c]),Math.abs(d-u)<a&&(a=Math.abs(d-u),s=this.items[o],this.direction=h?"up":"down")));if(!s&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[m])return;s?this._rearrange(t,s,null,!0):this._rearrange(t,null,this.containers[m].element,!0),this._trigger("change",t,this._uiHash()),this.containers[m]._trigger("change",t,this._uiHash(this)),this.currentContainer=this.containers[m],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[m]._trigger("over",t,this._uiHash(this)),this.containers[m].containerCache.over=1}},_createHelper:function(t){var n=this.options,i=e.isFunction(n.helper)?e(n.helper.apply(this.element[0],[t,this.currentItem])):"clone"===n.helper?this.currentItem.clone():this.currentItem;return i.parents("body").length||e("parent"!==n.appendTo?n.appendTo:this.currentItem[0].parentNode)[0].appendChild(i[0]),i[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),i[0].style.width&&!n.forceHelperSize||i.width(this.currentItem.width()),i[0].style.height&&!n.forceHelperSize||i.height(this.currentItem.height()),i},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,n,i,r=this.options;"parent"===r.containment&&(r.containment=this.helper[0].parentNode),"document"!==r.containment&&"window"!==r.containment||(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,e("document"===r.containment?document:window).width()-this.helperProportions.width-this.margins.left,(e("document"===r.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(r.containment)||(t=e(r.containment)[0],n=e(r.containment).offset(),i="hidden"!==e(t).css("overflow"),this.containment=[n.left+(parseInt(e(t).css("borderLeftWidth"),10)||0)+(parseInt(e(t).css("paddingLeft"),10)||0)-this.margins.left,n.top+(parseInt(e(t).css("borderTopWidth"),10)||0)+(parseInt(e(t).css("paddingTop"),10)||0)-this.margins.top,n.left+(i?Math.max(t.scrollWidth,t.offsetWidth):t.offsetWidth)-(parseInt(e(t).css("borderLeftWidth"),10)||0)-(parseInt(e(t).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,n.top+(i?Math.max(t.scrollHeight,t.offsetHeight):t.offsetHeight)-(parseInt(e(t).css("borderTopWidth"),10)||0)-(parseInt(e(t).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(t,n){n||(n=this.position);var i="absolute"===t?1:-1,r="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,o=/(html|body)/i.test(r[0].tagName);return{top:n.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():o?0:r.scrollTop())*i,left:n.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():o?0:r.scrollLeft())*i}},_generatePosition:function(t){var n,i,r=this.options,o=t.pageX,a=t.pageY,s="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,l=/(html|body)/i.test(s[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(o=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(a=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(o=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(a=this.containment[3]+this.offset.click.top)),r.grid&&(n=this.originalPageY+Math.round((a-this.originalPageY)/r.grid[1])*r.grid[1],a=this.containment?n-this.offset.click.top>=this.containment[1]&&n-this.offset.click.top<=this.containment[3]?n:n-this.offset.click.top>=this.containment[1]?n-r.grid[1]:n+r.grid[1]:n,i=this.originalPageX+Math.round((o-this.originalPageX)/r.grid[0])*r.grid[0],o=this.containment?i-this.offset.click.left>=this.containment[0]&&i-this.offset.click.left<=this.containment[2]?i:i-this.offset.click.left>=this.containment[0]?i-r.grid[0]:i+r.grid[0]:i)),{top:a-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():l?0:s.scrollTop()),left:o-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():l?0:s.scrollLeft())}},_rearrange:function(e,t,n,i){n?n[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var r=this.counter;this._delay(function(){r===this.counter&&this.refreshPositions(!i)})},_clear:function(e,t){function n(e,t,n){return function(i){n._trigger(e,i,t._uiHash(t))}}this.reverting=!1;var i,r=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(i in this._storedCSS)"auto"!==this._storedCSS[i]&&"static"!==this._storedCSS[i]||(this._storedCSS[i]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!t&&r.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||t||r.push(function(e){this._trigger("update",e,this._uiHash())}),this!==this.currentContainer&&(t||(r.push(function(e){this._trigger("remove",e,this._uiHash())}),r.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),r.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer)))),i=this.containers.length-1;i>=0;i--)t||r.push(n("deactivate",this,this.containers[i])),this.containers[i].containerCache.over&&(r.push(n("out",this,this.containers[i])),this.containers[i].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!t){for(this._trigger("beforeStop",e,this._uiHash()),i=0;i<r.length;i++)r[i].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!1}if(t||this._trigger("beforeStop",e,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null,!t){for(i=0;i<r.length;i++)r[i].call(this,e);this._trigger("stop",e,this._uiHash())}
return this.fromOutside=!1,!0},_trigger:function(){!1===e.Widget.prototype._trigger.apply(this,arguments)&&this.cancel()},_uiHash:function(t){var n=t||this;return{helper:n.helper,placeholder:n.placeholder||e([]),position:n.position,originalPosition:n.originalPosition,offset:n.positionAbs,item:n.currentItem,sender:t?t.element:null}}})}(jQuery),define("jqueryui",["jquery"],function(e){return function(){return e.$}}(this)),define("ts/modules/emailbuilder/content-blocks/spacer.directive",["require","exports","vendor/text!ts/modules/emailbuilder/content-blocks/spacer.directive.html","jqueryui"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=1,r=1e3,o=11,a=function(){function e(e,t){var a=this;this.restrict="A",this.template=n,this.link=function(e,t){e.handleOffset=o;var n=function(t){var n=a.lockLevelService.getLocks(t);e.canResize=n.canEditContentItemStyles};n(e.section.permissions),e.$on("permissionsChanged:section-"+e.section.uiId,function(e,t){n(t)}),t.find(".emb-spacer-handle").draggable({axis:"y",helper:"original",stop:function(t,n){e.$apply(function(){a.modelActivityService.contentUpdated()})},drag:function(t,n){e.$apply(function(){var t=Math.round(n.position.top)+o;t=Math.max(t,i),t=Math.min(t,r),e.block.height=t,n.position.top=t-o})},cursor:"ns-resize"})},this.modelActivityService=e,this.lockLevelService=t}return e.factory=function(t,n){return new e(t,n)},e}();t.Spacer=a}),define("vendor/text!ts/modules/emailbuilder/content-blocks/button-block.directive.html",[],function(){return"<div ng-class=\"[vm.buttonWrapperClasses.appearance, vm.buttonWrapperClasses.size, vm.buttonWrapperClasses.alignment]\" ng-style=\"block.halign ==='full' ? { 'text-align': 'center' } : { 'text-align': block.halign }\">\r\n    <a class=\"js-button-element\" href=\"#\" ng-style=\"vm.buttonCss\">{{vm.block.text || '&nbsp'}}</a>\r\n</div>"}),define("ts/modules/emailbuilder/string-utils",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stringIsNullOrWhitespace=function(e){return!e||0===e.trim().length},t.upperCaseFirstLetter=function(e){return t.stringIsNullOrWhitespace(e)?e:""+e[0].toUpperCase()+e.substring(1)},t.replaceSpacedStrings=function(e,t){return/\s+/.test(e)&&t>0?"-":""},t.stringEndsWith=function(e,t){return-1!==e.indexOf(t,e.length-t.length)},t.stringRemoveSuffix=function(e,n){return t.stringEndsWith(e,n)?e.substring(0,e.length-n.length):e}}),define("ts/modules/emailbuilder/content-blocks/button-block.controller",["require","exports","../string-utils"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t,i,r,o,a){var s=this;this.buttonCss={},this.init=function(e){s.block.width=null,s.buttonWrapperClasses.appearance="btn--"+(s.block.buttonStyleAppearance||"flat"),s.block.fontFamily?s.buttonCss.fontFamily=s.fontStyleMap[s.block.fontFamily]:(s.block.fontFamily=s.emailBuilderConfig.email.styles.p.fontFamily,s.buttonCss.fontFamily=s.fontStyleMap[s.emailBuilderConfig.email.styles.p.fontFamily]),null!==s.block.borderRadius?s.buttonCss.borderRadius=s.block.borderRadius:(s.block.borderRadius=s.emailBuilderConfig.settings.borderRadiusForRoundedButtonCorners,s.buttonCss.borderRadius=s.emailBuilderConfig.settings.borderRadiusForRoundedButtonCorners),s.updateButtonSize(s.block.buttonSize||"large",e),null===s.block.backgroundColor&&(s.block.backgroundColor=s.reinitializeInlineStyleValue),null===s.block.color&&(s.block.color=s.reinitializeInlineStyleValue),s.block.tempBackgroundColor=s.block.backgroundColor||s.emailBuilderConfig.email.styles.button.backgroundColor,s.block.tempTextColor=s.block.color||s.emailBuilderConfig.email.styles.button.color,s.nextButtonStyleService.setNextButtonStyle(s.block,!0)},this.calculateFontStyleMap=function(){for(var e={},t=0;t<s.emailBuilderConfig.fonts.length;t+=1){var n=s.emailBuilderConfig.fonts[t],i=n.cssValues["font-family"];e[n.value]=i}return e},this.updateHalign=function(e){s.block.halign=e},this.updateText=function(e,t,i){s.block.text=n.stringIsNullOrWhitespace(i.text())?"":i.text()},this.updateBorderRadius=function(e,t){e&&(s.buttonCss.borderRadius=e)},this.updateButtonSize=function(e,t){s.block.buttonSize=e,s.buttonWrapperClasses.size="btn--"+e},this.updateButtonStyleAppearance=function(e,t,n){"ghost"===e?(s.buttonCss.borderColor=s.buttonCss.backgroundColor,s.buttonCss.backgroundColor=s.reinitializeInlineStyleValue):"ghost"===t&&(s.buttonCss.backgroundColor=s.buttonCss.borderColor,s.buttonCss.borderColor=s.reinitializeInlineStyleValue),s.buttonWrapperClasses.appearance="btn--"+e},this.updateFontFamily=function(e,t){s.buttonCss.fontFamily=s.fontStyleMap[e]},this.updateTempBackgroundColor=function(){var e=s.emailBuilderConfig.email.styles.button.backgroundColor,t=s.block.tempBackgroundColor;t&&(t!==e?(s.block.backgroundColor=t,"ghost"===s.block.buttonStyleAppearance?s.buttonCss.borderColor="#"+t:s.buttonCss.backgroundColor="#"+t):(s.block.backgroundColor=s.reinitializeInlineStyleValue,s.buttonCss.backgroundColor=s.reinitializeInlineStyleValue,s.buttonCss.borderColor=s.reinitializeInlineStyleValue))},this.updateTempTextColor=function(){var e=s.emailBuilderConfig.email.styles.button.color,t=s.block.tempTextColor;t&&(t!==e?(s.block.color=t,s.buttonCss.color="#"+t):(s.block.color=s.reinitializeInlineStyleValue,s.buttonCss.color=s.reinitializeInlineStyleValue))},this.updateColorFromCustomiseColorPickerBgColor=function(){var e=s.emailBuilderConfig.email.styles.button.backgroundColor;s.block.backgroundColor||(s.block.tempBackgroundColor=e)},this.updateColorFromCustomiseColorPickerTextColor=function(){var e=s.emailBuilderConfig.email.styles.button.color;s.block.color||(s.block.tempTextColor=e)},this.undoModelChanged=function(){s.block.tempBackgroundColor=s.block.backgroundColor||s.emailBuilderConfig.email.styles.button.backgroundColor,s.block.tempTextColor=s.block.color||s.emailBuilderConfig.email.styles.button.color,s.contentBlockService.validateBlock(s.block)},this.updateButtonAlignment=function(e,t){e&&("full"===e?(s.buttonWrapperClasses.alignment="fullwidth",s.buttonCss.display="block"):(s.buttonWrapperClasses.alignment="",s.buttonCss.width="",s.buttonCss.display="inline-block"))},this.updatePropertiesCalculatedForVml=function(e){s.$timeout(function(){s.block.vmlWidth=Math.round(e.innerWidth()),s.block.vmlHeight=Math.round(e.outerHeight()),s.block.lines=s.textCalcService.getLines(e)},0)},this.$timeout=e,this.emailBuilderConfig=t,this.dynamicStylesService=i,this.nextButtonStyleService=r,this.textCalcService=o,this.contentBlockService=a,this.fontStyleMap=this.calculateFontStyleMap(),this.reinitializeInlineStyleValue="",this.buttonWrapperClasses={appearance:"",size:"",alignment:""}}return e}();t.ButtonBlockController=i});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/content-blocks/button-block-blueprint.directive",["require","exports","vendor/text!ts/modules/emailbuilder/content-blocks/button-block.directive.html","angular","./button-block.controller"],function(e,t,n,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=__importDefault(i);var o=function(){function e(e,t){var o=this;this.restrict="E",this.template=n,this.bindToController={block:"="},this.controller=["$timeout","EmailBuilderConfig","DynamicStylesService","NextButtonStyleService","ButtonTextCalcService","ContentBlockService",r.ButtonBlockController],this.controllerAs="vm",this.link=function(e,t,n,r){var a=t.find(".js-button-element");null!==e.block.halign&&""!==e.block.halign||r.updateHalign(a.parent().css("text-align")),e.$watch("block.halign",function(e){return r.updateButtonAlignment(e,a)}),e.$watch("block.text",function(e,t){r.updateText(e,t,a)}),e.$watch("block.borderRadius",function(e){r.updateBorderRadius(e,a)}),e.$watch("block.fontFamily",function(e){r.updateFontFamily(e,a)}),e.$watch("block.buttonStyleAppearance",function(e,t){r.updateButtonStyleAppearance(e,t,a)}),e.$watch("block.buttonSize",function(e){return r.updateButtonSize(e,a)}),e.$watch("block.tempBackgroundColor",function(){r.updateTempBackgroundColor()}),e.$watch("block.tempTextColor",function(){r.updateTempTextColor()}),e.$watch(function(){return o.emailBuildConfig.email.styles.button.backgroundColor},function(){r.updateColorFromCustomiseColorPickerBgColor()}),e.$watch(function(){return o.emailBuildConfig.email.styles.button.color},function(){r.updateColorFromCustomiseColorPickerTextColor()}),e.$watch(function(){return{text:e.block.text,href:e.block.href,backgroundColor:e.block.backgroundColor,color:e.block.color,fontFamily:e.block.fontFamily,halign:e.block.halign,borderRadius:e.block.borderRadius,buttonStyleAppearance:e.block.buttonStyleAppearance,buttonSize:e.block.buttonSize}},function(e,t){i.default.equals(e,t)||o.nextButtonStyleService.setNextButtonStyle(e,!1)},!0),e.$watch(function(){return{buttonSize:e.block.buttonSize,buttonStyleAppearance:e.block.buttonStyleAppearance,fontFamily:e.block.fontFamily,text:e.block.text,halign:e.block.halign}},function(){r.updatePropertiesCalculatedForVml(a)},!0),e.$on("undo:modelChanged",function(){r.undoModelChanged()}),r.init(a)},this.emailBuildConfig=e,this.nextButtonStyleService=t}return e.factory=function(t,n){return new e(t,n)},e}();t.ButtonBlockBlueprint=o}),define("vendor/text!ts/modules/emailbuilder/content-blocks/video-block.directive.html",[],function(){return'<div id="emb-js-image-{{block.tempContainer.sectionIndex}}-{{block.tempContainer.columnIndex}}" class="emb-content-inner emb-js-content-inner emb-js-content-handle emb-handle"\n     ng-class="{ \'emb-active\' :!dragging && block.isActive, \'emb-hoverable\' : !dragging && !block.isActive, \'emb-img-showing-dropzone\' :  !hasImage }"\n     ng-mouseover="hovered = true; $event.stopPropagation()"\n     ng-mouseout="hovered = false;">\n    <div emb-item-controls item-type="content" item="block" section-index="sectionIndex" content-index="column" item-hovered="hovered"></div>\n\n    \x3c!-- if this section is active show the toolbar --\x3e\n    <div class="c-toolbar-container">\n        <div class="c-toolbar" ng-if="!dragging && block.isActive && hasImage">\n            <div class="c-toolbar__item">\n\n                <div emb-item-controls\n                        item-type="content"\n                        item="block"\n                        section-index="sectionIndex"\n                        content-index="column"\n                        item-hovered="hovered"\n                        narrow-controls="false"\n                        image-controls="true"\n                        closer="toggleDisplay"></div>\n            </div>\n        </div>\n    </div>\n    <emb-validation-messages model="block" clear-on-inactive="1"></emb-validation-messages>\n    <div ng-show="!hasImage">\n        <div class="emb-js-img-container emb-img-dropzone emb-reset"\n             ng-class="{ \'emb-error\' : !block.tempIsValid && block.isActive, \'emb-hovered\': hovered }">\n            <div class="emb-dropzone-container emb-js-dropzone-container">\n                <p class="emb-drop-icon">\n                    <span class="emb-video-well">Select Video</span>\n                </p>\n            </div>\n        </div>\n    </div>\n    <div ng-show="hasImage">\n        <div ng-transclude\n             class="emb-js-img-container emb-img-container qa-email-video-thumbnail-container"\n             ng-class="{ \'emb-error\' : !block.tempIsValid && block.isActive }">\n        </div>\n    </div>\n</div>'}),define("ts/modules/emailbuilder/content-blocks/video-block.directive",["require","exports","vendor/text!ts/modules/emailbuilder/content-blocks/video-block.directive.html"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){var t=this;this.restrict="A",this.template=n,this.transclude=!0,this.link=function(e){e.getSrc=function(){return t.contentBlockService.getBlockSrc(e.block)},e.$watch(function(){return t.contentBlockService.getBlockSrc(e.block)},function(t){e.hasImage=!!t,e.allowReplace=!t})},this.contentBlockService=e}return e.factory=function(t){return new e(t)},e}();t.VideoBlock=i}),function(e){"use strict";function t(e,n,i,r,o,a,s,l){var c,u,d,h,p,f=function(e){a.text(e),a[l?"prepend":"append"](s)};return l?(c=0===r?"":i.slice(-r),u=i.slice(-o)):(c=i.slice(0,r),u=i.slice(0,o)),n<a.html(s)[e]()?0:(f(u),h=a[e](),f(c),p=a[e](),h<p?o:(d=parseInt((r+o)/2,10),c=l?i.slice(-d):i.slice(0,d),f(c),a[e]()===n?d:(a[e]()>n?o=d-1:r=d+1,t(e,n,i,r,o,a,s,l))))}e.fn.truncate=function(n){n&&n.center&&!n.side&&(n.side="center",delete n.center),n&&!/^(left|right|center)$/.test(n.side)&&delete n.side;var i={width:"auto",token:"&hellip;",side:"right",addclass:!1,addtitle:!1,multiline:!1};return n=e.extend(i,n),this.each(function(){var i,r,o,a=e(this),s={fontFamily:a.css("fontFamily"),fontSize:a.css("fontSize"),fontStyle:a.css("fontStyle"),fontWeight:a.css("fontWeight"),"font-variant":a.css("font-variant"),"text-indent":a.css("text-indent"),"text-transform":a.css("text-transform"),"letter-spacing":a.css("letter-spacing"),"word-spacing":a.css("word-spacing"),display:"none"},l=a.text(),c=e("<span/>").css(s).text(l).appendTo("body"),u=c.width(),d=parseInt(n.width,10)||a.width(),h="width";if(n.multiline?(c.width(a.width()),h="height",r=c.height(),o=a.height()+1):(r=u,o=d),i={before:"",after:""},r>o){var p,f;c.text(""),"left"===n.side?(p=t(h,o,l,0,l.length,c,n.token,!0),i.after=l.slice(-1*p)):"center"===n.side?(o=parseInt(o/2,10)-1,p=t(h,o,l,0,l.length,c,n.token,!1),f=t(h,o,l,0,l.length,c,"",!0),i.before=l.slice(0,p),i.after=l.slice(-1*f)):"right"===n.side&&(p=t(h,o,l,0,l.length,c,n.token,!1),i.before=l.slice(0,p)),n.addclass&&a.addClass(n.addclass),n.addtitle&&a.attr("title",l),i.before=c.text(i.before).html(),i.after=c.text(i.after).html(),a.empty().html(i.before+n.token+i.after)}c.remove()})}}(jQuery),define("vendor/jquery.truncate",["jquery"],function(e){return function(){return e.$}}(this));var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/content-blocks/truncate.directive",["require","exports","underscore","vendor/jquery.truncate"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=__importDefault(n);var i=function(){function e(e){var t=this;this.restrict="A",this.link=function(e,i,r){var o=t.$parse(r.csTruncate),a={width:r.maxWidth,side:r.side},s=function(e,t,n){return e.text(t).truncate(n).text()},l=n.default.memoize(s,function(e,t){return[e,t.width,t.side].join("|")}),c=function(e,t,n){return t?l(e,t,n):""},u=function(){i.text(c(i,o(e),a))};o.constant||e.$watch(r.csTruncate,u),u()},this.$parse=e}return e.factory=function(t){return new e(t)},e}();t.Truncate=i}),define("ts/modules/emailbuilder/content-blocks/block-render-image.directive",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){var t=this;this.restrict="A",this.link=function(e,n){t.imageBuilderService.resize(e.block),e.$watch(function(){var t=e.block,n=null;return(e.$first||e.$last)&&t.isFullWidth&&(t.tempResized||"center"!==t.halign)&&(n="gnd-corner-image gnd-corner-image-"+t.halign,e.$first&&(n+=" gnd-corner-image-top"),e.$last&&(n+=" gnd-corner-image-bottom")),n},function(e){n.removeClass("gnd-corner-image gnd-corner-image-bottom gnd-corner-image-top gnd-corner-image-left gnd-corner-image-right gnd-corner-image-center"),e&&n.addClass(e)})},this.imageBuilderService=e}return e.factory=function(t){return new e(t)},e}();t.BlockRenderImage=n});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/content-blocks/content-blocks.module",["require","exports","angular","./content-editable.directive","./divider.directive","./event-code.directive","./image-block.directive","./preview-text.directive","./text-block.directive","./text-command.directive","./image-ui-state.service","./scroll-content-block.directive","./countdown-block.directive","./countdown-date.service","./validation-messages.directive","./third-party-image-downloader.service","./button-block.directive","./button-text-calc.service","./spacer.directive","./button-block-blueprint.directive","./video-block.directive","./truncate.directive","./block-render-image.directive"],function(e,t,n,i,r,o,a,s,l,c,u,d,h,p,f,m,g,v,b,y,w,_,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=__importDefault(n);var k=n.default.module("emailbuilder.content-blocks",[]);t.module=k,k.directive("contenteditable",["ModelActivityService","$timeout",i.ContentEditable.factory]),k.directive("embCountdownBlock",[h.CountdownBlock.factory]),k.directive("embDivider",r.Divider.factory),k.directive("embEventCode",["ModelActivityService",o.EventCode.factory]),k.directive("embImageBlock",["ImageManagerService","ImageUiStateService","ThirdPartyImageDownloaderService","PersonalisationService","$rootScope","$document","LockLevelService","ContentBlockService","EmailBuilderConfig","$timeout","ImageBuilderService","ModelActivityService",a.ImageBlock.factory]),k.directive("embPreviewText",[s.PreviewText.factory]),k.directive("embScrollContentBlock",["ViewPortService",d.ScrollContentBlock.factory]),k.directive("embTextBlock",["ItemWidthService","$rootScope","$timeout","ModelActivityService","$sce","LockLevelService","EmailBuilderConfig","ViewPortService",l.TextBlock.factory]),k.directive("embTextCommand",["$rootScope","$timeout",c.TextCommand.factory]),k.directive("embValidationMessages",[f.ValidationMessages.factory]),k.directive("embSpacer",["ModelActivityService","LockLevelService",b.Spacer.factory]),k.service("CountdownDateService",["$filter",p.CountdownDateService]),k.service("ImageUiStateService",["$rootScope",u.ImageUiStateService]),k.service("ThirdPartyImageDownloaderService",["$rootScope","ImageBuilderService",m.ThirdPartyImageDownloaderService]),k.directive("embButton",["$timeout","EmailBuilderConfig","DynamicStylesService","ButtonTextCalcService","NextButtonStyleService",g.ButtonBlock.factory]),k.directive("embButtonBlock",["$timeout","EmailBuilderConfig","DynamicStylesService","ButtonTextCalcService","NextButtonStyleService",g.ButtonBlock.factory]),k.directive("embButtonBlockBlueprint",["EmailBuilderConfig","NextButtonStyleService",y.ButtonBlockBlueprint.factory]),k.service("ButtonTextCalcService",["$document",v.ButtonTextCalcService]),k.directive("embVideoBlock",["ContentBlockService",w.VideoBlock.factory]),k.directive("embBlockRenderImage",["ImageBuilderService",S.BlockRenderImage.factory]),k.directive("csTruncate",["$parse",_.Truncate.factory])}),define("vendor/text!ts/modules/emailbuilder/dialogs/login-dialog.directive.html",[],function(){return'<div id="emb-login-dialog" class="ng-cloak emb-js-animation-allowed" ng-show="showLoginForm" ng-controller="LoginController">\r\n    <form name="login" validate-on-submit="onValidLoginSubmission();" ng-class="{\'visible\': showLoginForm}">\r\n        <h2 class="emb-heading">Your session has expired</h2>\r\n        <p class="emb-headline">Please log in to save changes</p>\r\n        <div class="emb-dialog-container">\r\n            <div class="emb-dialog-main">\r\n                <div class="messaging-container">\r\n                    <div class="emb-dialog-info emb-dialog-error" ng-show="failure">\r\n                        <p>Invalid email or password</p>\r\n                    </div>\r\n                    <div class="emb-dialog-info emb-dialog-error" ng-show="lockout">\r\n                        <i>\r\n                            Can\'t remember your details?\r\n                            Don\'t worry, it happens to the best of us.\r\n                        </i> Wait a few moments and you\'ll be able to try again.\r\n                    </div>\r\n                </div>\r\n                <div class="login-credentials-container" ng-show="!twoFactorRequired">\r\n                    <div class="emb-form-input">\r\n                        <label for="email">Email</label>\r\n                        <input type="text" name="email" ng-model-on-blur="account.email" cs-focus="showLoginForm" placeholder="sally.sparrow@gmail.com" autoccorrect="off" autocomplete="off" required class="ng-dirty"/>\r\n                        <div class="emb-warning-tooltip" ng-show="login.email.$invalid && login.email.$dirty" class="help-block">Your email is required</div>\r\n                    </div>\r\n                    <div class="emb-form-input">\r\n                        <label for="password">Password</label>\r\n                        <input type="password" name="password" ng-model-on-blur="account.password" placeholder="Password" required class="ng-dirty"/>\r\n                        <div class="emb-warning-tooltip" ng-show="login.password.$error.required">Your password is required</div>\r\n                    </div>\r\n                    <div class="emb-opt-in">\r\n                        <input type="checkbox" name="rememberMe" ng-model="account.rememberMe" id="emb-login-rememberMe"/>\r\n                        <label for="emb-login-rememberMe">Remember me</label>\r\n                    </div>\r\n                </div>\r\n                <div class="two-factor-container" ng-show="twoFactorRequired">\r\n                    <div class="emb-dialog-info two-factor-info">\r\n                        <h3>Enter your two factor authentication code</h3>\r\n                    </div>\r\n                    <div class="emb-form-input">\r\n                        <label for="authenticatorCode">Authenticator code</label>\r\n                        <input type="text" name="authenticatorCode" ng-model="twoFactorModel.authenticator" ng-required="twoFactorRequired" cs-focus="twoFactorRequired"/>\r\n                    </div>\r\n                </div>\r\n                <div class="messaging-container">\r\n                    <div class="emb-dialog-info emb-dialog-error" ng-if="twoFactorCodeIncorrect">\r\n                        <p>The authentication code you entered was incorrect.</p>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <footer>\r\n                <button type="submit" ng-disabled="loginInProgress || twoFactorInProgress" class="c-button c-button--primary">Log in</button>\r\n            </footer>\r\n        </div>\r\n    </form>\r\n</div>'}),define("ts/modules/emailbuilder/dialogs/login-dialog.directive",["require","exports","vendor/text!ts/modules/emailbuilder/dialogs/login-dialog.directive.html"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this.restrict="E",this.template=n}return e.factory=function(){return new e},e}();t.LoginDialog=i}),define("vendor/text!ts/modules/emailbuilder/dialogs/send-test-dialog.directive.html",[],function(){return'<div id="emb-test-email" ng-class="{\'emb-hidden\': embState != \'editor\'}" class="ng-cloak emb-js-animation-allowed" ng-show="showTestEmailForm" ng-controller="SendTestEmailCtrl" ng-init="" ng-click="$event.stopPropagation();">\r\n    <form name="testEmail" validate-on-submit="sendTestEmail(embState === \'preview\');" ng-class="{\'visible\': showTestEmailForm}">\r\n        <h2 class="emb-heading">Send a test email</h2>\r\n        <p class="emb-headline">\r\n        </p>\r\n        <div class="emb-dialog-container">\r\n            <div class="emb-dialog-main">\r\n                <button class="modal__button" ng-click="hideTestModal($event);">\r\n                    <svg class="c-icon c-icon--close-btn" width="11px" height="11px" version="1.1" viewBox="0 0 21.9 21.7">\r\n                        <g>\r\n                            <title>Close Button</title>\r\n                            <rect fill="currentColor" x="-2.6" y="9.2" transform="matrix(0.6986 -0.7156 0.7156 0.6986 -4.5423 11.1551)" width="27.2" height="3.6" />\r\n                            <rect fill="currentColor" x="-2.6" y="9.2" transform="matrix(0.7156 0.6986 -0.6986 0.7156 10.7824 -4.5423)" width="27.2" height="3.6" />\r\n                        </g>\r\n                    </svg>\r\n                </button>\r\n                <div class="emb-form-input">\r\n                    <label>Send a test email to:</label>\r\n                    <input type="email" name="email" class="ng-dirty" ng-model-on-blur="user.email" cs-focus="showTestEmailForm" placeholder="" required ng-pattern="emailRegex" ng-disabled="sendInProgress" />\r\n                    <div class="emb-warning-tooltip" ng-show="testEmail.email.$error.required">An email address is required</div>\r\n                    <div class="emb-warning-tooltip" ng-show="testEmail.email.$error.pattern">Enter a valid email address</div>\r\n                </div>\r\n            </div>\r\n            <footer>\r\n                <button type="submit" ng-disabled="sendInProgress" class="c-button c-button--primary c-button--xlarge c-button--full">{{ !sendInProgress ? \'Send test\' : (!testEmailSent ? \'Sending...\' : \'Sent\')}}</button>\r\n            </footer>\r\n        </div>\r\n    </form>\r\n</div>'}),define("ts/modules/emailbuilder/dialogs/send-test-dialog.directive",["require","exports","vendor/text!ts/modules/emailbuilder/dialogs/send-test-dialog.directive.html"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this.restrict="E",this.template=n}return e.factory=function(){return new e},e}();t.SendTestDialog=i}),define("vendor/text!ts/modules/emailbuilder/dialogs/template-name-dialog.directive.html",[],function(){return'<div id="emb-name-template" ng-class="{\'emb-hidden\': embState != \'preview\'}" class="ng-cloak emb-js-animation-allowed" ng-show="showSaveTemplateAs">\r\n    <form ng-submit="saveTemplateAndContinue(true); $event.preventDefault();">\r\n        <div class="emb-dialog-container">\r\n            <div class="emb-dialog-main">\r\n                <h2 id="template-name">Name this template</h2>\r\n                <p>To save time, you can use it again for any future campaigns.</p>\r\n                <input aria-labelledby="template-name" id="templateName" type="text" placeholder="{{inputPlaceholderText}}" ng-change="updateUserCreatedTemplateName()" ng-model="userCreatedTemplateName" ng-style="inputBorderStyle" cs-focus="showSaveTemplateAs" maxlength="50"/>\r\n            </div>\r\n        </div>\r\n    </form>\r\n</div>'}),define("ts/modules/emailbuilder/dialogs/template-name-dialog.directive",["require","exports","vendor/text!ts/modules/emailbuilder/dialogs/template-name-dialog.directive.html"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t,i){var r=this;this.restrict="E",this.scope={embState:"=",showSaveTemplateAs:"="},this.template=n,this.link=function(e){e.userCreatedTemplateName="",e.inputPlaceholderText="Template name",e.inputBorderStyle={};var t=!1;e.updateUserCreatedTemplateName=function(){r.templateNameService.setName(e.userCreatedTemplateName)},e.saveTemplateAndContinue=function(){if(!t){if(t=!0,!e.userCreatedTemplateName)return e.inputPlaceholderText="Please enter a template name",e.inputBorderStyle="1px solid red !important",e.inputBorderStyle={border:"1px solid red"},void(t=!1);r.saveService.saveTemplate()}};var n=r.$rootScope.$on("template:trySave",e.saveTemplateAndContinue),i=r.$rootScope.$on("template:closeDialog",function(){e.inputBorderStyle={},e.inputPlaceholderText="Template name"});e.$watch("showSaveTemplateAs",function(t){t||(e.userCreatedTemplateName="",r.templateNameService.resetName())}),e.$on("$destroy",function(){n(),i()})},this.templateNameService=e,this.saveService=t,this.$rootScope=i}return e.factory=function(t,n,i){return new e(t,n,i)},e}();t.TemplateNameDialog=i}),define("ts/modules/emailbuilder/dialogs/model-on-blur.directive",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.restrict="A",this.priority=1,this.require="^form",this.link=function(e,t,n,i){if("radio"!==n.type&&"checkbox"!==n.type){var r=[i.$name,".",t.attr("name")].join(""),o=function(){e[n.ngModelOnBlur]=t.val()};t.on("blur",o).on("keydown",function(e){13===e.keyCode&&o()});var a=function(n){var i=e.$eval(r);i&&(i.$invalid||n)&&(i.$invalid=!1,i.$dirty=!1,i.$error={},t.removeClass("ng-invalid"))};t.on("input propertychange paste",function(){e.$apply(function(){a(!1)})}),e.$watch(function(){var t=e.$eval(r);return t&&t.$submittedOn},function(){var n=e.$eval(r);if(n){var i=n.$invalid?"ng-invalid":"ng-valid";t.removeClass("ng-invalid ng-valid").addClass(i)}}),e.$watch(function(){return e.$eval(n.ngModelOnBlur)},function(e){void 0!==e&&(t.val(e),a(!0))})}}}return e.factory=function(){return new e},e}();t.ModelOnBlur=n}),define("ts/modules/emailbuilder/services/login.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e.SUCCESS="Success",e.LOCKOUT="Lockout",e.TWO_FACTOR_CODE_REQUIRED="TwoFactorRequired",e.TWO_FACTOR_INCORRECT="TwoFactorIncorrect"}(n||(n={})),t.LoginOutcome=n;var i=function(){function e(e,t){var n=this;this.login=function(e){var t={email:e.email,password:e.password,rememberMe:e.rememberMe};return n.$http.post(n.emailBuilderConfig.urls.login,t)},this.loginWithTwoFactor=function(e,t){var i={email:e.email,password:e.password,rememberMe:e.rememberMe,authenticator:t};return n.$http.post(n.emailBuilderConfig.urls.login,i)},this.$http=e,this.emailBuilderConfig=t}return e}();t.LoginService=i}),define("ts/modules/emailbuilder/dialogs/login.controller",["require","exports","../services/login.service"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t,i,r,o){var a=this;this.resetForm=function(){a.$scope.success=!1,a.$scope.failure=!1,a.$scope.lockout=!1,a.$scope.twoFactorCodeIncorrect=!1},this.hardReset=function(){a.$scope.account={email:"",password:"",rememberMe:!1},a.$scope.twoFactorModel={authenticator:""},a.$scope.loginInProgress=!1,a.$scope.twoFactorInProgress=!1,a.$scope.twoFactorRequired=!1,a.$scope.twoFactorCodeIncorrect=!1,a.resetForm()},this.onLoginSuccess=function(){a.$scope.success=!0,a.$scope.failure=!1,a.$rootScope.showLoginForm=!1,a.$timeout(function(){a.hardReset(),a.retryRequestService.retry()},1e3)},this.onLockout=function(){a.$scope.failure=!1,a.$scope.lockout=!0},this.onUnknownFailure=function(){a.$scope.failure=!0},this.onLoginFinish=function(){a.$scope.loginInProgress=!1,a.$scope.twoFactorInProgress=!1},this.onTwoFactorCodeRequired=function(){a.$scope.twoFactorRequired=!0},this.onTwoFactorCodeIncorrect=function(){a.$scope.twoFactorCodeIncorrect=!0},this.handleLoginComplete=function(e){switch(e.data.status){case n.LoginOutcome.SUCCESS:a.onLoginSuccess();break;case n.LoginOutcome.TWO_FACTOR_CODE_REQUIRED:a.onLoginFinish(),a.onTwoFactorCodeRequired();break;case n.LoginOutcome.TWO_FACTOR_INCORRECT:a.onLoginFinish(),a.onTwoFactorCodeIncorrect();break;case n.LoginOutcome.LOCKOUT:a.onLoginFinish(),a.onLockout();break;default:a.onLoginFinish(),a.onUnknownFailure()}},this.loginWithCredentials=function(){return a.$scope.loginInProgress=!0,a.loginService.login(a.$scope.account)},this.loginWithTwoFactor=function(){return a.$scope.twoFactorInProgress=!0,a.loginService.loginWithTwoFactor(a.$scope.account,a.$scope.twoFactorModel.authenticator)},this.loginService=e,this.retryRequestService=t,this.$scope=i,this.$rootScope=r,this.$timeout=o,this.$scope.onValidLoginSubmission=function(){a.resetForm(),(a.$scope.twoFactorRequired?a.loginWithTwoFactor():a.loginWithCredentials()).then(a.handleLoginComplete)},this.hardReset()}return e}();t.LoginController=i});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}}
;define("ts/modules/emailbuilder/dialogs/validate-on-submit.directive",["require","exports","angular"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=__importDefault(n);var i=function(){function e(e){var t=this;this.restrict="A",this.link=function(e,i,r){i.attr("novalidate","novalidate"),i.bind("submit",function(o){o.preventDefault();var a=i.clone();if(n.default.forEach(a.find("[ng-model-on-blur]"),function(e){var t=$(e);t.attr("ng-model",t.attr("ng-model-on-blur")),t.removeAttr("ng-model-on-blur")}),t.$compile(a.get(0).outerHTML)(e),n.default.forEach(a.find("[ng-model]"),function(t){var n,o=$(t),a=[r.name,".",o.attr("name")].join(""),s=e.$eval(a),l=i.find("[name="+o.attr("name")+"]");switch(l.attr("type")){case"checkbox":case"radio":n=l.prop("checked");break;default:n=l.val()}s.$setViewValue(n),s.$submittedOn=(new Date).valueOf()}),e.$apply(),e[r.name].$invalid)return void a.find(".ng-invalid:first").focus();e.$eval(r.validateOnSubmit),e.$apply()})},this.$compile=e}return e.factory=function(t){return new e(t)},e}();t.ValidateOnSubmit=i});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/dialogs/dialogs.module",["require","exports","angular","./login-dialog.directive","./send-test-dialog.directive","./template-name-dialog.directive","./model-on-blur.directive","./login.controller","./validate-on-submit.directive"],function(e,t,n,i,r,o,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=__importDefault(n);var c=n.default.module("emailbuilder.dialogs",[]);t.module=c,c.directive("embLoginDialog",i.LoginDialog.factory),c.directive("embSendTestDialog",r.SendTestDialog.factory),c.directive("embTemplateNameDialog",["TemplateNameService","SaveService","$rootScope",o.TemplateNameDialog.factory]),c.directive("ngModelOnBlur",[a.ModelOnBlur.factory]),c.directive("validateOnSubmit",["$compile",l.ValidateOnSubmit.factory]),c.controller("LoginController",["LoginService","RetryRequestService","$scope","$rootScope","$timeout",s.LoginController])});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/dragging/disable-drag.directive",["require","exports","angular"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=__importDefault(n);var i=function(){function e(){this.link=function(e,t,i){var r=!!i.embDisableDrag;t.attr({unselectable:"on",draggable:"false"}).on("dragstart",function(e){if(r){return n.default.element(e.target).hasClass("ui-draggable")}return!1})}}return e.factory=function(){return new e},e}();t.DisableDrag=i}),define("modules/emailbuilder/helper/jquery-ui-fixes",["jqueryui"],function(e){function t(e,t){var n=t.currentContainer,i=1e4,r=null,o=t.positionAbs.top+t.offset.click.top;t.items.forEach(function(e){if(n.element.has(e[0]).length&&t.currentItem[0]!==e[0]){var a=e.item.offset().top,s=!1;Math.abs(a-o)>Math.abs(a+e.height-o)&&(s=!0,a+=e.height),Math.abs(a-o)<i&&(i=Math.abs(a-o),r=e,t.direction=s?"up":"down")}}),r?t._rearrange(e,r,null,!0):t._rearrange(e,null,t.currentContainer.element,!0),t._trigger("change",e,t._uiHash()),t.currentContainer._trigger("change",e,t._uiHash(t))}var n=e.ui.sortable.prototype,i=e.ui.draggable.prototype,r=i.plugins.stop.filter(function(e){return"connectToSortable"===e[0]})[0],o=i.plugins.drag.filter(function(e){return"connectToSortable"===e[0]})[0],a=i.plugins.start.filter(function(e){return"connectToSortable"===e[0]})[0],s=r[1],l=i._generatePosition,c=n._contactContainers,u=n._mouseDown,d=n._mouseStart;n._convertPositionTo;i._generatePosition=function(e){return this.offset.scroll=!1,l.call(this,e)},a[1]=function(t,n){var i=e(this).data("ui-draggable"),r=i.options,o=e.extend({},n,{item:i.element});i.sortables=[],i.currentSortable=!1;var a=Date.now();e(r.connectToSortable).filter(":visible").each(function(){var t=e.data(this,"ui-sortable");t&&(i.sortables.push({instance:t,shouldRevert:t.options.revert}),t.refreshVersion={current:a})}),i.sortables.forEach(function(e){e.instance.refreshVersion.completed!==a&&e.instance.refreshPositions(),e.instance._trigger("activate",t,o)}),i.sortables.forEach(function(e){delete e.instance.refreshVersion})},o[1]=function(t,n){var i,r,o=e(this),a=o.data("ui-draggable"),s=(t.pageY,t.pageX,!1),l=a.sortables.filter(function(e){var t,n=e.instance;return s||(t=n.element.scrollParent(),s={top:a.position.top+t.scrollTop(),left:a.position.left+t.scrollLeft()}),n.positionAbs=s,n.helperProportions=a.helperProportions,n.offset.click=a.offset.click,n._intersectsWith(n.containerCache)}).pop();l?l!==a.currentSortable&&(i=l.instance,r=a.currentSortable,a.currentSortable=l):(r=a.currentSortable,a.currentSortable=l),r&&(r.instance.cancelHelperRemoval=!0,r.instance.options.revert=!1,r.instance._trigger("out",t,r.instance._uiHash(r.instance)),r.instance._mouseStop(t,!0),r.instance.options.helper=r.instance.options._helper,r.instance.currentItem.remove(),r.instance.placeholder&&r.instance.placeholder.remove(),a._trigger("fromSortable",t),a.dropped=!1),i&&(i.currentItem=o.clone().removeAttr("id").appendTo(i.element).data("ui-sortable-item",!0),i.options._helper=i.options.helper,i.options.helper=function(){return n.helper[0]},t.target=i.currentItem[0],i._mouseCapture(t,!0),i._mouseStart(t,!0,!0),i.offset.click.top=a.offset.click.top,i.offset.click.left=a.offset.click.left,i.offset.parent.left-=a.offset.parent.left-i.offset.parent.left,i.offset.parent.top-=a.offset.parent.top-i.offset.parent.top,a._trigger("toSortable",t),a.dropped=i.element,a.currentItem=a.element,i.fromOutside=a,i._trigger("over",t,i._uiHash(i))),l&&l.instance&&l.instance.currentItem&&l.instance._mouseDrag(t)},r[1]=function(t,n){var i=e(this).data("ui-draggable").currentSortable;i&&(i.instance.isOver=1),s.call(this,t,n)},n._mouseStart=function(e,t,n){var i=this.currentItem.hide;this.currentItem.hide=function(){},d.call(this,e,t,n),this.currentItem.hide=i,this.currentContainer===this&&this._trigger("over",e,this._uiHash(this))},n._mouseMove=function(e){return this._mouseStarted?(this._mouseDrag(e),e.preventDefault()):(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,e),this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)),!this._mouseStarted)},e("html").is(".ie9")&&(n._mouseDown=function(e){return e.preventDefault=function(){},u.call(this,e)}),n._convertPositionTo=function(e,t){t||(t=this.position);var n="absolute"===e?1:-1;return{top:t.top+this.offset.relative.top*n+this.offset.parent.top*n- -this.scrollParent.scrollTop()*n,left:t.left+this.offset.relative.left*n+this.offset.parent.left*n- -this.scrollParent.scrollLeft()*n}},n._contactContainers=function(e){if("content"!==this.element.attr("type"))return c.call(this,e);var n,i=this,r=this.containers.filter(function(e){return i._intersectsWith(e.containerCache)})[0];r?r!==this.currentContainer&&(n=this.currentContainer,this.currentContainer=r,r._trigger("over",e,this._uiHash(this)),this.containers.length>1&&t(e,this)):(n=this.currentContainer,this.currentContainer=r||this),n&&n._trigger("out",e,this._uiHash(this))}});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/dragging/sortable.directive",["require","exports","angular","modules/emailbuilder/helper/jquery-ui-fixes"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=__importDefault(n);var i=50,r=10,o=function(){function e(e,t,o,a,s,l){var c=this;this.require="?^embDropzone",this.drag=function(e){c.$rootScope.$apply(function(){c.draggingService.move({mouseX:e.pageX,mouseY:e.pageY})})},this.eventOutsideWindow=function(e){return e.clientX<0||e.clientX>c.$window.innerWidth||e.clientY<0},this.publishItemMoved=function(e,t,n,i,r,o){var a=c.newPositionProviders[e](r,o);c.$rootScope.$broadcast(e+".moved",t,a,n,i)},this.newPositionProviders={section:function(e,t){var n=e.find(".emb-js-section-outer-wrapper"),i=n.siblings(".emb-insertion-bar");return n.add(i).not(t.find(".emb-js-section-outer-wrapper")).index(i)},content:function(e,t){var n=e.children().not(t),i=n.filter(".emb-insertion-bar,.emb-dz-container");return n.index(i)}},this.shouldIgnoreEvent=function(e,t,n){return e.is(".ui-draggable")||t||n&&!n.has(e).length},this.initialiseSorting=function(e,t){t.placeholder.height(0)},this.initializeDraggedItem=function(e,t,n){var i=e;return e.show(),"section"===n&&(i=e.find(".emb-js-section-outer-wrapper")),i.fadeTo(0,.5),e.scope()[t]},this.strengthenDraggedItem=function(e,t){var n=e;"section"===t&&(n=e.find(".emb-js-section-outer-wrapper")),n.fadeTo(0,1)},this.link=function(e,t,o,a){e.model=o.model,e.type=o.type;var s=function(n,i){if(c.shouldIgnoreEvent(i.item,i.sender))return void i.item.remove();$(t).data("ui-sortable")._noFinalSort=!0,e.$apply(function(){var r=t.children(":not(.emb-insertion-bar,.emb-dz-container)");e.oldPos=r.index(i.item);var o=c.initializeDraggedItem(i.item,e.model,e.type);e.draggedItem=o,c.initialiseSorting(n,i),c.draggingService.start({type:e.type,contentType:o.type,mouseX:n.pageX,mouseY:n.pageY}),c.$rootScope.$emit("content:deactivate")})},l=function(n,i){var r=i.item.closest(".emb-js-section-outer-wrapper").scope();if(r){if(c.lockLevelService.getLocks(r.section.permissions).dragAndDropLocked)return}var o=c.eventOutsideWindow(n),s=o||c.shouldIgnoreEvent(i.item,i.sender,t),l=c.newPositionProviders[e.type](t,i.item),u=l<0;if(!s&&l!==e.oldPos&&!u){var d=a&&a.getLocation();c.publishItemMoved(e.type,e.oldPos,d,null,t,i.item)}},u=function(t,n){c.shouldIgnoreEvent(n.item,n.sender)||e.$apply(function(){c.emailService.insertBefore=null,e.draggedItem=null,c.strengthenDraggedItem(n.item,e.type),c.draggingService.stop(),l(t,n)})};if(t.sortable({handle:o.handle,delay:i,distance:r,cursor:"move",tolerance:"pointer",cancel:"textarea,button,select,option",connectWith:o.connectWith||!1,over:c.initialiseSorting,start:s,sort:c.drag,stop:u,helper:function(){return n.default.element("<span />").hide()[0]},receive:function(n,i){if(!c.lockLevelService.getLocks(e.section.permissions).dragAndDropLocked)if(c.shouldIgnoreEvent(i.item))"content"===e.type&&c.emailService.setContentTarget(a.getLocation());else{var r=i.sender.controller("embDropzone"),o=i.item.scope();c.publishItemMoved(e.type,o.oldPos,r.getLocation(),a.getLocation(),t,i.item)}}}),"content"===e.type){var d=!0,h=!0;if(t.hasClass("emb-js-content-container")){var p=function(){h=!1,t.sortable("option","handle","doesnotexist"),t.toggleClass("emb-active-sortable",!1)},f=function(){h=!0,n.default.element(t).off("dragstart"),t.sortable("option","handle",o.handle),d&&t.toggleClass("emb-active-sortable",!0)},m=function(e){c.lockLevelService.getLocks(e).dragAndDropLocked?p():f()};m(e.section.permissions),e.$on("permissionsChanged:section-"+e.section.uiId,function(e,t){m(t)})}e.$watch(function(){return c.emailService.sortability.content},function(e){e?(d=!0,t.data("ui-sortable")&&t.sortable("enable"),h&&t.toggleClass("emb-active-sortable",!0)):(d=!1,t.data("ui-sortable")&&t.sortable("disable"),t.toggleClass("emb-active-sortable",!1))});var g=c.dropzoneDimensionsService;t.sortable("option","custom",{refreshContainers:function(){this.containers=this.containers.filter(function(e){var t=e.containerCache,i=e.element,r=i.controller("embDropzone"),o=r?r.getLocation():{},a=i.closest(".hmb-js-section-wrapper");if(e.refreshVersion&&(e.refreshVersion.completed=e.refreshVersion.current),!a.length||!a.parents("html").length)return!1;var s=g.getDimensions(i,a,o);return n.default.extend(t,s),!0})}})}},this.$rootScope=e,this.emailService=t,this.draggingService=o,this.dropzoneDimensionsService=a,this.$window=s,this.lockLevelService=l}return e.factory=function(t,n,i,r,o,a){return new e(t,n,i,r,o,a)},e}();t.Sortable=o}),function(e,t){"object"==typeof module&&module.exports?module.exports=function(e){return e=e||require("underscore"),t(e)}:"function"==typeof define&&define.amd?define("postal",["underscore"],function(n){return t(n,e)}):e.postal=t(e._,e)}(this,function(e,t,n){var i,r=function(){var t;return function(n){var i=!1;return e.isString(n)?(i=n===t,t=n):(i=e.isEqual(n,t),t=e.clone(n)),!i}},o=function(){var t=[];return function(n){var i=!e.any(t,function(t){return e.isObject(n)||e.isArray(n)?e.isEqual(n,t):n===t});return i&&t.push(n),i}},a=function(e){this.channel=e||i.configuration.DEFAULT_CHANNEL};a.prototype.subscribe=function(){return 1===arguments.length?new s(this.channel,arguments[0].topic,arguments[0].callback):new s(this.channel,arguments[0],arguments[1])},a.prototype.publish=function(){var e=1===arguments.length?"[object String]"===Object.prototype.toString.call(arguments[0])?{topic:arguments[0]}:arguments[0]:{topic:arguments[0],data:arguments[1]};return e.channel=this.channel,i.configuration.bus.publish(e)};var s=function(e,t,n){if(3!==arguments.length)throw new Error("You must provide a channel, topic and callback when creating a SubscriptionDefinition instance.");if(0===t.length)throw new Error("Topics cannot be empty");this.channel=e,this.topic=t,this.callback=n,this.constraints=[],this.context=null,i.configuration.bus.publish({channel:i.configuration.SYSTEM_CHANNEL,topic:"subscription.created",data:{event:"subscription.created",channel:e,topic:t}}),i.configuration.bus.subscribe(this)};s.prototype={unsubscribe:function(){this.inactive||(this.inactive=!0,i.configuration.bus.unsubscribe(this),i.configuration.bus.publish({channel:i.configuration.SYSTEM_CHANNEL,topic:"subscription.removed",data:{event:"subscription.removed",channel:this.channel,topic:this.topic}}))},defer:function(){var e=this,t=this.callback;return this.callback=function(n,i){setTimeout(function(){t.call(e.context,n,i)},0)},this},disposeAfter:function(t){if(e.isNaN(t)||t<=0)throw"The value provided to disposeAfter (maxCalls) must be a number greater than zero.";var n=this,i=this.callback,r=e.after(t,e.bind(function(){this.unsubscribe()},this));return this.callback=function(){i.apply(n.context,arguments),r()},this},distinctUntilChanged:function(){return this.withConstraint(new r),this},distinct:function(){return this.withConstraint(new o),this},once:function(){return this.disposeAfter(1),this},withConstraint:function(t){if(!e.isFunction(t))throw"Predicate constraint must be a function";return this.constraints.push(t),this},withConstraints:function(t){var n=this;return e.isArray(t)&&e.each(t,function(e){n.withConstraint(e)}),n},withContext:function(e){return this.context=e,this},withDebounce:function(t,n){if(e.isNaN(t))throw"Milliseconds must be a number";var i=this.callback;return this.callback=e.debounce(i,t,!!n),this},withDelay:function(t){if(e.isNaN(t))throw"Milliseconds must be a number";var n=this,i=this.callback;return this.callback=function(e,r){setTimeout(function(){i.call(n.context,e,r)},t)},this},withThrottle:function(t){if(e.isNaN(t))throw"Milliseconds must be a number";var n=this.callback;return this.callback=e.throttle(n,t),this},subscribe:function(e){return this.callback=e,this}};var l={cache:{},regex:{},compare:function(t,n){var i,r,o,a=this.cache[n]&&this.cache[n][t];return void 0!==a?a:((r=this.regex[t])||(i="^"+e.map(t.split("."),function(e){var t="";return o&&(t="#"!==o?"\\.\\b":"\\b"),t+="#"===e?"[\\s\\S]*":"*"===e?"[^.]+":e,o=e,t}).join("")+"$",r=this.regex[t]=new RegExp(i)),this.cache[n]=this.cache[n]||{},this.cache[n][t]=a=r.test(n),a)},reset:function(){this.cache={},this.regex={}}},c=function(t,n){!t.inactive&&i.configuration.resolver.compare(t.topic,n.topic)&&e.all(t.constraints,function(e){return e.call(t.context,n.data,n)})&&"function"==typeof t.callback&&t.callback.call(t.context,n.data,n)},u=0,d=[],h=function(){for(;d.length;)p.unsubscribe(d.shift())},p={addWireTap:function(e){var t=this;return t.wireTaps.push(e),function(){var n=t.wireTaps.indexOf(e);-1!==n&&t.wireTaps.splice(n,1)}},publish:function(t){return++u,t.timeStamp=new Date,e.each(this.wireTaps,function(e){e(t.data,t)}),this.subscriptions[t.channel]&&e.each(this.subscriptions[t.channel],function(e){for(var n,i=0,r=e.length;i<r;)(n=e[i++])&&c(n,t)}),0==--u&&h(),t},reset:function(){this.subscriptions&&(e.each(this.subscriptions,function(t){e.each(t,function(e){for(;e.length;)e.pop().unsubscribe()})}),this.subscriptions={})},subscribe:function(e){var t,n=this.subscriptions[e.channel];return n||(n=this.subscriptions[e.channel]={}),t=this.subscriptions[e.channel][e.topic],t||(t=this.subscriptions[e.channel][e.topic]=[]),t.push(e),e},subscriptions:{},wireTaps:[],unsubscribe:function(e){if(u)return void d.push(e);if(this.subscriptions[e.channel][e.topic])for(var t=this.subscriptions[e.channel][e.topic].length,n=0;n<t;){if(this.subscriptions[e.channel][e.topic][n]===e){this.subscriptions[e.channel][e.topic].splice(n,1);break}n+=1}}};if(i={configuration:{bus:p,resolver:l,DEFAULT_CHANNEL:"/",SYSTEM_CHANNEL:"postal"},ChannelDefinition:a,SubscriptionDefinition:s,channel:function(e){return new a(e)},subscribe:function(e){return new s(e.channel||i.configuration.DEFAULT_CHANNEL,e.topic,e.callback)},publish:function(e){return e.channel=e.channel||i.configuration.DEFAULT_CHANNEL,i.configuration.bus.publish(e)},addWireTap:function(e){return this.configuration.bus.addWireTap(e)},linkChannels:function(t,n){var r=[];return t=e.isArray(t)?t:[t],n=e.isArray(n)?n:[n],e.each(t,function(t){var o=t.topic||"#";e.each(n,function(n){var a=n.channel||i.configuration.DEFAULT_CHANNEL;r.push(i.subscribe({channel:t.channel||i.configuration.DEFAULT_CHANNEL,topic:o,callback:function(t,r){var o=e.clone(r);o.topic=e.isFunction(n.topic)?n.topic(r.topic):n.topic||r.topic,o.channel=a,o.data=t,i.publish(o)}}))})}),r},utils:{getSubscribersFor:function(){var e=arguments[0],t=arguments[1];return 1===arguments.length&&(e=arguments[0].channel||i.configuration.DEFAULT_CHANNEL,t=arguments[0].topic),i.configuration.bus.subscriptions[e]&&Object.prototype.hasOwnProperty.call(i.configuration.bus.subscriptions[e],t)?i.configuration.bus.subscriptions[e][t]:[]},reset:function(){i.configuration.bus.reset(),i.configuration.resolver.reset()}}},p.subscriptions[i.configuration.SYSTEM_CHANNEL]={},t&&Object.prototype.hasOwnProperty.call(t,"__postalReady__")&&e.isArray(t.__postalReady__))for(;t.__postalReady__.length;)t.__postalReady__.shift().onReady(i);return i});var __assign=this&&this.__assign||function(){return __assign=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},__assign.apply(this,arguments)},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/dragging/dragging.service",["require","exports","postal"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=__importDefault(n);var i=function(){function e(){this.dragging=!1,this.captured=!1,this.contentType="",this.type="",this.mouseX=0,this.mouseY=0}return e}();t.DraggingState=i;var r=function(){function e(){var e=this;this.start=function(t){e.state.dragging||(e.setState(__assign(__assign({},t),{dragging:!0})),e.chan.publish(t.type+".start",e.state))},this.capture=function(){e.state.dragging&&!e.state.captured&&"file"===e.state.contentType&&(e.setState({captured:!0}),e.chan.publish(e.state.type+".captured",e.state))},this.release=function(){e.state.dragging&&!e.state.captured&&"file"===e.state.contentType&&(e.setState({captured:!1}),e.chan.publish(e.state.type+".released",e.state))},this.move=function(t){e.state.dragging&&(e.setState(t),e.chan.publish(e.state.type+".move",e.state))},this.stop=function(){if(e.state.dragging){var t=e.state.captured;e.setState({dragging:!1,captured:!1}),e.chan.publish(e.state.type+".stop",e.state),t&&e.chan.publish(e.state.type+".released",e.state)}},this.setState=function(t){e.state=__assign(__assign({},e.state),t)},this.subscribe=function(t,n){return e.chan.subscribe(t,n)},this.chan=n.default.channel("embDragging"),this.state=new i}return e}();t.DraggingService=r}),define("vendor/text!ts/modules/emailbuilder/dragging/drag-helper.directive.html",[],function(){return'<button class="emb-{{contentType}} emb-{{type}}-dragger emb-js-{{type}}-dragger" ng-show="dragging" ng-style="position()"></button>'});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/dragging/drag-helper.directive",["require","exports","vendor/text!ts/modules/emailbuilder/dragging/drag-helper.directive.html","angular"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=__importDefault(i);var r=function(){function e(e){var t=this;this.restrict="A",this.template=n,this.scope={},this.link=function(e){var n={content:{top:47,left:47},section:{top:46,left:71}};e.position=function(){var t=n[e.type||"content"];return{left:e.mouseX-t.left,top:e.mouseY-t.top}},t.draggingService.subscribe("#",function(t){"file"!==t.contentType&&i.default.extend(e,t)})},this.draggingService=e}return e.factory=function(t){return new e(t)},e}();t.DragHelper=r}),define("ts/modules/emailbuilder/dragging/drop.directive",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){var n=this;this.link=function(e,t,i){var r=n.$parse(i.csDrop);t.on("drop",function(t){var i=t.originalEvent,o=i.dataTransfer.files;n.$timeout(function(){r(e,{event:t,files:o})}),t.preventDefault()})},this.$parse=e,this.$timeout=t}return e.factory=function(t,n){return new e(t,n)},e}();t.Drop=n}),define("ts/modules/emailbuilder/dragging/drag-over.directive",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){var n=this;this.link=function(e,t,i){var r=n.$parse(i.csDragover);t.on("dragover",function(t){var i=t.originalEvent;i.dataTransfer&&(i.dataTransfer.dropEffect="copy"),t.stopPropagation(),n.$timeout(function(){r(e,{event:t})}),t.preventDefault()})},this.$parse=e,this.$timeout=t}return e.factory=function(t,n){return new e(t,n)},e}();t.DragOver=n}),define("ts/modules/emailbuilder/dragging/drag-leave.directive",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){var n=this;this.link=function(e,t,i){var r=n.$parse(i.csDragleave);t.on("dragleave",function(t){n.$timeout(function(){r(e,{event:t})}),t.preventDefault()})},this.$parse=e,this.$timeout=t}return e.factory=function(t,n){return new e(t,n)},e}();t.DragLeave=n}),define("ts/modules/emailbuilder/dragging/drag-enter.directive",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){var n=this;this.link=function(e,t,i){var r=n.$parse(i.csDragenter);t.on("dragenter",function(t){n.$timeout(function(){r(e,{event:t})}),t.preventDefault()})},this.$parse=e,this.$timeout=t}return e.factory=function(t,n){return new e(t,n)},e}();t.DragEnter=n});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/dragging/image-drop-container.directive",["require","exports","angular"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=__importDefault(n);var i=function(){function e(e,t,i,r){var o=this;this.terminal=!0,this.priority=1e3,this.compile=function(e,t){return e.attr({"cs-dragover":"dragOver(event)","cs-dragleave":"dragLeave()"}),e.removeAttr("emb-image-drop-container"),o.link},this.link=function(e,t,i){var r=i.embImageDropContainer,a=!!r,s=!!i.replace;e.allowReplace=s,e.dragOver=function(t){e.allowReplace&&o.draggingService.capture(),e.hovered=!0,o.imageFileDraggingService.setLocationProvider(function(){return a&&e.allowReplace?{block:o.$parse(r)(e),location:null}:{block:null,location:n.default.element(t.target).controller("embDropzone").getLocation()}})},e.dragLeave=function(){e.allowReplace&&o.draggingService.release(),e.hovered=!1,o.imageFileDraggingService.setLocationProvider()},o.$compile(t)(e)},this.$parse=e,this.$compile=t,this.imageFileDraggingService=i,this.draggingService=r}return e.factory=function(t,n,i,r){return new e(t,n,i,r)},e}();t.ImageDropContainer=i}),define("ts/modules/emailbuilder/dragging/image-file-dragging.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n,i){var r=this;this.setLocationProvider=function(e){void 0===e&&(e=null),r.locationProvider=e},this.handleDrop=function(e){var t=r.locationProvider;if(r.setLocationProvider(null),e&&!(e.length<=0)){var n,i=null,o=t?t():null;o&&(i=o.block);var a=e[0];if(r.imageValidationService.validate({file:a}).length>0)return void(i&&r.$rootScope.$emit("content:activate",{block:i}));i?(n=function(){return i},r.$rootScope.$emit("content:activate",{block:i})):(o&&r.emailService.setContentTarget(o.location),i=r.emailService.addContent("image"),n=function(e){return function(t){return t||r.$rootScope.$emit("content:activate",{block:e}),e}}(i)),r.imageManagerService.uploadAsync({file:a,block:n})}},this.emailService=e,this.imageValidationService=t,this.imageManagerService=n,this.$rootScope=i,this.locationProvider=null}return e}();t.ImageFileDraggingService=n});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/dragging/dragging.module",["require","exports","angular","./disable-drag.directive","./sortable.directive","./dragging.service","./drag-helper.directive","./drop.directive","./drag-over.directive","./drag-leave.directive","./drag-enter.directive","./image-drop-container.directive","./image-file-dragging.service"],function(e,t,n,i,r,o,a,s,l,c,u,d,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=__importDefault(n);var p=n.default.module("emailbuilder.dragging",[]);t.module=p,p.directive("embDisableDrag",i.DisableDrag.factory),p.directive("embSortable",["$rootScope","EmailService","DraggingService","DropzoneDimensionsService","$window","LockLevelService",r.Sortable.factory]),p.directive("embDragHelper",["DraggingService",a.DragHelper.factory]),p.directive("csDrop",["$parse","$timeout",s.Drop.factory]),p.directive("csDragover",["$parse","$timeout",l.DragOver.factory]),p.directive("csDragleave",["$parse","$timeout",c.DragLeave.factory]),p.directive("csDragenter",["$parse","$timeout",u.DragEnter.factory]),p.directive("embImageDropContainer",["$parse","$compile","ImageFileDraggingService","DraggingService",d.ImageDropContainer.factory]),p.service("DraggingService",o.DraggingService),p.service("ImageFileDraggingService",["EmailService","ImageValidationService","ImageManagerService","$rootScope",h.ImageFileDraggingService])}),define("vendor/text!ts/modules/emailbuilder/header/header.directive.html",[],function(){
return'<header id="emb-js-editor-header" class="c-header emb-reset emb-editor-header">\n    <div class="l-anchor-left" ng-cloak>\n        <a flag="prev" class="c-button c-button--return" ng-href="{{navPrevHref}}" ng-click="prevClick($event)" ng-class="{\'select-choose-template\': embState == \'editor\', \'select-continue-editing\': embState == \'preview\'}">\n            <span class="c-button__text">{{navPrev}}</span>\n        </a>\n    </div>\n\n    <div class="status-display" ng-if="canvasPredefinedSections">\n        Editing a template \x3c!-- TODO: add logic for Creating a template also --\x3e\n    </div>\n\n    <div aria-live="polite" class="c-label-container c-app-progress c-template-mode" ng-show="isTemplateWithContent">\n        <div class="c-label">\n            Editing {{templateName ? "the \\"" + templateName + "\\"": "a"}} template\n        </div>\n    </div>\n\n    <div aria-live="polite" ng-show="showAutoSaving && (embState === \'editor\' || embState === \'firstrun\')">\n        <span class="c-app-progress__status" ng-show="progress == \'saving\'">Saving</span>\n\n        <img class="c-app-progress__status-container" ng-src="{{imageDomain}}/img/emailbuilder/@2x/auto_saving.gif" ng-if="progress == \'saving\'" alt="" role="presentation" />\n\n        <span class="c-app-progress__status hmb-status" ng-show="progress == \'idle\'">Saved</span>\n\n        <span class="c-app-progress__status hmb-status" ng-show="progress == \'failed\'">Save Failed</span>\n        <img class="c-app-progress__status-container" ng-src="{{imageDomain}}/img/emailbuilder/@2x/auto_waiting.gif" ng-if="progress == \'idle\'" alt="" role="presentation" />\n    </div>\n\n    \x3c!-- failure state for save draft button --\x3e\n    <div ng-show="showSaveDraftButton && embState == \'editor\'">\n        <span class="c-app-progress__status hmb-status" ng-show="progress == \'failed\'">Save failed, please retry</span>\n    </div>\n\n    <div class="c-app-progress" ng-show="embState == \'preview\'">\n        <span class="c-app-progress__status hmb-status" ng-class="{\'c-template-mode\': isTemplateWithContent}" ng-show="previewProgress == \'generating\'">\n            Getting latest version\n        </span>\n        <img class="c-app-progress__status-container hmb-progress-container" ng-class="{\'c-template-mode\': isTemplateWithContent}" ng-src="{{imageDomain}}/img/emailbuilder/@2x/auto_generating.gif" ng-if="previewProgress == \'generating\'"/>\n    </div>\n\n    <div class="l-anchor-right" ng-cloak>\n        <cm-notify ng-if="newFeatureNotificationEnabled" ng-cloak></cm-notify>\n        <button class="c-button c-button--header" ng-show="supportTestEmail" ng-if="!showSaveDraftButton || embState == \'preview\'" ng-click="showTestModal($event); $event.stopPropagation();">\n            <span class="c-button__text">Send a test email</span>\n        </button>\n        <emb-save-draft-button ng-if="showSaveDraftButton && embState == \'editor\'" progress="progress"></emb-save-draft-button>\n        <a id="header-next-button" flag="next" class="c-button c-button--primary" ng-href="{{navNextHref}}"\n           ng-click="(isTemplateWithContent) ? (showSaveTemplateAs ? trySaveTemplate($event) : nextClickTemplate($event)) : nextClickEmail($event)"\n           ng-class="{\'emb-active\': showSaveTemplateAs || showSignupForm || showTestEmailForm, \'c-button--forward\': embState == \'preview\', \'c-button--preview\': embState == \'editor\' || embState == \'firstrun\', \'select-define-recipients\': embState == \'preview\', \'select-preview\': embState == \'editor\'}">\n            <span class="c-button__text">{{navNext}}</span>\n        </a>\n        <div class="c-validation-message c-validation-message--preheader qa-preheader-validation-message" ng-show="showPreheaderNotification">\n            <div class="arrow-top" aria-hidden="true"></div>\n            <div class="c-validation-message__content">\n                <h2 class="c-validation-message__heading">It looks like you\'re missing something...</h2>\n                <div class="c-validation-message__description">\n                    <p><a href="/help-doc/campus-email-builder-preheader-text" target="_blank" rel="noopener" title="Preheader text">Preheader text</a> lets you highlight the best bits of your email in your recipient\'s inbox preview. <span ng-show="isTemplateWithContent">Preheader text in locked headers will not be editable in a campaign.</span></p>\n                    <button class="c-button c-button--primary c-button--large" ng-click="focusPreheader();">Add preheader text</button>\n                    <button class="c-button c-button--link-grey c-validation-message__button qa-preheader-validation-button-proceed" ng-click="proceedToPreview();">Continue to preview</button>\n                    <div class="l-offset--top-medium">\n                        <input type="checkbox" class="checkbox-options__input emb-checkbox" ng-model="neverShowPreheaderValidation" id="never-show" /><label class="checkbox-options__label c-validation-message__label qa-preheader-validation-label-dontshowagain" for="never-show">Don\'t show this again</label>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class="modal__overlay" ng-show="showPreheaderNotification"></div>\n    </div>\n    <emb-preview-notification-bar emb-State="embState"></emb-preview-notification-bar>\n</header>'});var __assign=this&&this.__assign||function(){return __assign=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},__assign.apply(this,arguments)};define("ts/modules/emailbuilder/services/analytics.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e.AddedContent="Added Content In Builder",e.DeletedSection="Deleted Section",e.EditedContent="Edited Email Content",e.EditedImage="Edited Image",e.LockedSection="Locked Section",e.PreheaderPrompt="Responded To Preheader Prompt",e.Previewed="Previewed Email",e.Redid="Redid Email Change In Drag And Drop Builder",e.Undid="Undid Email Change In Drag And Drop Builder",e.UpdatedFooter="Updated Footer Settings",e.UpdatedLanguage="Updated Email Language",e.UpdatedPreheader="Updated Preheader Text",e.UsedSetting="Used Setting In Drag And Drop Builder"}(n||(n={})),t.AnalyticsEventName=n;var i=function(){function e(e,t,n){var i=this;this.dragAndDropPropertyValue="Drag And Drop",this.analyticsLockType={LockEverything:"Lock Everything",UnlockEverything:"Unlock Everything",ContentNotDeleteLocked:"Content Not Delete Locked",ContentAndDeleteLocked:"Content And Delete Locked"},this.enrichPublicProperties=function(e,t){var n;void 0===e&&(e={}),void 0===t&&(t="Builder");var r=i.emailBuilderConfig.mode,o="Campaigns";return r.isTransactional&&(o="Transactional"),r.autoresponder&&(o="Journeys"),r.templateWithContent&&(o="My Templates"),__assign(__assign({},e),(n={Context:o,"AB Test":r.isAbTest},n[t]=i.dragAndDropPropertyValue,n))},this.enrichEncodedProperties=function(e){var t;void 0===e&&(e={});var n=i.emailBuilderConfig,r=n.mode;if(!i.analyticsValidationService.eventShouldHaveIdPropertyKey)return __assign({},e);var o="Campaign Id",a=n.enEntityId;return r.autoresponder&&(o="Journey Id"),r.templateWithContent&&(o="Template Id",a=n.template.encodedTemplateId),__assign(__assign({},e),(t={},t[o]=a,t))},this.trackClientLevel=function(e){i.emailBuilderConfig.mode.publicCanvas||i.$http.post("/diagnostics/analytics/track/?eventName="+encodeURIComponent(e.eventName),JSON.stringify({publicProperties:JSON.stringify(i.enrichPublicProperties(e.publicProperties,e.dragAndDropPropertyKey)),encodedProperties:JSON.stringify(i.enrichEncodedProperties(e.encodedProperties)),trackingLevel:"Client"}))},this.getLockTypeUsedByAnalytics=function(e){switch(e){case"full":return i.analyticsLockType.LockEverything;case"none":return i.analyticsLockType.UnlockEverything;case"partial":return i.analyticsLockType.ContentAndDeleteLocked;case"partial-removable":return i.analyticsLockType.ContentNotDeleteLocked}},this.$http=e,this.emailBuilderConfig=t,this.analyticsValidationService=n}return e}();t.AnalyticsService=i});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/header/header.directive",["require","exports","vendor/text!ts/modules/emailbuilder/header/header.directive.html","angular","../services/analytics.service"],function(e,t,n,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=__importDefault(i);var o=function(){function e(e,t,o,a,s,l,c,u,d,h,p,f,m){var g=this;this.scope={embState:"=",showSaveTemplateAs:"=",showSignupForm:"=",showTestEmailForm:"=",showMissingBackgroundModal:"=",showPermissionValidationModal:"=",showFooterValidationModal:"="},this.restrict="E",this.template=n,this.link=function(e,t,n){var o=!1;e.progress="idle",e.previewProgress="idle",e.sidebarEditorOpen=!1,e.imageDomain=g.emailBuilderConfig.urls.staticResourceBase,e.templateName=g.emailBuilderConfig.template.savedName,e.newFeatureNotificationEnabled=g.emailBuilderConfig.newFeatureNotificationEnabled,e.isTemplateWithContent=g.emailBuilderConfig.mode.templateWithContent,e.supportTestEmail=g.emailBuilderConfig.supportTestEmail,e.isTemplateChanged=0,e.showPreheaderNotification=!1,e.canvasPredefinedSections=g.emailBuilderConfig.canvasPredefinedSections,e.neverShowPreheaderValidation=!1,e.showSaveDraftButton=g.explicitSaveEnabled&&!e.isTemplateWithContent,e.showAutoSaving=!g.explicitSaveEnabled&&!e.isTemplateWithContent;var a=function(e){27===e.which&&(g.$location.path("#/editor"),i.default.element("body").off("keydown",a))},s=function(t){var n=document.getElementById("header-next-button").contains(t.target),r=document.getElementById("emb-name-template").contains(t.target);n||r||(e.showSaveTemplateAs=!1,i.default.element("body").off("mousedown",s),g.$rootScope.$emit("template:closeDialog"))};e.prevClick=function(t){e.sidebarEditorOpen&&"editor"===e.embState&&(t.preventDefault(),g.$rootScope.$emit("content:deactivate"))},e.trySaveTemplate=function(e){e.preventDefault(),g.$rootScope.$emit("template:trySave")};var l=function(){e.neverShowPreheaderValidation&&g.$http.get(g.emailBuilderConfig.urls.onboardPreheaderValidationUrl)},c=function(e){g.analyticsService.trackClientLevel({eventName:r.AnalyticsEventName.PreheaderPrompt,publicProperties:{"Selected Option":e}})};e.focusPreheader=function(){c("Add Preheader Text"),l(),e.showPreheaderNotification=!1,g.$timeout(function(){g.$rootScope.$emit("content:activate",{block:{type:"header",editableTextKey:"preheader",displayType:"image"}});var e=$(".c-sidebar__settings"),t=e.scrollTop(),n=$("#inbox-preview-settings").position().top;e.animate({scrollTop:t+n},300),$(".c-sidebar__form-textarea").focus()},400)},e.proceedToPreview=function(){c("Continue To Preview"),l(),g.$window.location.href="#/preview",e.showPreheaderNotification=!1};var u=function(){g.screenshotService.enqueueCampaignScreenshots()},d=function(t){var n=g.modelValidationService.isValidModel(g.emailService.model.sections,g.emailBuilderConfig.mode.templateWithContent);if(n.missingTypes.length>0)return e.showPermissionValidationModal=!0,g.$rootScope.permissionValidationResult=n,void t.preventDefault();if(g.emailBuilderConfig.mode.templateWithContent){var r=g.modelValidationService.isValidFooter(g.emailService.model);if(r.missingTypes.length>0)return e.showFooterValidationModal=!0,g.$rootScope.footerValidationResult=r,void t.preventDefault()}var o=g.emailService.isThereAMissingBackground();if(o)return g.$rootScope.closeMissingBackgroundModal=function(){i.default.element("#"+o.uiId).click(),e.showMissingBackgroundModal=!1},e.showMissingBackgroundModal=!0,void t.preventDefault();if(function(){if(g.emailBuilderConfig.skipPreheaderValidation)return!1;if(!g.emailBuilderConfig.canvasInboxPreviewValidation)return!1;if(e.showPreheaderNotification)return!1;if(e.neverShowPreheaderValidation)return!1;if(""!==g.emailService.model.previewText.contents)return!1;var t=g.lockLevelService.getLocks(g.emailService.model.header.permissions);return e.isTemplateWithContent?!t.canEditContentItems&&!!g.emailService.model.previewText.showInPreheader:!!t.canEditContentItems}())return e.showPreheaderNotification=!0,void t.preventDefault();e.showPreheaderNotification=!1};e.nextClickEmail=function(t){var n=g.emailBuilderConfig.mode;"preview"!==e.embState||n.publicCanvas||u(),"preview"===e.embState&&n.publicCanvas&&(t.preventDefault(),e.showSignupForm=!e.showSignupForm,e.showSignupForm&&(g.saveService.logFinishAndSave(),g.screenshotService.enqueueTemplateScreenshots())),"editor"!==e.embState&&"firstrun"!==e.embState||(d(t),i.default.element("body").on("keydown",a),g.saveService.saveCampaign(),n.templateWithContent||g.analyticsService.trackClientLevel({eventName:r.AnalyticsEventName.Previewed,dragAndDropPropertyKey:"Previewed Email Type",publicProperties:{"From Error":!1}}))},e.nextClickTemplate=function(t){"preview"===e.embState&&(g.emailBuilderConfig.mode.newTemplate?g.emailBuilderConfig.mode.newTemplate&&!e.showSaveTemplateAs&&(t.preventDefault(),e.isTemplateWithContent&&i.default.element("body").on("mousedown",s),e.showSaveTemplateAs=!0):(t.preventDefault(),g.saveService.saveTemplate())),e.showSaveTemplateAs&&!t.isDefaultPrevented()&&(e.showSaveTemplateAs=!1,t.preventDefault()),"preview"!==e.embState&&i.default.element("body").on("keydown",a),"editor"===e.embState&&(d(t),i.default.element("body").on("keydown",a))},e.showTestModal=function(t){t.preventDefault(),e.showTestEmailForm=!e.showTestEmailForm},g.saveService.subscribe("saving",function(){g.emailBuilderConfig.explicitSaveEnabled&&(e.progress=""),t.addClass("qa-status-saving")}),g.saveService.subscribe("saved",function(){e.progress="saving",t.removeClass("qa-status-saving"),e.isTemplateWithContent?++e.isTemplateChanged>1&&(e.progress="saving",g.saveService.isDirty=!0):g.$timeout(function(){e.progress="idle"},3e3)}),g.saveService.subscribe("failed",function(){e.progress="failed"}),g.saveService.subscribe("generated",function(){e.previewProgress="generating",g.$timeout(function(){e.previewProgress="idle"},3e3)}),e.$on("$routeChangeSuccess",function(t,n){o&&(e.embState=g.$route.current.action),e.showSaveTemplateAs=!1,e.showSignupForm=!!g.$route.current.showSignupForm,e.showTestEmailForm=!!g.$route.current.showTestEmailForm}),g.$rootScope.$$postDigest(function(){g.$rootScope.$$postDigest(function(){o=!0,e.embState=g.$route.current.action,e.$digest()})}),g.$rootScope.$on("content:activated",function(t,n){"image"!==n.block.type&&"button"!==n.block.type&&"survey"!==n.block.type||"editor"!==e.embState||(e.sidebarEditorOpen=!0,e.navPrev="Return",e.navPrevHref="#/editor")}),g.$rootScope.$on("content:deactivated",function(){"editor"===e.embState&&(e.sidebarEditorOpen=!1,e.navPrev=g.emailBuilderConfig.previousStep,e.navPrevHref=g.emailBuilderConfig.urls.stepBack)}),e.$watch("embState",function(t){switch(t){case"preview":e.navPrev="Return",e.navPrevHref="#/editor",e.navNext=g.emailBuilderConfig.nextStep,e.navNextHref=g.emailBuilderConfig.urls.stepForward;break;default:e.navPrev=g.emailBuilderConfig.previousStep,e.navPrevHref=g.emailBuilderConfig.urls.stepBack,e.navNext=g.emailBuilderConfig.previewText,e.navNextHref="#/preview",e.$broadcast("hidePreviewNotificationBar")}})},this.$rootScope=e,this.$timeout=t,this.$route=o,this.$location=a,this.saveService=s,this.screenshotService=l,this.emailService=c,this.modelValidationService=u,this.$window=d,this.lockLevelService=h,this.$http=p,this.emailBuilderConfig=f,this.analyticsService=m,this.explicitSaveEnabled=f.explicitSaveEnabled}return e.factory=function(t,n,i,r,o,a,s,l,c,u,d,h,p){return new e(t,n,i,r,o,a,s,l,c,u,d,h,p)},e}();t.Header=o}),define("vendor/text!ts/modules/emailbuilder/header/save-draft-button.directive.html",[],function(){return'<button class="c-button c-button--secondary" ng-class="{\'is-disabled\':disabled}" ng-click="saveDraft()" >\r\n    <span class="c-button__text">{{label}}</span>\r\n</button>'}),define("ts/modules/emailbuilder/header/save-draft-button.directive",["require","exports","vendor/text!ts/modules/emailbuilder/header/save-draft-button.directive.html"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){var i=this;this.idleLabel="Save draft",this.scope={},this.restrict="E",this.template=n,this.link=function(e,t,n){e.label=i.idleLabel,i.saveService.subscribe("saving",function(){e.disabled=!0,e.label="Saving..."}),e.saveDraft=function(){i.saveService.forceSaveCampaign()},i.saveService.subscribe("saved",function(){e.label="Saved",i.$timeout(function(){e.disabled=!1,e.label=i.idleLabel},2e3)}),i.saveService.subscribe("failed",function(){e.label="Retry",e.disabled=!1})},this.saveService=e,this.$timeout=t}return e.factory=function(t,n){return new e(t,n)},e}();t.SaveDraftButton=i});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/header/header.module",["require","exports","angular","./header.directive","./save-draft-button.directive"],function(e,t,n,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=__importDefault(n);var o=n.default.module("emailbuilder.header",[]);t.module=o,o.directive("embHeaderIsolate",["$rootScope","$timeout","$route","$location","SaveService","ScreenshotService","EmailService","ModelValidationService","$window","LockLevelService","$http","EmailBuilderConfig","AnalyticsService",i.Header.factory]),o.directive("embSaveDraftButton",["SaveService","$timeout",r.SaveDraftButton.factory])});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/layout/active-content-watcher.directive",["require","exports","angular"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=__importDefault(n);var i=function(){function e(e,t,i,r,o,a,s){var l=this;this.restrict="A",this.link=function(){function e(e){var t=n.default.element(e),i=t.scope()||t.isolateScope();i&&i.block?r(i.block):i&&i.section&&!i.section.readOnly?r(i.section):o()}var t=!1,i=!1,r=function(e){if(!l.activeContentService.isDisabled(e)){if(l.activeContentService.hasActiveContent()){var t=l.activeContentService.active.content;if(t===e)return;l.$rootScope.$emit("content:replaced",{block:t})}l.activeContentService.setActiveContent(e),l.$rootScope.$emit("content:activated",{block:e})}},o=function(e,t){if(void 0===e&&(e=void 0),void 0===t&&(t=!1),l.activeContentService.hasActiveContent())if(t&&i)l.$rootScope.$broadcast("sidebar:requestClose");else{var n=l.activeContentService.active.content;l.activeContentService.clearActiveContent(),l.$rootScope.$emit("content:deactivated",{block:n,tab:"content-tiles"})}else l.$rootScope.$emit("content:deactivated",{block:void 0,tab:e})};l.$rootScope.$on("content:activate",function(e,t){r(t.block)}),l.$rootScope.$on("content:deactivate",function(e,t){o(t)}),l.$rootScope.$on("imageBlock:cropStaged",function(e,t){i=!0}),l.$rootScope.$on("imageBlock:closeCropStage",function(e,t){i=!1}),l.$document.on("keydown keypress",function(e){27===e.which&&l.$rootScope.$apply(function(){o(void 0,!0)})}),l.$document.on("mousedown",function(e){t=!(!e.target||!("emb-inner-email-body"===e.target.id||e.target.id.indexOf("section-options-")>=0))});var a=function(t){t.tagName&&"body"!==t.tagName.toLowerCase()&&"emb-js-stage"!==t.id&&l.$timeout(function(){e(t)})},s=function(e){t&&l.emailBuilderConfig.selectionBreakerEnabled&&(e.empty?e.empty():e.removeAllRanges&&e.removeAllRanges(),t=!1)};l.$document.on("click",function(e){var t=l.$window.getSelection();t.isCollapsed?a(e.target):s(t)}),l.draggingService.subscribe("content.start",function(){l.$rootScope.$emit("content:deactivate")})},this.activeContentService=e,this.draggingService=t,this.$rootScope=i,this.$document=r,this.$window=o,this.$timeout=a,this.emailBuilderConfig=s}return e.factory=function(t,n,i,r,o,a,s){return new e(t,n,i,r,o,a,s)},e}();t.ActiveContentWatcher=i}),define("ts/modules/emailbuilder/layout/email-scroll-container.directive",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){var n=this;this.link=function(e,t){n.viewPortService.subscribe("scrollEmailContainer",function(e){var i=e.offset;e.relative&&(i+=t.prop("scrollTop"));var r=e.delay||0,o=e.duration||300,a=e.easing||"swing";n.$timeout(function(){t.animate({scrollTop:i},o,a)},r)})},this.viewPortService=e,this.$timeout=t}return e.factory=function(t,n){return new e(t,n)},e}();t.EmailScrollContainer=n});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/layout/layout.module",["require","exports","angular","./active-content-watcher.directive","./email-scroll-container.directive"],function(e,t,n,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=__importDefault(n);var o=n.default.module("emailbuilder.layout",[]);t.module=o,o.directive("embActiveContentWatcher",["ActiveContentService","DraggingService","$rootScope","$document","$window","$timeout","EmailBuilderConfig",i.ActiveContentWatcher.factory]),o.directive("embEmailScrollContainer",["ViewPortService","$timeout",r.EmailScrollContainer.factory])});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/preview/preview-frame.directive",["require","exports","angular"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=__importDefault(n);var i=function(){function e(e,t,n,i){var r=this;this.generationErrors=[],this.restrict="A",this.scope={state:"@embPreviewState",previewAs:"@embPreviewAs"},this.link=function(e,t,n){var i=!!n.forMobile,o=function(){r.reloadSource(t,e.previewAs,i),"preview"===e.state&&r.$timeout(function(){r.$rootScope.$broadcast("email:preview:loaded"),r.writeSource(t,i)},800,!1)};r.saveService.subscribe("generating",function(){t.addClass("qa-status-generating")}),r.saveService.subscribe("generated",function(){t.removeClass("qa-status-generating"),r.generationErrors=[],o()}),r.saveService.subscribe("failed",function(){r.generationErrors=r.saveService.getSaveErrors(),"preview"===e.state&&r.writeSource(t,i)}),e.$watch("state",function(e){"preview"===e&&r.writeSource(t,i)}),e.$watch("previewAs",function(e,t){e!==t&&o()})},this.$timeout=e,this.$rootScope=t,this.previewHtmlService=n,this.saveService=i}return e.prototype.reloadSource=function(e,t,i){var r={};if(t){var o=t.split(":");r.listId=o[0],o.length>1&&(r.segmentIds=o[1])}else r.previewAll=!0;var a=e.data("html-request");a&&a.abort(),n.default.element("#emb-body").addClass("emb-preview-loading");var s=this.previewHtmlService.get(i,r);e.data("html-request",s)},e.prototype.writeSource=function(e,t){var i=this,r=e.data("html-request");r&&r.html.then(function(r){var o=r.headers("Content-Type").indexOf("application/json")>=0,a=o?r.data.htmlContent:r.data,s=o?r.data.errors:[],l=s&&s.length>0?s:i.generationErrors;!t&&o&&(l&&l.length>0?i.$rootScope.$broadcast("email:preview:error",l):i.$rootScope.$broadcast("email:preview:success"));var c=e.contents()[0];c.open(),c.write(a),c.close(),n.default.element("#emb-body").removeClass("emb-preview-loading")})},e.factory=function(t,n,i,r){return new e(t,n,i,r)},e}();t.PreviewFrame=i}),define("vendor/text!ts/modules/emailbuilder/preview/preview-notification-bar.directive.html",[],function(){return'<div ng-show="embState === \'preview\'">\r\n    <div class="c-preview-notification-bar" ng-class="{\'is-active\' : hasError || isMissingSampleData}">\r\n        <div ng-if="hasError" class="c-preview-notification-bar__inner c-preview-notification-bar__error">\r\n            <div class="c-preview-notification-bar__text u-enable-select-text">{{notificationMessage}} {{retryIsInProgress ? "Retrying..." : ""}}\r\n                <a ng-if="previewCanBeRetried && !retryIsInProgress" href="" class="c-preview-notification-bar__error-link u-enable-select-text" ng-click="retrySave()"> Retry</a>\r\n            </div>\r\n        </div>\r\n        <div ng-if="isMissingSampleData" class="c-preview-notification-bar__inner c-preview-notification-bar__missing-data-error">\r\n            <div class="c-preview-notification-bar__text u-enable-select-text">\r\n                To preview event data in code blocks,\r\n                <a href="" class="c-preview-notification-bar__text-link u-enable-select-text" ng-click="viewSampleEvent()">add sample event data</a>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>'}),define("ts/modules/emailbuilder/preview/preview-notification-bar.directive",["require","exports","vendor/text!ts/modules/emailbuilder/preview/preview-notification-bar.directive.html","../services/analytics.service"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t,r,o,a){var s=this;this.scope={embState:"="},this.restrict="E",this.template=n,this.link=function(e,t,n){s.resetErrors(e),s.$rootScope.$on("email:preview:error",function(t,n){s.resetErrors(e),s.setBarBasedOnErrorType(e,n)}),s.$rootScope.$on("email:preview:success",function(){s.resetErrors(e)}),e.$on("hidePreviewNotificationBar",function(){s.resetErrors(e)}),e.viewSampleEvent=function(){null!=s.emailBuilderConfig.urls.sampleEventPageUrl&&0!==s.emailBuilderConfig.urls.sampleEventPageUrl.length&&s.$window.open(s.emailBuilderConfig.urls.sampleEventPageUrl,"_blank")},e.retrySave=function(){e.retryIsInProgress=!0,s.saveService.forceSaveCampaign();var t={eventName:i.AnalyticsEventName.Previewed,dragAndDropPropertyKey:"Previewed Email Type",publicProperties:{"From Error":!0,"Error Source":e.errorSource}};s.analyticsService.trackClientLevel(t)}},this.resetErrors=function(e){e.previewCanBeRetried=!1,e.retryIsInProgress=!1,e.isMissingSampleData=!1,e.hasError=!1},this.setBarBasedOnErrorType=function(e,t){if(s.thereWereGeneralServiceFailures(t)){var n=t.filter(function(e){return"emptyOrMissingSampleEventData"!==e.type});s.setBarNotificationMessage(e,"Service Error",n[0].message)}else if(s.thereWereLiquidRenderingErrors(t)){var n=t.filter(function(e){return"emptyOrMissingSampleEventData"!==e.type});s.setBarNotificationMessage(e,"Liquid Error",n[0].message)}else s.sampleEventDataWasMissing(t)?e.isMissingSampleData=!0:s.thereWereCountdownGenerationErrors(t)&&(e.previewCanBeRetried=!0,s.setBarNotificationMessage(e,"Countdown Timer",t[0].message))},this.setBarNotificationMessage=function(e,t,n){e.hasError=!0,e.errorSource=t,e.notificationMessage=n},this.thereWereGeneralServiceFailures=function(e){return e.filter(function(e){return"sampleServiceError"===e.type}).length>0},this.thereWereLiquidRenderingErrors=function(e){return e.filter(function(e){return"liquidError"===e.type}).length>0},this.thereWereCountdownGenerationErrors=function(e){return e.filter(function(e){return"countdownGenerationError"===e.type}).length>0},this.sampleEventDataWasMissing=function(e){return e.filter(function(e){return"emptyOrMissingSampleEventData"===e.type}).length>0},this.$rootScope=e,this.$window=t,this.saveService=r,this.analyticsService=o,this.emailBuilderConfig=a}return e.factory=function(t,n,i,r,o){return new e(t,n,i,r,o)},e}();t.PreviewNotificationBar=r}),define("vendor/text!ts/modules/emailbuilder/preview/preview-as-dropdown.directive.html",[],function(){return'<div class="emb-preview-as-dropdown">\r\n    <span class="emb-preview-sentence" ng-class="{\'emb-preview-as-arrow-open\': options, \'emb-preview-as-arrow-closed\': !options}"><span>Previewing</span> <a href="#" ng-click="$event.preventDefault(); $event.stopPropagation(); showOptions();">{{ selectedText }}</a><span class="emb-arrow"></span></span>\r\n    <form>\r\n        <div class="emb-preview-as-menu emb-js-animation-allowed ng-hide" ng-show="options">\r\n            <div class="emb-radio-container">\r\n              <input type="radio"\r\n                     id="emb-preview-as-input-all"\r\n                     name="emb-preview-as-input-{{ ::id }}"\r\n                     ng-click="selectAll()"\r\n                     checked="checked"\r\n                     class="emb-radio"/>\r\n\r\n              <label for="emb-preview-as-input-all">All available content</label>\r\n            </div>\r\n            <span class="emb-or-split">Or, as a subscriber of:</span>\r\n            <ul class="preview-list-segments" style="max-height: 350px; overflow-y: scroll; overflow-x: hidden;">\r\n                <li ng-repeat="list in ::lists" class="emb-radio-container">\r\n                  <input type="radio" id="emb-preview-as-input-{{ ::list.listId }}-{{ ::id }}" name="emb-preview-as-input-{{ ::id }}" class="emb-radio" ng-click="selectList(list)" />\r\n                  <label for="emb-preview-as-input-{{ ::list.listId }}-{{ ::id }}">{{ ::list.title }}</label>\r\n                <ul class="preview-list-segments" ng-if="::list.segments.length > 0">\r\n                    <li ng-repeat="segment in ::list.segments" class="emb-radio-container">\r\n                      <input type="radio" id="emb-preview-as-input-{{ ::list.listId }}-{{ ::segment.segmentId }}-{{ ::id }}" name="emb-preview-as-input-{{ ::id }}" class="emb-radio"  ng-click="selectSegment(list, segment)" />\r\n                      <label for="emb-preview-as-input-{{ ::list.listId }}-{{ ::segment.segmentId }}-{{ ::id }}">{{ ::segment.title }}</label>\r\n                  </li>\r\n                </ul>\r\n              </li>\r\n            </ul>\r\n        </div>\r\n    </form>\r\n</div>\r\n'});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/preview/preview-as-dropdown.directive",["require","exports","vendor/text!ts/modules/emailbuilder/preview/preview-as-dropdown.directive.html","angular"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=__importDefault(i);var r=function(){function e(e,t){var r=this;this.restrict="A",this.require="ngModel",this.template=n,this.scope={id:"@embPreviewAsDropdown",options:"=?"},this.link=function(e,t,n,o){e.lists=i.default.copy(r.emailBuilderConfig.listsAndSegments),e.options=!!e.options;e.selectedText="all available content",e.deactivateContent=function(){r.$rootScope.$emit("content:deactivate")},e.showOptions=function(){if(e.options)return void e.hideOptions();e.deactivateContent(),e.options=!0},e.hideOptions=function(){e.options=!1},e.selectAll=function(){e.selectedText="all available content",o.$setViewValue("")},e.selectList=function(t){e.selectedText="as a subscriber of "+t.title,o.$setViewValue(t.listId)},e.selectSegment=function(t,n){e.selectedText="as a subscriber of "+n.title,o.$setViewValue(t.listId+":"+n.segmentId)};var a=function(t){e.options&&e.hideOptions()};r.$rootScope.$on("text:command",a),r.$rootScope.$on("content:deactivated",a),r.$rootScope.$on("content:replaced",a),r.$rootScope.$on("content:activated",a)},this.$rootScope=e,this.emailBuilderConfig=t}return e.factory=function(t,n){return new e(t,n)},e}();t.PreviewAsDropdown=r}),function(){function e(e){e.easing.jswing=e.easing.swing,e.extend(e.easing,{def:"easeOutQuad",swing:function(t,n,i,r,o){return e.easing[e.easing.def](t,n,i,r,o)},easeInQuad:function(e,t,n,i,r){return i*(t/=r)*t+n},easeOutQuad:function(e,t,n,i,r){return-i*(t/=r)*(t-2)+n},easeInOutQuad:function(e,t,n,i,r){return(t/=r/2)<1?i/2*t*t+n:-i/2*(--t*(t-2)-1)+n},easeInCubic:function(e,t,n,i,r){return i*(t/=r)*t*t+n},easeOutCubic:function(e,t,n,i,r){return i*((t=t/r-1)*t*t+1)+n},easeInOutCubic:function(e,t,n,i,r){return(t/=r/2)<1?i/2*t*t*t+n:i/2*((t-=2)*t*t+2)+n},easeInQuart:function(e,t,n,i,r){return i*(t/=r)*t*t*t+n},easeOutQuart:function(e,t,n,i,r){return-i*((t=t/r-1)*t*t*t-1)+n},
easeInOutQuart:function(e,t,n,i,r){return(t/=r/2)<1?i/2*t*t*t*t+n:-i/2*((t-=2)*t*t*t-2)+n},easeInQuint:function(e,t,n,i,r){return i*(t/=r)*t*t*t*t+n},easeOutQuint:function(e,t,n,i,r){return i*((t=t/r-1)*t*t*t*t+1)+n},easeInOutQuint:function(e,t,n,i,r){return(t/=r/2)<1?i/2*t*t*t*t*t+n:i/2*((t-=2)*t*t*t*t+2)+n},easeInSine:function(e,t,n,i,r){return-i*Math.cos(t/r*(Math.PI/2))+i+n},easeOutSine:function(e,t,n,i,r){return i*Math.sin(t/r*(Math.PI/2))+n},easeInOutSine:function(e,t,n,i,r){return-i/2*(Math.cos(Math.PI*t/r)-1)+n},easeInExpo:function(e,t,n,i,r){return 0==t?n:i*Math.pow(2,10*(t/r-1))+n},easeOutExpo:function(e,t,n,i,r){return t==r?n+i:i*(1-Math.pow(2,-10*t/r))+n},easeInOutExpo:function(e,t,n,i,r){return 0==t?n:t==r?n+i:(t/=r/2)<1?i/2*Math.pow(2,10*(t-1))+n:i/2*(2-Math.pow(2,-10*--t))+n},easeInCirc:function(e,t,n,i,r){return-i*(Math.sqrt(1-(t/=r)*t)-1)+n},easeOutCirc:function(e,t,n,i,r){return i*Math.sqrt(1-(t=t/r-1)*t)+n},easeInOutCirc:function(e,t,n,i,r){return(t/=r/2)<1?-i/2*(Math.sqrt(1-t*t)-1)+n:i/2*(Math.sqrt(1-(t-=2)*t)+1)+n},easeInElastic:function(e,t,n,i,r){var o=1.70158,a=0,s=i;if(0==t)return n;if(1==(t/=r))return n+i;if(a||(a=.3*r),s<Math.abs(i)){s=i;var o=a/4}else var o=a/(2*Math.PI)*Math.asin(i/s);return-s*Math.pow(2,10*(t-=1))*Math.sin((t*r-o)*(2*Math.PI)/a)+n},easeOutElastic:function(e,t,n,i,r){var o=1.70158,a=0,s=i;if(0==t)return n;if(1==(t/=r))return n+i;if(a||(a=.3*r),s<Math.abs(i)){s=i;var o=a/4}else var o=a/(2*Math.PI)*Math.asin(i/s);return s*Math.pow(2,-10*t)*Math.sin((t*r-o)*(2*Math.PI)/a)+i+n},easeInOutElastic:function(e,t,n,i,r){var o=1.70158,a=0,s=i;if(0==t)return n;if(2==(t/=r/2))return n+i;if(a||(a=r*(.3*1.5)),s<Math.abs(i)){s=i;var o=a/4}else var o=a/(2*Math.PI)*Math.asin(i/s);return t<1?s*Math.pow(2,10*(t-=1))*Math.sin((t*r-o)*(2*Math.PI)/a)*-.5+n:s*Math.pow(2,-10*(t-=1))*Math.sin((t*r-o)*(2*Math.PI)/a)*.5+i+n},easeInBack:function(e,t,n,i,r,o){return void 0==o&&(o=1.70158),i*(t/=r)*t*((o+1)*t-o)+n},easeOutBack:function(e,t,n,i,r,o){return void 0==o&&(o=1.70158),i*((t=t/r-1)*t*((o+1)*t+o)+1)+n},easeInOutBack:function(e,t,n,i,r,o){return void 0==o&&(o=1.70158),(t/=r/2)<1?i/2*(t*t*((1+(o*=1.525))*t-o))+n:i/2*((t-=2)*t*((1+(o*=1.525))*t+o)+2)+n},easeInBounce:function(t,n,i,r,o){return r-e.easing.easeOutBounce(t,o-n,0,r,o)+i},easeOutBounce:function(e,t,n,i,r){return(t/=r)<1/2.75?i*(7.5625*t*t)+n:t<2/2.75?i*(7.5625*(t-=1.5/2.75)*t+.75)+n:t<2.5/2.75?i*(7.5625*(t-=2.25/2.75)*t+.9375)+n:i*(7.5625*(t-=2.625/2.75)*t+.984375)+n},easeInOutBounce:function(t,n,i,r,o){return n<o/2?.5*e.easing.easeInBounce(t,2*n,0,r,o)+i:.5*e.easing.easeOutBounce(t,2*n-o,0,r,o)+.5*r+i}})}"function"==typeof define?define("vendor/jquery.easing",["jquery"],e):e(jQuery)}(),define("ts/modules/emailbuilder/preview/preview.animation",["require","exports","vendor/jquery.easing"],function(e,t){"use strict";function n(e,t,n){function i(){r.stop().animate({bottom:0,top:0,left:"321px",right:0},475,function(){r.css({position:"relative",bottom:"auto",top:"auto","min-height":"100%",left:"auto",right:"auto","border-radius":0,overflow:"visible"})}),a.stop().animate({height:"45px"},475,"easeOutCirc",function(){a.css({overflow:"visible"})}),s.stop().animate({height:0},475,"easeOutCirc"),l.stop().animate({right:"320px"},475,"easeOutCirc"),c.stop().animate({left:0},475,"easeOutCirc",function(){c.css({overflow:"visible"})}),n()}var r=e.find("#emb-email-container"),o=r.find("#emb-js-email-body"),a=r.find(".emb-addsec-wrap "),s=r.find("#emb-preview-chrome"),l=e.find("#emb-phone-preview"),c=e.find(".emb-sidebar");"emb-show-preview"===t?o.stop().fadeIn(230,i):n()}function i(e,t,n){function i(){var e={duration:550,queue:!1,easing:"easeOutCirc"},t={duration:550,queue:!1,easing:"easeOutCirc",complete:r};o.stop().animate({left:"20px",right:"386px"},e),a.stop().fadeOut(e),c.stop().animate({right:"26px"},e),u.css({overflow:"hidden"}).stop().animate({left:"-321px"},t),n()}function r(){u.find("section.emb-top").css({left:0}).removeClass("emb-closed")}var o=e.find("#emb-email-container"),a=o.find("#emb-js-email-body"),s=o.find(".emb-addsec-wrap "),l=o.find("#emb-preview-chrome"),c=e.find("#emb-phone-preview"),u=e.find(".emb-sidebar");"emb-show-preview"===t?(o.css({"border-radius":"5px",position:"absolute",bottom:0,top:0,"min-height":"inherit",left:"321px",right:0,overflow:""}),s.css({overflow:"hidden"}),function(){var e={bottom:"50px",top:"50px",left:"341px",right:"20px"},t={duration:375,complete:i,easing:"easeOutCirc"};l.stop().animate({height:"117px"},375,"easeOutCirc"),s.stop().animate({height:0},375,"easeOutCirc"),o.stop().animate(e,t)}()):n()}function r(){return{addClass:i,removeClass:n}}Object.defineProperty(t,"__esModule",{value:!0}),t.PreviewAnimation=r});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/preview/preview.module",["require","exports","angular","./preview-frame.directive","./preview-notification-bar.directive","./preview-as-dropdown.directive","./preview.animation"],function(e,t,n,i,r,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=__importDefault(n);var s=n.default.module("emailbuilder.preview",[]);t.module=s,s.directive("embPreview",["$timeout","$rootScope","PreviewHtmlService","SaveService",i.PreviewFrame.factory]),s.directive("embPreviewAsDropdown",["$rootScope","EmailBuilderConfig",o.PreviewAsDropdown.factory]),s.directive("embPreviewNotificationBar",["$rootScope","$window","SaveService","AnalyticsService","EmailBuilderConfig",r.PreviewNotificationBar.factory]),s.animation(".emb-preview-anim",a.PreviewAnimation)}),define("vendor/text!ts/modules/emailbuilder/sections/add-section.directive.html",[],function(){return'<div class="add-section-container emb-addsec-wrap" id="emb-js-addsec-wrapper">\r\n\r\n    <div class="add-section emb-new-section emb-reset" id="emb-js-new-section" ng-click="toggle();" ng-show="newSectionShown">\r\n\r\n        <button class="c-button-add-section qa-add-section" ng-class="{ \'is-active\': menuShown }" id="emb-new-section-btn">Add section</button>\r\n\r\n        <div class="section-chooser emb-js-animation-allowed" ng-style="{ \'z-index\' : (menuShown) ? 11 : -1 }" ng-show="menuShown" ng-class="{\'ng-hide\': !empty}" id="emb-section-chooser">\r\n            <div class="section-chooser__container emb-popout-wrap">\r\n                <div class="section-chooser__inner emb-popout-inner">\r\n                    <div class="l-gap--top-large l-gap--bottom-medium section-tiles emb-section-tiles-wrap" ng-if="::sections.length > 0" ng-show="!showDesigns || !designs.length" cs-custom-scroll>\r\n\r\n                        <ol role="tablist" class="l-grid l-parent-offset--bottom-right-tiles l-offset--left-large section-tiles__list emb-section-tiles">\r\n                            <li class="l-grid__item section-tiles__list-item" ng-repeat="section in ::sections | filter: { hidden: false }">\r\n                                <div class="section-tiles__thumbnail emb-section-tile qa-section-tile-{{::$index}}" id="section-tile-{{::$index}}"\r\n                                    emb-tile\r\n                                    item="section"\r\n                                    type="section"\r\n                                    ng-class="::[\'emb-\' + section.id, \'is-\' + item.tileActive]"\r\n                                    ng-mousedown="item.tileActive = \'active\'"\r\n                                    ng-mouseover="item.tileHovered = true"\r\n                                    ng-mouseout="item.tileHovered = false; item.tileActive = \'inactive\'"\r\n                                ></div>\r\n                            </li>\r\n                        </ol>\r\n                    </div>\r\n\r\n                    <div class="l-gap--top-large l-gap--bottom-medium section-tiles emb-section-tiles-wrap" ng-if="::designs.length > 0" ng-show="showDesigns || !sections.length">\r\n                        <ol class="l-grid l-parent-offset--bottom-right-tiles l-offset--left-large section-tiles__list emb-section-tiles">\r\n                            <li class="l-grid__item section-tiles__list-item" ng-repeat="design in ::designs | filter: { hidden: false }">\r\n                                <div class="section-tiles__thumbnail emb-section-tile" id="design-tile-{{::$index}}"\r\n                                    emb-tile\r\n                                    item="design"\r\n                                    type="section"\r\n                                    ng-class="::[\'emb-design-\' + $index, \'is-\' + item.tileActive]"\r\n                                    ng-mousedown="item.tileActive = \'active\'"\r\n                                    ng-mouseover="item.tileHovered = true"\r\n                                    ng-mouseout="item.tileHovered = false; item.tileActive = \'inactive\'"\r\n                                ></div>\r\n                            </li>\r\n                        </ol>\r\n                    </div>\r\n                    <div cs-switch switch-left-text="Sample content" switch-right-text="No content" ng-model="$parent.showDesigns" class="section-switch emb-section-switch-wrap" ng-if="sections.length > 0 && designs.length > 0"></div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n'});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/sections/add-section.directive",["require","exports","vendor/text!ts/modules/emailbuilder/sections/add-section.directive.html","angular"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=__importDefault(i);var r=function(){function e(e,t,r,o,a){var s=this;this.restrict="A",this.scope={sections:"=",designs:"=",empty:"@"},this.transclude=!1,this.template=n,this.link=function(e,t){e.toggle=function(){e.menuShown=!e.menuShown,e.menuShown&&s.viewPortService.ensureElementInViewPort(i.default.element("#emb-section-chooser"))},e.newSectionShown=!0,e.menuShown=!s.emailBuilderConfig.isFirstRun&&"true"===e.empty,e.showDesigns=!!s.emailBuilderConfig.settings.layoutMenuOpt,e.scrollSections=e.sections.length>12,e.scrollDesigns=e.designs.length>12;var n=function(){e.newSectionShown=!0,e.menuShown=!1};s.$rootScope.$on("section.add",n),s.draggingService.subscribe("#.stop",n),s.draggingService.subscribe("#.start",function(){e.newSectionShown=!1,e.menuShown=!1}),s.$rootScope.$on("content:activated",function(t,n){e.menuShown=!1}),s.emailBuilderConfig.mode.templateWithContent||e.$watch("showDesigns",function(e){s.$http.post(s.emailBuilderConfig.urls.saveLayoutOpt,$.param({newOption:e?1:0}),{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}})})},this.$rootScope=e,this.$http=t,this.viewPortService=r,this.draggingService=o,this.emailBuilderConfig=a}return e.factory=function(t,n,i,r,o){return new e(t,n,i,r,o)},e}();t.AddSection=r}),define("vendor/text!ts/modules/emailbuilder/sections/dropzone.directive.html",[],function(){return'<div class="emb-js-dropzone-wrap" ng-style="::relativity">\r\n    <div class="emb-dropzone emb-reset" ng-class="dropzone" ng-if="!hasContent">\r\n        &nbsp;\r\n        <div\r\n            class="emb-dz-wrap emb-js-content-dropzone"\r\n            ng-style="::wrapperSize"\r\n            emb-sortable\r\n            connect-with=".emb-js-content-container"\r\n            model="block"\r\n            handle=".emb-js-content-handle"\r\n            type="content"\r\n        >\r\n            <div class="emb-insertion-bar emb-reset" ng-style="::{ width: width + \'px\' }" />\r\n            <div class="emb-dz-container" ng-class="{ \'emb-dark\': dark, \'emb-dynamic-color\': dynamicColor }">\r\n                <div class="emb-dz-inner">\r\n                    <span>Drag content here</span>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <ng-include ng-show="content.tempHasPadding" src="sectionId | topPaddingUrl : column" />\r\n    <div\r\n        cs-dragenter="captured = true"\r\n        cs-dragleave="captured = false"\r\n        class="emb-js-content-container"\r\n        ng-class="container"\r\n        cs-dropline-container\r\n        emb-sortable\r\n        connect-with=".emb-js-content-container,.emb-js-content-dropzone"\r\n        model="block"\r\n        handle=".emb-js-content-handle"\r\n        type="content"\r\n    >\r\n        <div\r\n            class="emb-js-content-outer-wrapper emb-content-wrapper"\r\n            ng-class="{\r\n            \'emb-active\' : !readOnly && block.isActive,\r\n            \'emb-hovered\' : !readOnly && hovered,\r\n            \'emb-block-errors\': !block.tempIsValid,\r\n            \'emb-column-padding-top\': contentHasTopPadding(),\r\n            \'emb-column-padding-bottom\': contentHasBottomPadding(),\r\n            \'emb-column-padding-not-last\': contentHasPaddingNotLast(),\r\n            \'emb-column-padding\' : contentHasColumnPadding(),\r\n            \'emb-after-image\': contentAfterImage(),\r\n            \'emb-block-type-button\': block.type === \'button\',\r\n            \'emb-block-type-survey\': block.type === \'survey\',\r\n            \'emb-block-type-spacer\': block.type === \'spacer\',\r\n            \'emb-block-type-text\': block.type === \'text\',\r\n            \'emb-block-type-countdown\': block.type === \'countdown\'\r\n            }"\r\n            ng-repeat="block in content.content"\r\n            ng-mouseover="hovered = true; $event.stopPropagation()"\r\n            ng-controller="BlockController"\r\n            cs-dragenter="hovered = true;"\r\n            ng-mouseout="hovered = false;"\r\n            cs-dragleave="hovered = false;"\r\n            emb-scroll-content-block\r\n        >\r\n            <div\r\n                class="emb-content-inner emb-js-content-inner"\r\n                ng-if="::!block.hasTemplatesDefinedForWrapper"\r\n                ng-mouseenter="hovered = true"\r\n                ng-mouseleave="hovered = false"\r\n                ng-class="{\'emb-hovered\': !readOnly && hovered,\r\n                            \'emb-active\': !readOnly && block.isActive,\r\n                            \'emb-hoverable\': !readOnly && !block.isActive,\r\n                            \'emb-block-error\' : !block.tempIsValid && !block.tempIsNew && (block.type === \'button\' || block.type === \'survey\' || block.type === \'countdown\'),\r\n                            \'emb-spacer-inner-wrap\': block.type === \'spacer\' }"\r\n            >\r\n                <div\r\n                    ng-if="!readOnly"\r\n                    emb-item-controls\r\n                    item-type="content"\r\n                    item="block"\r\n                    section-index="sectionIndex"\r\n                    content-index="column"\r\n                    item-hovered="hovered"\r\n                />\r\n                <emb-validation-messages ng-if="block.hasValidationMessage" model="block" clear-on-active="1" />\r\n                <ng-include class="emb-handle emb-js-content-handle" src="block | contentPaddingUrl:sectionId:column" />\r\n            </div>\r\n            <div ng-if="::block.hasTemplatesDefinedForWrapper">\r\n                <ng-include src="block | contentPaddingUrl:sectionId:column" />\r\n            </div>\r\n        </div>\r\n        <div class="emb-insertion-bar emb-reset" ng-show="draggingWithin()" />\r\n    </div>\r\n</div>'});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/sections/dropzone.directive",["require","exports","vendor/text!ts/modules/emailbuilder/sections/dropzone.directive.html","angular"],function(e,t,n,i){"use strict";function r(e){return e.toArray().map(function(e){return i.default.element(e).outerHeight()}).reduce(function(e,t){return e+t},0)}Object.defineProperty(t,"__esModule",{value:!0}),i=__importDefault(i);var o=function(){function e(e,t){var n=this;this.getLocation=function(){var e=n.$scope,t=parseInt(e.column,10),i=parseInt(e.maxColumn,10),r=e.sectionIndex();return{readOnly:e.readOnly,sectionID:e.sectionId,columnIndex:t,sectionIndex:r,firstColumn:0===t,firstSection:0===r,lastColumn:t===i,lastSection:r===e.maxSectionIndex()}},this.hasContent=function(){return n.$scope.hasContent},this.$scope=e,this.$scope.width=t.getDropzoneWidth(this.getLocation())}return e}();t.DropzoneController=o;var a=function(){function e(e,t){var a=this;this.restrict="A",this.template=n,this.transclude=!1,this.scope={content:"=",sectionIndex:"&",sectionId:"=",readOnly:"=",column:"@",maxColumn:"@",maxSectionIndex:"&",height:"@",dynamicColor:"@",dark:"@",independent:"@",section:"="},this.controller=["$scope","ItemWidthService",o],this.link=function(e,t){e.dynamicColor=!!e.dynamicColor,e.dark=!!e.dark,e.dropzone="emb-dropzone-inactive",e.wrapperSize={width:e.width},e.independent&&(e.relativity={position:"relative"},e.wrapperSize.top=-1*r(t.prevAll()),e.wrapperSize.bottom=-1*r(t.nextAll())),e.$watch("content.content.length",function(t){var n=!!t;e.hasContent=n,e.container=n?"emb-content-container":"",e.dropzone=n?e.dropzone:"emb-dropzone-inactive"}),e.draggingWithin=function(){return!e.readOnly&&e.droplineActive&&e.dragging&&e.hasContent&&!e.captured};var n,o=function(){clearTimeout(n),e.dropzone="emb-dropzone-inactive",e.droplineActive=!1,e.$digest()},s=e.section,l=function(){t.off("sortover dragover"),t.off("sortout sortstop sortreceive drop"),t.off("dragleave")},c=function(){l(),t.on("sortover dragover",function(t){"input"!==t.target.tagName.toLowerCase()?(clearTimeout(n),e.dropzone="",e.droplineActive=!0,e.$digest()):o()}),t.on("sortout sortstop sortreceive drop",o),t.on("dragleave",function(){clearTimeout(n),n=window.setTimeout(o,30)})},u=function(){l(),t.on("sortover dragover",function(t){if(i.default.element(t.target).data("ui-sortable")){var n=parseInt(e.column,10);s.content[n].isHighlighted=!0,e.$emit("section.highlight",s)}}),t.on("sortout sortstop sortreceive drop",function(t){if(i.default.element(t.target).data("ui-sortable")){var n=parseInt(e.column,10);s.content[n].isHighlighted=!1,e.$emit("section.highlight",s)}}),t.on("dragleave",function(t){if(i.default.element(t.target).data("ui-sortable")){var n=parseInt(e.column,10);s.content[n].isHighlighted=!1,e.$emit("section.highlight",s)}})},d=function(e){a.lockLevelService.getLocks(e).dragAndDropLocked?u():c()};d(s.permissions),e.$on("permissionsChanged:section-"+s.uiId,function(e,t){d(t)}),e.$on("backgroundChanged",function(t,n){e.dark=a.colorService.isDark(n)})},this.lockLevelService=e,this.colorService=t}return e.factory=function(t,n){return new e(t,n)},e}();t.Dropzone=a});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/sections/footer.directive",["require","exports","angular"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=__importDefault(n);var i=function(){function e(e,t,i){var r=this;this.restrict="A",this.scope=!0,this.link=function(e,t){e.block=n.default.copy(r.emailService.model.footer);try{var i=n.default.element(".address",t).scope();i.block.type="footer",i.block.subType="companyDetails"}catch(e){}var o=function(e){r.lockLevelService.getLocks(e).anyLocking?t.addClass("is-locked"):t.removeClass("is-locked")};o(e.block.permissions),e.$on("permissionsChanged:footer",function(e,t){o(t)}),t.mouseenter(function(){t.addClass("is-hovered")}),t.mouseout(function(){t.removeClass("is-hovered")});var a=r.$rootScope.$on("content:activated",function(e,n){"footer"===n.block.type?t.addClass("is-active"):t.removeClass("is-active")}),s=r.$rootScope.$on("content:deactivated",function(e,n){t.removeClass("is-active")});e.$on("$destroy",function(){a(),s()})},this.compile=function(e){var t=$('<button class="c-section-highlight__label c-section-highlight__label--locked"></button>');return t.append('<span class="c-section-highlight__label-lock" aria-hidden="true"></span>'),t.append('<span class="c-section-highlight__label-text">Locked</span>'),e.append(t),r.link},this.lockLevelService=i,this.$rootScope=t,this.emailService=e}return e.factory=function(t,n,i){return new e(t,n,i)},e}();t.Footer=i});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/sections/preheader.directive",["require","exports","angular"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=__importDefault(n);var i=function(){function e(e,t,i){var r=this;this.restrict="A",this.scope=!0,this.link=function(e,t){e.block=n.default.copy(r.emailService.model.header),e.block.subType="preheader";var i=!1;r.emailBuilderConfig.canvasSectionPermissions&&("full"===e.block.permissions.lockLevel?t.addClass("is-locked"):"partial"===e.block.permissions.lockLevel&&t.addClass("is-partially-locked"),e.$on("permissionsChanged:header",function(e,n){t.removeClass("is-partially-locked"),t.removeClass("is-locked"),i||("full"===n.lockLevel?t.addClass("is-locked"):"partial"===n.lockLevel&&t.addClass("is-partially-locked"))})),t.mouseenter(function(){i||t.addClass("is-hovered")}),t.mouseout(function(){t.removeClass("is-hovered")});var o=r.$rootScope.$on("content:activated",function(e,n){i||"header"!==n.block.type||"preheader"!==n.block.subType?t.removeClass("is-active"):t.addClass("is-active")}),a=r.$rootScope.$on("content:deactivated",function(e,n){t.removeClass("is-active")}),s=r.$rootScope.$on("checkbox:value-changed",function(e){i=!(r.emailService.model.social.webversion.on||!r.emailService.model.editableText.preheader||!r.emailService.model.editableText.preheader.isDisabled)});e.$on("$destroy",function(){o(),a(),s()})},this.compile=function(e){var t=$("<button></button>");t.addClass("c-section-highlight__label"),t.addClass("c-section-highlight__label--locked");var n=$("<span></span>");n.addClass("c-section-highlight__label-lock"),n.attr("aria-hidden","true"),t.append(n);var i=$("<span>Locked</span>");i.addClass("c-section-highlight__label-text"),i.attr("aria-hidden","true"),t.append(i),e.append(t);var o=$("<button></button>");o.addClass("c-section-highlight__label"),o.addClass("c-section-highlight__label--partially-locked");var a=$("<span></span>");a.addClass("c-section-highlight__label-lock"),a.addClass("c-section-highlight__label-lock--partial"),a.attr("aria-hidden","true"),o.append(a);var s=$("<span>Edit content only</span>");return s.addClass("c-section-highlight__label-text"),s.attr("aria-hidden","true"),o.append(s),e.append(o),r.link},this.emailService=e,this.$rootScope=t,this.emailBuilderConfig=i}return e.factory=function(t,n,i){return new e(t,n,i)},e}();t.Preheader=i}),define("ts/modules/emailbuilder/sections/web-links.directive",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.restrict="A",this.link=function(e){e.block={type:"footer",subType:"companyDetails"}}}return e.factory=function(){return new e},e}();t.WebLinks=n}),define("ts/modules/emailbuilder/sections/section.animation",["require","exports","vendor/jquery.easing"],function(e,t){"use strict";function n(e){return{leave:function(t,n){return setTimeout(function(){t.animate({height:"0px"},300,"linear",n)},120),e(t,{addClass:"ng-leave ng-leave-active"})}}}Object.defineProperty(t,"__esModule",{value:!0}),t.SectionAnimation=n});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/sections/section.controller",["require","exports","angular"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=__importDefault(n);var i=function(){function e(e,t,i,r,o,a,s){function l(t){var n=i.getLocks(t);e.section.hideSectionSettings=n.anyLocking,u=n.anyLocking}function c(t){var i=n.default.element("#js_section_separator_after_"+e.section.uiId+" > div");i.css("line-height",t+"px"),i.css("font-size",t+"px"),r.updateTopBorderForNextSection(e.section,o.model.sections)}e.canvasSectionPermissions=s.canvasSectionPermissions;var u=!1;l(e.section.permissions),e.$on("permissionsChanged:section-"+e.section.uiId,function(e,t){l(t)});var d=$(".emb-js-section-outer-wrapper",t);e.hasIcon=function(){return u&&d.innerHeight()>35},s.email.isBlueprint&&(e.$watch(function(e){return e.section.settings.verticalSpacing},function(e){isNaN(e)||c(e)}),a(function(){c(e.section.settings.verticalSpacing)},500))}return e}();t.SectionController=i}),define("ts/modules/emailbuilder/sections/block.controller",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){var n=this;this.excludedFromPaddingRequiresFullwidth=["image","video"],this.excludedFromPadding=["countdown"],this.blockAppliesWithoutFullwidth=function(e){return n.excludedFromPadding.indexOf(e.type)>=0},this.blockNeedsAndHasFullwidth=function(e){return("image"===e.type||"video"===e.type)&&(n.excludedFromPaddingRequiresFullwidth.indexOf(e.type)>=0&&e.isFullWidth)},e.contentHasTopPadding=function(){return!n.blockNeedsAndHasFullwidth(e.block)&&(!n.blockAppliesWithoutFullwidth(e.block)&&e.$first)},e.contentHasBottomPadding=function(){return!n.blockNeedsAndHasFullwidth(e.block)&&(!n.blockAppliesWithoutFullwidth(e.block)&&e.$last)},e.contentHasPaddingNotLast=function(){return!(n.blockNeedsAndHasFullwidth(e.block)&&!e.$last)&&(!(n.blockAppliesWithoutFullwidth(e.block)&&!e.$last)&&!e.$last)},e.contentAfterImage=function(){return 0!==e.$index&&-1!==n.excludedFromPaddingRequiresFullwidth.concat(n.excludedFromPadding).indexOf(e.content.content[e.$index-1].type)},e.contentHasColumnPadding=function(){return!n.blockNeedsAndHasFullwidth(e.block)&&!n.blockAppliesWithoutFullwidth(e.block)},t.active.content!==e.block&&(e.block.isActive=!1)}return e}();t.BlockController=n}),define("ts/modules/emailbuilder/sidebar/section-stacking.service",["require","exports","../string-utils"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sideBySideIdSuffix="-sidebyside";var i=function(){function e(){this.getMobileStackingType=function(e){return n.stringEndsWith(e.id,t.sideBySideIdSuffix)?"sidebyside":e.isReverseStacked?"stackcolumnsreverse":"stackcolumns"},this.setMobileStackingType=function(e,i){e.id=n.stringRemoveSuffix(e.id,t.sideBySideIdSuffix),"sidebyside"===i&&(e.id=""+e.id+t.sideBySideIdSuffix),e.isReverseStacked="stackcolumnsreverse"===i}}return e}();t.SectionStackingService=i}),define("ts/modules/emailbuilder/sections/section-id.service",["require","exports","../sidebar/section-stacking.service","../string-utils"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){var e=this;this.layoutsClasses={fullWidth:"-full-width",spacing:"-gutter",border:"-border"},this.propertiesToId=function(t,r){var o=i.stringEndsWith(t,n.sideBySideIdSuffix);t=i.stringRemoveSuffix(t,n.sideBySideIdSuffix);var a=Object.keys(e.layoutsClasses).reduce(function(t,n){return t.replace(e.layoutsClasses[n],"")},t),s="";switch(r){case"fixedWidth":s=a;break;case"fullWidth":s=""+a+e.layoutsClasses.fullWidth;break;case"spacing":s=""+a+e.layoutsClasses.spacing}return-1!==t.indexOf(e.layoutsClasses.border)&&(s=""+s+e.layoutsClasses.border),o&&(s=""+s+n.sideBySideIdSuffix),s},this.idToProperties=function(t){var n="fixedWidth";return-1!==t.indexOf(e.layoutsClasses.fullWidth)&&(n="fullWidth"),-1!==t.indexOf(e.layoutsClasses.spacing)&&(n="spacing"),n},this.updateBorderForSection=function(t){var r=i.stringEndsWith(t.id,n.sideBySideIdSuffix);t.id=i.stringRemoveSuffix(t.id,n.sideBySideIdSuffix),t.bordered&&-1===t.id.indexOf(e.layoutsClasses.border)?t.id=""+t.id+e.layoutsClasses.border:t.id=t.id.replace(e.layoutsClasses.border,""),r&&(t.id=""+t.id+n.sideBySideIdSuffix)},this.updateTopBorderForNextSection=function(e,t){var n=t.indexOf(e),i=t[n+1];e.settings&&0===e.settings.verticalSpacing&&-1!==e.id.indexOf("border")?-1!==n&&void 0!==i&&null!==i&&(void 0===i.cssClasses?i.cssClasses=[]:-1===i.cssClasses.indexOf("layout--double-border")&&i.cssClasses.push("layout--double-border")):void 0!==i&&null!==i&&(i.cssClasses=[])},this.updateTopBorderForNextSectionAfterRemoving=function(e,t){var n=t.indexOf(e),i=t[n+1],r=t[n-1];void 0!==r&&null!==r&&r.settings&&0===r.settings.verticalSpacing&&-1!==r.id.indexOf("border")?void 0!==i&&null!==i&&(void 0===i.cssClasses?i.cssClasses=[]:-1===i.cssClasses.indexOf("layout--double-border")&&i.cssClasses.push("layout--double-border")):void 0!==i&&null!==i&&(i.cssClasses=[])},this.updateAfterMoving=function(t,n,i,r){var o=i>r?i:i-1;if(o>=0){var a=n[o];e.updateTopBorderForNextSection(a,n)}else n[i].cssClasses=[];e.updateTopBorderForNextSection(t,n);var s=r-1;if(s>=0){var l=n[s];e.updateTopBorderForNextSection(l,n)}else n[r].cssClasses=[]}}return e}();t.SectionIdService=r}),define("vendor/text!ts/modules/emailbuilder/sections/switch-button.directive.html",[],function(){return'<div>\n    <span class="section-switch__label section-switch__label--left" ng-class="{\'is-active\': buttonLeft}" ng-click="switchSides(true)" ng-if="leftText">{{leftText}}</span>\n    <span class="section-switch__inner js-switch" ng-click="switchSides(!buttonLeft)">\n        <span class="section-switch__handle js-switch-handle"></span>\n    </span>\n    <span class="section-switch__label section-switch__label--right" ng-class="{\'is-active\': !buttonLeft}" ng-click="switchSides(false)" ng-if="rightText">{{rightText}}</span>\n</div>'}),define("ts/modules/emailbuilder/sections/switch-button.directive",["require","exports","vendor/text!ts/modules/emailbuilder/sections/switch-button.directive.html"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){var t=this;this.restrict="A",this.template=n,this.require="ngModel",this.link=function(e,n,i,r){var o=n.find(".js-switch-handle"),a=n.find(".js-switch"),s=a.width(),l=o.width(),c=Math.round(s/2)-Math.round(l/2),u=s-l;e.buttonLeft=!0,e.leftText=i.switchLeftText,e.rightText=i.switchRightText,r.$render=function(){t.$timeout(function(){e.buttonLeft=r.$modelValue,o.css({left:e.buttonLeft?0:u})})},e.switchSides=function(n){t.$timeout(function(){var t=n?0:u;e.buttonLeft=n,o.animate({left:t},100),r.$setViewValue(n)})},n.on({click:function(e){e.stopPropagation()}}),o.draggable({axis:"x",containment:"parent",stop:function(){var t=parseInt(o.css("left"),10),n=t<=c;e.switchSides(n)}})},this.$timeout=e}return e.factory=function(t){return new e(t)},e}();t.SwitchButton=i});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/sections/dropline-container.directive",["require","exports","angular"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=__importDefault(n);var i=function(){function e(e,t,i){var r=this;this.link=function(e,t,n){var i=t.find(".emb-insertion-bar"),o=r.$document[0],a=n.type,s=function(n){e.mouse={x:n.mouseX,y:n.mouseY},r.positionDropline(e,i,o,t,a)},l=[],c=r.draggingService.subscribe(a+".stop",function(){e.dragging=!1});l.push(c),c=r.draggingService.subscribe(a+".move",s),l.push(c),c=r.draggingService.subscribe(a+".start",function(t){e.dragging=!0,s(t)}),l.push(c),"content"===a&&(c=r.draggingService.subscribe("content.captured",function(){e.captured=!0}),l.push(c),c=r.draggingService.subscribe("content.released",function(){e.captured=!1}),l.push(c)),e.$on("$destroy",function(){l.forEach(function(e){e.unsubscribe()})})},this.positionAroundItem=function(e,t,n,i){var o=t.offset().top,a=t.height(),s=r.beforeOrAfterItem(e.y,o,a,t,n,!1);r.shouldCheckDeadzone(s,t,i)&&(s=r.beforeOrAfterItem(e.y,o,a,t,n,!0)),s&&(s.before?s.before.before(i):s.after.after(i))},this.shouldCheckDeadzone=function(e,t,n){if(!e)return!1;var i=e.check,r=e.before?"prev":"next";return i||(i=t,r="next"),i[r]().is(n)},
this.beforeOrAfterItem=function(e,t,n,i,r,o){var a=o?.45:.5,s=t+n*a,l=t+n-n*a;return e<=s?{before:i,check:r}:e>=l?r?{before:r,check:i}:{after:i,check:i}:void 0},this.ensureTopOrBottom=function(e,t,n,i){var r,o,a=t.offset().top,s=a+t.height();e<=a?(r="first",o="before"):e>=s&&(r="last",o="after"),r&&o&&t.find(i)[r]()[o](n)},this.normaliseMousePosition=function(e,t){var n=e.offset().left,i=e.width(),r=n+i,o=t.x;(o<=n||o>=r)&&(t.x=n+i/2)},this.positionDropline=function(e,t,i,o,a){var s=e.mouse;if(s&&e.dragging&&e.droplineActive){r.normaliseMousePosition(o,s);var l=n.default.element(i.elementFromPoint(s.x,s.y)),c=".emb-js-"+a+"-outer-wrapper:not(.ui-sortable-placeholder)",u=void 0,d=void 0,h=void 0,p=void 0;l.is(".emb-js-"+a+"-dragger")?(l.hide(),u=n.default.element(i.elementFromPoint(s.x,s.y)),l.show()):u=l,d=u.closest(c),d.length?(h=o.find(c),p=h.eq(h.index(d)+1),p.length||(p=void 0),r.positionAroundItem(s,d,p,t)):r.ensureTopOrBottom(s.y,o,t,c),r.setInsertBefore(t,c,a)}},this.setInsertBefore=function(e,t,i){var o=e.nextAll(t).get(0),a=null;if(o){var s=n.default.element(o).scope();s&&(a=s["section"===i?i:"block"])}r.emailService.setInsertBefore(a)},this.$document=e,this.draggingService=t,this.emailService=i}return e.factory=function(t,n,i){return new e(t,n,i)},e}();t.DroplineContainer=i});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/sections/sections.module",["require","exports","angular","./add-section.directive","./dropzone.directive","./footer.directive","./preheader.directive","./web-links.directive","./section-background.directive","./section.animation","./section.controller","./block.controller","./section-id.service","./switch-button.directive","./dropline-container.directive"],function(e,t,n,i,r,o,a,s,l,c,u,d,h,p,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=__importDefault(n);var m=n.default.module("emailbuilder.sections",[]);t.module=m,m.directive("csAddSection",["$rootScope","$http","ViewPortService","DraggingService","EmailBuilderConfig",i.AddSection.factory]),m.directive("embDropzone",["LockLevelService","ColorService",r.Dropzone.factory]),m.directive("embFooter",["EmailService","$rootScope","LockLevelService",o.Footer.factory]),m.directive("embPreheader",["EmailService","$rootScope","EmailBuilderConfig",a.Preheader.factory]),m.directive("embSectionBackground",["EmailService","$q","ContentBlockService","EmailBuilderConfig",l.SectionBackground.factory]),m.directive("embWebLinks",[s.WebLinks.factory]),m.directive("csSwitch",["$timeout",p.SwitchButton.factory]),m.directive("csDroplineContainer",["$document","DraggingService","EmailService",f.DroplineContainer.factory]),m.animation(".emb-js-section-and-separator-wrapper",["$animateCss",c.SectionAnimation]),m.controller("SectionController",["$scope","$element","LockLevelService","SectionIdService","EmailService","$timeout","EmailBuilderConfig",u.SectionController]),m.service("SectionIdService",[h.SectionIdService]),m.controller("BlockController",["$scope","ActiveContentService",d.BlockController])}),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define("vendor/raven/raven",[],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.Raven=e()}}(function(){return function e(t,n,i){function r(a,s){if(!n[a]){if(!t[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(o)return o(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[a]={exports:{}};t[a][0].call(u.exports,function(e){var n=t[a][1][e];return r(n||e)},u,u.exports,e,t,n,i)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<i.length;a++)r(i[a]);return r}({1:[function(e,t,n){function i(e,t,n,i){return JSON.stringify(e,r(t,i),n)}function r(e,t){var n=[],i=[];return null==t&&(t=function(e,t){return n[0]===t?"[Circular ~]":"[Circular ~."+i.slice(0,n.indexOf(t)).join(".")+"]"}),function(r,o){if(n.length>0){var a=n.indexOf(this);~a?n.splice(a+1):n.push(this),~a?i.splice(a,1/0,r):i.push(r),~n.indexOf(o)&&(o=t.call(this,r,o))}else n.push(o);return null==e?o:e.call(this,r,o)}}n=t.exports=i,n.getSerialize=r},{}],2:[function(e,t,n){"use strict";function i(e){this.name="RavenConfigError",this.message=e}i.prototype=new Error,i.prototype.constructor=i,t.exports=i},{}],3:[function(e,t,n){"use strict";var i=function(e,t,n){var i=e[t],r=e;if(t in e){var o="warn"===t?"warning":t;e[t]=function(){var e=[].slice.call(arguments),t=""+e.join(" "),a={level:o,logger:"console",extra:{arguments:e}};n&&n(t,a),i&&Function.prototype.apply.call(i,r,e)}}};t.exports={wrapMethod:i}},{}],4:[function(e,t,n){"use strict";function i(){return+new Date}function r(){this._hasJSON=!("object"!=typeof JSON||!JSON.stringify),this._hasDocument="undefined"!=typeof document,this._lastCapturedException=null,this._lastEventId=null,this._globalServer=null,this._globalKey=null,this._globalProject=null,this._globalContext={},this._globalOptions={logger:"javascript",ignoreErrors:[],ignoreUrls:[],whitelistUrls:[],includePaths:[],crossOrigin:"anonymous",collectWindowErrors:!0,maxMessageLength:0,stackTraceLimit:50,autoBreadcrumbs:!0},this._ignoreOnError=0,this._isRavenInstalled=!1,this._originalErrorStackTraceLimit=Error.stackTraceLimit,this._originalConsole=window.console||{},this._originalConsoleMethods={},this._plugins=[],this._startTime=i(),this._wrappedBuiltIns=[],this._breadcrumbs=[],this._lastCapturedEvent=null,this._keypressTimeout,this._location=window.location,this._lastHref=this._location&&this._location.href;for(var e in this._originalConsole)this._originalConsoleMethods[e]=this._originalConsole[e]}var o=e(7),a=e(2),s=e(6),l=e(1),c=s.isFunction,u=s.isUndefined,d=s.isError,h=s.isEmptyObject,p=s.hasKey,f=s.joinRegExp,m=s.each,g=s.objectMerge,v=s.truncate,b=s.urlencode,y=s.uuid4,w=s.htmlTreeAsString,_=s.parseUrl,S=s.isString,k=s.fill,x=e(3).wrapMethod,C="source protocol user pass host port path".split(" "),I=/^(?:(\w+):)?\/\/(?:(\w+)(:\w+)?@)?([\w\.-]+)(?::(\d+))?(\/.*)/;r.prototype={VERSION:"3.7.0",debug:!1,TraceKit:o,config:function(e,t){var n=this;if(this._globalServer)return this._logDebug("error","Error: Raven has already been configured"),this;if(!e)return this;t&&m(t,function(e,t){"tags"===e||"extra"===e?n._globalContext[e]=t:n._globalOptions[e]=t}),this.setDSN(e),this._globalOptions.ignoreErrors.push(/^Script error\.?$/),this._globalOptions.ignoreErrors.push(/^Javascript error: Script error\.? on line 0$/),this._globalOptions.ignoreErrors=f(this._globalOptions.ignoreErrors),this._globalOptions.ignoreUrls=!!this._globalOptions.ignoreUrls.length&&f(this._globalOptions.ignoreUrls),this._globalOptions.whitelistUrls=!!this._globalOptions.whitelistUrls.length&&f(this._globalOptions.whitelistUrls),this._globalOptions.includePaths=f(this._globalOptions.includePaths),this._globalOptions.maxBreadcrumbs=Math.max(0,Math.min(this._globalOptions.maxBreadcrumbs||100,100));var i={xhr:!0,console:!0,dom:!0,location:!0},r=this._globalOptions.autoBreadcrumbs;return"[object Object]"==={}.toString.call(r)?r=g(i,r):!1!==r&&(r=i),this._globalOptions.autoBreadcrumbs=r,o.collectWindowErrors=!!this._globalOptions.collectWindowErrors,this},install:function(){var e=this;return this.isSetup()&&!this._isRavenInstalled&&(o.report.subscribe(function(){e._handleOnErrorStackInfo.apply(e,arguments)}),this._instrumentTryCatch(),e._globalOptions.autoBreadcrumbs&&this._instrumentBreadcrumbs(),this._drainPlugins(),this._isRavenInstalled=!0),Error.stackTraceLimit=this._globalOptions.stackTraceLimit,this},setDSN:function(e){var t=this._parseDSN(e),n=t.path.lastIndexOf("/"),i=t.path.substr(1,n);this._dsn=e,this._globalKey=t.user,this._globalSecret=t.pass&&t.pass.substr(1),this._globalProject=t.path.substr(n+1),this._globalServer=this._getGlobalServer(t),this._globalEndpoint=this._globalServer+"/"+i+"api/"+this._globalProject+"/store/"},context:function(e,t,n){return c(e)&&(n=t||[],t=e,e=void 0),this.wrap(e,t).apply(this,n)},wrap:function(e,t,n){function i(){var i=[],o=arguments.length,a=!e||e&&!1!==e.deep;for(n&&c(n)&&n.apply(this,arguments);o--;)i[o]=a?r.wrap(e,arguments[o]):arguments[o];try{return t.apply(this,i)}catch(t){throw r._ignoreNextOnError(),r.captureException(t,e),t}}var r=this;if(u(t)&&!c(e))return e;if(c(e)&&(t=e,e=void 0),!c(t))return t;try{if(t.__raven__)return t;if(t.__raven_wrapper__)return t.__raven_wrapper__}catch(e){return t}for(var o in t)p(t,o)&&(i[o]=t[o]);return i.prototype=t.prototype,t.__raven_wrapper__=i,i.__raven__=!0,i.__inner__=t,i},uninstall:function(){return o.report.uninstall(),this._restoreBuiltIns(),Error.stackTraceLimit=this._originalErrorStackTraceLimit,this._isRavenInstalled=!1,this},captureException:function(e,t){if(!d(e))return this.captureMessage(e,g({trimHeadFrames:1,stacktrace:!0},t));this._lastCapturedException=e;try{var n=o.computeStackTrace(e);this._handleStackInfo(n,t)}catch(t){if(e!==t)throw t}return this},captureMessage:function(e,t){if(!this._globalOptions.ignoreErrors.test||!this._globalOptions.ignoreErrors.test(e)){var n=g({message:e+""},t);if(t&&t.stacktrace){var i;try{throw new Error(e)}catch(e){i=e}i.name=null,t=g({fingerprint:e,trimHeadFrames:(t.trimHeadFrames||0)+1},t);var r=o.computeStackTrace(i),a=this._prepareFrames(r,t);n.stacktrace={frames:a.reverse()}}return this._send(n),this}},captureBreadcrumb:function(e){var t=g({timestamp:i()/1e3},e);return this._breadcrumbs.push(t),this._breadcrumbs.length>this._globalOptions.maxBreadcrumbs&&this._breadcrumbs.shift(),this},addPlugin:function(e){var t=Array.prototype.slice.call(arguments,1);return this._plugins.push([e,t]),this._isRavenInstalled&&this._drainPlugins(),this},setUserContext:function(e){return this._globalContext.user=e,this},setExtraContext:function(e){return this._mergeContext("extra",e),this},setTagsContext:function(e){return this._mergeContext("tags",e),this},clearContext:function(){return this._globalContext={},this},getContext:function(){return JSON.parse(l(this._globalContext))},setEnvironment:function(e){return this._globalOptions.environment=e,this},setRelease:function(e){return this._globalOptions.release=e,this},setDataCallback:function(e){var t=this._globalOptions.dataCallback;return this._globalOptions.dataCallback=c(e)?function(n){return e(n,t)}:e,this},setShouldSendCallback:function(e){var t=this._globalOptions.shouldSendCallback;return this._globalOptions.shouldSendCallback=c(e)?function(n){return e(n,t)}:e,this},setTransport:function(e){return this._globalOptions.transport=e,this},lastException:function(){return this._lastCapturedException},lastEventId:function(){return this._lastEventId},isSetup:function(){return!!this._hasJSON&&(!!this._globalServer||(this.ravenNotConfiguredError||(this.ravenNotConfiguredError=!0,this._logDebug("error","Error: Raven has not been configured.")),!1))},afterLoad:function(){var e=window.RavenConfig;e&&this.config(e.dsn,e.config).install()},showReportDialog:function(e){if(window.document){e=e||{};var t=e.eventId||this.lastEventId();if(!t)throw new a("Missing eventId");var n=e.dsn||this._dsn;if(!n)throw new a("Missing DSN");var i=encodeURIComponent,r="";r+="?eventId="+i(t),r+="&dsn="+i(n);var o=e.user||this._globalContext.user;o&&(o.name&&(r+="&name="+i(o.name)),o.email&&(r+="&email="+i(o.email)));var s=this._getGlobalServer(this._parseDSN(n)),l=document.createElement("script");l.async=!0,l.src=s+"/api/embed/error-page/"+r,(document.head||document.body).appendChild(l)}},_ignoreNextOnError:function(){var e=this;this._ignoreOnError+=1,setTimeout(function(){e._ignoreOnError-=1})},_triggerEvent:function(e,t){var n,i;if(this._hasDocument){t=t||{},e="raven"+e.substr(0,1).toUpperCase()+e.substr(1),document.createEvent?(n=document.createEvent("HTMLEvents"),n.initEvent(e,!0,!0)):(n=document.createEventObject(),n.eventType=e);for(i in t)p(t,i)&&(n[i]=t[i]);if(document.createEvent)document.dispatchEvent(n);else try{document.fireEvent("on"+n.eventType.toLowerCase(),n)}catch(e){}}},_breadcrumbEventHandler:function(e){var t=this;return function(n){if(t._keypressTimeout=null,t._lastCapturedEvent!==n){t._lastCapturedEvent=n;var i,r=n.target;try{i=w(r)}catch(e){i="<unknown>"}t.captureBreadcrumb({category:"ui."+e,message:i})}}},_keypressEventHandler:function(){var e=this;return function(t){var n=t.target,i=n&&n.tagName;if(i&&("INPUT"===i||"TEXTAREA"===i)){var r=e._keypressTimeout;r||e._breadcrumbEventHandler("input")(t),clearTimeout(r),e._keypressTimeout=setTimeout(function(){e._keypressTimeout=null},1e3)}}},_captureUrlChange:function(e,t){var n=_(this._location.href),i=_(t),r=_(e);this._lastHref=t,n.protocol===i.protocol&&n.host===i.host&&(t=i.relative),n.protocol===r.protocol&&n.host===r.host&&(e=r.relative),this.captureBreadcrumb({category:"navigation",data:{to:t,from:e}})},_instrumentTryCatch:function(){function e(e){return function(n,i){for(var r=new Array(arguments.length),o=0;o<r.length;++o)r[o]=arguments[o];var a=r[0];return c(a)&&(r[0]=t.wrap(a)),e.apply?e.apply(this,r):e(r[0],r[1])}}var t=this,n=t._wrappedBuiltIns,i=this._globalOptions.autoBreadcrumbs;k(window,"setTimeout",e,n),k(window,"setInterval",e,n),window.requestAnimationFrame&&k(window,"requestAnimationFrame",function(e){return function(n){return e(t.wrap(n))}},n);for(var r=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],o=0;o<r.length;o++)!function(e){var r=window[e]&&window[e].prototype;r&&r.hasOwnProperty&&r.hasOwnProperty("addEventListener")&&(k(r,"addEventListener",function(n){return function(r,o,a,s){try{o&&o.handleEvent&&(o.handleEvent=t.wrap(o.handleEvent))}catch(e){}var l;return i&&i.dom&&("EventTarget"===e||"Node"===e)&&("click"===r?l=t._breadcrumbEventHandler(r):"keypress"===r&&(l=t._keypressEventHandler())),n.call(this,r,t.wrap(o,void 0,l),a,s)}},n),k(r,"removeEventListener",function(e){return function(t,n,i,r){try{n=n&&(n.__raven_wrapper__?n.__raven_wrapper__:n)}catch(e){}return e.call(this,t,n,i,r)}},n))}(r[o]);var a=window.jQuery||window.$;a&&a.fn&&a.fn.ready&&k(a.fn,"ready",function(e){return function(n){return e.call(this,t.wrap(n))}},n)},_instrumentBreadcrumbs:function(){function e(e,n){e in n&&c(n[e])&&k(n,e,function(e){return t.wrap(e)})}var t=this,n=this._globalOptions.autoBreadcrumbs,i=t._wrappedBuiltIns;if(n.xhr&&"XMLHttpRequest"in window){var r=XMLHttpRequest.prototype;k(r,"open",function(e){return function(n,i){return S(i)&&-1===i.indexOf(t._globalKey)&&(this.__raven_xhr={method:n,url:i,status_code:null}),e.apply(this,arguments)}},i),k(r,"send",function(n){return function(i){function r(){if(o.__raven_xhr&&(1===o.readyState||4===o.readyState)){try{o.__raven_xhr.status_code=o.status}catch(e){}t.captureBreadcrumb({type:"http",category:"xhr",data:o.__raven_xhr})}}for(var o=this,a=["onload","onerror","onprogress"],s=0;s<a.length;s++)e(a[s],o);return"onreadystatechange"in o&&c(o.onreadystatechange)?k(o,"onreadystatechange",function(e){return t.wrap(e,void 0,r)}):o.onreadystatechange=r,n.apply(this,arguments)}},i)}n.dom&&this._hasDocument&&(document.addEventListener?(document.addEventListener("click",t._breadcrumbEventHandler("click"),!1),document.addEventListener("keypress",t._keypressEventHandler(),!1)):(document.attachEvent("onclick",t._breadcrumbEventHandler("click")),document.attachEvent("onkeypress",t._keypressEventHandler())));var o=window.chrome,a=o&&o.app&&o.app.runtime,s=!a&&window.history&&history.pushState;if(n.location&&s){var l=window.onpopstate;window.onpopstate=function(){var e=t._location.href;if(t._captureUrlChange(t._lastHref,e),l)return l.apply(this,arguments)},k(history,"pushState",function(e){return function(){var n=arguments.length>2?arguments[2]:void 0;return n&&t._captureUrlChange(t._lastHref,n+""),e.apply(this,arguments)}},i)}if(n.console&&"console"in window&&console.log){var u=function(e,n){t.captureBreadcrumb({message:e,level:n.level,category:"console"})};m(["debug","info","warn","error","log"],function(e,t){x(console,t,u)})}},_restoreBuiltIns:function(){for(var e;this._wrappedBuiltIns.length;){e=this._wrappedBuiltIns.shift();var t=e[0],n=e[1],i=e[2];t[n]=i}},_drainPlugins:function(){var e=this;m(this._plugins,function(t,n){var i=n[0],r=n[1];i.apply(e,[e].concat(r))})},_parseDSN:function(e){var t=I.exec(e),n={},i=7;try{for(;i--;)n[C[i]]=t[i]||""}catch(t){throw new a("Invalid DSN: "+e)}if(n.pass&&!this._globalOptions.allowSecretKey)throw new a("Do not specify your secret key in the DSN. See: http://bit.ly/raven-secret-key");return n},_getGlobalServer:function(e){var t="//"+e.host+(e.port?":"+e.port:"");return e.protocol&&(t=e.protocol+":"+t),t},_handleOnErrorStackInfo:function(){this._ignoreOnError||this._handleStackInfo.apply(this,arguments)},_handleStackInfo:function(e,t){var n=this._prepareFrames(e,t);this._triggerEvent("handle",{stackInfo:e,options:t}),this._processException(e.name,e.message,e.url,e.lineno,n,t)},_prepareFrames:function(e,t){var n=this,i=[];if(e.stack&&e.stack.length&&(m(e.stack,function(e,t){var r=n._normalizeFrame(t);r&&i.push(r)}),t&&t.trimHeadFrames))for(var r=0;r<t.trimHeadFrames&&r<i.length;r++)i[r].in_app=!1;return i=i.slice(0,this._globalOptions.stackTraceLimit)},_normalizeFrame:function(e){if(e.url){var t={filename:e.url,lineno:e.line,colno:e.column,function:e.func||"?"};return t.in_app=!(this._globalOptions.includePaths.test&&!this._globalOptions.includePaths.test(t.filename)||/(Raven|TraceKit)\./.test(t.function)||/raven\.(min\.)?js$/.test(t.filename)),t}},_processException:function(e,t,n,i,r,o){var a;if((!this._globalOptions.ignoreErrors.test||!this._globalOptions.ignoreErrors.test(t))&&(t+="",r&&r.length?(n=r[0].filename||n,r.reverse(),a={frames:r}):n&&(a={frames:[{filename:n,lineno:i,in_app:!0}]}),(!this._globalOptions.ignoreUrls.test||!this._globalOptions.ignoreUrls.test(n))&&(!this._globalOptions.whitelistUrls.test||this._globalOptions.whitelistUrls.test(n)))){var s=g({exception:{values:[{type:e,value:t,stacktrace:a}]},culprit:n},o);this._send(s)}},_trimPacket:function(e){var t=this._globalOptions.maxMessageLength;if(e.message&&(e.message=v(e.message,t)),e.exception){var n=e.exception.values[0];n.value=v(n.value,t)}return e},_getHttpData:function(){if(this._hasDocument&&document.location&&document.location.href){var e={headers:{"User-Agent":navigator.userAgent}};return e.url=document.location.href,document.referrer&&(e.headers.Referer=document.referrer),e}},_send:function(e){var t=this._globalOptions,n={project:this._globalProject,logger:t.logger,platform:"javascript"},r=this._getHttpData();r&&(n.request=r),e.trimHeadFrames&&delete e.trimHeadFrames,e=g(n,e),e.tags=g(g({},this._globalContext.tags),e.tags),e.extra=g(g({},this._globalContext.extra),e.extra),e.extra["session:duration"]=i()-this._startTime,this._breadcrumbs&&this._breadcrumbs.length>0&&(e.breadcrumbs={values:[].slice.call(this._breadcrumbs,0)}),h(e.tags)&&delete e.tags,this._globalContext.user&&(e.user=this._globalContext.user),t.environment&&(e.environment=t.environment),t.release&&(e.release=t.release),t.serverName&&(e.server_name=t.serverName),c(t.dataCallback)&&(e=t.dataCallback(e)||e),e&&!h(e)&&(c(t.shouldSendCallback)&&!t.shouldSendCallback(e)||this._sendProcessedPayload(e))},_sendProcessedPayload:function(e,t){var n=this,i=this._globalOptions;if(this._lastEventId=e.event_id||(e.event_id=y()),e=this._trimPacket(e),this._logDebug("debug","Raven about to send:",e),this.isSetup()){var r={sentry_version:"7",sentry_client:"raven-js/"+this.VERSION,sentry_key:this._globalKey};this._globalSecret&&(r.sentry_secret=this._globalSecret);var o=e.exception&&e.exception.values[0];this.captureBreadcrumb({category:"sentry",message:o?(o.type?o.type+": ":"")+o.value:e.message,event_id:e.event_id,level:e.level||"error"});var a=this._globalEndpoint;(i.transport||this._makeRequest).call(this,{url:a,auth:r,data:e,options:i,onSuccess:function(){n._triggerEvent("success",{data:e,src:a}),t&&t()},onError:function(i){n._triggerEvent("failure",{data:e,src:a}),i=i||new Error("Raven send failed (no additional details provided)"),t&&t(i)}})}},_makeRequest:function(e){function t(){200===n.status?e.onSuccess&&e.onSuccess():e.onError&&e.onError(new Error("Sentry error code: "+n.status))}var n=new XMLHttpRequest;if("withCredentials"in n||"undefined"!=typeof XDomainRequest){var i=e.url;"withCredentials"in n?n.onreadystatechange=function(){4===n.readyState&&t()}:(n=new XDomainRequest,i=i.replace(/^https?:/,""),n.onload=t),n.open("POST",i+"?"+b(e.auth)),n.send(l(e.data))}},_logDebug:function(e){this._originalConsoleMethods[e]&&this.debug&&Function.prototype.apply.call(this._originalConsoleMethods[e],this._originalConsole,[].slice.call(arguments,1))},_mergeContext:function(e,t){u(t)?delete this._globalContext[e]:this._globalContext[e]=g(this._globalContext[e]||{},t)}},r.prototype.setUser=r.prototype.setUserContext,r.prototype.setReleaseContext=r.prototype.setRelease,t.exports=r},{1:1,2:2,3:3,6:6,7:7}],5:[function(e,t,n){"use strict";var i=e(4),r=window.Raven,o=new i;o.noConflict=function(){return window.Raven=r,o},o.afterLoad(),t.exports=o},{4:4}],6:[function(e,t,n){"use strict";function i(e){return void 0===e}function r(e){return"function"==typeof e}function o(e){return"[object String]"===w.toString.call(e)}function a(e){return"object"==typeof e&&null!==e}function s(e){for(var t in e)return!1;return!0}function l(e){var t=w.toString.call(e);return a(e)&&"[object Error]"===t||"[object Exception]"===t||e instanceof Error}function c(e,t){var n,r;if(i(e.length))for(n in e)h(e,n)&&t.call(null,n,e[n]);else if(r=e.length)for(n=0;n<r;n++)t.call(null,n,e[n])}function u(e,t){return t?(c(t,function(t,n){e[t]=n}),e):e}function d(e,t){return!t||e.length<=t?e:e.substr(0,t)+""}function h(e,t){return w.hasOwnProperty.call(e,t)}function p(e){for(var t,n=[],i=0,r=e.length;i<r;i++)t=e[i],o(t)?n.push(t.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")):t&&t.source&&n.push(t.source);return new RegExp(n.join("|"),"i")}function f(e){var t=[];return c(e,function(e,n){t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))}),t.join("&")}function m(e){var t=e.match(/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!t)return{};var n=t[6]||"",i=t[8]||"";return{protocol:t[2],host:t[4],path:t[5],relative:t[5]+n+i}}function g(){var e=window.crypto||window.msCrypto;if(!i(e)&&e.getRandomValues){var t=new Uint16Array(8);e.getRandomValues(t),t[3]=4095&t[3]|16384,t[4]=16383&t[4]|32768;var n=function(e){for(var t=e.toString(16);t.length<4;)t="0"+t;return t};return n(t[0])+n(t[1])+n(t[2])+n(t[3])+n(t[4])+n(t[5])+n(t[6])+n(t[7])}return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}function v(e){for(var t,n=[],i=0,r=0,o=" > ".length;e&&i++<5&&!("html"===(t=b(e))||i>1&&r+n.length*o+t.length>=80);)n.push(t),r+=t.length,e=e.parentNode;return n.reverse().join(" > ")}function b(e){var t,n,i,r,a,s=[];if(!e||!e.tagName)return"";if(s.push(e.tagName.toLowerCase()),e.id&&s.push("#"+e.id),(t=e.className)&&o(t))for(n=t.split(" "),a=0;a<n.length;a++)s.push("."+n[a]);var l=["type","name","title","alt"];for(a=0;a<l.length;a++)i=l[a],(r=e.getAttribute(i))&&s.push("["+i+'="'+r+'"]');return s.join("")}function y(e,t,n,i){var r=e[t];e[t]=n(r),i&&i.push([e,t,r])}var w=Object.prototype;t.exports={isUndefined:i,isFunction:r,isString:o,isObject:a,isEmptyObject:s,isError:l,each:c,objectMerge:u,truncate:d,hasKey:h,joinRegExp:p,urlencode:f,uuid4:g,htmlTreeAsString:v,htmlElementAsString:b,parseUrl:m,fill:y}},{}],7:[function(e,t,n){"use strict";function i(){return"undefined"==typeof document?"":document.location.href}var r=e(6),o=r.hasKey,a=r.isString,s=r.isUndefined,l={collectWindowErrors:!0,debug:!1},c=[].slice,u="?",d=/^(?:Uncaught (?:exception: )?)?((?:Eval|Internal|Range|Reference|Syntax|Type|URI)Error): ?(.*)$/;l.report=function(){function e(e){h(),b.push(e)}function t(e){for(var t=b.length-1;t>=0;--t)b[t]===e&&b.splice(t,1)}function n(){p(),b=[]}function r(e,t){var n=null;if(!t||l.collectWindowErrors){for(var i in b)if(o(b,i))try{b[i].apply(null,[e].concat(c.call(arguments,2)))}catch(e){n=e}if(n)throw n}}function s(e,t,n,o,s){var c=null;if(_)l.computeStackTrace.augmentStackTraceWithInitialElement(_,t,n,e),f();else if(s)c=l.computeStackTrace(s),r(c,!0);else{var h,p={url:t,line:n,column:o},m=void 0,v=e;if(a(e)){var h=e.match(d);h&&(m=h[1],v=h[2])}p.func=u,c={name:m,message:v,url:i(),stack:[p]},r(c,!0)}return!!g&&g.apply(this,arguments)}function h(){v||(g=window.onerror,window.onerror=s,v=!0)}function p(){v&&(window.onerror=g,v=!1,g=void 0)}function f(){var e=_,t=y;y=null,_=null,w=null,r.apply(null,[e,!1].concat(t))}function m(e,t){var n=c.call(arguments,1);if(_){if(w===e)return;f()}var i=l.computeStackTrace(e);if(_=i,w=e,y=n,window.setTimeout(function(){w===e&&f()},i.incomplete?2e3:0),!1!==t)throw e}var g,v,b=[],y=null,w=null,_=null;return m.subscribe=e,m.unsubscribe=t,m.uninstall=n,m}(),l.computeStackTrace=function(){function e(e){if(!s(e.stack)&&e.stack){for(var t,n,r=/^\s*at (.*?) ?\(((?:file|https?|blob|chrome-extension|native|eval|<anonymous>).*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,o=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)((?:file|https?|blob|chrome|\[native).*?)(?::(\d+))?(?::(\d+))?\s*$/i,a=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:file|ms-appx|https?|blob):.*?):(\d+)(?::(\d+))?\)?\s*$/i,l=e.stack.split("\n"),c=[],d=(/^(.*) is undefined$/.exec(e.message),0),h=l.length;d<h;++d){if(t=r.exec(l[d])){var p=t[2]&&-1!==t[2].indexOf("native");n={url:p?null:t[2],func:t[1]||u,args:p?[t[2]]:[],line:t[3]?+t[3]:null,column:t[4]?+t[4]:null}}else if(t=a.exec(l[d]))n={url:t[2],func:t[1]||u,args:[],line:+t[3],column:t[4]?+t[4]:null};else{if(!(t=o.exec(l[d])))continue;n={url:t[3],func:t[1]||u,args:t[2]?t[2].split(","):[],line:t[4]?+t[4]:null,column:t[5]?+t[5]:null}}!n.func&&n.line&&(n.func=u),c.push(n)}return c.length?(c[0].column||s(e.columnNumber)||(c[0].column=e.columnNumber+1),{name:e.name,message:e.message,url:i(),stack:c}):null}}function t(e,t,n,i){var r={url:t,line:n};if(r.url&&r.line){if(e.incomplete=!1,r.func||(r.func=u),e.stack.length>0&&e.stack[0].url===r.url){if(e.stack[0].line===r.line)return!1;if(!e.stack[0].line&&e.stack[0].func===r.func)return e.stack[0].line=r.line,!1}return e.stack.unshift(r),e.partial=!0,!0}return e.incomplete=!0,!1}function n(e,o){for(var a,s,c=/function\s+([_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*)?\s*\(/i,d=[],h={},p=!1,f=n.caller;f&&!p;f=f.caller)if(f!==r&&f!==l.report){if(s={url:null,func:u,line:null,column:null},f.name?s.func=f.name:(a=c.exec(f.toString()))&&(s.func=a[1]),void 0===s.func)try{s.func=a.input.substring(0,a.input.indexOf("{"))}catch(e){}h[""+f]?p=!0:h[""+f]=!0,d.push(s)}o&&d.splice(0,o);var m={name:e.name,message:e.message,url:i(),stack:d};return t(m,e.sourceURL||e.fileName,e.line||e.lineNumber,e.message||e.description),m}function r(t,r){var o=null;r=null==r?0:+r;try{if(o=e(t))return o}catch(e){if(l.debug)throw e}try{if(o=n(t,r+1))return o}catch(e){if(l.debug)throw e}return{name:t.name,message:t.message,url:i()}}return r.augmentStackTraceWithInitialElement=t,r.computeStackTraceFromStackProp=e,r}(),t.exports=l},{6:6}]},{},[5])(5)}),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define("vendor/raven/plugins/angular",[],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t=t.Raven||(t.Raven={}),t=t.Plugins||(t.Plugins={}),t.Angular=e()}}(function(){return function e(t,n,i){function r(a,s){if(!n[a]){if(!t[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(o)return o(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[a]={exports:{}};t[a][0].call(u.exports,function(e){var n=t[a][1][e];return r(n||e)},u,u.exports,e,t,n,i)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<i.length;a++)r(i[a]);return r}({1:[function(e,t,n){"use strict";function i(e,t){function n(){this.$get=["$window",function(t){return e}]}function r(e){e.decorator("$exceptionHandler",["Raven","$delegate",o])}function o(e,t){return function(n,i){e.captureException(n,{extra:{cause:i}}),t(n,i)}}(t=t||window.angular)&&(t.module("ngRaven",[]).provider("Raven",n).config(["$provide",r]),e.setDataCallback(function(e,t){i._normalizeData(e),t&&t(e)}))}var r=/^\[((?:[$a-zA-Z0-9]+:)?(?:[$a-zA-Z0-9]+))\] (.*?)\n?(\S+)$/;i._normalizeData=function(e){var t=e.exception;if(t){t=t.values[0];var n=r.exec(t.value);n&&(t.type=n[1],t.value=n[2],e.message=t.type+": "+t.value,e.extra.angularDocs=n[3].substr(0,250))}},t.exports=i},{}]},{},[1])(1)});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/services/active-content.service",["require","exports","angular"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=__importDefault(n);var i=function(){function e(e,t){var i=this;this.clearActiveContent=function(){i.active.content&&(i.active.content.isActive=!1,i.emailBody.removeClass("content-activated"))},this.setActiveContent=function(e){i.active.content&&i.clearActiveContent(),e.isActive=!0,i.active.content=e,i.emailBody.addClass("content-activated")},this.hasActiveContent=function(){return!!i.active.content&&(i.active.content&&i.active.content.isActive||!1)},this.isDisabled=function(e){if("section"!==e.type&&"header"!==e.type&&"footer"!==e.type)return!1;if(!e.permissions)return!1;var t=i.lockLevelService.getLocks(e.permissions);return!i.emailBuilderConfig.mode.customisable&&"header"===e.type&&!t.canEditContentItems},this.lockLevelService=e,this.emailBuilderConfig=t,this.emailBody=n.default.element("#emb-js-email-body"),this.active={}}return e}();t.ActiveContentService=i}),define("ts/modules/emailbuilder/services/color.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.isDark=function(e){var t,n,i;if(e.match(/^rgb/)){var r=e.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/);t=parseInt(r[1],10),n=parseInt(r[2],10),i=parseInt(r[3],10)}else{var o=e.length<5?e.replace(/./g,"$&$&"):e,r=+("0x"+o);t=r>>16,n=r>>8&255,i=255&r}return Math.sqrt(t*t*.299+i*i*.587+n*n*.114)<172.5}}return e}();t.ColorService=n});var __assign=this&&this.__assign||function(){return __assign=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},__assign.apply(this,arguments)};define("ts/modules/emailbuilder/services/content-block.service",["require","exports","../string-utils"],function(e,t,n){"use strict";function i(e){return"isBackground"in e&&e.isBackground}Object.defineProperty(t,"__esModule",{value:!0}),t.isBackgroundImage=i;var r=function(){function e(e,t,r,o,a,s){var l=this;this.resetControlMapper={image:function(e){delete e.fileName,delete e.thirdPartyUrl,delete e.tempThirdPartyUrl,delete e.originalWidth,delete e.originalHeight,delete e.tempWidth,delete e.tempHeight,delete e.src,delete e.crop,delete e.tempAspectRatio},video:function(e){delete e.fileName,delete e.thirdPartyUrl,delete e.tempThirdPartyUrl,delete e.originalWidth,delete e.originalHeight,delete e.tempWidth,delete e.tempHeight,delete e.href,delete e.videoUrl,delete e.tempVideoUrl},header:function(e){delete e.fileName,delete e.originalWidth,delete e.originalHeight,delete e.width,delete e.height,
delete e.contents,delete e.src}},this.resetBlock=function(e){var t=l.resetControlMapper[e.type];t&&(t(e),l.modelActivityService.contentUpdated())},this.typeValidationMapper={button:function(e){var t=!n.stringIsNullOrWhitespace(e.text),i=!!e.href,r=l.linkValidationService.isValidLink(e.href,l.linkValidationService.hasValidVariable);if(t)e.tempValidation=i?r?[]:["btnInvalidLink"]:["btnNoLink"];else{var o="btnNoText";i||(o="btnNoLinkNoText"),e.tempValidation=[o]}e.tempIsValid=e.tempValidation.length>0},survey:function(e){var t=!!e.text,n=!!e.href;if(t)n||(e.tempValidation=["surveyNoLink"]);else{var i="surveyNoText";n||(i="surveyNoLinkNoText"),e.tempValidation=[i]}e.tempValidation=e.tempValidation||[],e.tempIsValid=e.tempValidation.length>0},countdown:function(e){var t=l.countdownDateService.stringToDate(e.expiryDate);null===e.expiryDate||isNaN(t.getDate())?e.tempValidation=["countdownInvalidDate"]:t<l.countdownDateService.GetMinExpiry()?e.tempValidation=["countdownExpiredDate"]:t>l.countdownDateService.GetMaxExpiry()&&(e.tempValidation=["countdownExcessDate"]),e.tempValidation=e.tempValidation||[],e.tempIsValid=e.tempValidation.length>0}},this.validateBlock=function(e){var t=l.typeValidationMapper[e.type];t&&t(e)},this.getDimensionParameter=function(e){if(i(e)&&("backgroundLayoutImage"===e.displayType||"backgroundEmailImage"===e.displayType)){var t=l.maxImageWidthService.maxBackgroundImage;return e.originalWidth<e.originalHeight?{h:t}:{w:t}}return{w:l.maxImageWidthService.maxSize()}},this.getCropParameter=function(e){return e.crop?{crop:e.crop.x+","+e.crop.y+","+(e.crop.x+e.crop.width)+","+(e.crop.y+e.crop.height)}:{}},this.getBlockSrc=function(e){if("video"===e.type)return e.thirdPartyUrl?e.thirdPartyUrl:"";if("image"===e.type&&!i(e)&&e.thirdPartyUrl)return e.thirdPartyUrl;if(e.fileName){var t=l.getDimensionParameter(e),n=l.emailBuilderConfig.email.isBlueprint,r=!i(e)&&n?l.getCropParameter(e):{},o=__assign(__assign({},t),r),a=l.$httpParamSerializer(o);return""+l.emailBuilderConfig.urls.imagePrefix+e.fileName+"?"+a}return""},this.hasBlockSrc=function(e){return!!l.getBlockSrc(e)},this.modelActivityService=e,this.linkValidationService=t,this.maxImageWidthService=r,this.emailBuilderConfig=o,this.$httpParamSerializer=a,this.countdownDateService=s}return e}();t.ContentBlockService=r});var __extends=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("ts/modules/emailbuilder/services/content-provider.service",["require","exports","../content-blocks/image-ui-state.service"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this.isActive=!1,this.tempContainer=null,this.hasSidebarEditor=!1,this.hasTemplatesDefinedForWrapper=!1,this.hasValidationMessage=!1,this.tempValidation=[],this.tempIsValid=!0,this.tempIsNew=!1,this.uiId=e.generateId("block")}return e}(),r=function(e){function t(t){var n=e.call(this,t)||this;return n.type="text",n.hasTemplatesDefinedForWrapper=!0,n.contents="",n}return __extends(t,e),t}(i);t.TextBlock=r;var o=function(e){function t(t){var n=e.call(this,t)||this;return n.hasSidebarEditor=!0,n.hasTemplatesDefinedForWrapper=!0,n.isFullWidth=!0,n.alt="",n.fileName="",n.halign="center",n.href="",n.content="Upload Image",n.originalWidth=0,n.originalHeight=0,n}return __extends(t,e),t}(i),a=function(e){function t(t){var i=e.call(this,t)||this;return i.type="image",i.thirdPartyUrl="",i.src="",i.displayWidth=0,i.state=new n.UiState(n.UiStateValues.Initial),i}return __extends(t,e),t}(o),s=function(e){function t(t){var n=e.call(this,t)||this;return n.type="spacer",n.hasValidationMessage=!1,n.height=20,n}return __extends(t,e),t}(i),l=function(e){function t(t){var n=e.call(this,t)||this;return n.type="divider",n}return __extends(t,e),t}(i),c=function(e){function t(t){var n=e.call(this,t)||this;return n.hasSidebarEditor=!0,n.hasValidationMessage=!0,n.text="Button",n.href="",n.tempHref="",n.halign="",n.tempValidation=[],n.tempIsValid=!0,n.tempIsNew=!0,n.lines=["Button"],n.backgroundColor="",n.borderRadius="4px",n.buttonStyleAppearance="flat",n.buttonSize="large",n.color="",n}return __extends(t,e),t}(i),u=function(e){function t(t){var n=e.call(this,t)||this;return n.type="button",n}return __extends(t,e),t}(c);t.ButtonBlock=u;var d=function(e){function t(t){var n=e.call(this,t)||this;return n.type="survey",n.text="Get started",n.surveyId="",n.surveyTitle="",n}return __extends(t,e),t}(c),h=function(e){function t(t){var n=e.call(this,t)||this;return n.type="readonlytext",n.hasSidebarEditor=!0,n.previewText="",n.actualText="",n.editableText="",n}return __extends(t,e),t}(i),p=function(e){function t(t){var n=e.call(this,t)||this;return n.type="video",n.hasSidebarEditor=!0,n.hasTemplatesDefinedForWrapper=!0,n.hasValidationMessage=!1,n.content="Select Video",n.videoUrl="",n.videoProvider="vimeo",n.validVideoSelected=!1,n.thirdPartyUrl="",n.tempHref="",n.src="",n}return __extends(t,e),t}(o),f=function(e){function t(t){var n=e.call(this,t)||this;return n.type="code",n.hasSidebarEditor=!0,n.hasTemplatesDefinedForWrapper=!0,n.contents=["\x3c!--","This code block accepts a subset of HTML, inline CSS, and Liquid code. See the developer reference for full capability and syntax:","","https://www.campaignmonitor.com/resources/guides/how-to-use-behavioral-code-block-for-developers/","","<script>, <style>, and personalization tags will be removed.","--\x3e"].join("\n"),n}return __extends(t,e),t}(i);t.CodeBlock=f;var m=function(e){function t(t,n){var i=e.call(this,t)||this;return i.expiryDate="",i.useDarkText=!1,i.type="countdown",i.hasSidebarEditor=!0,i.hasValidationMessage=!0,i.tempValidation=[],i.tempIsValid=!0,i.tempIsNew=!0,i.id=n.generateId(),i}return __extends(t,e),t}(i);t.CountdownBlock=m;var g=function(){function e(e){var t=this;this.provide=function(){return new r(t.uiIdService)},this.uiIdService=e}return e}(),v=function(){function e(e){var t=this;this.provide=function(){return new a(t.uiIdService)},this.uiIdService=e}return e}(),b=function(){function e(e){var t=this;this.provide=function(){return new s(t.uiIdService)},this.uiIdService=e}return e}(),y=function(){function e(e){var t=this;this.provide=function(){return new l(t.uiIdService)},this.uiIdService=e}return e}(),w=function(){function e(e,t){var n=this;this.provide=function(){var e=new u(n.uiIdService);return n.nextButtonStyleService.applyNextButtonStyle(e),e},this.uiIdService=e,this.nextButtonStyleService=t}return e}(),_=function(){function e(e){var t=this;this.provide=function(){return new d(t.uiIdService)},this.uiIdService=e}return e}(),S=function(){function e(e){var t=this;this.provide=function(){return new h(t.uiIdService)},this.uiIdService=e}return e}(),k=function(){function e(e){var t=this;this.provide=function(){return new p(t.uiIdService)},this.uiIdService=e}return e}(),x=function(){function e(e){var t=this;this.provide=function(){return new f(t.uiIdService)},this.uiIdService=e}return e}(),C=function(){function e(e,t){var n=this;this.provide=function(){return new m(n.uiIdService,n.contentBlockIdService)},this.uiIdService=e,this.contentBlockIdService=t}return e}(),I=function(){function e(e,t,n){var i=this;this.getProviderFor=function(e){return i.providers[e]},this.providers={text:new g(e),image:new v(e),spacer:new b(e),divider:new y(e),button:new w(e,t),survey:new _(e),video:new k(e),code:new x(e),readonlytext:new S(e),countdown:new C(e,n)}}return e}();t.ContentProviderService=I}),define("ts/modules/emailbuilder/services/content-version.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){var e=this;this.builderSessionId=Date.now(),this.versionId=0,this.incrementVersion=function(){return e.versionId+=1,e.builderSessionId+"_"+e.versionId}}return e}();t.ContentVersionService=n});var __assign=this&&this.__assign||function(){return __assign=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},__assign.apply(this,arguments)},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/services/email.service",["require","exports","config","angular","../constants"],function(e,t,n,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=__importDefault(i);var o=function(){function e(){this.section=!1,this.content=!1}return e}(),a=function(){function e(e,t,a,s,l,c,u,d,h,p,f){var m=this;this.insertBefore=null,this.isDesignSection=function(e){return e.hasOwnProperty("usingSection")},this.addSection=function(e){var t,n=m.isDesignSection(e)?m.availableSectionSelectorService.fromID(e.usingSection):e,i=m.addStandardSection(n),r=null;return m.isDesignSection(e)&&(t=m.model.sections.indexOf(i),e.content.forEach(function(e,n){var o=i.content[n];o.content=m.formatDesignedContent(e,t,i.id,n),m.dropzoneHasPadding(o),r||(r=o.content[0])}),r&&m.activeContentService.setActiveContent(r)),m.$timeout(function(){m.modelActivityService.sectionAdded()}),i},this.reorderSection=function(e,t){var i=m.model.sections,r=m,o=i.splice(e,1)[0];i.splice(t,0,o),n.sectionBorderEnabled&&m.sectionIdService.updateAfterMoving(o,m.model.sections,e,t),m.updateAllContainers(),m.$timeout(function(){r.modelActivityService.sectionMoved()})},this.removeSection=function(e){var t=m.activeContentService,n=m;t.active.content&&t.clearActiveContent(),m.sectionIdService.updateTopBorderForNextSectionAfterRemoving(e,m.model.sections),m.removeItem(m.model.sections,e),m.updateAllContainers(),m.$timeout(function(){n.modelActivityService.sectionRemoved()})},this.duplicateSection=function(e){var t=m.model.sections.indexOf(e),n=m,r=i.default.copy(e);r.uiId=m.uiIdService.generateId("section_options"),m.contentBlockIdService.refreshBlockIdsForSection(r),m.model.sections.splice(t+1,0,r),r.content.forEach(function(e){e.uiId=m.uiIdService.generateId("dropzone"),e.content.forEach(function(e){e.uiId=m.uiIdService.generateId("block")})}),m.updateAllContainers(),m.updateSortability(),m.$timeout(function(){n.modelActivityService.sectionDuplicated()})},this.setUsedDynamicContent=function(){if(!m.model.usedDynamicContent){var e=m;m.model.usedDynamicContent=!0,m.$timeout(function(){e.modelActivityService.dynamicContentUsed()})}},this.setInsertBefore=function(e){void 0===e&&(e=null),m.insertBefore=e||null},this.setContentTarget=function(e){m.contentTarget=e},this.dropzoneHasPadding=function(e){var t=!!e.content,n=t?e.content[0]:void 0,i=!1;if(n)if("image"===n.type||"video"===n.type){var r=n;i=!r.isFullWidth}else i=!0;e.tempHasPadding=i},this.addContent=function(e){var t=m.contentTarget||m.getContentTarget(),n=m.contentProviderService.getProviderFor(e),i=n.provide(),r=m.model.sections[t.sectionIndex],o=r.content[t.columnIndex],a=m;return m.lockLevelService.getLocks(r.permissions).dragAndDropLocked?(m.insertBefore=null,m.contentTarget=null,null):(i.tempContainer={sectionID:r.id,sectionIndex:t.sectionIndex,columnIndex:t.columnIndex},m.addItem(o.content,m.insertBefore,i),m.dropzoneHasPadding(o),m.insertBefore=null,m.contentTarget=null,m.updateSortability(),m.$timeout(function(){a.modelActivityService.contentAdded(e)}),i)},this.removeContent=function(e,t){var n=m.model.sections[e.sectionIndex].content[e.columnIndex],i=m;m.removeItem(n.content,t),m.dropzoneHasPadding(n),m.$timeout(function(){i.modelActivityService.contentRemoved()})},this.moveContent=function(e,t,n,i){if(i){var r=m.model.sections[i.sectionIndex];if(m.lockLevelService.getLocks(r.permissions).dragAndDropLocked)return null}var o,a,s,l=m.model.sections[e.sectionIndex].content[e.columnIndex],c=l.content,u=c.splice(t,1)[0];return i?(o=m.model.sections[i.sectionIndex].content[i.columnIndex],a=m.model.sections[i.sectionIndex],s=a.content[i.columnIndex].content,u.tempContainer={sectionID:a.id,sectionIndex:i.sectionIndex,columnIndex:i.columnIndex}):s=c,s.splice(n,0,u),o&&m.dropzoneHasPadding(o),m.dropzoneHasPadding(l),m.$timeout(function(){m.modelActivityService.contentMoved()}),u},this.isThereAMissingBackground=function(){var e=function(e){return e.hasMissingBackground};return m.model.sections.filter(e)[0]},this.blockIsCodeBlock=function(e){return"code"===e.type},this.dropzoneContainsCodeBlock=function(e){return e.content.some(m.blockIsCodeBlock)},this.sectionContainsCodeBlock=function(e){return e.content.some(m.dropzoneContainsCodeBlock)},this.hasCodeBlock=function(){return m.model.sections.some(m.sectionContainsCodeBlock)},this.updateSortability=function(){var e=m.model.sections.length>1,t=m.model.sections[0],n=t&&t.content.length>1,i=t&&t.content[0].content.length>1;m.sortability.section=e,m.sortability.content=e||n||i},this.checkFirstRun=function(){if(n.isFirstRun&&!m.model.sections.length&&!n.mode.templateWithContent){m.addContent("text").contents=n.onBoardText}},this.formatDesignedContent=function(e,t,n,r){var o=[];return e.forEach(function(e){var a=i.default.copy(e),s=m.contentProviderService.getProviderFor(a.type),l=s.provide();for(var c in l)a.hasOwnProperty(c)&&null!==a[c]||(a[c]=l[c]);"text"===a.type&&(a.contents||(a.contents=l.contents)),a.tempContainer={sectionID:n,sectionIndex:t,columnIndex:r},o.push(a)}),o},this.addStandardSection=function(e){var t=e.dropzones.map(function(e){return __assign(__assign({},e),{content:[],isHighlighted:!1,tempHasPadding:!1,uiId:m.uiIdService.generateId("dropzone")})}),n={id:e.id,uiId:m.uiIdService.generateId("section_options"),content:t,type:"section",isActive:!1,permissions:{lockLevel:"none"},style:m.styleFactoryService.addBackgroundLayoutStyle(),settings:{verticalSpacing:20},bordered:-1!==e.id.indexOf("border"),hideSectionSettings:!1,hasMissingBackground:!1,readOnly:!1,lists:null,segments:null,cssClasses:[],subType:void 0,isReverseStacked:!1};return m.addItem(m.model.sections,m.insertBefore,n),m.insertBefore=null,m.updateSortability(),n},this.addItem=function(e,t,n){if(t){var i=e.indexOf(t);e.splice(i,0,n)}else e.push(n)},this.getContentTarget=function(){var e,t=m.model.sections,i=!1;if(n.canvasSectionPermissions&&t.length>0){i=m.lockLevelService.getLocks(t[t.length-1].permissions).dragAndDropLocked}return t.length&&!i||(e=n.template.sections.filter(function(e){return 1===e.dropzones.length}),m.addSection(e[0])),{sectionID:"",sectionIndex:t.length-1,columnIndex:0}},this.removeItem=function(e,t){e.splice(e.indexOf(t),1),m.updateSortability()},this.processLoadedModel=function(e){e.header=e.header||{type:"header",displayType:"image",href:"",src:"",fileName:""},e.footer=e.footer||{type:"footer"},e.spacing=e.spacing||{verticalSpacing:2,isDefined:!1},e.language=e.language||r.FALLBACK_LANGUAGE,e.sections=e.sections||[],e.social=e.social||{tweet:{on:!0},fblike:{on:!0,type:"Like this email"},webversion:{on:!0},forwardtoafriend:{on:!0},preferences:{on:!0}},e.webLinks=e.webLinks||{facebook:{On:!0,Href:null},twitter:{On:!0,Href:null},youtube:{On:!0,Href:null},instagram:{On:!0,Href:null},linkedin:{On:!0,Href:null},website:{On:!0,Href:null},pinterest:{On:!0,Href:null}},n.templateBadge?e.templateBadge&&void 0!==e.templateBadge.displayBadge&&null!==e.templateBadge.displayBadge||(e.templateBadge||(e.templateBadge={}),e.templateBadge.displayBadge=!0):e.templateBadge=null;var t=0;return e.header.fileName&&(e.header.src=n.urls.imagePrefix+e.header.fileName),e.sections.forEach(function(e){var n=e,i=n.id;n.uiId=m.uiIdService.generateId("section_options"),n.style=m.styleFactoryService.addBackgroundLayoutStyle(n.style),n.type="section",n.isActive=!1,n.bordered=-1!==n.id.indexOf("border"),n.content.forEach(function(e,n){m.dropzoneHasPadding(e),e.uiId=m.uiIdService.generateId("dropzone"),e.content.forEach(function(e){var r=m.contentProviderService.getProviderFor(e.type),o=r.provide();"text"===e.type&&(e.contents||(e.contents=o.contents)),e.hasTemplatesDefinedForWrapper=o.hasTemplatesDefinedForWrapper,e.hasValidationMessage=o.hasValidationMessage,e.hasSidebarEditor=o.hasSidebarEditor,e.uiId=o.uiId,e.tempContainer={sectionID:i,sectionIndex:t,columnIndex:n},m.contentBlockService.validateBlock(e)})}),t++}),e},this.updateAllContainers=function(){m.model.sections.forEach(function(e,t){e.content.forEach(function(n,i){n.content.forEach(function(n){n.tempContainer={sectionID:e.id,sectionIndex:t,columnIndex:i}})})})},this.contentProviderService=e,this.activeContentService=a,this.availableSectionSelectorService=s,this.modelActivityService=t,this.sortability=new o,this.$timeout=l,this.styleFactoryService=c,this.sectionIdService=u,this.lockLevelService=d,this.contentBlockService=h,this.contentBlockIdService=p,this.uiIdService=f,this.contentTarget=null,this.model=this.processLoadedModel(n.email),this.checkFirstRun(),this.updateSortability()}return e}();t.EmailService=a}),define("ts/modules/emailbuilder/services/lock-level.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.dragAndDropLocked=!1,this.anyLocking=!1,this.canDeleteContentItems=!0,this.canEditContentItems=!0,this.restrictedTextStyles=!1,this.canEditContentItemStyles=!0}return e}(),i=function(){function e(e,t){var i=this;this.getLocks=function(e){var t=new n;return i.emailBuilderConfig.canvasSectionPermissions?("none"!==e.lockLevel&&(i.encounteredLocking=!0),"full"===e.lockLevel&&(t.canEditContentItems=!1),"full"!==e.lockLevel&&"partial"!==e.lockLevel&&"partial-removable"!==e.lockLevel||(t.dragAndDropLocked=!0,t.anyLocking=!0,t.restrictedTextStyles=!0,t.canEditContentItemStyles=!1,t.canDeleteContentItems=!1),t):t},this.permissionsChanged=function(e,t){i.rootScope.$broadcast("permissionsChanged:"+e,t),e.length>6&&"section"===e.substring(0,7)&&i.rootScope.$broadcast("permissionsChanged:any-section",t)},this.anyLocking=function(){return i.encounteredLocking},this.rootScope=e,this.emailBuilderConfig=t,this.encounteredLocking=!1}return e}();t.LockLevelService=i}),define("ts/modules/emailbuilder/services/max-image-width.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){var n=this;this.maxSize=function(){return n.$window.retina||n.$window.devicePixelRatio>1?1.5*n.largestDropzoneWidth:n.largestDropzoneWidth},this.maxContainerSize=function(){return n.largestDropzoneWidth},this.maxBackgroundImage=3200,this.$window=e,this.largestDropzoneWidth=t.template.sections.reduce(function(e,t){return t.dropzones.reduce(function(e,t){return Math.max(e,t.width)},e)},0)}return e}();t.MaxImageWidthService=n});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/services/model-activity.service",["require","exports","postal"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=__importDefault(n);var i=function(){function e(){var e=this;this.contentUpdated=function(){e.chan.publish("content.updated")},this.contentAdded=function(t){e.chan.publish("content.added",t)},this.contentRemoved=function(){e.chan.publish("content.removed")},this.contentMoved=function(){e.chan.publish("content.moved")},this.sectionMoved=function(){e.chan.publish("section.moved")},this.sectionAdded=function(){e.chan.publish("section.added")},this.sectionRemoved=function(){e.chan.publish("section.removed")},this.sectionDuplicated=function(){e.chan.publish("section.duplicated")},this.sectionPropertyChanged=function(){e.chan.publish("section.propertyChanged")},this.dynamicContentUsed=function(){e.chan.publish("internal.dynamicContentUsed")},this.subscribe=function(t,n){return e.chan.subscribe(t,n)},this.chan=n.default.channel("embModelActivity")}return e}();t.ModelActivityService=i}),define("ts/modules/emailbuilder/services/model-validation.service",["require","exports"],function(e,t){"use strict";function n(e,t,n){switch(e.type){case"text":var i=/(<([^>]+)>)/gi;return!(!e||!e.contents||""===e.contents.replace(i,""));case"image":return e&&t.hasBlockSrc(e);case"button":return e&&""!==e.href&&n.isValidLink(e.href);case"video":return e&&t.hasBlockSrc(e);case"spacer":case"divider":case"code":return!0}}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this.contentType=""}return e}(),r=function(){function e(){this.missingTypes=[],this.validationItems=[]}return e}();t.ValidationResult=r;var o=function(){function e(e,t,o,a){var s=this;this.isValidModel=function(e,t){var o=new r;return s.emailBuilderConfig.canvasSectionPermissions?(e.forEach(function(e){var r=s.lockLevelService.getLocks(e.permissions);(t&&!r.canEditContentItems||!t&&r.anyLocking)&&e.content.forEach(function(e){e.content.forEach(function(e){if(!n(e,s.contentBlockService,s.linkValidationService)){var t=new i;t.contentType=e.type,o.validationItems.push(t),-1===o.missingTypes.indexOf(e.type)&&o.missingTypes.push(e.type)}})})}),o):o},this.isValidFooter=function(e){var t=new r;if(!s.emailBuilderConfig.canvasSectionPermissions)return t;if(s.lockLevelService.getLocks(e.footer.permissions).anyLocking){for(var n in e.webLinks)if(e.webLinks.hasOwnProperty(n)){var i=e.webLinks[n];if(i.on&&!i.href){t.missingTypes.push("webLinks");break}}e.editableText.address.isPlaceholder&&t.missingTypes.push("address"),!e.editableText.permission.isDisabled&&e.editableText.permission.isPlaceholder&&t.missingTypes.push("permission")}return t},this.lockLevelService=e,this.contentBlockService=t,this.emailBuilderConfig=o,this.linkValidationService=a}return e}();t.ModelValidationService=o}),define("ts/modules/emailbuilder/services/notification.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n){var i=this;this.getNotifications=function(){var e={params:{hasLocking:i.lockingLevelSvc.anyLocking()}},t=function(e){var t=[];return e&&e.data&&Array.isArray(e.data)&&e.data.length>0&&(t=e.data.map(function(e){return{id:e.NotificationId,heading:e.Heading,image:e.Image,description:e.Description,openByDefault:e.OpenByDefault,read:!1}})),t};return i.$http.get(i.emailBuilderConfig.urls.notifications.getLatestUrl,e).then(t)},this.markNotificationAsRead=function(e){return i.$http.post(i.emailBuilderConfig.urls.notifications.markAsReadUrl,{notificationId:e})},this.markNotificationAsOpened=function(e){return i.$http.post(i.emailBuilderConfig.urls.notifications.markAsOpenedUrl,{notificationId:e})},this.$http=e,this.lockingLevelSvc=t,this.emailBuilderConfig=n}return e}();t.NotificationService=n}),define("ts/modules/emailbuilder/services/personalisation.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.replaceWithFallback=function(e){if(!e)return e;var t=/\[(.+?)\]/g,n=/[^\[\]]*\[[^,\[\]]*,\s*fallback\s*=([^\[\]]*)?\]+[^\[\]]*/,i=function(e){var t=n.exec(e);return t&&t.length>1?t[1]:e};return e.replace(t,i)}}return e}();t.PersonalisationService=n}),define("ts/modules/emailbuilder/services/preload-image.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){var t=this;this.load=function(e){t.preload(t.emailBuilderConfig.urls.staticResourceBase,e)},this.preload=function(e,t){t.forEach(function(t){(new Image).src=e+"/"+t})},this.emailBuilderConfig=e}return e}();t.PreloadImageService=n}),define("ts/modules/emailbuilder/services/preview-html.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n){var i=this;this.get=function(e,t){var n=i.$q.defer(),r={cache:Date.now(),forMobile:!1};return e&&(r.forMobile=!0),{html:i.$h({timeout:n.promise,method:"POST",url:i.emailBuilderConfig.urls.preview,params:r,data:t}),abort:function(){n.resolve()}}},this.$h=e,this.$q=t,this.emailBuilderConfig=n}return e}();t.PreviewHtmlService=n}),define("ts/modules/emailbuilder/services/raven.service",["require","exports","vendor/raven/raven"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){var i=this;this.configureSentry=function(){i.emailBuilderConfig.canvasSentryMonitoring&&i.$document.ajaxError(function(e,t,i,r){n.captureMessage(r||t.statusText,{extra:{type:i.type,url:i.url,data:i.data,status:t.status,error:r||t.statusText,response:t.responseText.substring(0,100)}})})},this.$document=e,this.emailBuilderConfig=t}return e}();t.RavenService=i}),define("ts/modules/emailbuilder/services/recent-color.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=8,i=function(){function e(e,t,i){var r=this;this.getRecentColors=function(){return r.recentColors},this.getColorsFromConfig=function(){var e=[];return e.unshift(r.emailBuilderConfig.email.styles.h3.color),e.unshift(r.emailBuilderConfig.email.styles.h2.color),e.unshift(r.emailBuilderConfig.email.styles.button.backgroundColor),e.unshift(r.emailBuilderConfig.email.styles.headerAndFooter.color),e.unshift(r.emailBuilderConfig.email.styles.link.color),e.unshift(r.emailBuilderConfig.email.styles.button.color),e.unshift(r.emailBuilderConfig.email.styles.p.color),e.unshift(r.emailBuilderConfig.email.styles.h1.color),e.unshift(r.emailBuilderConfig.email.styles.body.backgroundColor),"text"===r.emailBuilderConfig.email.header.displayType&&e.unshift(r.emailBuilderConfig.email.styles.logo.color),e},this.getRecentColorsFromServer=function(){var e=function(e){e&&e.data&&e.data.RecentColors&&null!==e.data.RecentColors&&(r.recentColors=e.data.RecentColors),r.$rootScope.$broadcast("recentColors:loaded")};r.$http.get(r.emailBuilderConfig.urls.getRecentColors).then(e)},this.addRecentColor=function(e){if(null!==e){var t=e.replace("#","");-1===r.recentColors.indexOf(t)&&r.checkValidColor(t)&&(r.addColor(t),r.$rootScope.$broadcast("recentColors:loaded"))}},this.addColor=function(e){r.recentColors.length>=n&&(r.recentColors=r.recentColors.slice(0,n-1)),r.recentColors.unshift(e),r.saveColors(r.recentColors)},this.saveColors=function(e){var t={method:"POST",url:r.emailBuilderConfig.urls.saveRecentColors,headers:{"Content-Type":"application/json"},data:{RecentColors:e}};r.$http(t)},this.checkValidColor=function(e){return/#?([\da-fA-F]{6})|#([\d|a-f|A-F]){3}/i.test(e)},this.$rootScope=e,this.$http=t,this.emailBuilderConfig=i,this.recentColors=this.getColorsFromConfig(),this.emailBuilderConfig.mode.publicCanvas||this.getRecentColorsFromServer()}return e}();t.RecentColorService=i});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/services/save.service",["require","exports","postal","underscore","./analytics.service"],function(e,t,n,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=__importDefault(n),i=__importDefault(i);var o=function(){function e(e,t,o,a,s,l,c,u,d,h,p,f){var m=this;this.isDirty=!1,this.isSaving=!1,this.hasEditedContentTracked=!1,this.currentTaskId="",this.generationErrors=null,this.startPollingGeneration=function(){var e=m.currentGenerationTimeout,t=m.currentGenerationCancellation;e&&clearTimeout(e),t&&t.resolve(),m.pollGeneration(null)},this.pollGeneration=function(e){var t=m.currentTaskId;if(!e||e===t){m.channel.publish("generating");var n=[m.emailBuilderConfig.urls.status,"/",t];m.currentGenerationCancellation=m.$q.defer(),m.$http({timeout:m.currentGenerationCancellation.promise,method:"GET",url:n.join("")}).then(function(e){"inprogress"===e.data.Status?m.currentGenerationTimeout=window.setTimeout(function(){m.pollGeneration(t)},300):"failed"===e.data.Status?(m.generationErrors=e.data.Errors,m.channel.publish("failed")):(m.currentTaskId=e.data.Data,m.channel.publish("generated"))}).catch(function(){})}},this.jsonCensor=function(e,t){switch(e){case"$$hashKey":case"isActive":case"uiId":return}if(!("string"==typeof e&&e.toLowerCase().indexOf("href")>-1&&t&&"string"==typeof t&&t.match(/^[""]?data:.*;base64/)||e.substring&&"temp"===e.substring(0,4)&&"template"!==e.substring(0,8)))return t},this.save=function(e,t){m.isDirty&&(m.delayedSaveTimeout&&(clearTimeout(m.delayedSaveTimeout),m.delayedSaveTimeout=0),m.isDirty=!1,m.isSaving=!0,m.currentTaskId=Date.now().toString(),t||m.channel.publish("saving"),m.emailService.model.contentVersionId=m.contentVersionService.incrementVersion(),m.$http({method:"post",url:e||m.emailBuilderConfig.urls.save,data:{name:m.templateNameService.name,data:JSON.stringify(m.emailService.model,m.jsonCensor),taskId:m.currentTaskId},headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},transformRequest:function(e){return $.param(e)}}).then(function(e){m.isSaving=!1,e.data.redirectTo&&(m.channel.publish("redirect"),m.$window.location.href=e.data.redirectTo),m.startPollingGeneration(),t||m.channel.publish("saved"),m.hasEditedContentTracked||m.emailBuilderConfig.mode.newTemplate||(m.analyticsService.trackClientLevel({eventName:r.AnalyticsEventName.EditedContent,dragAndDropPropertyKey:"Email Source"}),m.hasEditedContentTracked=!0)}).catch(function(){m.isDirty=!1,m.isSaving=!1,t||m.channel.publish("failed")}))},this.saveTemplate=function(){m.isDirty=!0,m.save(m.emailBuilderConfig.urls.saveTemplate,!1)},this.subscribe=function(e,t){return m.channel.subscribe(e,t)},this.poll=function(e){m.currentTaskId=e,m.startPollingGeneration()},this.logFinishAndSave=function(){m.$http.post(m.emailBuilderConfig.urls.logFinishAndSave,null)},this.forceSaveCampaign=function(){m.isDirty=!0,m.save(null,!1)},this.saveCampaign=function(){m.save(null,!1)},this.getSaveErrors=function(){return m.generationErrors?[m.generationErrors]:[]};var g=function(){m.save(null,!1)},v=i.default.debounce(g,7e3),b=function(){m.save(null,!0)};this.contentVersionService=o,this.emailBuilderConfig=u,this.analyticsService=d,this.undoService=h,this.channel=n.default.channel("embSaving"),this.templateNameService=e,this.emailService=t,this.$http=s,this.$q=l,this.$window=c,this.delayedSaveTimeout=0,this.currentGenerationTimeout=0,this.currentGenerationCancellation=null;var y=i.default.debounce(function(){f.$apply(function(){m.undoService.trackChanges(m.emailService.model)})},50),w=function(){m.isDirty=!0,y(),v(),m.delayedSaveTimeout||(m.delayedSaveTimeout=i.default.delay(g,2e4))};a.subscribe("content.#",w),a.subscribe("section.#",w),a.subscribe("internal.#",function(){m.isDirty=!0,b()}),p(w,0)}return e}();t.SaveService=o}),define("ts/modules/emailbuilder/services/analytics.validation.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){var t=this;this.setEventShouldHaveIdPropertyKey=function(){return!t.config.mode.templateWithContent||!t.templateIsNew()},this.templateIsNew=function(){return!!t.config.mode.newTemplate&&!t.config.template.savedName},this.config=e,this.eventShouldHaveIdPropertyKey=this.setEventShouldHaveIdPropertyKey()}return e}();t.AnalyticsValidationService=n}),define("ts/modules/emailbuilder/services/tracking-snapshot-compare.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){var t=this;this.compareObjectPropertiesWithTrackingValueMap=function(e,n,i){var r=[];return Object.keys(e).forEach(function(o){t.emailModelComparisonService.ObjectsAreEqual(e[o],n[o])||i.hasOwnProperty(o)&&r.push(i[o])}),r},this.emailModelComparisonService=e}return e}();t.TrackingSnapshotCompareService=n});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}}
;define("ts/modules/emailbuilder/services/view-port.service",["require","exports","angular","postal"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=__importDefault(n),i=__importDefault(i);var r=function(){function e(e,t){var r=this;this.isOffScreen=function(e){return r.$w.scrollTop()>=e.offset().top-r.editorHeader.height()&&-e.offset().top-e.outerHeight()<=0},this.getScrollToPosition=function(e,t){var i=n.default.element(e),o=i.offset().top,a=i.height(),s=r.stage.height(),l=t.threshold||0,c=o+a-s-l;return{screenPos:c,scrollTo:c+r.stage.scrollTop()}},this.isIgnoringContentDrop=function(e,t){var n=r.$document.find("#emb-js-sidebar"),i=n.offset();return e>i.left&&t>i.top&&e<i.left+n.width()&&t<i.top+n.height()},this.scrollStage=function(e){r.chan.publish("scrollEmailContainer",e)},this.subscribe=function(e,t){return r.chan.subscribe(e,t)},this.scrollElementToTop=function(e){var t=n.default.element(e),i=t.offset().top-r.editorHeader.height();r.scrollStage({offset:i,relative:!0})},this.ensureElementInViewPort=function(e){var t=r.getScrollToPosition(e,{threshold:r.editorHeader.height()});t.screenPos+80>0&&r.scrollStage({offset:t.scrollTo+80})},this.getElementTopRelativeToEmail=function(e){return r.stage.scrollTop()+e.offset().top},this.chan=i.default.channel("embStageScrolling"),this.$w=n.default.element(e),this.stage=t.find("#emb-js-email-body"),this.editorHeader=t.find("#emb-js-editor-header"),this.$document=t}return e}();t.ViewPortService=r}),define("ts/modules/emailbuilder/services/crop-area-calculator.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=1,i=1,r=100,o=8,a=function(){function e(){this.getCropContainerDimensions=function(e,t){var a=Math.min(r,e.width/o),s=Math.min(r,e.height/o),l=e.width,c=e.height,u=t.originalWidth,d=t.originalHeight,h=t.originalWidth/t.originalHeight;return h>l/c?t.originalWidth>l-a&&(u=l-a,d=u/h):t.originalHeight>c-s&&(d=c-s,u=d*h),{width:Math.max(n,u),height:Math.max(i,d)}}}return e}();t.CropAreaCalculatorService=a}),define("ts/modules/emailbuilder/services/file-extension.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.getFileExtension=function(e){var t=e&&e.split("."),n=t[t.length-1].toLowerCase();return"jpeg"===n&&(n="jpg"),n.toLowerCase()}}return e}();t.FileExtensionService=n});var __assign=this&&this.__assign||function(){return __assign=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},__assign.apply(this,arguments)};define("ts/modules/emailbuilder/services/model-activity-tracker.service",["require","exports","./analytics.service","./content-block.service"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.Method=e}return e}(),o={countdown:"Countdown Timer"},a={text:"Text",button:"Button",image:"Image",video:"Video",countdown:"Countdown Timer",spacer:"Spacer",divider:"Divider",survey:"Survey",code:"Code",section:"Section",logo:"Logo",globalStyles:"Global Styling",viewInBrowser:"View Email In Browser",header:"Header",footer:"Footer",preheader:"Preheader Text",language:"Language"},s=function(){function e(e,t,s){var l=this;this.configureActivityTracking=function(){l.modelActivityService.subscribe("section.removed",function(){var e={eventName:n.AnalyticsEventName.DeletedSection};l.analyticsService.trackClientLevel(e)}),l.modelActivityService.subscribe("content.added",function(e){var t=o[e];if(t){var i={eventName:n.AnalyticsEventName.AddedContent,publicProperties:{"Content Type":t}};l.analyticsService.trackClientLevel(i)}}),l.$rootScope.$on("upload:end",function(e,t){l.trackImageAdded(t.block,new r("Upload"))}),l.$rootScope.$on("thirdPartyImage:success",function(e,t){if(t.isUploadAction){var n=new r("URL");n.URL=t.block.thirdPartyUrl,l.trackImageAdded(t.block,n)}}),l.$rootScope.$on("undo:modelChanged",function(e,t){var i="undo"===t.type?n.AnalyticsEventName.Undid:n.AnalyticsEventName.Redid,r={eventName:i};null!==t.componentType&&a[t.componentType]&&(r.publicProperties={"Content Type":a[t.componentType]}),l.analyticsService.trackClientLevel(r)}),l.subscribeToPermissionsChanged()},this.trackImageAdded=function(e,t){var i=l.getImageType(e),r={eventName:n.AnalyticsEventName.AddedContent,publicProperties:__assign(__assign({"Content Type":"Image"},t),{"Image Type":i})};l.analyticsService.trackClientLevel(r)},this.getImageType=function(e){return"header"===e.type?"Logo":i.isBackgroundImage(e)?"Background":"Email Content"},this.subscribeToPermissionsChanged=function(){l.$rootScope.$on("permissionsChanged:header",function(e,t){l.trackPermissionsChangedAnalytics("Header",t)}),l.$rootScope.$on("permissionsChanged:footer",function(e,t){l.trackPermissionsChangedAnalytics("Footer",t)}),l.$rootScope.$on("permissionsChanged:any-section",function(e,t){l.trackPermissionsChangedAnalytics("Regular",t)})},this.trackPermissionsChangedAnalytics=function(e,t){l.analyticsService.trackClientLevel({eventName:n.AnalyticsEventName.LockedSection,publicProperties:{"Lock Type":l.analyticsService.getLockTypeUsedByAnalytics(t.lockLevel),"Section Locked":e}})},this.analyticsService=e,this.modelActivityService=t,this.$rootScope=s}return e}();t.ModelActivityTrackerService=s}),define("ts/modules/emailbuilder/services/content-block-id.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){var e=this;this.lastGeneratedId=0,this.generateId=function(){var t=(new Date).getTime();return t<=e.lastGeneratedId&&(t=e.lastGeneratedId+1),e.lastGeneratedId=t,t.toString()},this.refreshBlockIdsForSection=function(t){t.content.forEach(function(t){t.content.forEach(function(t){"countdown"===t.type&&(t.id=e.generateId())})})}}return e}();t.ContentBlockIdService=n}),define("vendor/empty",function(){}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("./empty"),require("./empty")):"function"==typeof define&&define.amd?define("vendor/jsondiffpatch.umd.slim",["exports","./empty","./empty"],t):t(e.jsondiffpatch={},e["diff-match-patch"],e.chalk)}(this,function(e,t,n){"use strict";function i(e){var t=/^\/(.*)\/([gimyu]*)$/.exec(e.toString());return new RegExp(t[1],t[2])}function r(e){if("object"!==(void 0===e?"undefined":k(e)))return e;if(null===e)return null;if(A(e))return e.map(r);if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp)return i(e);var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=r(e[n]));return t}function o(e){if(e&&e.children){for(var t=e.children.length,n=void 0,i=e.result,r=0;r<t;r++)n=e.children[r],void 0!==n.result&&(i=i||{},i[n.childName]=n.result);i&&e.leftIsArray&&(i._t="a"),e.setResult(i).exit()}}function a(e){if(!e.leftIsArray&&"object"===e.leftType){var t=void 0,n=void 0,i=e.options.propertyFilter;for(t in e.left)Object.prototype.hasOwnProperty.call(e.left,t)&&(i&&!i(t,e)||(n=new L(e.left[t],e.right[t]),e.push(n,t)));for(t in e.right)Object.prototype.hasOwnProperty.call(e.right,t)&&(i&&!i(t,e)||void 0===e.left[t]&&(n=new L(void 0,e.right[t]),e.push(n,t)));if(!e.children||0===e.children.length)return void e.setResult(void 0).exit();e.exit()}}function s(e){if(e&&e.children&&!e.delta._t){for(var t=e.children.length,n=void 0,i={},r=0;r<t;r++)n=e.children[r],i[n.childName]!==n.result&&(i[n.childName]=n.result);e.setResult(i).exit()}}function l(e,t,n,i){for(var r=0;r<n;r++)for(var o=e[r],a=0;a<i;a++){var s=t[a];if(r!==a&&o===s)return!0}}function c(e,t,n,i,r){var o=e[n],a=t[i];if(o===a)return!0;if("object"!==(void 0===o?"undefined":k(o))||"object"!==(void 0===a?"undefined":k(a)))return!1;var s=r.objectHash;if(!s)return r.matchByPosition&&n===i;var l=void 0,c=void 0;return"number"==typeof n?(r.hashCache1=r.hashCache1||[],void 0===(l=r.hashCache1[n])&&(r.hashCache1[n]=l=s(o,n))):l=s(o),void 0!==l&&("number"==typeof i?(r.hashCache2=r.hashCache2||[],void 0===(c=r.hashCache2[i])&&(r.hashCache2[i]=c=s(a,i))):c=s(a),void 0!==c&&l===c)}function u(e){if(e&&e.children&&"a"===e.delta._t){for(var t=e.children.length,n=void 0,i={_t:"a"},r=0;r<t;r++){n=e.children[r];var o=n.newName;void 0===o&&(o=ie(e.delta,n.childName,n.result)),i[o]!==n.result&&(i[o]=n.result)}e.setResult(i).exit()}}function d(e){for(var t=e,n=[[/&/g,"&amp;"],[/</g,"&lt;"],[/>/g,"&gt;"],[/'/g,"&apos;"],[/"/g,"&quot;"]],i=0;i<n.length;i++)t=t.replace(n[i][0],n[i][1]);return t}function h(e,t){return ke||(ke=new ye),ke.format(e,t)}function p(e,t){return Ee||(Ee=new Ce),Ee.format(e,t)}function f(e){return n&&n[e]||function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t}}function m(e,t){console.log(Xe(e,t))}function g(e,t){var n=void 0;return"string"==typeof t&&(n=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:\.(\d*))?(Z|([+-])(\d{2}):(\d{2}))$/.exec(t))?new Date(Date.UTC(+n[1],+n[2]-1,+n[3],+n[4],+n[5],+n[6],+(n[7]||0))):t}function v(e){return new de(e)}function b(){return Je||(Je=new de),Je.diff.apply(Je,arguments)}function y(){return Je||(Je=new de),Je.patch.apply(Je,arguments)}function w(){return Je||(Je=new de),Je.unpatch.apply(Je,arguments)}function _(){return Je||(Je=new de),Je.reverse.apply(Je,arguments)}function S(){return Je||(Je=new de),Je.clone.apply(Je,arguments)}t=t&&t.hasOwnProperty("default")?t.default:t,n=n&&n.hasOwnProperty("default")?n.default:n;var k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},x=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},C=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),I=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},P=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},T=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},E=function(){function e(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),M=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)},D=function(){function e(t){x(this,e),this.selfOptions=t||{},this.pipes={}}return C(e,[{key:"options",value:function(e){return e&&(this.selfOptions=e),this.selfOptions}},{key:"pipe",value:function(e,t){var n=t;if("string"==typeof e){if(void 0===n)return this.pipes[e];this.pipes[e]=n}if(e&&e.name){if(n=e,n.processor===this)return n;this.pipes[n.name]=n}return n.processor=this,n}},{key:"process",value:function(e,t){var n=e;n.options=this.options();for(var i=t||e.pipe||"default",r=void 0,o=void 0;i;)void 0!==n.nextAfterChildren&&(n.next=n.nextAfterChildren,n.nextAfterChildren=null),"string"==typeof i&&(i=this.pipe(i)),i.process(n),o=n,r=i,i=null,n&&n.next&&(n=n.next,i=o.nextPipe||n.pipe||r);return n.hasResult?n.result:void 0}}]),e}(),$=function(){function e(t){x(this,e),this.name=t,this.filters=[]}return C(e,[{key:"process",value:function(e){if(!this.processor)throw new Error("add this pipe to a processor before using it");for(var t=this.debug,n=this.filters.length,i=e,r=0;r<n;r++){var o=this.filters[r];if(t&&this.log("filter: "+o.filterName),o(i),"object"===(void 0===i?"undefined":k(i))&&i.exiting){i.exiting=!1;break}}!i.next&&this.resultCheck&&this.resultCheck(i)}},{key:"log",value:function(e){console.log("[jsondiffpatch] "+this.name+" pipe, "+e)}},{key:"append",value:function(){var e;return(e=this.filters).push.apply(e,arguments),this}},{key:"prepend",value:function(){var e;return(e=this.filters).unshift.apply(e,arguments),this}},{key:"indexOf",value:function(e){if(!e)throw new Error("a filter name is required");for(var t=0;t<this.filters.length;t++){if(this.filters[t].filterName===e)return t}throw new Error("filter not found: "+e)}},{key:"list",value:function(){return this.filters.map(function(e){return e.filterName})}},{key:"after",value:function(e){var t=this.indexOf(e),n=Array.prototype.slice.call(arguments,1);if(!n.length)throw new Error("a filter is required");return n.unshift(t+1,0),Array.prototype.splice.apply(this.filters,n),this}},{key:"before",value:function(e){var t=this.indexOf(e),n=Array.prototype.slice.call(arguments,1);if(!n.length)throw new Error("a filter is required");return n.unshift(t,0),Array.prototype.splice.apply(this.filters,n),this}},{key:"replace",value:function(e){var t=this.indexOf(e),n=Array.prototype.slice.call(arguments,1);if(!n.length)throw new Error("a filter is required");return n.unshift(t,1),Array.prototype.splice.apply(this.filters,n),this}},{key:"remove",value:function(e){var t=this.indexOf(e);return this.filters.splice(t,1),this}},{key:"clear",value:function(){return this.filters.length=0,this}},{key:"shouldHaveResult",value:function(e){if(!1===e)return void(this.resultCheck=null);if(!this.resultCheck){var t=this;return this.resultCheck=function(e){if(!e.hasResult){console.log(e);var n=new Error(t.name+" failed");throw n.noResult=!0,n}},this}}}]),e}(),B=function(){function e(){x(this,e)}return C(e,[{key:"setResult",value:function(e){return this.result=e,this.hasResult=!0,this}},{key:"exit",value:function(){return this.exiting=!0,this}},{key:"switchTo",value:function(e,t){return"string"==typeof e||e instanceof $?this.nextPipe=e:(this.next=e,t&&(this.nextPipe=t)),this}},{key:"push",value:function(e,t){return e.parent=this,void 0!==t&&(e.childName=t),e.root=this.root||this,e.options=e.options||this.options,this.children?(this.children[this.children.length-1].next=e,this.children.push(e)):(this.children=[e],this.nextAfterChildren=this.next||null,this.next=e),e.next=this,this}}]),e}(),A="function"==typeof Array.isArray?Array.isArray:function(e){return e instanceof Array},L=function(e){function t(e,n){x(this,t);var i=T(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i.left=e,i.right=n,i.pipe="diff",i}return P(t,e),C(t,[{key:"setResult",value:function(e){if(this.options.cloneDiffValues&&"object"===(void 0===e?"undefined":k(e))){var t="function"==typeof this.options.cloneDiffValues?this.options.cloneDiffValues:r;"object"===k(e[0])&&(e[0]=t(e[0])),"object"===k(e[1])&&(e[1]=t(e[1]))}return B.prototype.setResult.apply(this,arguments)}}]),t}(B),O=function(e){function t(e,n){x(this,t);var i=T(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i.left=e,i.delta=n,i.pipe="patch",i}return P(t,e),t}(B),F=function(e){function t(e){x(this,t);var n=T(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.delta=e,n.pipe="reverse",n}return P(t,e),t}(B),j="function"==typeof Array.isArray?Array.isArray:function(e){return e instanceof Array},R=function(e){if(e.left===e.right)return void e.setResult(void 0).exit();if(void 0===e.left){if("function"==typeof e.right)throw new Error("functions are not supported");return void e.setResult([e.right]).exit()}if(void 0===e.right)return void e.setResult([e.left,0,0]).exit();if("function"==typeof e.left||"function"==typeof e.right)throw new Error("functions are not supported");return e.leftType=null===e.left?"null":k(e.left),e.rightType=null===e.right?"null":k(e.right),e.leftType!==e.rightType?void e.setResult([e.left,e.right]).exit():"boolean"===e.leftType||"number"===e.leftType?void e.setResult([e.left,e.right]).exit():("object"===e.leftType&&(e.leftIsArray=j(e.left)),"object"===e.rightType&&(e.rightIsArray=j(e.right)),e.leftIsArray!==e.rightIsArray?void e.setResult([e.left,e.right]).exit():void(e.left instanceof RegExp&&(e.right instanceof RegExp?e.setResult([e.left.toString(),e.right.toString()]).exit():e.setResult([e.left,e.right]).exit())))};R.filterName="trivial";var N=function(e){if(void 0===e.delta)return void e.setResult(e.left).exit();if(e.nested=!j(e.delta),!e.nested){if(1===e.delta.length)return void e.setResult(e.delta[0]).exit();if(2===e.delta.length){if(e.left instanceof RegExp){var t=/^\/(.*)\/([gimyu]+)$/.exec(e.delta[1]);if(t)return void e.setResult(new RegExp(t[1],t[2])).exit()}return void e.setResult(e.delta[1]).exit()}3===e.delta.length&&0===e.delta[2]&&e.setResult(void 0).exit()}};N.filterName="trivial";var z=function(e){return void 0===e.delta?void e.setResult(e.delta).exit():(e.nested=!j(e.delta),e.nested?void 0:1===e.delta.length?void e.setResult([e.delta[0],0,0]).exit():2===e.delta.length?void e.setResult([e.delta[1],e.delta[0]]).exit():void(3===e.delta.length&&0===e.delta[2]&&e.setResult([e.delta[0]]).exit()))};z.filterName="trivial",o.filterName="collectChildren",a.filterName="objects";var U=function(e){if(e.nested&&!e.delta._t){var t=void 0,n=void 0;for(t in e.delta)n=new O(e.left[t],e.delta[t]),e.push(n,t);e.exit()}};U.filterName="objects";var q=function(e){if(e&&e.children&&!e.delta._t){for(var t=e.children.length,n=void 0,i=0;i<t;i++)n=e.children[i],Object.prototype.hasOwnProperty.call(e.left,n.childName)&&void 0===n.result?delete e.left[n.childName]:e.left[n.childName]!==n.result&&(e.left[n.childName]=n.result);e.setResult(e.left).exit()}};q.filterName="collectChildren";var H=function(e){if(e.nested&&!e.delta._t){var t=void 0,n=void 0;for(t in e.delta)n=new F(e.delta[t]),e.push(n,t);e.exit()}};H.filterName="objects",s.filterName="collectChildren";var V=function(e,t,n,i){return e[n]===t[i]},W=function(e,t,n,i){var r=e.length,o=t.length,a=void 0,s=void 0,l=[r+1];for(a=0;a<r+1;a++)for(l[a]=[o+1],s=0;s<o+1;s++)l[a][s]=0;for(l.match=n,a=1;a<r+1;a++)for(s=1;s<o+1;s++)n(e,t,a-1,s-1,i)?l[a][s]=l[a-1][s-1]+1:l[a][s]=Math.max(l[a-1][s],l[a][s-1]);return l},Y=function e(t,n,i,r,o,a){if(0===r||0===o)return{sequence:[],indices1:[],indices2:[]};if(t.match(n,i,r-1,o-1,a)){var s=e(t,n,i,r-1,o-1,a);return s.sequence.push(n[r-1]),s.indices1.push(r-1),s.indices2.push(o-1),s}return t[r][o-1]>t[r-1][o]?e(t,n,i,r,o-1,a):e(t,n,i,r-1,o,a)},X=function(e,t,n,i){var r=i||{},o=W(e,t,n||V,r),a=Y(o,e,t,e.length,t.length,r);return"string"==typeof e&&"string"==typeof t&&(a.sequence=a.sequence.join("")),a},G={get:X},K="function"==typeof Array.isArray?Array.isArray:function(e){return e instanceof Array},J="function"==typeof Array.prototype.indexOf?function(e,t){return e.indexOf(t)}:function(e,t){for(var n=e.length,i=0;i<n;i++)if(e[i]===t)return i;return-1},Q=function(e){if(e.leftIsArray){var t={objectHash:e.options&&e.options.objectHash,matchByPosition:e.options&&e.options.matchByPosition},n=0,i=0,r=void 0,o=void 0,a=void 0,s=e.left,u=e.right,d=s.length,h=u.length,p=void 0;for(d>0&&h>0&&!t.objectHash&&"boolean"!=typeof t.matchByPosition&&(t.matchByPosition=!l(s,u,d,h));n<d&&n<h&&c(s,u,n,n,t);)r=n,p=new L(e.left[r],e.right[r]),e.push(p,r),n++;for(;i+n<d&&i+n<h&&c(s,u,d-1-i,h-1-i,t);)o=d-1-i,a=h-1-i,p=new L(e.left[o],e.right[a]),e.push(p,a),i++;var f=void 0;if(n+i===d){if(d===h)return void e.setResult(void 0).exit();for(f=f||{_t:"a"},r=n;r<h-i;r++)f[r]=[u[r]];return void e.setResult(f).exit()}if(n+i===h){for(f=f||{_t:"a"},r=n;r<d-i;r++)f["_"+r]=[s[r],0,0];return void e.setResult(f).exit()}delete t.hashCache1,delete t.hashCache2;var m=s.slice(n,d-i),g=u.slice(n,h-i),v=G.get(m,g,c,t),b=[];for(f=f||{_t:"a"},r=n;r<d-i;r++)J(v.indices1,r-n)<0&&(f["_"+r]=[s[r],0,0],b.push(r));var y=!0;e.options&&e.options.arrays&&!1===e.options.arrays.detectMove&&(y=!1);var w=!1;e.options&&e.options.arrays&&e.options.arrays.includeValueOnMove&&(w=!0);var _=b.length;for(r=n;r<h-i;r++){var S=J(v.indices2,r-n);if(S<0){var k=!1;if(y&&_>0)for(var x=0;x<_;x++)if(o=b[x],c(m,g,o-n,r-n,t)){f["_"+o].splice(1,2,r,3),w||(f["_"+o][0]=""),a=r,p=new L(e.left[o],e.right[a]),e.push(p,a),b.splice(x,1),k=!0;break}k||(f[r]=[u[r]])}else o=v.indices1[S]+n,a=v.indices2[S]+n,p=new L(e.left[o],e.right[a]),e.push(p,a)}e.setResult(f).exit()}};Q.filterName="arrays";var Z={numerically:function(e,t){return e-t},numericallyBy:function(e){return function(t,n){return t[e]-n[e]}}},ee=function(e){if(e.nested&&"a"===e.delta._t){var t=void 0,n=void 0,i=e.delta,r=e.left,o=[],a=[],s=[];for(t in i)if("_t"!==t)if("_"===t[0]){if(0!==i[t][2]&&3!==i[t][2])throw new Error("only removal or move can be applied at original array indices, invalid diff type: "+i[t][2]);o.push(parseInt(t.slice(1),10))}else 1===i[t].length?a.push({index:parseInt(t,10),value:i[t][0]}):s.push({index:parseInt(t,10),delta:i[t]});for(o=o.sort(Z.numerically),t=o.length-1;t>=0;t--){n=o[t];var l=i["_"+n],c=r.splice(n,1)[0];3===l[2]&&a.push({index:l[1],value:c})}a=a.sort(Z.numericallyBy("index"));var u=a.length;for(t=0;t<u;t++){var d=a[t];r.splice(d.index,0,d.value)}var h=s.length,p=void 0;if(h>0)for(t=0;t<h;t++){var f=s[t];p=new O(e.left[f.index],f.delta),e.push(p,f.index)}if(!e.children)return void e.setResult(e.left).exit();e.exit()}};ee.filterName="arrays";var te=function(e){if(e&&e.children&&"a"===e.delta._t){for(var t=e.children.length,n=void 0,i=0;i<t;i++)n=e.children[i],e.left[n.childName]=n.result;e.setResult(e.left).exit()}};te.filterName="arraysCollectChildren";var ne=function(e){if(!e.nested)return void(3===e.delta[2]&&(e.newName="_"+e.delta[1],e.setResult([e.delta[0],parseInt(e.childName.substr(1),10),3]).exit()));if("a"===e.delta._t){var t=void 0,n=void 0;for(t in e.delta)"_t"!==t&&(n=new F(e.delta[t]),e.push(n,t));e.exit()}};ne.filterName="arrays";var ie=function(e,t,n){if("string"==typeof t&&"_"===t[0])return parseInt(t.substr(1),10);if(K(n)&&0===n[2])return"_"+t;var i=+t;for(var r in e){var o=e[r];if(K(o))if(3===o[2]){var a=parseInt(r.substr(1),10),s=o[1];if(s===+t)return a;a<=i&&s>i?i++:a>=i&&s<i&&i--}else if(0===o[2]){var l=parseInt(r.substr(1),10);l<=i&&i++}else 1===o.length&&r<=i&&i--}return i};u.filterName="arraysCollectChildren";var re=function(e){e.left instanceof Date?(e.right instanceof Date?e.left.getTime()!==e.right.getTime()?e.setResult([e.left,e.right]):e.setResult(void 0):e.setResult([e.left,e.right]),e.exit()):e.right instanceof Date&&e.setResult([e.left,e.right]).exit()};re.filterName="dates";var oe=null,ae=function(e){if(!oe){var n=void 0;if("undefined"!=typeof diff_match_patch)n="function"==typeof diff_match_patch?new diff_match_patch:new diff_match_patch.diff_match_patch;else if(t)try{n=t&&new t}catch(e){n=null}if(!n){if(!e)return null;var i=new Error("text diff_match_patch library not found");throw i.diff_match_patch_not_found=!0,i}oe={diff:function(e,t){return n.patch_toText(n.patch_make(e,t))},patch:function(e,t){for(var i=n.patch_apply(n.patch_fromText(t),e),r=0;r<i[1].length;r++)if(!i[1][r]){var o=new Error("text patch failed");o.textPatchFailed=!0}return i[0]}}}return oe},se=function(e){if("string"===e.leftType){var t=e.options&&e.options.textDiff&&e.options.textDiff.minLength||60;if(e.left.length<t||e.right.length<t)return void e.setResult([e.left,e.right]).exit();var n=ae();if(!n)return void e.setResult([e.left,e.right]).exit();var i=n.diff;e.setResult([i(e.left,e.right),0,2]).exit()}};se.filterName="texts";var le=function(e){if(!e.nested&&2===e.delta[2]){var t=ae(!0).patch;e.setResult(t(e.left,e.delta[0])).exit()}};le.filterName="texts";var ce=function(e){var t=void 0,n=void 0,i=void 0,r=void 0,o=void 0,a=null,s=/^@@ +-(\d+),(\d+) +\+(\d+),(\d+) +@@$/,l=void 0;for(i=e.split("\n"),t=0,n=i.length;t<n;t++){r=i[t];var c=r.slice(0,1);"@"===c?(a=s.exec(r),l=t,i[l]="@@ -"+a[3]+","+a[4]+" +"+a[1]+","+a[2]+" @@"):"+"===c?(i[t]="-"+i[t].slice(1),"+"===i[t-1].slice(0,1)&&(o=i[t],i[t]=i[t-1],i[t-1]=o)):"-"===c&&(i[t]="+"+i[t].slice(1))}return i.join("\n")},ue=function(e){e.nested||2===e.delta[2]&&e.setResult([ce(e.delta[0]),0,2]).exit()};ue.filterName="texts";var de=function(){function e(t){x(this,e),this.processor=new D(t),this.processor.pipe(new $("diff").append(o,R,re,se,a,Q).shouldHaveResult()),this.processor.pipe(new $("patch").append(q,te,N,le,U,ee).shouldHaveResult()),this.processor.pipe(new $("reverse").append(s,u,z,ue,H,ne).shouldHaveResult())}return C(e,[{key:"options",value:function(){var e;return(e=this.processor).options.apply(e,arguments)}},{key:"diff",value:function(e,t){return this.processor.process(new L(e,t))}},{key:"patch",value:function(e,t){return this.processor.process(new O(e,t))}},{key:"reverse",value:function(e){return this.processor.process(new F(e))}},{key:"unpatch",value:function(e,t){return this.patch(e,this.reverse(t))}},{key:"clone",value:function(e){return r(e)}}]),e}(),he="function"==typeof Array.isArray?Array.isArray:function(e){return e instanceof Array},pe="function"==typeof Object.keys?function(e){return Object.keys(e)}:function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t},fe=function(e){return"_"===e.substr(0,1)?e.slice(1):e},me=function(e){return"_t"===e?-1:"_"===e.substr(0,1)?parseInt(e.slice(1),10):parseInt(e,10)+.1},ge=function(e,t){return me(e)-me(t)},ve=function(){function e(){x(this,e)}return C(e,[{key:"format",value:function(e,t){var n={};return this.prepareContext(n),this.recurse(n,e,t),this.finalize(n)}},{key:"prepareContext",value:function(e){e.buffer=[],e.out=function(){var e;(e=this.buffer).push.apply(e,arguments)}}},{key:"typeFormattterNotFound",value:function(e,t){throw new Error("cannot format delta type: "+t)}},{key:"typeFormattterErrorFormatter",value:function(e,t){return t.toString()}},{key:"finalize",value:function(e){var t=e.buffer;if(he(t))return t.join("")}},{key:"recurse",value:function(e,t,n,i,r,o,a){var s=t&&o,l=s?o.value:n;if(void 0!==t||void 0!==i){var c=this.getDeltaType(t,o),u="node"===c?"a"===t._t?"array":"object":"";void 0!==i?this.nodeBegin(e,i,r,c,u,a):this.rootBegin(e,c,u);var d=void 0;try{d=this["format_"+c]||this.typeFormattterNotFound(e,c),d.call(this,e,t,l,i,r,o)}catch(n){this.typeFormattterErrorFormatter(e,n,t,l,i,r,o),"undefined"!=typeof console&&console.error&&console.error(n.stack)}void 0!==i?this.nodeEnd(e,i,r,c,u,a):this.rootEnd(e,c,u)}}},{key:"formatDeltaChildren",value:function(e,t,n){var i=this;this.forEachDeltaKey(t,n,function(r,o,a,s){i.recurse(e,t[r],n?n[o]:void 0,r,o,a,s)})}},{key:"forEachDeltaKey",value:function(e,t,n){var i=pe(e),r="a"===e._t,o={},a=void 0;if(void 0!==t)for(a in t)Object.prototype.hasOwnProperty.call(t,a)&&(void 0!==e[a]||r&&void 0!==e["_"+a]||i.push(a));for(a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var s=e[a];he(s)&&3===s[2]&&(o[s[1].toString()]={key:a,value:t&&t[parseInt(a.substr(1))]},!1!==this.includeMoveDestinations&&void 0===t&&void 0===e[s[1]]&&i.push(s[1].toString()))}r?i.sort(ge):i.sort();for(var l=0,c=i.length;l<c;l++){var u=i[l];if(!r||"_t"!==u){var d=r?"number"==typeof u?u:parseInt(fe(u),10):u,h=l===c-1;n(u,d,o[d],h)}}}},{key:"getDeltaType",value:function(e,t){if(void 0===e)return void 0!==t?"movedestination":"unchanged";if(he(e)){if(1===e.length)return"added";if(2===e.length)return"modified";if(3===e.length&&0===e[2])return"deleted";if(3===e.length&&2===e[2])return"textdiff";if(3===e.length&&3===e[2])return"moved"}else if("object"===(void 0===e?"undefined":k(e)))return"node";return"unknown"}},{key:"parseTextDiff",value:function(e){for(var t=[],n=e.split("\n@@ "),i=0,r=n.length;i<r;i++){var o=n[i],a={pieces:[]},s=/^(?:@@ )?[-+]?(\d+),(\d+)/.exec(o).slice(1);a.location={line:s[0],chr:s[1]};for(var l=o.split("\n").slice(1),c=0,u=l.length;c<u;c++){var d=l[c];if(d.length){var h={type:"context"};"+"===d.substr(0,1)?h.type="added":"-"===d.substr(0,1)&&(h.type="deleted"),h.text=d.slice(1),a.pieces.push(h)}}t.push(a)}return t}}]),e}(),be=Object.freeze({default:ve}),ye=function(e){function t(){return x(this,t),T(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return P(t,e),C(t,[{key:"typeFormattterErrorFormatter",value:function(e,t){e.out('<pre class="jsondiffpatch-error">'+t+"</pre>")}},{key:"formatValue",value:function(e,t){e.out("<pre>"+d(JSON.stringify(t,null,2))+"</pre>")}},{key:"formatTextDiffString",value:function(e,t){var n=this.parseTextDiff(t);e.out('<ul class="jsondiffpatch-textdiff">');for(var i=0,r=n.length;i<r;i++){var o=n[i];e.out('<li><div class="jsondiffpatch-textdiff-location"><span class="jsondiffpatch-textdiff-line-number">'+o.location.line+'</span><span class="jsondiffpatch-textdiff-char">'+o.location.chr+'</span></div><div class="jsondiffpatch-textdiff-line">');for(var a=o.pieces,s=0,l=a.length;s<l;s++){var c=a[s];e.out('<span class="jsondiffpatch-textdiff-'+c.type+'">'+d(decodeURI(c.text))+"</span>")}e.out("</div></li>")}e.out("</ul>")}},{key:"rootBegin",value:function(e,t,n){var i="jsondiffpatch-"+t+(n?" jsondiffpatch-child-node-type-"+n:"");e.out('<div class="jsondiffpatch-delta '+i+'">')}},{key:"rootEnd",value:function(e){e.out("</div>"+(e.hasArrows?'<script type="text/javascript">setTimeout('+we.toString()+",10);<\/script>":""))}},{key:"nodeBegin",value:function(e,t,n,i,r){var o="jsondiffpatch-"+i+(r?" jsondiffpatch-child-node-type-"+r:"");e.out('<li class="'+o+'" data-key="'+n+'"><div class="jsondiffpatch-property-name">'+n+"</div>")}},{key:"nodeEnd",value:function(e){e.out("</li>")}},{key:"format_unchanged",value:function(e,t,n){void 0!==n&&(e.out('<div class="jsondiffpatch-value">'),this.formatValue(e,n),e.out("</div>"))}},{key:"format_movedestination",value:function(e,t,n){void 0!==n&&(e.out('<div class="jsondiffpatch-value">'),this.formatValue(e,n),e.out("</div>"))}},{key:"format_node",value:function(e,t,n){var i="a"===t._t?"array":"object";e.out('<ul class="jsondiffpatch-node jsondiffpatch-node-type-'+i+'">'),this.formatDeltaChildren(e,t,n),e.out("</ul>")}},{key:"format_added",value:function(e,t){e.out('<div class="jsondiffpatch-value">'),this.formatValue(e,t[0]),e.out("</div>")}},{key:"format_modified",value:function(e,t){e.out('<div class="jsondiffpatch-value jsondiffpatch-left-value">'),this.formatValue(e,t[0]),e.out('</div><div class="jsondiffpatch-value jsondiffpatch-right-value">'),this.formatValue(e,t[1]),e.out("</div>")}},{key:"format_deleted",value:function(e,t){e.out('<div class="jsondiffpatch-value">'),this.formatValue(e,t[0]),e.out("</div>")}},{key:"format_moved",value:function(e,t){e.out('<div class="jsondiffpatch-value">'),this.formatValue(e,t[0]),e.out('</div><div class="jsondiffpatch-moved-destination">'+t[1]+"</div>"),e.out('<div class="jsondiffpatch-arrow" style="position: relative; left: -34px;">\n          <svg width="30" height="60" style="position: absolute; display: none;">\n          <defs>\n              <marker id="markerArrow" markerWidth="8" markerHeight="8"\n                 refx="2" refy="4"\n                     orient="auto" markerUnits="userSpaceOnUse">\n                  <path d="M1,1 L1,7 L7,4 L1,1" style="fill: #339;" />\n              </marker>\n          </defs>\n          <path d="M30,0 Q-10,25 26,50"\n            style="stroke: #88f; stroke-width: 2px; fill: none; stroke-opacity: 0.5; marker-end: url(#markerArrow);"\n          ></path>\n          </svg>\n      </div>'),e.hasArrows=!0}},{key:"format_textdiff",value:function(e,t){e.out('<div class="jsondiffpatch-value">'),this.formatTextDiffString(e,t[0]),e.out("</div>")}}]),t}(ve),we=function(e){
var t=e||document,n=function(e){var t=e.textContent,n=e.innerText;return t||n},i=function(e,t){for(var n=e.children,i=0,r=n.length;i<r;i++)t(n[i],i)};!function(e,t,n){for(var i=e.querySelectorAll(t),r=0,o=i.length;r<o;r++)n(i[r])}(t,".jsondiffpatch-arrow",function(e){var t=e.parentNode,r=e.children,o=e.style,a=t,s=r[0],l=s.children[1];s.style.display="none";var c=n(a.querySelector(".jsondiffpatch-moved-destination")),u=a.parentNode,d=void 0;if(i(u,function(e){e.getAttribute("data-key")===c&&(d=e)}),d)try{var h=d.offsetTop-a.offsetTop;s.setAttribute("height",Math.abs(h)+6),o.top=-8+(h>0?0:h)+"px";var p=h>0?"M30,0 Q-10,"+Math.round(h/2)+" 26,"+(h-4):"M30,"+-h+" Q-10,"+Math.round(-h/2)+" 26,4";l.setAttribute("d",p),s.style.display=""}catch(e){}})},_e=function(e,t,n){var i=t||document.body,r="jsondiffpatch-unchanged-",o={showing:r+"showing",hiding:r+"hiding",visible:r+"visible",hidden:r+"hidden"},a=i.classList;if(a){if(!n)return a.remove(o.showing),a.remove(o.hiding),a.remove(o.visible),a.remove(o.hidden),void(!1===e&&a.add(o.hidden));!1===e?(a.remove(o.showing),a.add(o.visible),setTimeout(function(){a.add(o.hiding)},10)):(a.remove(o.hiding),a.add(o.showing),a.remove(o.hidden));var s=setInterval(function(){we(i)},100);setTimeout(function(){a.remove(o.showing),a.remove(o.hiding),!1===e?(a.add(o.hidden),a.remove(o.visible)):(a.add(o.visible),a.remove(o.hidden)),setTimeout(function(){a.remove(o.visible),clearInterval(s)},n+400)},n)}},Se=function(e,t){return _e(!1,e,t)},ke=void 0,xe=Object.freeze({showUnchanged:_e,hideUnchanged:Se,default:ye,format:h}),Ce=function(e){function t(){x(this,t);var e=T(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.includeMoveDestinations=!1,e}return P(t,e),C(t,[{key:"prepareContext",value:function(e){I(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"prepareContext",this).call(this,e),e.indent=function(e){this.indentLevel=(this.indentLevel||0)+(void 0===e?1:e),this.indentPad=new Array(this.indentLevel+1).join("&nbsp;&nbsp;")},e.row=function(t,n){e.out('<tr><td style="white-space: nowrap;"><pre class="jsondiffpatch-annotated-indent" style="display: inline-block">'),e.out(e.indentPad),e.out('</pre><pre style="display: inline-block">'),e.out(t),e.out('</pre></td><td class="jsondiffpatch-delta-note"><div>'),e.out(n),e.out("</div></td></tr>")}}},{key:"typeFormattterErrorFormatter",value:function(e,t){e.row("",'<pre class="jsondiffpatch-error">'+t+"</pre>")}},{key:"formatTextDiffString",value:function(e,t){var n=this.parseTextDiff(t);e.out('<ul class="jsondiffpatch-textdiff">');for(var i=0,r=n.length;i<r;i++){var o=n[i];e.out('<li><div class="jsondiffpatch-textdiff-location"><span class="jsondiffpatch-textdiff-line-number">'+o.location.line+'</span><span class="jsondiffpatch-textdiff-char">'+o.location.chr+'</span></div><div class="jsondiffpatch-textdiff-line">');for(var a=o.pieces,s=0,l=a.length;s<l;s++){var c=a[s];e.out('<span class="jsondiffpatch-textdiff-'+c.type+'">'+c.text+"</span>")}e.out("</div></li>")}e.out("</ul>")}},{key:"rootBegin",value:function(e,t,n){e.out('<table class="jsondiffpatch-annotated-delta">'),"node"===t&&(e.row("{"),e.indent()),"array"===n&&e.row('"_t": "a",',"Array delta (member names indicate array indices)")}},{key:"rootEnd",value:function(e,t){"node"===t&&(e.indent(-1),e.row("}")),e.out("</table>")}},{key:"nodeBegin",value:function(e,t,n,i,r){e.row("&quot;"+t+"&quot;: {"),"node"===i&&e.indent(),"array"===r&&e.row('"_t": "a",',"Array delta (member names indicate array indices)")}},{key:"nodeEnd",value:function(e,t,n,i,r,o){"node"===i&&e.indent(-1),e.row("}"+(o?"":","))}},{key:"format_unchanged",value:function(){}},{key:"format_movedestination",value:function(){}},{key:"format_node",value:function(e,t,n){this.formatDeltaChildren(e,t,n)}}]),t}(ve),Ie=function(e){return'<pre style="display:inline-block">&quot;'+e+"&quot;</pre>"},Pe={added:function(e,t,n,i){var r=" <pre>([newValue])</pre>";return void 0===i?"new value"+r:"number"==typeof i?"insert at index "+i+r:"add property "+Ie(i)+r},modified:function(e,t,n,i){var r=" <pre>([previousValue, newValue])</pre>";return void 0===i?"modify value"+r:"number"==typeof i?"modify at index "+i+r:"modify property "+Ie(i)+r},deleted:function(e,t,n,i){var r=" <pre>([previousValue, 0, 0])</pre>";return void 0===i?"delete value"+r:"number"==typeof i?"remove index "+i+r:"delete property "+Ie(i)+r},moved:function(e,t,n,i){return'move from <span title="(position to remove at original state)">index '+i+'</span> to <span title="(position to insert at final state)">index '+e[1]+"</span>"},textdiff:function(e,t,n,i){return"text diff"+(void 0===i?"":"number"==typeof i?" at index "+i:" at property "+Ie(i))+', format is <a href="https://code.google.com/p/google-diff-match-patch/wiki/Unidiff">a variation of Unidiff</a>'}},Te=function(e,t){var n=this.getDeltaType(t),i=Pe[n],r=i&&i.apply(i,Array.prototype.slice.call(arguments,1)),o=JSON.stringify(t,null,2);"textdiff"===n&&(o=o.split("\\n").join('\\n"+\n   "')),e.indent(),e.row(o,r),e.indent(-1)};Ce.prototype.format_added=Te,Ce.prototype.format_modified=Te,Ce.prototype.format_deleted=Te,Ce.prototype.format_moved=Te,Ce.prototype.format_textdiff=Te;var Ee=void 0,Me=Object.freeze({default:Ce,format:p}),De={add:"add",remove:"remove",replace:"replace",move:"move"},$e=function(e){function t(){x(this,t);var e=T(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.includeMoveDestinations=!0,e}return P(t,e),C(t,[{key:"prepareContext",value:function(e){I(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"prepareContext",this).call(this,e),e.result=[],e.path=[],e.pushCurrentOp=function(e){var t=e.op,n=e.value,i={op:t,path:this.currentPath()};void 0!==n&&(i.value=n),this.result.push(i)},e.pushMoveOp=function(e){var t=this.currentPath();this.result.push({op:De.move,from:t,path:this.toPath(e)})},e.currentPath=function(){return"/"+this.path.join("/")},e.toPath=function(e){var t=this.path.slice();return t[t.length-1]=e,"/"+t.join("/")}}},{key:"typeFormattterErrorFormatter",value:function(e,t){e.out("[ERROR] "+t)}},{key:"rootBegin",value:function(){}},{key:"rootEnd",value:function(){}},{key:"nodeBegin",value:function(e,t,n){e.path.push(n)}},{key:"nodeEnd",value:function(e){e.path.pop()}},{key:"format_unchanged",value:function(){}},{key:"format_movedestination",value:function(){}},{key:"format_node",value:function(e,t,n){this.formatDeltaChildren(e,t,n)}},{key:"format_added",value:function(e,t){e.pushCurrentOp({op:De.add,value:t[0]})}},{key:"format_modified",value:function(e,t){e.pushCurrentOp({op:De.replace,value:t[1]})}},{key:"format_deleted",value:function(e){e.pushCurrentOp({op:De.remove})}},{key:"format_moved",value:function(e,t){var n=t[1];e.pushMoveOp(n)}},{key:"format_textdiff",value:function(){throw new Error("Not implemented")}},{key:"format",value:function(e,t){var n={};return this.prepareContext(n),this.recurse(n,e,t),n.result}}]),t}(ve),Be=function(e){return e[e.length-1]},Ae=function(e,t){return e.sort(t),e},Le=function(e,t){var n=parseInt(e,10),i=parseInt(t,10);return isNaN(n)||isNaN(i)?0:i-n},Oe=function(e){return Ae(e,function(e,t){var n=e.path.split("/"),i=t.path.split("/");return n.length!==i.length?n.length-i.length:Le(Be(n),Be(i))})},Fe=function(e,t){var n=Array(t.length+1).fill().map(function(){return[]});return e.map(function(e){var n=t.map(function(t){return t(e)}).indexOf(!0);return n<0&&(n=t.length),{item:e,position:n}}).reduce(function(e,t){return e[t.position].push(t.item),e},n)},je=function(e){return"move"===e.op},Re=function(e){return"remove"===e.op},Ne=function(e){var t=Fe(e,[je,Re]),n=E(t,3),i=n[0],r=n[1],o=n[2],a=Oe(r);return[].concat(M(a),M(i),M(o))},ze=void 0,Ue=function(e,t){return ze||(ze=new $e),Ne(ze.format(e,t))},qe=function(e,t){console.log(Ue(e,t))},He=Object.freeze({default:$e,partitionOps:Fe,format:Ue,log:qe}),Ve={added:f("green"),deleted:f("red"),movedestination:f("gray"),moved:f("yellow"),unchanged:f("gray"),error:f("white.bgRed"),textDiffLine:f("gray")},We=function(e){function t(){x(this,t);var e=T(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.includeMoveDestinations=!1,e}return P(t,e),C(t,[{key:"prepareContext",value:function(e){I(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"prepareContext",this).call(this,e),e.indent=function(e){this.indentLevel=(this.indentLevel||0)+(void 0===e?1:e),this.indentPad=new Array(this.indentLevel+1).join("  "),this.outLine()},e.outLine=function(){this.buffer.push("\n"+(this.indentPad||""))},e.out=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var i=0,r=t.length;i<r;i++){var o=t[i].split("\n"),a=o.join("\n"+(this.indentPad||""));this.color&&this.color[0]&&(a=this.color[0](a)),this.buffer.push(a)}},e.pushColor=function(e){this.color=this.color||[],this.color.unshift(e)},e.popColor=function(){this.color=this.color||[],this.color.shift()}}},{key:"typeFormattterErrorFormatter",value:function(e,t){e.pushColor(Ve.error),e.out("[ERROR]"+t),e.popColor()}},{key:"formatValue",value:function(e,t){e.out(JSON.stringify(t,null,2))}},{key:"formatTextDiffString",value:function(e,t){var n=this.parseTextDiff(t);e.indent();for(var i=0,r=n.length;i<r;i++){var o=n[i];e.pushColor(Ve.textDiffLine),e.out(o.location.line+","+o.location.chr+" "),e.popColor();for(var a=o.pieces,s=0,l=a.length;s<l;s++){var c=a[s];e.pushColor(Ve[c.type]),e.out(c.text),e.popColor()}i<r-1&&e.outLine()}e.indent(-1)}},{key:"rootBegin",value:function(e,t,n){e.pushColor(Ve[t]),"node"===t&&(e.out("array"===n?"[":"{"),e.indent())}},{key:"rootEnd",value:function(e,t,n){"node"===t&&(e.indent(-1),e.out("array"===n?"]":"}")),e.popColor()}},{key:"nodeBegin",value:function(e,t,n,i,r){e.pushColor(Ve[i]),e.out(n+": "),"node"===i&&(e.out("array"===r?"[":"{"),e.indent())}},{key:"nodeEnd",value:function(e,t,n,i,r,o){"node"===i&&(e.indent(-1),e.out("array"===r?"]":"}"+(o?"":","))),o||e.outLine(),e.popColor()}},{key:"format_unchanged",value:function(e,t,n){void 0!==n&&this.formatValue(e,n)}},{key:"format_movedestination",value:function(e,t,n){void 0!==n&&this.formatValue(e,n)}},{key:"format_node",value:function(e,t,n){this.formatDeltaChildren(e,t,n)}},{key:"format_added",value:function(e,t){this.formatValue(e,t[0])}},{key:"format_modified",value:function(e,t){e.pushColor(Ve.deleted),this.formatValue(e,t[0]),e.popColor(),e.out(" => "),e.pushColor(Ve.added),this.formatValue(e,t[1]),e.popColor()}},{key:"format_deleted",value:function(e,t){this.formatValue(e,t[0])}},{key:"format_moved",value:function(e,t){e.out("==> "+t[1])}},{key:"format_textdiff",value:function(e,t){this.formatTextDiffString(e,t[0])}}]),t}(ve),Ye=void 0,Xe=function(e,t){return Ye||(Ye=new We),Ye.format(e,t)},Ge=Object.freeze({default:We,format:Xe,log:m}),Ke=Object.freeze({base:be,html:xe,annotated:Me,jsonpatch:He,console:Ge}),Je=void 0;e.DiffPatcher=de,e.formatters=Ke,e.console=Ge,e.create=v,e.dateReviver=g,e.diff=b,e.patch=y,e.unpatch=w,e.reverse=_,e.clone=S,Object.defineProperty(e,"__esModule",{value:!0})}),function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define("vendor/object_hash",e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.objectHash=e()}}(function(){return function e(t,n,i){function r(a,s){if(!n[a]){if(!t[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(o)return o(a,!0);throw new Error("Cannot find module '"+a+"'")}var c=n[a]={exports:{}};t[a][0].call(c.exports,function(e){return r(t[a][1][e]||e)},c,c.exports,e,t,n,i)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<i.length;a++)r(i[a]);return r}({1:[function(e,t,n){(function(i,r,o,a,s,l,c,u,d){"use strict";function h(e,t){return function(e,t){var n;if(n="passthrough"!==t.algorithm?v.createHash(t.algorithm):new g,void 0===n.write&&(n.write=n.update,n.end=n.update),m(t,n).dispatch(e),n.update||n.end(""),n.digest)return n.digest("buffer"===t.encoding?void 0:t.encoding);var i=n.read();return"buffer"!==t.encoding?i.toString(t.encoding):i}(e,t=p(e,t))}function p(e,t){t=t||{};var n={};if(n.algorithm=t.algorithm||"sha1",n.encoding=t.encoding||"hex",n.excludeValues=!!t.excludeValues,n.algorithm=n.algorithm.toLowerCase(),n.encoding=n.encoding.toLowerCase(),n.ignoreUnknown=!0===t.ignoreUnknown,n.respectType=!1!==t.respectType,n.respectFunctionNames=!1!==t.respectFunctionNames,n.respectFunctionProperties=!1!==t.respectFunctionProperties,n.unorderedArrays=!0===t.unorderedArrays,n.unorderedSets=!1!==t.unorderedSets,n.unorderedObjects=!1!==t.unorderedObjects,n.replacer=t.replacer||void 0,n.excludeKeys=t.excludeKeys||void 0,void 0===e)throw new Error("Object argument required.");for(var i=0;i<b.length;++i)b[i].toLowerCase()===n.algorithm.toLowerCase()&&(n.algorithm=b[i]);if(-1===b.indexOf(n.algorithm))throw new Error('Algorithm "'+n.algorithm+'"  not supported. supported values: '+b.join(", "));if(-1===y.indexOf(n.encoding)&&"passthrough"!==n.algorithm)throw new Error('Encoding "'+n.encoding+'"  not supported. supported values: '+y.join(", "));return n}function f(e){return"function"==typeof e&&null!=/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(e))}function m(e,t,n){function i(e){return t.update?t.update(e,"utf8"):t.write(e,"utf8")}return n=n||[],{dispatch:function(t){e.replacer&&(t=e.replacer(t));var n=typeof t;return null===t&&(n="null"),this["_"+n](t)},_object:function(t){var r=Object.prototype.toString.call(t),a=/\[object (.*)\]/i.exec(r);a=(a=a?a[1]:"unknown:["+r+"]").toLowerCase();var s;if(0<=(s=n.indexOf(t)))return this.dispatch("[CIRCULAR:"+s+"]");if(n.push(t),void 0!==o&&o.isBuffer&&o.isBuffer(t))return i("buffer:"),i(t);if("object"===a||"function"===a){var l=Object.keys(t);e.unorderedObjects&&(l=l.sort()),!1===e.respectType||f(t)||l.splice(0,0,"prototype","__proto__","constructor"),e.excludeKeys&&(l=l.filter(function(t){return!e.excludeKeys(t)})),i("object:"+l.length+":");var c=this;return l.forEach(function(n){c.dispatch(n),i(":"),e.excludeValues||c.dispatch(t[n]),i(",")})}if(!this["_"+a]){if(e.ignoreUnknown)return i("["+a+"]");throw new Error('Unknown object type "'+a+'"')}this["_"+a](t)},_array:function(t,r){r=void 0!==r?r:!1!==e.unorderedArrays;var o=this;if(i("array:"+t.length+":"),!r||t.length<=1)return t.forEach(function(e){return o.dispatch(e)});var a=[],s=t.map(function(t){var i=new g,r=n.slice();return m(e,i,r).dispatch(t),a=a.concat(r.slice(n.length)),i.read().toString()});return n=n.concat(a),s.sort(),this._array(s,!1)},_date:function(e){return i("date:"+e.toJSON())},_symbol:function(e){return i("symbol:"+e.toString())},_error:function(e){return i("error:"+e.toString())},_boolean:function(e){return i("bool:"+e.toString())},_string:function(e){i("string:"+e.length+":"),i(e.toString())},_function:function(t){i("fn:"),f(t)?this.dispatch("[native]"):this.dispatch(t.toString()),!1!==e.respectFunctionNames&&this.dispatch("function-name:"+String(t.name)),e.respectFunctionProperties&&this._object(t)},_number:function(e){return i("number:"+e.toString())},_xml:function(e){return i("xml:"+e.toString())},_null:function(){return i("Null")},_undefined:function(){return i("Undefined")},_regexp:function(e){return i("regex:"+e.toString())},_uint8array:function(e){return i("uint8array:"),this.dispatch(Array.prototype.slice.call(e))},_uint8clampedarray:function(e){return i("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(e))},_int8array:function(e){return i("uint8array:"),this.dispatch(Array.prototype.slice.call(e))},_uint16array:function(e){return i("uint16array:"),this.dispatch(Array.prototype.slice.call(e))},_int16array:function(e){return i("uint16array:"),this.dispatch(Array.prototype.slice.call(e))},_uint32array:function(e){return i("uint32array:"),this.dispatch(Array.prototype.slice.call(e))},_int32array:function(e){return i("uint32array:"),this.dispatch(Array.prototype.slice.call(e))},_float32array:function(e){return i("float32array:"),this.dispatch(Array.prototype.slice.call(e))},_float64array:function(e){return i("float64array:"),this.dispatch(Array.prototype.slice.call(e))},_arraybuffer:function(e){return i("arraybuffer:"),this.dispatch(new Uint8Array(e))},_url:function(e){return i("url:"+e.toString())},_map:function(t){i("map:");var n=Array.from(t);return this._array(n,!1!==e.unorderedSets)},_set:function(t){i("set:");var n=Array.from(t);return this._array(n,!1!==e.unorderedSets)},_blob:function(){if(e.ignoreUnknown)return i("[blob]");throw Error('Hashing Blob objects is currently not supported\n(see https://github.com/puleos/object-hash/issues/26)\nUse "options.replacer" or "options.ignoreUnknown"\n')},_domwindow:function(){return i("domwindow")},_process:function(){return i("process")},_timer:function(){return i("timer")},_pipe:function(){return i("pipe")},_tcp:function(){return i("tcp")},_udp:function(){return i("udp")},_tty:function(){return i("tty")},_statwatcher:function(){return i("statwatcher")},_securecontext:function(){return i("securecontext")},_connection:function(){return i("connection")},_zlib:function(){return i("zlib")},_context:function(){return i("context")},_nodescript:function(){return i("nodescript")},_httpparser:function(){return i("httpparser")},_dataview:function(){return i("dataview")},_signal:function(){return i("signal")},_fsevent:function(){return i("fsevent")},_tlswrap:function(){return i("tlswrap")}}}function g(){return{buf:"",write:function(e){this.buf+=e},end:function(e){this.buf+=e},read:function(){return this.buf}}}var v=e("crypto");(n=t.exports=h).sha1=function(e){return h(e)},n.keys=function(e){return h(e,{excludeValues:!0,algorithm:"sha1",encoding:"hex"})},n.MD5=function(e){return h(e,{algorithm:"md5",encoding:"hex"})},n.keysMD5=function(e){return h(e,{algorithm:"md5",encoding:"hex",excludeValues:!0})};var b=v.getHashes?v.getHashes().slice():["sha1","md5"];b.push("passthrough");var y=["buffer","hex","binary","base64"];n.writeToStream=function(e,t,n){return void 0===n&&(n=t,t={}),m(t=p(e,t),n).dispatch(e)}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/fake_8fc94e7b.js","/")},{buffer:3,crypto:5,lYpoI2:10}],2:[function(e,t,n){(function(e,t,i,r,o,a,s,l,c){!function(e){"use strict";function t(e){var t=e.charCodeAt(0);return t===i||t===l?62:t===r||t===c?63:t<o?-1:t<o+10?t-o+26+26:t<s+26?t-s:t<a+26?t-a+26:void 0}var n="undefined"!=typeof Uint8Array?Uint8Array:Array,i="+".charCodeAt(0),r="/".charCodeAt(0),o="0".charCodeAt(0),a="a".charCodeAt(0),s="A".charCodeAt(0),l="-".charCodeAt(0),c="_".charCodeAt(0);e.toByteArray=function(e){function i(e){l[u++]=e}var r,o,a,s,l;if(0<e.length%4)throw new Error("Invalid string. Length must be a multiple of 4");var c=e.length;s="="===e.charAt(c-2)?2:"="===e.charAt(c-1)?1:0,l=new n(3*e.length/4-s),o=0<s?e.length-4:e.length;var u=0;for(r=0;r<o;r+=4,3)i((16711680&(a=t(e.charAt(r))<<18|t(e.charAt(r+1))<<12|t(e.charAt(r+2))<<6|t(e.charAt(r+3))))>>16),i((65280&a)>>8),i(255&a);return 2==s?i(255&(a=t(e.charAt(r))<<2|t(e.charAt(r+1))>>4)):1==s&&(i((a=t(e.charAt(r))<<10|t(e.charAt(r+1))<<4|t(e.charAt(r+2))>>2)>>8&255),i(255&a)),l},e.fromByteArray=function(e){function t(e){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e)}var n,i,r,o,a=e.length%3,s="";for(n=0,r=e.length-a;n<r;n+=3)i=(e[n]<<16)+(e[n+1]<<8)+e[n+2],s+=t((o=i)>>18&63)+t(o>>12&63)+t(o>>6&63)+t(63&o);switch(a){case 1:s+=t((i=e[e.length-1])>>2),s+=t(i<<4&63),s+="==";break;case 2:s+=t((i=(e[e.length-2]<<8)+e[e.length-1])>>10),s+=t(i>>4&63),s+=t(i<<2&63),s+="="}return s}}(void 0===n?this.base64js={}:n)}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/base64-js/lib/b64.js","/node_modules/gulp-browserify/node_modules/base64-js/lib")},{buffer:3,lYpoI2:10}],3:[function(e,t,n){(function(t,i,r,o,a,s,l,c,u){function r(e,t,n){if(!(this instanceof r))return new r(e,t,n);var i,o,a,s=typeof e;if("base64"===t&&"string"==s)for(e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e);e.length%4!=0;)e+="=";if("number"==s)i=I(e);else if("string"==s)i=r.byteLength(e,t);else{if("object"!=s)throw new Error("First argument needs to be a number, array or string.");i=I(e.length)}if(r._useTypedArrays?o=r._augment(new Uint8Array(i)):((o=this).length=i,o._isBuffer=!0),r._useTypedArrays&&"number"==typeof e.byteLength)o._set(e);else if(function(e){return P(e)||r.isBuffer(e)||e&&"object"==typeof e&&"number"==typeof e.length}(e))for(a=0;a<i;a++)r.isBuffer(e)?o[a]=e.readUInt8(a):o[a]=e[a];else if("string"==s)o.write(e,0,t);else if("number"==s&&!r._useTypedArrays&&!n)for(a=0;a<i;a++)o[a]=0;return o}function d(e,t,n,i){return r._charsWritten=D(function(e){for(var t=[],n=0;n<e.length;n++)t.push(255&e.charCodeAt(n));return t}(t),e,n,i)}function h(e,t,n){var i="";n=Math.min(e.length,n);for(var r=t;r<n;r++)i+=String.fromCharCode(e[r]);return i}function p(e,t,n,i){i||(O("boolean"==typeof n,"missing or invalid endian"),O(null!=t,"missing offset"),O(t+1<e.length,"Trying to read beyond buffer length"));var r,o=e.length;if(!(o<=t))return n?(r=e[t],t+1<o&&(r|=e[t+1]<<8)):(r=e[t]<<8,t+1<o&&(r|=e[t+1])),r}function f(e,t,n,i){i||(O("boolean"==typeof n,"missing or invalid endian"),O(null!=t,"missing offset"),O(t+3<e.length,"Trying to read beyond buffer length"));var r,o=e.length;if(!(o<=t))return n?(t+2<o&&(r=e[t+2]<<16),t+1<o&&(r|=e[t+1]<<8),r|=e[t],t+3<o&&(r+=e[t+3]<<24>>>0)):(t+1<o&&(r=e[t+1]<<16),t+2<o&&(r|=e[t+2]<<8),t+3<o&&(r|=e[t+3]),r+=e[t]<<24>>>0),r}function m(e,t,n,i){if(i||(O("boolean"==typeof n,"missing or invalid endian"),O(null!=t,"missing offset"),O(t+1<e.length,"Trying to read beyond buffer length")),!(e.length<=t)){var r=p(e,t,n,!0);return 32768&r?-1*(65535-r+1):r}}function g(e,t,n,i){if(i||(O("boolean"==typeof n,"missing or invalid endian"),O(null!=t,"missing offset"),O(t+3<e.length,"Trying to read beyond buffer length")),!(e.length<=t)){var r=f(e,t,n,!0);return 2147483648&r?-1*(4294967295-r+1):r}}function v(e,t,n,i){return i||(O("boolean"==typeof n,"missing or invalid endian"),O(t+3<e.length,"Trying to read beyond buffer length")),j.read(e,t,n,23,4)}function b(e,t,n,i){return i||(O("boolean"==typeof n,"missing or invalid endian"),O(t+7<e.length,"Trying to read beyond buffer length")),j.read(e,t,n,52,8)}function y(e,t,n,i,r){r||(O(null!=t,"missing value"),O("boolean"==typeof i,"missing or invalid endian"),O(null!=n,"missing offset"),O(n+1<e.length,"trying to write beyond buffer length"),B(t,65535));var o=e.length;if(!(o<=n))for(var a=0,s=Math.min(o-n,2);a<s;a++)e[n+a]=(t&255<<8*(i?a:1-a))>>>8*(i?a:1-a)}function w(e,t,n,i,r){r||(O(null!=t,"missing value"),O("boolean"==typeof i,"missing or invalid endian"),O(null!=n,"missing offset"),O(n+3<e.length,"trying to write beyond buffer length"),B(t,4294967295));var o=e.length;if(!(o<=n))for(var a=0,s=Math.min(o-n,4);a<s;a++)e[n+a]=t>>>8*(i?a:3-a)&255}function _(e,t,n,i,r){r||(O(null!=t,"missing value"),O("boolean"==typeof i,"missing or invalid endian"),O(null!=n,"missing offset"),O(n+1<e.length,"Trying to write beyond buffer length"),A(t,32767,-32768)),e.length<=n||y(e,0<=t?t:65535+t+1,n,i,r)}function S(e,t,n,i,r){r||(O(null!=t,"missing value"),O("boolean"==typeof i,"missing or invalid endian"),O(null!=n,"missing offset"),O(n+3<e.length,"Trying to write beyond buffer length"),A(t,2147483647,-2147483648)),e.length<=n||w(e,0<=t?t:4294967295+t+1,n,i,r)}function k(e,t,n,i,r){r||(O(null!=t,"missing value"),O("boolean"==typeof i,"missing or invalid endian"),O(null!=n,"missing offset"),O(n+3<e.length,"Trying to write beyond buffer length"),L(t,3.4028234663852886e38,-3.4028234663852886e38)),e.length<=n||j.write(e,t,n,i,23,4)}function x(e,t,n,i,r){r||(O(null!=t,"missing value"),O("boolean"==typeof i,"missing or invalid endian"),O(null!=n,"missing offset"),O(n+7<e.length,"Trying to write beyond buffer length"),L(t,1.7976931348623157e308,-1.7976931348623157e308)),e.length<=n||j.write(e,t,n,i,52,8)}function C(e,t,n){return"number"!=typeof e?n:t<=(e=~~e)?t:0<=e?e:0<=(e+=t)?e:0}function I(e){return(e=~~Math.ceil(+e))<0?0:e}function P(e){return(Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)})(e)}function T(e){return e<16?"0"+e.toString(16):e.toString(16)}function E(e){for(var t=[],n=0;n<e.length;n++){var i=e.charCodeAt(n);if(i<=127)t.push(e.charCodeAt(n));else{var r=n;55296<=i&&i<=57343&&n++;for(var o=encodeURIComponent(e.slice(r,n+1)).substr(1).split("%"),a=0;a<o.length;a++)t.push(parseInt(o[a],16))}}return t}function M(e){return F.toByteArray(e)}function D(e,t,n,i){for(var r=0;r<i&&!(r+n>=t.length||r>=e.length);r++)t[r+n]=e[r];return r}function $(e){try{return decodeURIComponent(e)}catch(e){return String.fromCharCode(65533)}}function B(e,t){O("number"==typeof e,"cannot write a non-number as a number"),O(0<=e,"specified a negative value for writing an unsigned value"),O(e<=t,"value is larger than maximum value for type"),O(Math.floor(e)===e,"value has a fractional component")}function A(e,t,n){O("number"==typeof e,"cannot write a non-number as a number"),O(e<=t,"value larger than maximum allowed value"),O(n<=e,"value smaller than minimum allowed value"),O(Math.floor(e)===e,"value has a fractional component")}function L(e,t,n){O("number"==typeof e,"cannot write a non-number as a number"),O(e<=t,"value larger than maximum allowed value"),O(n<=e,"value smaller than minimum allowed value")}function O(e,t){if(!e)throw new Error(t||"Failed assertion")}var F=e("base64-js"),j=e("ieee754");n.Buffer=r,n.SlowBuffer=r,n.INSPECT_MAX_BYTES=50,r.poolSize=8192,r._useTypedArrays=function(){try{var e=new ArrayBuffer(0),t=new Uint8Array(e);return t.foo=function(){return 42},42===t.foo()&&"function"==typeof t.subarray}catch(e){return!1}}(),r.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},r.isBuffer=function(e){return!(null==e||!e._isBuffer)},r.byteLength=function(e,t){var n;switch(e+="",t||"utf8"){case"hex":n=e.length/2;break;case"utf8":case"utf-8":n=E(e).length;break;case"ascii":case"binary":case"raw":n=e.length;break;case"base64":n=M(e).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":n=2*e.length;break;default:throw new Error("Unknown encoding")}return n},r.concat=function(e,t){if(O(P(e),"Usage: Buffer.concat(list, [totalLength])\nlist should be an Array."),0===e.length)return new r(0);if(1===e.length)return e[0];var n;if("number"!=typeof t)for(n=t=0;n<e.length;n++)t+=e[n].length;var i=new r(t),o=0;for(n=0;n<e.length;n++){var a=e[n];a.copy(i,o),o+=a.length}return i},r.prototype.write=function(e,t,n,i){if(isFinite(t))isFinite(n)||(i=n,n=void 0);else{var o=i;i=t,t=n,n=o}t=Number(t)||0;var a,s=this.length-t;switch(n?s<(n=Number(n))&&(n=s):n=s,i=String(i||"utf8").toLowerCase()){case"hex":a=function(e,t,n,i){n=Number(n)||0;var o=e.length-n;i?o<(i=Number(i))&&(i=o):i=o;var a=t.length;O(a%2==0,"Invalid hex string"),a/2<i&&(i=a/2);for(var s=0;s<i;s++){var l=parseInt(t.substr(2*s,2),16);O(!isNaN(l),"Invalid hex string"),e[n+s]=l}return r._charsWritten=2*s,s}(this,e,t,n);break;case"utf8":case"utf-8":a=function(e,t,n,i){return r._charsWritten=D(E(t),e,n,i)}(this,e,t,n);break;case"ascii":a=d(this,e,t,n);break;case"binary":a=function(e,t,n,i){return d(e,t,n,i)}(this,e,t,n);break;case"base64":a=function(e,t,n,i){return r._charsWritten=D(M(t),e,n,i)}(this,e,t,n);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":a=function(e,t,n,i){return r._charsWritten=D(function(e){for(var t,n,i,r=[],o=0;o<e.length;o++)t=e.charCodeAt(o),n=t>>8,i=t%256,r.push(i),r.push(n);return r}(t),e,n,i)}(this,e,t,n);break;default:throw new Error("Unknown encoding")}return a},r.prototype.toString=function(e,t,n){var i,r=this;if(e=String(e||"utf8").toLowerCase(),t=Number(t)||0,(n=void 0!==n?Number(n):n=r.length)===t)return"";switch(e){case"hex":i=function(e,t,n){var i=e.length;(!t||t<0)&&(t=0),(!n||n<0||i<n)&&(n=i);for(var r="",o=t;o<n;o++)r+=T(e[o]);return r}(r,t,n);break;case"utf8":case"utf-8":i=function(e,t,n){var i="",r="";n=Math.min(e.length,n);for(var o=t;o<n;o++)e[o]<=127?(i+=$(r)+String.fromCharCode(e[o]),r=""):r+="%"+e[o].toString(16);return i+$(r)}(r,t,n);break;case"ascii":i=h(r,t,n);break;case"binary":i=function(e,t,n){return h(e,t,n)}(r,t,n);break;case"base64":i=function(e,t,n){return 0===t&&n===e.length?F.fromByteArray(e):F.fromByteArray(e.slice(t,n))}(r,t,n);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":i=function(e,t,n){for(var i=e.slice(t,n),r="",o=0;o<i.length;o+=2)r+=String.fromCharCode(i[o]+256*i[o+1]);return r}(r,t,n);break;default:throw new Error("Unknown encoding")}return i},r.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},r.prototype.copy=function(e,t,n,i){if(n=n||0,i||0===i||(i=this.length),t=t||0,i!==n&&0!==e.length&&0!==this.length){O(n<=i,"sourceEnd < sourceStart"),O(0<=t&&t<e.length,"targetStart out of bounds"),O(0<=n&&n<this.length,"sourceStart out of bounds"),O(0<=i&&i<=this.length,"sourceEnd out of bounds"),i>this.length&&(i=this.length),e.length-t<i-n&&(i=e.length-t+n);var o=i-n;if(o<100||!r._useTypedArrays)for(var a=0;a<o;a++)e[a+t]=this[a+n];else e._set(this.subarray(n,n+o),t)}},r.prototype.slice=function(e,t){var n=this.length;if(e=C(e,n,0),t=C(t,n,n),r._useTypedArrays)return r._augment(this.subarray(e,t));for(var i=t-e,o=new r(i,void 0,!0),a=0;a<i;a++)o[a]=this[a+e];return o},r.prototype.get=function(e){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(e)},r.prototype.set=function(e,t){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(e,t)},r.prototype.readUInt8=function(e,t){if(t||(O(null!=e,"missing offset"),O(e<this.length,"Trying to read beyond buffer length")),!(e>=this.length))return this[e]},r.prototype.readUInt16LE=function(e,t){return p(this,e,!0,t)},r.prototype.readUInt16BE=function(e,t){return p(this,e,!1,t)},r.prototype.readUInt32LE=function(e,t){return f(this,e,!0,t)},r.prototype.readUInt32BE=function(e,t){return f(this,e,!1,t)},r.prototype.readInt8=function(e,t){if(t||(O(null!=e,"missing offset"),O(e<this.length,"Trying to read beyond buffer length")),!(e>=this.length))return 128&this[e]?-1*(255-this[e]+1):this[e]},r.prototype.readInt16LE=function(e,t){return m(this,e,!0,t)},r.prototype.readInt16BE=function(e,t){return m(this,e,!1,t)},r.prototype.readInt32LE=function(e,t){return g(this,e,!0,t)},r.prototype.readInt32BE=function(e,t){return g(this,e,!1,t)},r.prototype.readFloatLE=function(e,t){return v(this,e,!0,t)},r.prototype.readFloatBE=function(e,t){return v(this,e,!1,t)},r.prototype.readDoubleLE=function(e,t){return b(this,e,!0,t)},r.prototype.readDoubleBE=function(e,t){return b(this,e,!1,t)},r.prototype.writeUInt8=function(e,t,n){n||(O(null!=e,"missing value"),O(null!=t,"missing offset"),O(t<this.length,"trying to write beyond buffer length"),B(e,255)),t>=this.length||(this[t]=e)},r.prototype.writeUInt16LE=function(e,t,n){y(this,e,t,!0,n)},r.prototype.writeUInt16BE=function(e,t,n){y(this,e,t,!1,n)},r.prototype.writeUInt32LE=function(e,t,n){w(this,e,t,!0,n)},r.prototype.writeUInt32BE=function(e,t,n){w(this,e,t,!1,n)},r.prototype.writeInt8=function(e,t,n){n||(O(null!=e,"missing value"),O(null!=t,"missing offset"),O(t<this.length,"Trying to write beyond buffer length"),A(e,127,-128)),t>=this.length||(0<=e?this.writeUInt8(e,t,n):this.writeUInt8(255+e+1,t,n))},r.prototype.writeInt16LE=function(e,t,n){_(this,e,t,!0,n)},r.prototype.writeInt16BE=function(e,t,n){_(this,e,t,!1,n)},r.prototype.writeInt32LE=function(e,t,n){S(this,e,t,!0,n)},r.prototype.writeInt32BE=function(e,t,n){S(this,e,t,!1,n)},
r.prototype.writeFloatLE=function(e,t,n){k(this,e,t,!0,n)},r.prototype.writeFloatBE=function(e,t,n){k(this,e,t,!1,n)},r.prototype.writeDoubleLE=function(e,t,n){x(this,e,t,!0,n)},r.prototype.writeDoubleBE=function(e,t,n){x(this,e,t,!1,n)},r.prototype.fill=function(e,t,n){if(e=e||0,t=t||0,n=n||this.length,"string"==typeof e&&(e=e.charCodeAt(0)),O("number"==typeof e&&!isNaN(e),"value is not a number"),O(t<=n,"end < start"),n!==t&&0!==this.length){O(0<=t&&t<this.length,"start out of bounds"),O(0<=n&&n<=this.length,"end out of bounds");for(var i=t;i<n;i++)this[i]=e}},r.prototype.inspect=function(){for(var e=[],t=this.length,i=0;i<t;i++)if(e[i]=T(this[i]),i===n.INSPECT_MAX_BYTES){e[i+1]="...";break}return"<Buffer "+e.join(" ")+">"},r.prototype.toArrayBuffer=function(){if("undefined"==typeof Uint8Array)throw new Error("Buffer.toArrayBuffer not supported in this browser");if(r._useTypedArrays)return new r(this).buffer;for(var e=new Uint8Array(this.length),t=0,n=e.length;t<n;t+=1)e[t]=this[t];return e.buffer};var R=r.prototype;r._augment=function(e){return e._isBuffer=!0,e._get=e.get,e._set=e.set,e.get=R.get,e.set=R.set,e.write=R.write,e.toString=R.toString,e.toLocaleString=R.toString,e.toJSON=R.toJSON,e.copy=R.copy,e.slice=R.slice,e.readUInt8=R.readUInt8,e.readUInt16LE=R.readUInt16LE,e.readUInt16BE=R.readUInt16BE,e.readUInt32LE=R.readUInt32LE,e.readUInt32BE=R.readUInt32BE,e.readInt8=R.readInt8,e.readInt16LE=R.readInt16LE,e.readInt16BE=R.readInt16BE,e.readInt32LE=R.readInt32LE,e.readInt32BE=R.readInt32BE,e.readFloatLE=R.readFloatLE,e.readFloatBE=R.readFloatBE,e.readDoubleLE=R.readDoubleLE,e.readDoubleBE=R.readDoubleBE,e.writeUInt8=R.writeUInt8,e.writeUInt16LE=R.writeUInt16LE,e.writeUInt16BE=R.writeUInt16BE,e.writeUInt32LE=R.writeUInt32LE,e.writeUInt32BE=R.writeUInt32BE,e.writeInt8=R.writeInt8,e.writeInt16LE=R.writeInt16LE,e.writeInt16BE=R.writeInt16BE,e.writeInt32LE=R.writeInt32LE,e.writeInt32BE=R.writeInt32BE,e.writeFloatLE=R.writeFloatLE,e.writeFloatBE=R.writeFloatBE,e.writeDoubleLE=R.writeDoubleLE,e.writeDoubleBE=R.writeDoubleBE,e.fill=R.fill,e.inspect=R.inspect,e.toArrayBuffer=R.toArrayBuffer,e}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/buffer/index.js","/node_modules/gulp-browserify/node_modules/buffer")},{"base64-js":2,buffer:3,ieee754:11,lYpoI2:10}],4:[function(e,t,n){(function(n,i,r,o,a,s,l,c,u){r=e("buffer").Buffer;var d=new r(4);d.fill(0),t.exports={hash:function(e,t,n,i){return r.isBuffer(e)||(e=new r(e)),function(e,t,n){for(var i=new r(t),o=n?i.writeInt32BE:i.writeInt32LE,a=0;a<e.length;a++)o.call(i,e[a],4*a,!0);return i}(t(function(e,t){if(e.length%4!=0){var n=e.length+(4-e.length%4);e=r.concat([e,d],n)}for(var i=[],o=t?e.readInt32BE:e.readInt32LE,a=0;a<e.length;a+=4)i.push(o.call(e,a));return i}(e,i),8*e.length),n,i)}}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/helpers.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:10}],5:[function(e,t,n){(function(t,i,r,o,a,s,l,c,u){function d(e,t){var n=g[e=e||"sha1"],i=[];return n||h("algorithm:",e,"is not yet supported"),{update:function(e){return r.isBuffer(e)||(e=new r(e)),i.push(e),e.length,this},digest:function(e){var o=r.concat(i),a=t?function(e,t,n){r.isBuffer(t)||(t=new r(t)),r.isBuffer(n)||(n=new r(n)),t.length>v?t=e(t):t.length<v&&(t=r.concat([t,b],v));for(var i=new r(v),o=new r(v),a=0;a<v;a++)i[a]=54^t[a],o[a]=92^t[a];var s=e(r.concat([i,n]));return e(r.concat([o,s]))}(n,t,o):n(o);return i=null,e?a.toString(e):a}}}function h(){var e=[].slice.call(arguments).join(" ");throw new Error([e,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join("\n"))}r=e("buffer").Buffer;var p=e("./sha"),f=e("./sha256"),m=e("./rng"),g={sha1:p,sha256:f,md5:e("./md5")},v=64,b=new r(v);b.fill(0),n.createHash=function(e){return d(e)},n.createHmac=function(e,t){return d(e,t)},n.randomBytes=function(e,t){if(!t||!t.call)return new r(m(e));try{t.call(this,void 0,new r(m(e)))}catch(e){t(e)}},function(e,t){for(var i in e)!function(e){n[e]=function(){h("sorry,",e,"is not implemented yet")}}(e[i])}(["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"])}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/index.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./md5":6,"./rng":7,"./sha":8,"./sha256":9,buffer:3,lYpoI2:10}],6:[function(e,t,n){(function(n,i,r,o,a,s,l,c,u){function d(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var n=1732584193,i=-271733879,r=-1732584194,o=271733878,a=0;a<e.length;a+=16){var s=n,l=i,c=r,u=o;i=g(i=g(i=g(i=g(i=m(i=m(i=m(i=m(i=f(i=f(i=f(i=f(i=p(i=p(i=p(i=p(i,r=p(r,o=p(o,n=p(n,i,r,o,e[a+0],7,-680876936),i,r,e[a+1],12,-389564586),n,i,e[a+2],17,606105819),o,n,e[a+3],22,-1044525330),r=p(r,o=p(o,n=p(n,i,r,o,e[a+4],7,-176418897),i,r,e[a+5],12,1200080426),n,i,e[a+6],17,-1473231341),o,n,e[a+7],22,-45705983),r=p(r,o=p(o,n=p(n,i,r,o,e[a+8],7,1770035416),i,r,e[a+9],12,-1958414417),n,i,e[a+10],17,-42063),o,n,e[a+11],22,-1990404162),r=p(r,o=p(o,n=p(n,i,r,o,e[a+12],7,1804603682),i,r,e[a+13],12,-40341101),n,i,e[a+14],17,-1502002290),o,n,e[a+15],22,1236535329),r=f(r,o=f(o,n=f(n,i,r,o,e[a+1],5,-165796510),i,r,e[a+6],9,-1069501632),n,i,e[a+11],14,643717713),o,n,e[a+0],20,-373897302),r=f(r,o=f(o,n=f(n,i,r,o,e[a+5],5,-701558691),i,r,e[a+10],9,38016083),n,i,e[a+15],14,-660478335),o,n,e[a+4],20,-405537848),r=f(r,o=f(o,n=f(n,i,r,o,e[a+9],5,568446438),i,r,e[a+14],9,-1019803690),n,i,e[a+3],14,-187363961),o,n,e[a+8],20,1163531501),r=f(r,o=f(o,n=f(n,i,r,o,e[a+13],5,-1444681467),i,r,e[a+2],9,-51403784),n,i,e[a+7],14,1735328473),o,n,e[a+12],20,-1926607734),r=m(r,o=m(o,n=m(n,i,r,o,e[a+5],4,-378558),i,r,e[a+8],11,-2022574463),n,i,e[a+11],16,1839030562),o,n,e[a+14],23,-35309556),r=m(r,o=m(o,n=m(n,i,r,o,e[a+1],4,-1530992060),i,r,e[a+4],11,1272893353),n,i,e[a+7],16,-155497632),o,n,e[a+10],23,-1094730640),r=m(r,o=m(o,n=m(n,i,r,o,e[a+13],4,681279174),i,r,e[a+0],11,-358537222),n,i,e[a+3],16,-722521979),o,n,e[a+6],23,76029189),r=m(r,o=m(o,n=m(n,i,r,o,e[a+9],4,-640364487),i,r,e[a+12],11,-421815835),n,i,e[a+15],16,530742520),o,n,e[a+2],23,-995338651),r=g(r,o=g(o,n=g(n,i,r,o,e[a+0],6,-198630844),i,r,e[a+7],10,1126891415),n,i,e[a+14],15,-1416354905),o,n,e[a+5],21,-57434055),r=g(r,o=g(o,n=g(n,i,r,o,e[a+12],6,1700485571),i,r,e[a+3],10,-1894986606),n,i,e[a+10],15,-1051523),o,n,e[a+1],21,-2054922799),r=g(r,o=g(o,n=g(n,i,r,o,e[a+8],6,1873313359),i,r,e[a+15],10,-30611744),n,i,e[a+6],15,-1560198380),o,n,e[a+13],21,1309151649),r=g(r,o=g(o,n=g(n,i,r,o,e[a+4],6,-145523070),i,r,e[a+11],10,-1120210379),n,i,e[a+2],15,718787259),o,n,e[a+9],21,-343485551),n=v(n,s),i=v(i,l),r=v(r,c),o=v(o,u)}return Array(n,i,r,o)}function h(e,t,n,i,r,o){return v(function(e,t){return e<<t|e>>>32-t}(v(v(t,e),v(i,o)),r),n)}function p(e,t,n,i,r,o,a){return h(t&n|~t&i,e,t,r,o,a)}function f(e,t,n,i,r,o,a){return h(t&i|n&~i,e,t,r,o,a)}function m(e,t,n,i,r,o,a){return h(t^n^i,e,t,r,o,a)}function g(e,t,n,i,r,o,a){return h(n^(t|~i),e,t,r,o,a)}function v(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}var b=e("./helpers");t.exports=function(e){return b.hash(e,d,16)}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/md5.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:10}],7:[function(e,t,n){(function(e,n,i,r,o,a,s,l,c){!function(){var e,n;e=function(e){for(var t,n=new Array(e),i=0;i<e;i++)0==(3&i)&&(t=4294967296*Math.random()),n[i]=t>>>((3&i)<<3)&255;return n},this.crypto&&crypto.getRandomValues&&(n=function(e){var t=new Uint8Array(e);return crypto.getRandomValues(t),t}),t.exports=n||e}()}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/rng.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:10}],8:[function(e,t,n){(function(n,i,r,o,a,s,l,c,u){function d(e,t){e[t>>5]|=128<<24-t%32,e[15+(t+64>>9<<4)]=t;for(var n,i=Array(80),r=1732584193,o=-271733879,a=-1732584194,s=271733878,l=-1009589776,c=0;c<e.length;c+=16){for(var u=r,d=o,m=a,g=s,v=l,b=0;b<80;b++){i[b]=b<16?e[c+b]:f(i[b-3]^i[b-8]^i[b-14]^i[b-16],1);var y=p(p(f(r,5),h(b,o,a,s)),p(p(l,i[b]),(n=b)<20?1518500249:n<40?1859775393:n<60?-1894007588:-899497514));l=s,s=a,a=f(o,30),o=r,r=y}r=p(r,u),o=p(o,d),a=p(a,m),s=p(s,g),l=p(l,v)}return Array(r,o,a,s,l)}function h(e,t,n,i){return e<20?t&n|~t&i:e<40?t^n^i:e<60?t&n|t&i|n&i:t^n^i}function p(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function f(e,t){return e<<t|e>>>32-t}var m=e("./helpers");t.exports=function(e){return m.hash(e,d,20,!0)}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:10}],9:[function(e,t,n){(function(n,i,r,o,a,s,l,c,u){function d(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function h(e,t){return e>>>t|e<<32-t}function p(e,t){return e>>>t}function f(e,t){var n,i,r,o,a,s,l,c,u,f,m,g,v,b,y,w,_,S,k=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),x=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),C=new Array(64);e[t>>5]|=128<<24-t%32,e[15+(t+64>>9<<4)]=t;for(var I=0;I<e.length;I+=16){n=x[0],i=x[1],r=x[2],o=x[3],a=x[4],s=x[5],l=x[6],c=x[7];for(var P=0;P<64;P++)C[P]=P<16?e[P+I]:d(d(d((S=C[P-2],h(S,17)^h(S,19)^p(S,10)),C[P-7]),(_=C[P-15],h(_,7)^h(_,18)^p(_,3))),C[P-16]),u=d(d(d(d(c,h(w=a,6)^h(w,11)^h(w,25)),(y=a)&s^~y&l),k[P]),C[P]),f=d(h(b=n,2)^h(b,13)^h(b,22),(m=n)&(g=i)^m&(v=r)^g&v),c=l,l=s,s=a,a=d(o,u),o=r,r=i,i=n,n=d(u,f);x[0]=d(n,x[0]),x[1]=d(i,x[1]),x[2]=d(r,x[2]),x[3]=d(o,x[3]),x[4]=d(a,x[4]),x[5]=d(s,x[5]),x[6]=d(l,x[6]),x[7]=d(c,x[7])}return x}var m=e("./helpers");t.exports=function(e){return m.hash(e,f,32,!0)}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha256.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:10}],10:[function(e,t,n){(function(e,n,i,r,o,a,s,l,c){function u(){}(e=t.exports={}).nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(t){var n=[];return window.addEventListener("message",function(e){var t=e.source;t!==window&&null!==t||"process-tick"!==e.data||(e.stopPropagation(),0<n.length&&n.shift()())},!0),function(e){n.push(e),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),e.title="browser",e.browser=!0,e.env={},e.argv=[],e.on=u,e.addListener=u,e.once=u,e.off=u,e.removeListener=u,e.removeAllListeners=u,e.emit=u,e.binding=function(e){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(e){throw new Error("process.chdir is not supported")}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/process/browser.js","/node_modules/gulp-browserify/node_modules/process")},{buffer:3,lYpoI2:10}],11:[function(e,t,n){(function(e,t,i,r,o,a,s,l,c){n.read=function(e,t,n,i,r){var o,a,s=8*r-i-1,l=(1<<s)-1,c=l>>1,u=-7,d=n?r-1:0,h=n?-1:1,p=e[t+d];for(d+=h,o=p&(1<<-u)-1,p>>=-u,u+=s;0<u;o=256*o+e[t+d],d+=h,u-=8);for(a=o&(1<<-u)-1,o>>=-u,u+=i;0<u;a=256*a+e[t+d],d+=h,u-=8);if(0===o)o=1-c;else{if(o===l)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,i),o-=c}return(p?-1:1)*a*Math.pow(2,o-i)},n.write=function(e,t,n,i,r,o){var a,s,l,c=8*o-r-1,u=(1<<c)-1,d=u>>1,h=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:o-1,f=i?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),2<=(t+=1<=a+d?h/l:h*Math.pow(2,1-d))*l&&(a++,l/=2),u<=a+d?(s=0,a=u):1<=a+d?(s=(t*l-1)*Math.pow(2,r),a+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,r),a=0));8<=r;e[n+p]=255&s,p+=f,s/=256,r-=8);for(a=a<<r|s,c+=r;0<c;e[n+p]=255&a,p+=f,a/=256,c-=8);e[n+p-f]|=128*m}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/ieee754/index.js","/node_modules/ieee754")},{buffer:3,lYpoI2:10}]},{},[1])(1)});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/services/undo.service",["require","exports","vendor/angular","vendor/jsondiffpatch.umd.slim","vendor/object_hash","underscore"],function(e,t,n,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=__importDefault(o);var a=20,s=function(){function e(e,t){this.hash=e,this.diffs=t}return e}(),l=function(e){return Object.keys(e).filter(function(e){return"_t"!==e}).shift()},c=function(){function e(e,t,i,r,c){var u=this;this.undoList=[],this.redoList=[],this.startingPointHash="",this.lastHash="",this.lastModel=null,this.trackChanges=function(e){if(u.emailBuilderConfig.undoButtonEnabled){var t=u.emailModelComparisonService.getHash(e);if(t!==u.lastHash){u.lastHash=t;var i=t===u.startingPointHash,r=u.canUndo()&&u.undoList[u.undoList.length-1].hash===t,o=u.canRedo()&&u.redoList[u.redoList.length-1].hash===t;if(u.lastModel&&!r&&!o&&!i){var l=n.copy(e),c=u.emailModelComparisonService.getDiffs(u.lastModel,l),d=u.undoList.push(new s(t,c));if(u.redoList=[],d>a){var h=u.undoList.shift();u.startingPointHash=h.hash}}u.startingPointHash||(u.startingPointHash=t),u.lastModel=n.copy(e)}}},this.canUndo=function(){return u.undoList.length>0},this.canRedo=function(){return u.redoList.length>0},this.getUndoComponentType=function(e,t,n){if(void 0===n&&(n=!1),e.header)return e.header.permissions?"header":"logo";if(e.previewText)return"preheader";if(e.styles||e.spacing)return"globalStyles";if(e.language)return"language";if(e.social)return e.social.webversion?"viewInBrowser":"footer";if(e.editableText||e.webLinks)return"footer";if(e.sections){var i=l(e.sections);if(void 0===i)return null;var r=e.sections[i];if(!r.content||Array.isArray(r.content))return"section";var a=l(r.content);if(void 0===a)return null;var s=r.content[a],c=l(s.content);if(void 0===c)return null;var u=s.content[c];if(!Array.isArray(u)){var d=t.sections[i].content[a].content[c];return d&&d.type?d.type:null}var h=u.find(function(e){return o.default.isObject(e)&&e.type});if(h&&h.type)return h.type;var p=n?u[1]:c.slice(1);return t.sections[i].content[a].content[p].type}return null},this.undo=function(){var e=u.undoList.pop();if(void 0!==e){var t=n.copy(e.diffs),i=u.emailModelComparisonService.unpatch(u.emailService.model,t),r=u.getUndoComponentType(e.diffs,i);u.redoList.push(e),u.emailService.updateAllContainers(),u.$rootScope.$broadcast("undo:modelChanged",{type:"undo",componentType:r}),u.modelActivityService.contentUpdated()}},this.redo=function(){var e=u.redoList.pop();if(void 0!==e){var t=n.copy(e.diffs),i=u.emailModelComparisonService.patch(u.emailService.model,t),r=u.getUndoComponentType(e.diffs,i,!0);u.undoList.push(e),u.$rootScope.$broadcast("undo:modelChanged",{type:"redo",componentType:r}),u.emailService.updateAllContainers(),u.modelActivityService.contentUpdated()}},this.emailBuilderConfig=e,this.emailService=t,this.$rootScope=i,this.modelActivityService=r,this.emailModelComparisonService=c}return e}();t.UndoService=c}),define("ts/modules/emailbuilder/services/ui-id.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){var e=this;this.pseudoGuid=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return""+e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},this.generateId=function(t){return t+"_"+e.pseudoGuid()}}return e}();t.UiIdService=n}),define("ts/modules/emailbuilder/services/section-separator-selector.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){var n=this;this.getMatchingIndex=function(e){var t=n.conditions.filter(function(t){return t.condition(e)})[0];return t&&t.index},this.conditions=t.template.sectionSeparators.map(function(t,n){return{condition:e(t),index:n}})}return e}();t.SectionSeparatorSelectorService=n}),define("ts/modules/emailbuilder/services/web-worker.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.create=function(e){return new Worker(e)}}return e}();t.WebWorkerService=n}),define("ts/modules/emailbuilder/services/getfeedback-connector.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){var n=this;this.loadSurveys=function(){return n.$http({method:"POST",url:n.retrieveGetFeedbackSurveysUrl})},this.completeOauthHandshake=function(e,t){return n.$http({method:"POST",url:n.completeOauthWithGetFeedbackUrl,data:{oauthApplicationID:n.getFeedbackEncryptedOAuthApplicationIDForUrl,authorizationCode:e,oauthState:t},headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},transformRequest:function(e){return $.param(e)}})},this.revokeConnection=function(){return n.$http({method:"POST",url:n.revokeOAuthConnectionWithGetFeedback,data:{oauthApplicationID:n.getFeedbackEncryptedOAuthApplicationIDForUrl},headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},transformRequest:function(e){return $.param(e)}})},this.getFeedbackEncryptedOAuthApplicationIDForUrl=t.urls.getFeedbackEncryptedOAuthApplicationIDForUrl,this.retrieveGetFeedbackSurveysUrl=t.urls.retrieveGetFeedbackSurveys,this.completeOauthWithGetFeedbackUrl=t.urls.completeOAuthHandshakeWithGetFeedback,this.revokeOAuthConnectionWithGetFeedback=t.urls.revokeOAuthConnectionWithGetFeedback,this.$http=e}return e}();t.GetFeedbackConnectorService=n}),define("ts/modules/emailbuilder/services/available-section-selector.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){var t=this;this.byID={},this.byDropzones=[],this.select=function(e){var n=t.byID[e.id];return n||(n=t.byDropzones[e.content.length],t.byID[e.id]=n),n},this.fromID=function(e){return t.byID[e]},e.template&&e.template.sections&&e.template.sections.forEach(function(e){t.byID[e.id]=e,t.byDropzones[e.dropzones.length]||(t.byDropzones[e.dropzones.length]=e)})}return e}();t.AvailableSectionSelectorService=n}),define("ts/modules/emailbuilder/services/screenshot.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){var n=this;this.enqueueCampaignScreenshots=function(){n.$http({method:"POST",url:n.emailBuilderConfig.urls.enqueueCampaignScreenshots})},this.enqueueTemplateScreenshots=function(){n.$http({method:"POST",url:n.emailBuilderConfig.urls.enqueueTemplateScreenshots})},this.$http=e,this.emailBuilderConfig=t}return e}();t.ScreenshotService=n}),define("ts/modules/emailbuilder/services/logo-best-fit.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){var t=this;this.resize=function(e){var n=t.getDimensions(e);e.height=n.height,e.width=n.width},this.getDimensions=function(e){var n=0,i=e.originalHeight,r=e.originalWidth,o=r/i;return r<=t.resizeWidth&&i<=300?(r=Math.round(r),i=Math.round(i)):r>i?(n=Math.min(t.MAX_WIDTH,Math.pow(2e4*o,.5),r),r=Math.round(n),i=Math.round(r/o)):(n=Math.min(Math.pow(1/o*2e4,.5),t.MAX_WIDTH,i),i=Math.round(n),r=Math.round(i*o)),{width:r,height:i}},this.MAX_WIDTH=e.template.logoMaxWidth||440,this.resizeWidth=Math.min(this.MAX_WIDTH,300)}return e}();t.LogoBestFitService=n}),define("ts/modules/emailbuilder/services/item-width.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){var t=this;this.getDropzone=function(e){return t.availableSectionSelectorService.fromID(e.sectionID).dropzones[e.columnIndex]},this.getBlockWidth=function(e){var n=t.getDropzone(e.tempContainer);return"image"!==e.type&&"video"!==e.type||e.isFullWidth?n.width:n.width-n.imagePadding},this.getDropzoneWidth=function(e){return t.getDropzone(e).width},this.availableSectionSelectorService=e}return e}();t.ItemWidthService=n}),define("ts/modules/emailbuilder/services/onboarding.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n){var i=this;this.update=function(){return i.emailBuilderConfig.isSubsequentRun?i.$q.reject():i.$http({method:"POST",url:i.emailBuilderConfig.urls.updateOnBoarding})},this.$http=e,this.emailBuilderConfig=t,this.$q=n}return e}();t.OnboardingService=n}),define("ts/modules/emailbuilder/services/image-builder.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){var n=this;this.resize=function(e){var t=n.getDimensions(e);e.tempHeight=t.height,e.tempWidth=t.width,e.tempResized=t.resized},this.getDimensions=function(e){var t,i,r=0;if("image"===e.type){var o=n.emailBuilderConfig.email.isBlueprint&&e.crop;t=o?e.crop.width:e.originalWidth,i=o?e.crop.height:e.originalHeight}else t=e.originalWidth,i=e.originalHeight;var a=n.itemWidthService.getBlockWidth(e);return t>a&&(r=Math.min(a/t),t=Math.round(a),i=Math.round(i*r)),i<=0&&(i=1),{width:t,height:i,resized:t===a}},this.itemWidthService=e,this.emailBuilderConfig=t}return e}();t.ImageBuilderService=n}),define("ts/modules/emailbuilder/services/dropzone-dimensions.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){var e=this;this.previousSectionAndSeparatorClassName=".hmb-js-section-wrapper",this.sectionAndSeparatorWrapperClassName=".emb-js-section-and-separator-wrapper",this.getSectionEndsAt=function(t,n,i,r){var o=n.next(e.sectionAndSeparatorWrapperClassName),a=o.offset().top,s=t.outerHeight();return i.top+r+s+(a-(i.top+s))/2},this.getSectionStartsAt=function(t,n,i){var r=t.prev(e.sectionAndSeparatorWrapperClassName),o=r.find(e.previousSectionAndSeparatorClassName),a=o.offset().top,s=o.outerHeight();return n.top+i-(n.top-(a+s))/2},this.getSectionDetails=function(t,n){var i=t.scrollParent().scrollTop(),r=t.offset(),o=t.closest(e.sectionAndSeparatorWrapperClassName),a=n.firstSection?0:e.getSectionStartsAt(o,r,i),s=n.lastSection?Number.MAX_VALUE:e.getSectionEndsAt(t,o,r,i);return{width:t.outerWidth(),left:r.left,top:a,height:s-a}},this.getDimensions=function(t,n,i){var r=t.offset(),o=t.outerWidth(),a=e.getSectionDetails(n,i);return i.firstColumn&&i.lastColumn?o=a.width:i.firstColumn?o+=r.left-a.left:i.lastColumn&&(o=a.width-(r.left-a.left)),{left:i.firstColumn?a.left:r.left,top:a.top,width:o,height:a.height}}}return e}();t.DropzoneDimensionsService=n}),define("ts/modules/emailbuilder/services/check-on-preview.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){var t=this;this.runCheck=function(){return t.saveService.poll("TemplateSwitch")},this.saveService=e}return e}();t.CheckOnPreviewService=n}),define("ts/modules/emailbuilder/services/image-validation.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){var t=this;this.reImageTypeValidation=/image\/(?!tiff)/i,this.fileSizeAllowed=function(e){return e.size<=1048576*t.emailBuilderConfig.settings.maxFileSizeInMB},this.fileAllowedType=function(e){return null!==e.type.match(t.reImageTypeValidation)},this.validate=function(e){var n=e.file,i=[];return t.fileAllowedType(n)||i.push("invalidType"),t.fileSizeAllowed(n)||i.push("invalidSize"),i},this.emailBuilderConfig=e}return e}();t.ImageValidationService=n}),define("ts/modules/emailbuilder/services/async-file-uploader.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){var n=this;this.WORKER_FILE_PATH="/js/modules/emailbuilder/workers/uploadFile.js",this.send=function(e){var t=n.webWorkerService.create(n.WORKER_FILE_PATH),i=function(){t&&t.terminate()},r=function(){var i=n.antiForgeryService.get();t.postMessage({token:i,url:e.action,file:e.file})},o=3;t.onmessage=function(t){var n=t.data,a=!1;switch(n.status){case"error":e.onError(),a=!0;break;case"retry":if(--o<=0){e.onError(),a=!0;break}r();break;case"started":e.onStart&&e.onStart();break;default:a=!0,e.onComplete(n.data)}a&&window.setTimeout(i,0)},r()},this.webWorkerService=e,this.antiForgeryService=t}return e}();t.AsyncFileUploaderService=n}),define("ts/modules/emailbuilder/services/test-email.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){var n=this;this.sendTestEmail=function(e,t){return n.$http.post(n.emailBuilderConfig.urls.testEmailUrl,{txtTestCampaign:e.email,source:t?"DragAndDropPreview":"DragAndDrop"})},this.getTestEmailAddress=function(){if(!n.emailBuilderConfig.supportTestEmail)return"";var e=n.emailBuilderConfig.previousTestEmails[0];return void 0!==e?e:n.emailBuilderConfig.loggedInMemberEmail},this.$http=e,this.emailBuilderConfig=t}return e}();t.TestEmailService=n}),define("ts/modules/emailbuilder/services/translation.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="English",i=function(){function e(e){var t=this;this.getValue=function(e,i,r){var o=t.getLanguage(e);if(void 0!==o){var a=o.resources.filter(function(e){if(e.key.toLowerCase()===i.toLowerCase())return e});return a.length>0?a[0].text:r?t.getValue(n,i,!1):"No Translation"}},this.getLanguage=function(e){if(void 0!==t.emailBuilderConfig.translations){var n=t.emailBuilderConfig.translations.filter(function(t){if(t.language.toLowerCase()===e.toLowerCase())return t});if(0!==n.length)return n[0]}},this.emailBuilderConfig=e}return e}();t.TranslationService=i}),define("ts/modules/emailbuilder/services/image-manager.service",["require","exports","./content-block.service"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t,i,r,o,a,s,l,c){var u=this;this.maxContainerWidth=function(){return u.maxImageWidthService.maxContainerSize()},this.ready=function(e,t,n,i,r){var o=new Image,a=""+u.emailBuilderConfig.urls.imagePrefix+e+"?w="+u.maxImageWidthService.maxSize();o.onload=function(){u.$rootScope.$applyAsync(function(){n.resolve(t),t.fileName=e,i&&"header"!==t.type&&(t.originalFileName=e),u.modelActivityService.contentUpdated(),u.$rootScope.$broadcast(r.success,{block:t})})},o.onerror=function(e){u.$rootScope.$applyAsync(function(){n.reject(e),u.modelActivityService.contentUpdated(),u.$rootScope.$broadcast(r.error,{block:t})})},o.src=a},this.uploadAsync=function(e){var t=u.$q.defer(),n={upload:t.promise},i=e.block(),r=u.imageValidationService.validate(e);return"header"!==i.type&&(delete i.tempValidation,i.tempIsValid=!0),u.$rootScope.$broadcast("upload:loading",{block:i}),r.length>0?void(i&&("header"!==i.type&&(i.tempValidation=r),u.$rootScope.$broadcast("upload:error",{block:i}))):(u.asyncFileUploaderService.send({action:u.emailBuilderConfig.urls.image,file:e.file,onStart:function(){u.$rootScope.$applyAsync(function(){u.$rootScope.$broadcast("upload:start",{block:i})})},onComplete:function(n){u.$rootScope.$applyAsync(function(){u.onTransferComplete(n,e.block(),t,!0,{error:"upload:error",success:"upload:end"})})},onError:function(){u.$rootScope.$applyAsync(function(){var n=e.block();"header"!==n.type&&(n.tempValidation=["uploadError"]),t.reject(n),u.$rootScope.$broadcast("upload:error",{block:n})})}}),n)},this.onTransferComplete=function(e,t,i,r,o){var a=e.Data;t.originalWidth=a.OriginalWidth,t.originalHeight=a.OriginalHeight,"header"!==t.type&&(delete t.crop,delete t.tempAspectRatio),n.isBackgroundImage(t)||u.resize(t),u.ready(a.FileName,t,i,r,o)},this.resize=function(e){"header"===e.type?u.logoBestFitService.resize(e):u.imageBuilderService.resize(e)},this.asyncFileUploaderService=e,this.imageValidationService=t,this.$rootScope=i,this.$q=r,this.modelActivityService=o,this.maxImageWidthService=a,this.imageBuilderService=s,this.logoBestFitService=l,this.emailBuilderConfig=c}return e}();t.ImageManagerService=i}),define("ts/modules/emailbuilder/services/next-button-style.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){var e=this;this.copyStyles=function(e,t){t.backgroundColor=e.backgroundColor,t.color=e.color,t.fontFamily=e.fontFamily,t.halign=e.halign,t.tempBackgroundColor=e.tempBackgroundColor,t.tempTextColor=e.tempTextColor,t.borderRadius=e.borderRadius,t.buttonStyleAppearance=e.buttonStyleAppearance,t.buttonSize=e.buttonSize},this.setNextButtonStyle=function(t,n){n&&e.nextButtonStyle||(null===e.nextButtonStyle&&(e.nextButtonStyle={backgroundColor:"",borderRadius:"",buttonSize:"",buttonStyleAppearance:"flat",color:"",fontFamily:"",halign:""}),e.copyStyles(t,e.nextButtonStyle))},this.applyNextButtonStyle=function(t){null!==e.nextButtonStyle&&e.copyStyles(e.nextButtonStyle,t)},this.nextButtonStyle=null}return e}();t.NextButtonStyleService=n});var __assign=this&&this.__assign||function(){return __assign=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},__assign.apply(this,arguments)};define("ts/modules/emailbuilder/services/style-factory.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.type="image",this.displayType=e,this.href="",this.src="",this.fileName="",this.backgroundRepeat="no-repeat",this.size="original",this.isBackground=!0,this.alt=null,this.originalWidth=0,
this.originalHeight=0}return e}(),i=function(){function e(){this.addBackgroundLayoutStyle=function(e){return __assign(__assign({},e),{backgroundColor:e&&void 0!==e.backgroundColor?e.backgroundColor:null,backgroundLayoutImage:e&&e.backgroundLayoutImage?e.backgroundLayoutImage:new n("backgroundLayoutImage")})},this.addBackgroundEmailStyle=function(e){return __assign(__assign({},e),{backgroundColor:e.backgroundColor?e.backgroundColor:"",backgroundLayoutImage:e.backgroundLayoutImage?e.backgroundLayoutImage:new n("backgroundEmailImage")})}}return e}();t.StyleFactoryService=i}),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define("less",[],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.less=e()}}(function(){return function e(t,n,i){function r(a,s){if(!n[a]){if(!t[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(o)return o(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[a]={exports:{}};t[a][0].call(u.exports,function(e){var n=t[a][1][e];return r(n||e)},u,u.exports,e,t,n,i)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;i.length>a;a++)r(i[a]);return r}({1:[function(e,t){var n=e("./utils").addDataAttr,i=e("./browser");t.exports=function(e,t){n(t,i.currentScript(e)),void 0===t.isFileProtocol&&(t.isFileProtocol=/^(file|(chrome|safari)(-extension)?|resource|qrc|app):/.test(e.location.protocol)),t.async=t.async||!1,t.fileAsync=t.fileAsync||!1,t.poll=t.poll||(t.isFileProtocol?1e3:1500),t.env=t.env||("127.0.0.1"==e.location.hostname||"0.0.0.0"==e.location.hostname||"localhost"==e.location.hostname||e.location.port&&e.location.port.length>0||t.isFileProtocol?"development":"production");var r=/!dumpLineNumbers:(comments|mediaquery|all)/.exec(e.location.hash);r&&(t.dumpLineNumbers=r[1]),void 0===t.useFileCache&&(t.useFileCache=!0),void 0===t.onReady&&(t.onReady=!0)}},{"./browser":3,"./utils":9}],2:[function(e,t){e("promise/polyfill.js");var n=window.less||{};e("./add-default-options")(window,n);var i=t.exports=e("./index")(window,n);window.less=i,n.onReady&&(/!watch/.test(window.location.hash)&&i.watch(),i.registerStylesheetsImmediately(),i.pageLoadFinished=i.refresh("development"===i.env))},{"./add-default-options":1,"./index":7,"promise/polyfill.js":94}],3:[function(e,t){var n=e("./utils");t.exports={createCSS:function(e,t,i){var r=i.href||"",o="less:"+(i.title||n.extractId(r)),a=e.getElementById(o),s=!1,l=e.createElement("style");l.setAttribute("type","text/css"),i.media&&l.setAttribute("media",i.media),l.id=o,l.styleSheet||(l.appendChild(e.createTextNode(t)),s=null!==a&&a.childNodes.length>0&&l.childNodes.length>0&&a.firstChild.nodeValue===l.firstChild.nodeValue);var c=e.getElementsByTagName("head")[0];if(null===a||!1===s){var u=i&&i.nextSibling||null;u?u.parentNode.insertBefore(l,u):c.appendChild(l)}if(a&&!1===s&&a.parentNode.removeChild(a),l.styleSheet)try{l.styleSheet.cssText=t}catch(e){throw new Error("Couldn't reassign styleSheet.cssText.")}},currentScript:function(e){var t=e.document;return t.currentScript||function(){var e=t.getElementsByTagName("script");return e[e.length-1]}()}}},{"./utils":9}],4:[function(e,t){t.exports=function(e,t,n){var i=null;if("development"!==t.env)try{i=void 0===e.localStorage?null:e.localStorage}catch(e){}return{setCSS:function(e,t,r){if(i){n.info("saving "+e+" to cache.");try{i.setItem(e,r),i.setItem(e+":timestamp",t)}catch(t){n.error('failed to save "'+e+'" to local storage for caching.')}}},getCSS:function(e,t){var n=i&&i.getItem(e),r=i&&i.getItem(e+":timestamp");return r&&t.lastModified&&new Date(t.lastModified).valueOf()===new Date(r).valueOf()?n:void 0}}}},{}],5:[function(e,t){var n=e("./utils"),i=e("./browser");t.exports=function(e,t,r){function o(t,o){var a,s,l="less-error-message:"+n.extractId(o||""),c='<li><label>{line}</label><pre class="{class}">{content}</pre></li>',u=e.document.createElement("div"),d=[],h=t.filename||o,p=h.match(/([^\/]+(\?.*)?)$/)[1];u.id=l,u.className="less-error-message",s="<h3>"+(t.type||"Syntax")+"Error: "+(t.message||"There is an error in your .less file")+'</h3><p>in <a href="'+h+'">'+p+"</a> ";var f=function(e,t,n){void 0!==e.extract[t]&&d.push(c.replace(/\{line\}/,(parseInt(e.line,10)||0)+(t-1)).replace(/\{class\}/,n).replace(/\{content\}/,e.extract[t]))};t.extract&&(f(t,0,""),f(t,1,"line"),f(t,2,""),s+="on line "+t.line+", column "+(t.column+1)+":</p><ul>"+d.join("")+"</ul>"),t.stack&&(t.extract||r.logLevel>=4)&&(s+="<br/>Stack Trace</br />"+t.stack.split("\n").slice(1).join("<br/>")),u.innerHTML=s,i.createCSS(e.document,[".less-error-message ul, .less-error-message li {","list-style-type: none;","margin-right: 15px;","padding: 4px 0;","margin: 0;","}",".less-error-message label {","font-size: 12px;","margin-right: 15px;","padding: 4px 0;","color: #cc7777;","}",".less-error-message pre {","color: #dd6666;","padding: 4px 0;","margin: 0;","display: inline-block;","}",".less-error-message pre.line {","color: #ff0000;","}",".less-error-message h3 {","font-size: 20px;","font-weight: bold;","padding: 15px 0 5px 0;","margin: 0;","}",".less-error-message a {","color: #10a","}",".less-error-message .error {","color: red;","font-weight: bold;","padding-bottom: 2px;","border-bottom: 1px dashed red;","}"].join("\n"),{title:"error-message"}),u.style.cssText=["font-family: Arial, sans-serif","border: 1px solid #e00","background-color: #eee","border-radius: 5px","-webkit-border-radius: 5px","-moz-border-radius: 5px","color: #e00","padding: 15px","margin-bottom: 15px"].join(";"),"development"===r.env&&(a=setInterval(function(){var t=e.document,n=t.body;n&&(t.getElementById(l)?n.replaceChild(u,t.getElementById(l)):n.insertBefore(u,n.firstChild),clearInterval(a))},10))}function a(e,t){r.errorReporting&&"html"!==r.errorReporting?"console"===r.errorReporting?u(e,t):"function"==typeof r.errorReporting&&r.errorReporting("add",e,t):o(e,t)}function s(t){var i=e.document.getElementById("less-error-message:"+n.extractId(t));i&&i.parentNode.removeChild(i)}function l(){}function c(e){r.errorReporting&&"html"!==r.errorReporting?"console"===r.errorReporting?l(e):"function"==typeof r.errorReporting&&r.errorReporting("remove",e):s(e)}function u(e,n){var i="{line} {content}",o=e.filename||n,a=[],s=(e.type||"Syntax")+"Error: "+(e.message||"There is an error in your .less file")+" in "+o+" ",l=function(e,t,n){void 0!==e.extract[t]&&a.push(i.replace(/\{line\}/,(parseInt(e.line,10)||0)+(t-1)).replace(/\{class\}/,n).replace(/\{content\}/,e.extract[t]))};e.extract&&(l(e,0,""),l(e,1,"line"),l(e,2,""),s+="on line "+e.line+", column "+(e.column+1)+":\n"+a.join("\n")),e.stack&&(e.extract||r.logLevel>=4)&&(s+="\nStack Trace\n"+e.stack),t.logger.error(s)}return{add:a,remove:c}}},{"./browser":3,"./utils":9}],6:[function(e,t){t.exports=function(t,n){function i(){if(window.XMLHttpRequest&&!("file:"===window.location.protocol&&"ActiveXObject"in window))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){return n.error("browser doesn't support AJAX."),null}}var r=e("../less/environment/abstract-file-manager.js"),o={},a=function(){};return a.prototype=new r,a.prototype.alwaysMakePathsAbsolute=function(){return!0},a.prototype.join=function(e,t){return e?this.extractUrlParts(t,e).path:t},a.prototype.doXHR=function(e,r,o,a){function s(t,n,i){t.status>=200&&300>t.status?n(t.responseText,t.getResponseHeader("Last-Modified")):"function"==typeof i&&i(t.status,e)}var l=i(),c=t.isFileProtocol?t.fileAsync:t.async;"function"==typeof l.overrideMimeType&&l.overrideMimeType("text/css"),n.debug("XHR: Getting '"+e+"'"),l.open("GET",e,c),l.setRequestHeader("Accept",r||"text/x-less, text/css; q=0.9, */*; q=0.5"),l.send(null),t.isFileProtocol&&!t.fileAsync?0===l.status||l.status>=200&&300>l.status?o(l.responseText):a(l.status,e):c?l.onreadystatechange=function(){4==l.readyState&&s(l,o,a)}:s(l,o,a)},a.prototype.supports=function(){return!0},a.prototype.clearFileCache=function(){o={}},a.prototype.loadFile=function(e,t,n,i,r){t&&!this.isPathAbsolute(e)&&(e=t+e),n=n||{};var a=this.extractUrlParts(e,window.location.href),s=a.url;if(n.useFileCache&&o[s])try{var l=o[s];r(null,{contents:l,filename:s,webInfo:{lastModified:new Date}})}catch(e){r({filename:s,message:"Error loading file "+s+" error was "+e.message})}else this.doXHR(s,n.mime,function(e,t){o[s]=e,r(null,{contents:e,filename:s,webInfo:{lastModified:t}})},function(e,t){r({type:"File",message:"'"+t+"' wasn't found ("+e+")",href:s})})},a}},{"../less/environment/abstract-file-manager.js":14}],7:[function(e,t){var n=e("./utils").addDataAttr,i=e("./browser");t.exports=function(t,r){function o(e){return r.postProcessor&&"function"==typeof r.postProcessor&&(e=r.postProcessor.call(e,e)||e),e}function a(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function s(e,t){var n=Array.prototype.slice.call(arguments,2);return function(){var i=n.concat(Array.prototype.slice.call(arguments,0));return e.apply(t,i)}}function l(e){for(var t,n=h.getElementsByTagName("style"),i=0;n.length>i;i++)if(t=n[i],t.type.match(y)){var o=a(r);o.modifyVars=e;var l=t.innerHTML||"";o.filename=h.location.href.replace(/#.*$/,""),p.render(l,o,s(function(e,t,n){t?v.add(t,"inline"):(e.type="text/css",e.styleSheet?e.styleSheet.cssText=n.css:e.innerHTML=n.css)},null,t))}}function c(e,t,i,s,l){function c(n){var r=n.contents,a=n.filename,l=n.webInfo,c={currentDirectory:g.getPath(a),filename:a,rootFilename:a,relativeUrls:u.relativeUrls};if(c.entryPath=c.currentDirectory,c.rootpath=u.rootpath||c.currentDirectory,l&&(l.remaining=s,!u.modifyVars)){var d=b.getCSS(a,l);if(!i&&d)return l.local=!0,void t(null,d,r,e,l,a)}v.remove(a),u.rootFileInfo=c,p.render(r,u,function(n,i){n?(n.href=a,t(n)):(i.css=o(i.css),u.modifyVars||b.setCSS(e.href,l.lastModified,i.css),t(null,i.css,r,e,l,a))})}var u=a(r);n(u,e),u.mime=e.type,l&&(u.modifyVars=l),g.loadFile(e.href,null,u,f,function(e,n){return e?void t(e):void c(n)})}function u(e,t,n){for(var i=0;p.sheets.length>i;i++)c(p.sheets[i],e,t,p.sheets.length-(i+1),n)}function d(){"development"===p.env&&(p.watchTimer=setInterval(function(){p.watchMode&&(g.clearFileCache(),u(function(e,n,r,o){e?v.add(e,e.href||o.href):n&&i.createCSS(t.document,n,o)}))},r.poll))}var h=t.document,p=e("../less")();p.options=r;var f=p.environment,m=e("./file-manager")(r,p.logger),g=new m;f.addFileManager(g),p.FileManager=m,e("./log-listener")(p,r);var v=e("./error-reporting")(t,p,r),b=p.cache=r.cache||e("./cache")(t,r,p.logger);r.functions&&p.functions.functionRegistry.addMultiple(r.functions);var y=/^text\/(x-)?less$/;return p.watch=function(){return p.watchMode||(p.env="development",d()),this.watchMode=!0,!0},p.unwatch=function(){return clearInterval(p.watchTimer),this.watchMode=!1,!1},p.registerStylesheetsImmediately=function(){var e=h.getElementsByTagName("link");p.sheets=[];for(var t=0;e.length>t;t++)("stylesheet/less"===e[t].rel||e[t].rel.match(/stylesheet/)&&e[t].type.match(y))&&p.sheets.push(e[t])},p.registerStylesheets=function(){return new Promise(function(e){p.registerStylesheetsImmediately(),e()})},p.modifyVars=function(e){return p.refresh(!0,e,!1)},p.refresh=function(e,n,r){return(e||r)&&!1!==r&&g.clearFileCache(),new Promise(function(r,o){var a,s,c;a=s=new Date,u(function(e,n,l,u,d){return e?(v.add(e,e.href||u.href),void o(e)):(p.logger.info(d.local?"loading "+u.href+" from cache.":"rendered "+u.href+" successfully."),i.createCSS(t.document,n,u),p.logger.info("css for "+u.href+" generated in "+(new Date-s)+"ms"),0===d.remaining&&(c=new Date-a,p.logger.info("less has finished. css generated in "+c+"ms"),r({startTime:a,endTime:s,totalMilliseconds:c,sheets:p.sheets.length})),void(s=new Date))},e,n),l(n)})},p.refreshStyles=l,p}},{"../less":29,"./browser":3,"./cache":4,"./error-reporting":5,"./file-manager":6,"./log-listener":8,"./utils":9}],8:[function(e,t){t.exports=function(e,t){t.logLevel=void 0!==t.logLevel?t.logLevel:"development"===t.env?3:1,t.loggers||(t.loggers=[{debug:function(e){t.logLevel>=4&&console.log(e)},info:function(e){t.logLevel>=3&&console.log(e)},warn:function(e){t.logLevel>=2&&console.warn(e)},error:function(e){t.logLevel>=1&&console.error(e)}}]);for(var n=0;t.loggers.length>n;n++)e.logger.addListener(t.loggers[n])}},{}],9:[function(e,t){t.exports={extractId:function(e){return e.replace(/^[a-z-]+:\/+?[^\/]+/,"").replace(/[\?\&]livereload=\w+/,"").replace(/^\//,"").replace(/\.[a-zA-Z]+$/,"").replace(/[^\.\w-]+/g,"-").replace(/\./g,":")},addDataAttr:function(e,t){for(var n in t.dataset)if(t.dataset.hasOwnProperty(n))if("env"===n||"dumpLineNumbers"===n||"rootpath"===n||"errorReporting"===n)e[n]=t.dataset[n];else try{e[n]=JSON.parse(t.dataset[n])}catch(e){}}}},{}],10:[function(e,t){var n={};t.exports=n;var i=function(e,t,n){if(e)for(var i=0;n.length>i;i++)e.hasOwnProperty(n[i])&&(t[n[i]]=e[n[i]])},r=["paths","relativeUrls","rootpath","strictImports","insecure","dumpLineNumbers","compress","syncImport","chunkInput","mime","useFileCache","processImports","reference","pluginManager"];n.Parse=function(e){i(e,this,r),"string"==typeof this.paths&&(this.paths=[this.paths])};var o=["paths","compress","ieCompat","strictMath","strictUnits","sourceMap","importMultiple","urlArgs","javascriptEnabled","pluginManager","importantScope"];n.Eval=function(e,t){i(e,this,o),"string"==typeof this.paths&&(this.paths=[this.paths]),this.frames=t||[],this.importantScope=this.importantScope||[]},n.Eval.prototype.inParenthesis=function(){this.parensStack||(this.parensStack=[]),this.parensStack.push(!0)},n.Eval.prototype.outOfParenthesis=function(){this.parensStack.pop()},n.Eval.prototype.isMathOn=function(){return!this.strictMath||this.parensStack&&this.parensStack.length},n.Eval.prototype.isPathRelative=function(e){return!/^(?:[a-z-]+:|\/|#)/i.test(e)},n.Eval.prototype.normalizePath=function(e){var t,n=e.split("/").reverse();for(e=[];0!==n.length;)switch(t=n.pop()){case".":break;case"..":0===e.length||".."===e[e.length-1]?e.push(t):e.pop();break;default:e.push(t)}return e.join("/")}},{}],11:[function(e,t){t.exports={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"}},{}],12:[function(e,t){t.exports={colors:e("./colors"),unitConversions:e("./unit-conversions")}},{"./colors":11,"./unit-conversions":13}],13:[function(e,t){t.exports={length:{m:1,cm:.01,mm:.001,in:.0254,px:.0254/96,pt:.0254/72,pc:.0254/72*12},duration:{s:1,ms:.001},angle:{rad:1/(2*Math.PI),deg:1/360,grad:.0025,turn:1}}},{}],14:[function(e,t){var n=function(){};n.prototype.getPath=function(e){var t=e.lastIndexOf("?");return t>0&&(e=e.slice(0,t)),t=e.lastIndexOf("/"),0>t&&(t=e.lastIndexOf("\\")),0>t?"":e.slice(0,t+1)},n.prototype.tryAppendExtension=function(e,t){return/(\.[a-z]*$)|([\?;].*)$/.test(e)?e:e+t},n.prototype.tryAppendLessExtension=function(e){return this.tryAppendExtension(e,".less")},n.prototype.supportsSync=function(){return!1},n.prototype.alwaysMakePathsAbsolute=function(){return!1},n.prototype.isPathAbsolute=function(e){return/^(?:[a-z-]+:|\/|\\|#)/i.test(e)},n.prototype.join=function(e,t){return e?e+t:t},n.prototype.pathDiff=function(e,t){var n,i,r,o,a=this.extractUrlParts(e),s=this.extractUrlParts(t),l="";if(a.hostPart!==s.hostPart)return"";for(i=Math.max(s.directories.length,a.directories.length),n=0;i>n&&s.directories[n]===a.directories[n];n++);for(o=s.directories.slice(n),r=a.directories.slice(n),n=0;o.length-1>n;n++)l+="../";for(n=0;r.length-1>n;n++)l+=r[n]+"/";return l},n.prototype.extractUrlParts=function(e,t){var n,i,r=/^((?:[a-z-]+:)?\/+?(?:[^\/\?#]*\/)|([\/\\]))?((?:[^\/\\\?#]*[\/\\])*)([^\/\\\?#]*)([#\?].*)?$/i,o=e.match(r),a={},s=[];if(!o)throw new Error("Could not parse sheet href - '"+e+"'");if(t&&(!o[1]||o[2])){if(!(i=t.match(r)))throw new Error("Could not parse page url - '"+t+"'");o[1]=o[1]||i[1]||"",o[2]||(o[3]=i[3]+o[3])}if(o[3]){for(s=o[3].replace(/\\/g,"/").split("/"),n=0;s.length>n;n++)"."===s[n]&&(s.splice(n,1),n-=1);for(n=0;s.length>n;n++)".."===s[n]&&n>0&&(s.splice(n-1,2),n-=2)}return a.hostPart=o[1],a.directories=s,a.path=(o[1]||"")+s.join("/"),a.fileUrl=a.path+(o[4]||""),a.url=a.fileUrl+(o[5]||""),a},t.exports=n},{}],15:[function(e,t){var n=e("../logger"),i=function(e,t){this.fileManagers=t||[],e=e||{};for(var n=["encodeBase64","mimeLookup","charsetLookup","getSourceMapGenerator"],i=[],r=i.concat(n),o=0;r.length>o;o++){var a=r[o],s=e[a];s?this[a]=s.bind(e):i.length>o&&this.warn("missing required function in environment - "+a)}};i.prototype.getFileManager=function(e,t,i,r,o){e||n.warn("getFileManager called with no filename.. Please report this issue. continuing."),null==t&&n.warn("getFileManager called with null directory.. Please report this issue. continuing.");var a=this.fileManagers;i.pluginManager&&(a=[].concat(a).concat(i.pluginManager.getFileManagers()));for(var s=a.length-1;s>=0;s--){var l=a[s];if(l[o?"supportsSync":"supports"](e,t,i,r))return l}return null},i.prototype.addFileManager=function(e){this.fileManagers.push(e)},i.prototype.clearFileManagers=function(){this.fileManagers=[]},t.exports=i},{"../logger":31}],16:[function(e){function t(e,t,i){var r,o,a,s,l=t.alpha,c=i.alpha,u=[];a=c+l*(1-c);for(var d=0;3>d;d++)r=t.rgb[d]/255,o=i.rgb[d]/255,s=e(r,o),a&&(s=(c*o+l*(r-c*(r+o-s)))/a),u[d]=255*s;return new n(u,a)}var n=e("../tree/color"),i=e("./function-registry"),r={multiply:function(e,t){return e*t},screen:function(e,t){return e+t-e*t},overlay:function(e,t){return e*=2,1>=e?r.multiply(e,t):r.screen(e-1,t)},softlight:function(e,t){var n=1,i=e;return t>.5&&(i=1,n=e>.25?Math.sqrt(e):((16*e-12)*e+4)*e),e-(1-2*t)*i*(n-e)},hardlight:function(e,t){return r.overlay(t,e)},difference:function(e,t){return Math.abs(e-t)},exclusion:function(e,t){return e+t-2*e*t},average:function(e,t){return(e+t)/2},negation:function(e,t){return 1-Math.abs(e+t-1)}};for(var o in r)r.hasOwnProperty(o)&&(t[o]=t.bind(null,r[o]));i.addMultiple(t)},{"../tree/color":48,"./function-registry":21}],17:[function(e){function t(e){return Math.min(1,Math.max(0,e))}function n(e){return o.hsla(e.h,e.s,e.l,e.a)}function i(e){if(e instanceof a)return parseFloat(e.unit.is("%")?e.value/100:e.value);if("number"==typeof e)return e;throw{type:"Argument",message:"color functions take numbers as parameters"}}function r(e,t){return e instanceof a&&e.unit.is("%")?parseFloat(e.value*t/100):i(e)}var o,a=e("../tree/dimension"),s=e("../tree/color"),l=e("../tree/quoted"),c=e("../tree/anonymous"),u=e("./function-registry");o={rgb:function(e,t,n){return o.rgba(e,t,n,1)},rgba:function(e,t,n,o){var a=[e,t,n].map(function(e){return r(e,255)});return o=i(o),new s(a,o)},hsl:function(e,t,n){return o.hsla(e,t,n,1)},hsla:function(e,n,r,a){function s(e){return e=0>e?e+1:e>1?e-1:e,1>6*e?c+(l-c)*e*6:1>2*e?l:2>3*e?c+(l-c)*(2/3-e)*6:c}e=i(e)%360/360,n=t(i(n)),r=t(i(r)),a=t(i(a));var l=.5>=r?r*(n+1):r+n-r*n,c=2*r-l;return o.rgba(255*s(e+1/3),255*s(e),255*s(e-1/3),a)},hsv:function(e,t,n){return o.hsva(e,t,n,1)},hsva:function(e,t,n,r){e=i(e)%360/360*360,t=i(t),n=i(n),r=i(r);var a,s;a=Math.floor(e/60%6),s=e/60-a;var l=[n,n*(1-t),n*(1-s*t),n*(1-(1-s)*t)],c=[[0,3,1],[2,0,1],[1,0,3],[1,2,0],[3,1,0],[0,1,2]];return o.rgba(255*l[c[a][0]],255*l[c[a][1]],255*l[c[a][2]],r)},hue:function(e){return new a(e.toHSL().h)},saturation:function(e){return new a(100*e.toHSL().s,"%")},lightness:function(e){return new a(100*e.toHSL().l,"%")},hsvhue:function(e){return new a(e.toHSV().h)},hsvsaturation:function(e){return new a(100*e.toHSV().s,"%")},hsvvalue:function(e){return new a(100*e.toHSV().v,"%")},red:function(e){return new a(e.rgb[0])},green:function(e){return new a(e.rgb[1])},blue:function(e){return new a(e.rgb[2])},alpha:function(e){return new a(e.toHSL().a)},luma:function(e){return new a(e.luma()*e.alpha*100,"%")},luminance:function(e){var t=.2126*e.rgb[0]/255+.7152*e.rgb[1]/255+.0722*e.rgb[2]/255;return new a(t*e.alpha*100,"%")},saturate:function(e,i,r){if(!e.rgb)return null;var o=e.toHSL();return o.s+=void 0!==r&&"relative"===r.value?o.s*i.value/100:i.value/100,o.s=t(o.s),n(o)},desaturate:function(e,i,r){var o=e.toHSL();return o.s-=void 0!==r&&"relative"===r.value?o.s*i.value/100:i.value/100,o.s=t(o.s),n(o)},lighten:function(e,i,r){var o=e.toHSL();return o.l+=void 0!==r&&"relative"===r.value?o.l*i.value/100:i.value/100,o.l=t(o.l),n(o)},darken:function(e,i,r){var o=e.toHSL();return o.l-=void 0!==r&&"relative"===r.value?o.l*i.value/100:i.value/100,o.l=t(o.l),n(o)},fadein:function(e,i,r){var o=e.toHSL();return o.a+=void 0!==r&&"relative"===r.value?o.a*i.value/100:i.value/100,o.a=t(o.a),n(o)},fadeout:function(e,i,r){var o=e.toHSL();return o.a-=void 0!==r&&"relative"===r.value?o.a*i.value/100:i.value/100,o.a=t(o.a),n(o)},fade:function(e,i){var r=e.toHSL();return r.a=i.value/100,r.a=t(r.a),n(r)},spin:function(e,t){var i=e.toHSL(),r=(i.h+t.value)%360;return i.h=0>r?360+r:r,n(i)},mix:function(e,t,n){e.toHSL&&t.toHSL||(console.log(t.type),console.dir(t)),n||(n=new a(50));var i=n.value/100,r=2*i-1,o=e.toHSL().a-t.toHSL().a,l=((r*o==-1?r:(r+o)/(1+r*o))+1)/2,c=1-l,u=[e.rgb[0]*l+t.rgb[0]*c,e.rgb[1]*l+t.rgb[1]*c,e.rgb[2]*l+t.rgb[2]*c],d=e.alpha*i+t.alpha*(1-i);return new s(u,d)},greyscale:function(e){return o.desaturate(e,new a(100))},contrast:function(e,t,n,r){if(!e.rgb)return null;if(void 0===n&&(n=o.rgba(255,255,255,1)),void 0===t&&(t=o.rgba(0,0,0,1)),t.luma()>n.luma()){var a=n;n=t,t=a}return r=void 0===r?.43:i(r),e.luma()<r?n:t},argb:function(e){return new c(e.toARGB())},color:function(e){if(e instanceof l&&/^#([a-f0-9]{6}|[a-f0-9]{3})$/i.test(e.value))return new s(e.value.slice(1));if(e instanceof s||(e=s.fromKeyword(e.value)))return e.value=void 0,e;throw{type:"Argument",message:"argument must be a color keyword or 3/6 digit hex e.g. #FFF"}},tint:function(e,t){return o.mix(o.rgb(255,255,255),e,t)},shade:function(e,t){return o.mix(o.rgb(0,0,0),e,t)}},u.addMultiple(o)},{"../tree/anonymous":44,"../tree/color":48,"../tree/dimension":54,"../tree/quoted":71,"./function-registry":21}],18:[function(e,t){t.exports=function(t){var n=e("../tree/quoted"),i=e("../tree/url"),r=e("./function-registry"),o=function(e,t){return new i(t,e.index,e.currentFileInfo).eval(e.context)},a=e("../logger");r.add("data-uri",function(e,r){r||(r=e,e=null);var s=e&&e.value,l=r.value,c=this.currentFileInfo,u=c.relativeUrls?c.currentDirectory:c.entryPath,d=l.indexOf("#"),h="";-1!==d&&(h=l.slice(d),l=l.slice(0,d));var p=t.getFileManager(l,u,this.context,t,!0);if(!p)return o(this,r);var f=!1;if(e)f=/;base64$/.test(s);else{if("image/svg+xml"===(s=t.mimeLookup(l)))f=!1;else{f=["US-ASCII","UTF-8"].indexOf(t.charsetLookup(s))<0}f&&(s+=";base64")}var m=p.loadFileSync(l,u,this.context,t);if(!m.contents)return a.warn("Skipped data-uri embedding of "+l+" because file not found"),o(this,r||e);var g=m.contents;if(f&&!t.encodeBase64)return o(this,r);g=f?t.encodeBase64(g):encodeURIComponent(g);var v="data:"+s+","+g+h;return v.length>=32768&&!1!==this.context.ieCompat?(a.warn("Skipped data-uri embedding of "+l+" because its size ("+v.length+" characters) exceeds IE8-safe 32768 characters!"),o(this,r||e)):new i(new n('"'+v+'"',v,!1,this.index,this.currentFileInfo),this.index,this.currentFileInfo)})}},{"../logger":31,"../tree/quoted":71,"../tree/url":78,"./function-registry":21}],19:[function(e,t){var n=e("../tree/keyword"),i=e("./function-registry"),r={eval:function(){var e=this.value_,t=this.error_;if(t)throw t;return null!=e?e?n.True:n.False:void 0},value:function(e){this.value_=e},error:function(e){this.error_=e},reset:function(){this.value_=this.error_=null}};i.add("default",r.eval.bind(r)),t.exports=r},{"../tree/keyword":63,"./function-registry":21}],20:[function(e,t){var n=e("../tree/expression"),i=function(e,t,n,i){this.name=e.toLowerCase(),this.index=n,this.context=t,this.currentFileInfo=i,this.func=t.frames[0].functionRegistry.get(this.name)};i.prototype.isValid=function(){return Boolean(this.func)},i.prototype.call=function(e){return Array.isArray(e)&&(e=e.filter(function(e){return"Comment"!==e.type}).map(function(e){if("Expression"===e.type){var t=e.value.filter(function(e){return"Comment"!==e.type});return 1===t.length?t[0]:new n(t)}return e})),this.func.apply(this,e)},t.exports=i},{"../tree/expression":57}],21:[function(e,t){function n(e){return{_data:{},add:function(e,t){e=e.toLowerCase(),this._data.hasOwnProperty(e),this._data[e]=t},addMultiple:function(e){Object.keys(e).forEach(function(t){this.add(t,e[t])}.bind(this))},get:function(t){return this._data[t]||e&&e.get(t)},inherit:function(){return n(this)}}}t.exports=n(null)},{}],22:[function(e,t){t.exports=function(t){var n={functionRegistry:e("./function-registry"),functionCaller:e("./function-caller")};return e("./default"),e("./color"),e("./color-blending"),e("./data-uri")(t),e("./math"),e("./number"),e("./string"),e("./svg")(t),e("./types"),n}},{"./color":17,"./color-blending":16,"./data-uri":18,"./default":19,"./function-caller":20,"./function-registry":21,"./math":23,"./number":24,"./string":25,"./svg":26,"./types":27}],23:[function(e){function t(e,t,i){if(!(i instanceof n))throw{type:"Argument",message:"argument must be a number"};return null==t?t=i.unit:i=i.unify(),new n(e(parseFloat(i.value)),t)}var n=e("../tree/dimension"),i=e("./function-registry"),r={ceil:null,floor:null,sqrt:null,abs:null,tan:"",sin:"",cos:"",atan:"rad",asin:"rad",acos:"rad"};for(var o in r)r.hasOwnProperty(o)&&(r[o]=t.bind(null,Math[o],r[o]));r.round=function(e,n){var i=void 0===n?0:n.value;return t(function(e){return e.toFixed(i)},null,e)},i.addMultiple(r)},{"../tree/dimension":54,"./function-registry":21}],24:[function(e){var t=e("../tree/dimension"),n=e("../tree/anonymous"),i=e("./function-registry"),r=function(e,i){switch(i=Array.prototype.slice.call(i),i.length){case 0:throw{type:"Argument",message:"one or more arguments required"}}var r,o,a,s,l,c,u,d,h=[],p={};for(r=0;i.length>r;r++)if((a=i[r])instanceof t)if(s=""===a.unit.toString()&&void 0!==d?new t(a.value,d).unify():a.unify(),c=""===s.unit.toString()&&void 0!==u?u:s.unit.toString(),u=""!==c&&void 0===u||""!==c&&""===h[0].unify().unit.toString()?c:u,d=""!==c&&void 0===d?a.unit.toString():d,void 0!==(o=void 0!==p[""]&&""!==c&&c===u?p[""]:p[c]))l=""===h[o].unit.toString()&&void 0!==d?new t(h[o].value,d).unify():h[o].unify(),(e&&l.value>s.value||!e&&s.value>l.value)&&(h[o]=a);else{if(void 0!==u&&c!==u)throw{type:"Argument",message:"incompatible types"};p[c]=h.length,h.push(a)}else Array.isArray(i[r].value)&&Array.prototype.push.apply(i,Array.prototype.slice.call(i[r].value));return 1==h.length?h[0]:(i=h.map(function(e){return e.toCSS(this.context)}).join(this.context.compress?",":", "),new n((e?"min":"max")+"("+i+")"))};i.addMultiple({min:function(){return r(!0,arguments)},max:function(){return r(!1,arguments)},convert:function(e,t){return e.convertTo(t.value)},pi:function(){return new t(Math.PI)},mod:function(e,n){return new t(e.value%n.value,e.unit)},pow:function(e,n){if("number"==typeof e&&"number"==typeof n)e=new t(e),n=new t(n);else if(!(e instanceof t&&n instanceof t))throw{type:"Argument",message:"arguments must be numbers"};return new t(Math.pow(e.value,n.value),e.unit)},percentage:function(e){return new t(100*e.value,"%")}})},{"../tree/anonymous":44,"../tree/dimension":54,"./function-registry":21}],25:[function(e){var t=e("../tree/quoted"),n=e("../tree/anonymous"),i=e("../tree/javascript");e("./function-registry").addMultiple({e:function(e){return new n(e instanceof i?e.evaluated:e.value)},escape:function(e){return new n(encodeURI(e.value).replace(/=/g,"%3D").replace(/:/g,"%3A").replace(/#/g,"%23").replace(/;/g,"%3B").replace(/\(/g,"%28").replace(/\)/g,"%29"))},replace:function(e,n,i,r){var o=e.value;return i="Quoted"===i.type?i.value:i.toCSS(),o=o.replace(new RegExp(n.value,r?r.value:""),i),new t(e.quote||"",o,e.escaped)},"%":function(e){for(var n=Array.prototype.slice.call(arguments,1),i=e.value,r=0;n.length>r;r++)i=i.replace(/%[sda]/i,function(e){var t="Quoted"===n[r].type&&e.match(/s/i)?n[r].value:n[r].toCSS();return e.match(/[A-Z]$/)?encodeURIComponent(t):t});return i=i.replace(/%%/g,"%"),new t(e.quote||"",i,e.escaped)}})},{"../tree/anonymous":44,"../tree/javascript":61,"../tree/quoted":71,"./function-registry":21}],26:[function(e,t){t.exports=function(){var t=e("../tree/dimension"),n=e("../tree/color"),i=e("../tree/expression"),r=e("../tree/quoted"),o=e("../tree/url");e("./function-registry").add("svg-gradient",function(e){function a(){throw{type:"Argument",message:"svg-gradient expects direction, start_color [start_position], [color position,]..., end_color [end_position] or direction, color list"}}var s,l,c,u,d,h,p,f,m="linear",g='x="0" y="0" width="1" height="1"',v={compress:!1},b=e.toCSS(v);switch(2==arguments.length?(arguments[1].value.length<2&&a(),s=arguments[1].value):arguments.length<3?a():s=Array.prototype.slice.call(arguments,1),b){case"to bottom":l='x1="0%" y1="0%" x2="0%" y2="100%"';break;case"to right":l='x1="0%" y1="0%" x2="100%" y2="0%"';break;case"to bottom right":l='x1="0%" y1="0%" x2="100%" y2="100%"';break;case"to top right":
l='x1="0%" y1="100%" x2="100%" y2="0%"';break;case"ellipse":case"ellipse at center":m="radial",l='cx="50%" cy="50%" r="75%"',g='x="-50" y="-50" width="101" height="101"';break;default:throw{type:"Argument",message:"svg-gradient direction must be 'to bottom', 'to right', 'to bottom right', 'to top right' or 'ellipse at center'"}}for(c='<?xml version="1.0" ?><svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="100%" height="100%" viewBox="0 0 1 1" preserveAspectRatio="none"><'+m+'Gradient id="gradient" gradientUnits="userSpaceOnUse" '+l+">",u=0;s.length>u;u+=1)s[u]instanceof i?(d=s[u].value[0],h=s[u].value[1]):(d=s[u],h=void 0),d instanceof n&&((0===u||u+1===s.length)&&void 0===h||h instanceof t)||a(),p=h?h.toCSS(v):0===u?"0%":"100%",f=d.alpha,c+='<stop offset="'+p+'" stop-color="'+d.toRGB()+'"'+(1>f?' stop-opacity="'+f+'"':"")+"/>";return c+="</"+m+"Gradient><rect "+g+' fill="url(#gradient)" /></svg>',c=encodeURIComponent(c),c="data:image/svg+xml,"+c,new o(new r("'"+c+"'",c,!1,this.index,this.currentFileInfo),this.index,this.currentFileInfo)})}},{"../tree/color":48,"../tree/dimension":54,"../tree/expression":57,"../tree/quoted":71,"../tree/url":78,"./function-registry":21}],27:[function(e){var t=e("../tree/keyword"),n=e("../tree/detached-ruleset"),i=e("../tree/dimension"),r=e("../tree/color"),o=e("../tree/quoted"),a=e("../tree/anonymous"),s=e("../tree/url"),l=e("../tree/operation"),c=e("./function-registry"),u=function(e,n){return e instanceof n?t.True:t.False},d=function(e,n){if(void 0===n)throw{type:"Argument",message:"missing the required second argument to isunit."};if("string"!=typeof(n="string"==typeof n.value?n.value:n))throw{type:"Argument",message:"Second argument to isunit should be a unit or a string."};return e instanceof i&&e.unit.is(n)?t.True:t.False},h=function(e){return Array.isArray(e.value)?e.value:Array(e)};c.addMultiple({isruleset:function(e){return u(e,n)},iscolor:function(e){return u(e,r)},isnumber:function(e){return u(e,i)},isstring:function(e){return u(e,o)},iskeyword:function(e){return u(e,t)},isurl:function(e){return u(e,s)},ispixel:function(e){return d(e,"px")},ispercentage:function(e){return d(e,"%")},isem:function(e){return d(e,"em")},isunit:d,unit:function(e,n){if(!(e instanceof i))throw{type:"Argument",message:"the first argument to unit must be a number"+(e instanceof l?". Have you forgotten parenthesis?":"")};return n=n?n instanceof t?n.value:n.toCSS():"",new i(e.value,n)},"get-unit":function(e){return new a(e.unit)},extract:function(e,t){return t=t.value-1,h(e)[t]},length:function(e){return new i(h(e).length)}})},{"../tree/anonymous":44,"../tree/color":48,"../tree/detached-ruleset":53,"../tree/dimension":54,"../tree/keyword":63,"../tree/operation":69,"../tree/quoted":71,"../tree/url":78,"./function-registry":21}],28:[function(e,t){var n=e("./contexts"),i=e("./parser/parser"),r=e("./plugins/function-importer");t.exports=function(e){var t=function(e,t){this.rootFilename=t.filename,this.paths=e.paths||[],this.contents={},this.contentsIgnoredChars={},this.mime=e.mime,this.error=null,this.context=e,this.queue=[],this.files={}};return t.prototype.push=function(t,o,a,s,l){var c=this;this.queue.push(t);var u=function(e,n,i){c.queue.splice(c.queue.indexOf(t),1);var r=i===c.rootFilename;s.optional&&e?l(null,{rules:[]},!1,null):(c.files[i]=n,e&&!c.error&&(c.error=e),l(e,n,r,i))},d={relativeUrls:this.context.relativeUrls,entryPath:a.entryPath,rootpath:a.rootpath,rootFilename:a.rootFilename},h=e.getFileManager(t,a.currentDirectory,this.context,e);if(!h)return void u({message:"Could not find a file-manager for "+t});o&&(t=h.tryAppendExtension(t,s.plugin?".js":".less"));var p=function(e){var t=e.filename,o=e.contents.replace(/^\uFEFF/,"");d.currentDirectory=h.getPath(t),d.relativeUrls&&(d.rootpath=h.join(c.context.rootpath||"",h.pathDiff(d.currentDirectory,d.entryPath)),!h.isPathAbsolute(d.rootpath)&&h.alwaysMakePathsAbsolute()&&(d.rootpath=h.join(d.entryPath,d.rootpath))),d.filename=t;var l=new n.Parse(c.context);l.processImports=!1,c.contents[t]=o,(a.reference||s.reference)&&(d.reference=!0),s.plugin?new r(l,d).eval(o,function(e,n){u(e,n,t)}):s.inline?u(null,o,t):new i(l,c,d).parse(o,function(e,n){u(e,n,t)})},f=h.loadFile(t,a.currentDirectory,this.context,e,function(e,t){e?u(e):p(t)});f&&f.then(p,u)},t}},{"./contexts":10,"./parser/parser":36,"./plugins/function-importer":38}],29:[function(e,t){t.exports=function(t,n){var i,r,o,a,s;return{version:[2,5,1],data:e("./data"),tree:e("./tree"),Environment:s=e("./environment/environment"),AbstractFileManager:e("./environment/abstract-file-manager"),environment:t=new s(t,n),visitors:e("./visitors"),Parser:e("./parser/parser"),functions:e("./functions")(t),contexts:e("./contexts"),SourceMapOutput:i=e("./source-map-output")(t),SourceMapBuilder:r=e("./source-map-builder")(i,t),ParseTree:o=e("./parse-tree")(r),ImportManager:a=e("./import-manager")(t),render:e("./render")(t,o,a),parse:e("./parse")(t,o,a),LessError:e("./less-error"),transformTree:e("./transform-tree"),utils:e("./utils"),PluginManager:e("./plugin-manager"),logger:e("./logger")}}},{"./contexts":10,"./data":12,"./environment/abstract-file-manager":14,"./environment/environment":15,"./functions":22,"./import-manager":28,"./less-error":30,"./logger":31,"./parse":33,"./parse-tree":32,"./parser/parser":36,"./plugin-manager":37,"./render":39,"./source-map-builder":40,"./source-map-output":41,"./transform-tree":42,"./tree":60,"./utils":81,"./visitors":85}],30:[function(e,t){var n=e("./utils"),i=t.exports=function(e,t,i){Error.call(this);var r=e.filename||i;if(t&&r){var o=t.contents[r],a=n.getLocation(e.index,o),s=a.line,l=a.column,c=e.call&&n.getLocation(e.call,o).line,u=o.split("\n");this.type=e.type||"Syntax",this.filename=r,this.index=e.index,this.line="number"==typeof s?s+1:null,this.callLine=c+1,this.callExtract=u[c],this.column=l,this.extract=[u[s-1],u[s],u[s+1]]}this.message=e.message,this.stack=e.stack};if(void 0===Object.create){var r=function(){};r.prototype=Error.prototype,i.prototype=new r}else i.prototype=Object.create(Error.prototype);i.prototype.constructor=i},{"./utils":81}],31:[function(e,t){t.exports={error:function(e){this._fireEvent("error",e)},warn:function(e){this._fireEvent("warn",e)},info:function(e){this._fireEvent("info",e)},debug:function(e){this._fireEvent("debug",e)},addListener:function(e){this._listeners.push(e)},removeListener:function(e){for(var t=0;this._listeners.length>t;t++)if(this._listeners[t]===e)return void this._listeners.splice(t,1)},_fireEvent:function(e,t){for(var n=0;this._listeners.length>n;n++){var i=this._listeners[n][e];i&&i(t)}},_listeners:[]}},{}],32:[function(e,t){var n=e("./less-error"),i=e("./transform-tree"),r=e("./logger");t.exports=function(e){var t=function(e,t){this.root=e,this.imports=t};return t.prototype.toCSS=function(t){var o,a,s={};try{o=i(this.root,t)}catch(e){throw new n(e,this.imports)}try{var l=Boolean(t.compress);l&&r.warn("The compress option has been deprecated. We recommend you use a dedicated css minifier, for instance see less-plugin-clean-css.");var c={compress:l,dumpLineNumbers:t.dumpLineNumbers,strictUnits:Boolean(t.strictUnits),numPrecision:8};t.sourceMap?(a=new e(t.sourceMap),s.css=a.toCSS(o,c,this.imports)):s.css=o.toCSS(c)}catch(e){throw new n(e,this.imports)}if(t.pluginManager)for(var u=t.pluginManager.getPostProcessors(),d=0;u.length>d;d++)s.css=u[d].process(s.css,{sourceMap:a,options:t,imports:this.imports});t.sourceMap&&(s.map=a.getExternalSourceMap()),s.imports=[];for(var h in this.imports.files)this.imports.files.hasOwnProperty(h)&&h!==this.imports.rootFilename&&s.imports.push(h);return s},t}},{"./less-error":30,"./logger":31,"./transform-tree":42}],33:[function(e,t){var n,i=e("./contexts"),r=e("./parser/parser"),o=e("./plugin-manager");t.exports=function(t,a,s){var l=function(t,a,c){if(a=a||{},"function"==typeof a&&(c=a,a={}),!c){n||(n="undefined"==typeof Promise?e("promise"):Promise);var u=this;return new n(function(e,n){l.call(u,t,a,function(t,i){t?n(t):e(i)})})}var d,h,p=new o(this);if(p.addPlugins(a.plugins),a.pluginManager=p,d=new i.Parse(a),a.rootFileInfo)h=a.rootFileInfo;else{var f=a.filename||"input",m=f.replace(/[^\/\\]*$/,"");h={filename:f,relativeUrls:d.relativeUrls,rootpath:d.rootpath||"",currentDirectory:m,entryPath:m,rootFilename:f},h.rootpath&&"/"!==h.rootpath.slice(-1)&&(h.rootpath+="/")}var g=new s(d,h);new r(d,g,h).parse(t,function(e,t){return e?c(e):void c(null,t,g,a)},a)};return l}},{"./contexts":10,"./parser/parser":36,"./plugin-manager":37,promise:void 0}],34:[function(e,t){t.exports=function(e,t){function n(t){var n=s-g;512>n&&!t||!n||(m.push(e.slice(g,s+1)),g=s+1)}var i,r,o,a,s,l,c,u,d,h=e.length,p=0,f=0,m=[],g=0;for(s=0;h>s;s++)if(!((c=e.charCodeAt(s))>=97&&122>=c||34>c))switch(c){case 40:f++,r=s;continue;case 41:if(--f<0)return t("missing opening `(`",s);continue;case 59:f||n();continue;case 123:p++,i=s;continue;case 125:if(--p<0)return t("missing opening `{`",s);p||f||n();continue;case 92:if(h-1>s){s++;continue}return t("unescaped `\\`",s);case 34:case 39:case 96:for(d=0,l=s,s+=1;h>s;s++)if(!((u=e.charCodeAt(s))>96)){if(u==c){d=1;break}if(92==u){if(s==h-1)return t("unescaped `\\`",s);s++}}if(d)continue;return t("unmatched `"+String.fromCharCode(c)+"`",l);case 47:if(f||s==h-1)continue;if(47==(u=e.charCodeAt(s+1)))for(s+=2;h>s&&(!(13>=(u=e.charCodeAt(s)))||10!=u&&13!=u);s++);else if(42==u){for(o=l=s,s+=2;h-1>s&&(u=e.charCodeAt(s),125==u&&(a=s),42!=u||47!=e.charCodeAt(s+1));s++);if(s==h-1)return t("missing closing `*/`",l);s++}continue;case 42:if(h-1>s&&47==e.charCodeAt(s+1))return t("unmatched `/*`",s);continue}return 0!==p?o>i&&a>o?t("missing closing `}` or `*/`",i):t("missing closing `}`",i):0!==f?t("missing closing `)`",r):(n(!0),m)}},{}],35:[function(e,t){var n=e("./chunker");t.exports=function(){var e,t,i,r,o,a,s,l=[],c={};c.save=function(){s=c.i,l.push({current:a,i:c.i,j:t})},c.restore=function(e){(c.i>i||c.i===i&&e&&!r)&&(i=c.i,r=e);var n=l.pop();a=n.current,s=c.i=n.i,t=n.j},c.forget=function(){l.pop()},c.isWhitespace=function(t){var n=c.i+(t||0),i=e.charCodeAt(n);return i===u||i===p||i===d||i===h},c.$re=function(e){c.i>s&&(a=a.slice(c.i-s),s=c.i);var t=e.exec(a);return t?(f(t[0].length),"string"==typeof t?t:1===t.length?t[0]:t):null},c.$char=function(t){return e.charAt(c.i)!==t?null:(f(1),t)},c.$str=function(t){for(var n=t.length,i=0;n>i;i++)if(e.charAt(c.i+i)!==t.charAt(i))return null;return f(n),t},c.$quoted=function(){var t=e.charAt(c.i);if("'"===t||'"'===t){for(var n=e.length,i=c.i,r=1;n>r+i;r++){switch(e.charAt(r+i)){case"\\":r++;continue;case"\r":case"\n":break;case t:var o=e.substr(i,r+1);return f(r+1),o}}return null}};var u=32,d=9,h=10,p=13;c.autoCommentAbsorb=!0,c.commentStore=[],c.finished=!1;var f=function(n){for(var i,r,l,m=c.i,g=t,v=c.i-s,b=c.i+a.length-v,y=c.i+=n,w=e;b>c.i;c.i++){if(i=w.charCodeAt(c.i),c.autoCommentAbsorb&&47===i){if("/"===(r=w.charAt(c.i+1))){l={index:c.i,isLineComment:!0};var _=w.indexOf("\n",c.i+2);0>_&&(_=b),c.i=_,l.text=w.substr(l.i,c.i-l.i),c.commentStore.push(l);continue}if("*"===r){var S=w.indexOf("*/",c.i+2);if(S>=0){l={index:c.i,text:w.substr(c.i,S+2-c.i),isLineComment:!1},c.i+=l.text.length-1,c.commentStore.push(l);continue}}break}if(i!==u&&i!==h&&i!==d&&i!==p)break}if(a=a.slice(n+c.i-y+v),s=c.i,!a.length){if(o.length-1>t)return a=o[++t],f(0),!0;c.finished=!0}return m!==c.i||g!==t};return c.peek=function(t){if("string"==typeof t){for(var n=0;t.length>n;n++)if(e.charAt(c.i+n)!==t.charAt(n))return!1;return!0}return t.test(a)},c.peekChar=function(t){return e.charAt(c.i)===t},c.currentChar=function(){return e.charAt(c.i)},c.getInput=function(){return e},c.peekNotNumeric=function(){var t=e.charCodeAt(c.i);return t>57||43>t||47===t||44===t},c.start=function(r,l,u){e=r,c.i=t=s=i=0,o=l?n(r,u):[r],a=o[0],f(0)},c.end=function(){var t,n=c.i>=e.length;return i>c.i&&(t=r,c.i=i),{isFinished:n,furthest:c.i,furthestPossibleErrorMessage:t,furthestReachedEnd:c.i>=e.length-1,furthestChar:e[c.i]}},c}},{"./chunker":34}],36:[function(e,t){var n=e("../less-error"),i=e("../tree"),r=e("../visitors"),o=e("./parser-input"),a=e("../utils"),s=function e(t,s,l){function c(e,t){var n="[object Function]"===Object.prototype.toString.call(e)?e.call(p):f.$re(e);return n||void d(t||("string"==typeof e?"expected '"+e+"' got '"+f.currentChar()+"'":"unexpected token"))}function u(e,t){return f.$char(e)?e:void d(t||"expected '"+e+"' got '"+f.currentChar()+"'")}function d(e,t){throw new n({index:f.i,filename:l.filename,type:t||"Syntax",message:e},s)}function h(e){var t=l.filename;return{lineNumber:a.getLocation(e,f.getInput()).line+1,fileName:t}}var p,f=o();return{parse:function(o,a,c){var u,d,h,p,m=null,g="";if(d=c&&c.globalVars?e.serializeVars(c.globalVars)+"\n":"",h=c&&c.modifyVars?"\n"+e.serializeVars(c.modifyVars):"",t.pluginManager)for(var v=t.pluginManager.getPreProcessors(),b=0;v.length>b;b++)o=v[b].process(o,{context:t,imports:s,fileInfo:l});(d||c&&c.banner)&&(g=(c&&c.banner?c.banner:"")+d,p=s.contentsIgnoredChars,p[l.filename]=p[l.filename]||0,p[l.filename]+=g.length),o=o.replace(/\r\n?/g,"\n"),o=g+o.replace(/^\uFEFF/,"")+h,s.contents[l.filename]=o;try{f.start(o,t.chunkInput,function(e,t){throw new n({index:t,type:"Parse",message:e,filename:l.filename},s)}),u=new i.Ruleset(null,this.parsers.primary()),u.root=!0,u.firstRoot=!0}catch(e){return a(new n(e,s,l.filename))}var y=f.end();if(!y.isFinished){var w=y.furthestPossibleErrorMessage;w||(w="Unrecognised input","}"===y.furthestChar?w+=". Possibly missing opening '{'":")"===y.furthestChar?w+=". Possibly missing opening '('":y.furthestReachedEnd&&(w+=". Possibly missing something")),m=new n({type:"Parse",message:w,index:y.furthest,filename:l.filename},s)}var _=function(e){return e=m||e||s.error,e?(e instanceof n||(e=new n(e,s,l.filename)),a(e)):a(null,u)};return!1===t.processImports?_():void new r.ImportVisitor(s,_).run(u)},parsers:p={primary:function(){for(var e,t=this.mixin,n=[];;){for(;e=this.comment();)n.push(e);if(f.finished)break;if(f.peek("}"))break;if(e=this.extendRule())n=n.concat(e);else if(e=t.definition()||this.rule()||this.ruleset()||t.call()||this.rulesetCall()||this.directive())n.push(e);else{for(var i=!1;f.$char(";");)i=!0;if(!i)break}}return n},comment:function(){if(f.commentStore.length){var e=f.commentStore.shift();return new i.Comment(e.text,e.isLineComment,e.index,l)}},entities:{quoted:function(){var e,t=f.i,n=!1;return f.save(),f.$char("~")&&(n=!0),(e=f.$quoted())?(f.forget(),new i.Quoted(e.charAt(0),e.substr(1,e.length-2),n,t,l)):void f.restore()},keyword:function(){var e=f.$char("%")||f.$re(/^[_A-Za-z-][_A-Za-z0-9-]*/);return e?i.Color.fromKeyword(e)||new i.Keyword(e):void 0},call:function(){var e,t,n,r,o=f.i;if(!f.peek(/^url\(/i))return f.save(),(e=f.$re(/^([\w-]+|%|progid:[\w\.]+)\(/))?(e=e[1],t=e.toLowerCase(),"alpha"===t&&(r=p.alpha())?(f.forget(),r):(n=this.arguments(),f.$char(")")?(f.forget(),new i.Call(e,n,o,l)):void f.restore("Could not parse call arguments or missing ')'"))):void f.forget()},arguments:function(){for(var e,t=[];(e=this.assignment()||p.expression())&&(t.push(e),f.$char(",")););return t},literal:function(){return this.dimension()||this.color()||this.quoted()||this.unicodeDescriptor()},assignment:function(){var e,t;return f.save(),(e=f.$re(/^\w+(?=\s?=)/i))&&f.$char("=")&&(t=p.entity())?(f.forget(),new i.Assignment(e,t)):void f.restore()},url:function(){var e,t=f.i;return f.autoCommentAbsorb=!1,f.$str("url(")?(e=this.quoted()||this.variable()||f.$re(/^(?:(?:\\[\(\)'"])|[^\(\)'"])+/)||"",f.autoCommentAbsorb=!0,u(")"),new i.URL(null!=e.value||e instanceof i.Variable?e:new i.Anonymous(e),t,l)):void(f.autoCommentAbsorb=!0)},variable:function(){var e,t=f.i;return"@"===f.currentChar()&&(e=f.$re(/^@@?[\w-]+/))?new i.Variable(e,t,l):void 0},variableCurly:function(){var e,t=f.i;return"@"===f.currentChar()&&(e=f.$re(/^@\{([\w-]+)\}/))?new i.Variable("@"+e[1],t,l):void 0},color:function(){var e;if("#"===f.currentChar()&&(e=f.$re(/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})/))){var t=e.input.match(/^#([\w]+).*/);return t=t[1],t.match(/^[A-Fa-f0-9]+$/)||d("Invalid HEX color code"),new i.Color(e[1])}},dimension:function(){if(!f.peekNotNumeric()){var e=f.$re(/^([+-]?\d*\.?\d+)(%|[a-z]+)?/i);return e?new i.Dimension(e[1],e[2]):void 0}},unicodeDescriptor:function(){var e;return e=f.$re(/^U\+[0-9a-fA-F?]+(\-[0-9a-fA-F?]+)?/),e?new i.UnicodeDescriptor(e[0]):void 0},javascript:function(){var e,t=f.i;f.save();var n=f.$char("~");return f.$char("`")?(e=f.$re(/^[^`]*`/))?(f.forget(),new i.JavaScript(e.substr(0,e.length-1),Boolean(n),t,l)):void f.restore("invalid javascript definition"):void f.restore()}},variable:function(){var e;return"@"===f.currentChar()&&(e=f.$re(/^(@[\w-]+)\s*:/))?e[1]:void 0},rulesetCall:function(){var e;return"@"===f.currentChar()&&(e=f.$re(/^(@[\w-]+)\s*\(\s*\)\s*;/))?new i.RulesetCall(e[1]):void 0},extend:function(e){var t,n,r,o,a,s=f.i;if(f.$str(e?"&:extend(":":extend(")){do{for(r=null,t=null;!(r=f.$re(/^(all)(?=\s*(\)|,))/))&&(n=this.element());)t?t.push(n):t=[n];r=r&&r[1],t||d("Missing target selector for :extend()."),a=new i.Extend(new i.Selector(t),r,s),o?o.push(a):o=[a]}while(f.$char(","));return c(/^\)/),e&&c(/^;/),o}},extendRule:function(){return this.extend(!0)},mixin:{call:function(){var e,t,n,r,o,a,s=f.currentChar(),c=!1,d=f.i;if("."===s||"#"===s){for(f.save();e=f.i,r=f.$re(/^[#.](?:[\w-]|\\(?:[A-Fa-f0-9]{1,6} ?|[^A-Fa-f0-9]))+/);)n=new i.Element(o,r,e,l),t?t.push(n):t=[n],o=f.$char(">");return t&&(f.$char("(")&&(a=this.args(!0).args,u(")")),p.important()&&(c=!0),p.end())?(f.forget(),new i.mixin.Call(t,a,d,l,c)):void f.restore()}},args:function(e){var t,n,r,o,a,s,l=p.entities,c={args:null,variadic:!1},u=[],h=[],m=[];for(f.save();;){if(e)s=p.detachedRuleset()||p.expression();else{if(f.commentStore.length=0,f.$str("...")){c.variadic=!0,f.$char(";")&&!t&&(t=!0),(t?h:m).push({variadic:!0});break}s=l.variable()||l.literal()||l.keyword()}if(!s)break;o=null,s.throwAwayComments&&s.throwAwayComments(),a=s;var g=null;if(e?s.value&&1==s.value.length&&(g=s.value[0]):g=s,g&&g instanceof i.Variable)if(f.$char(":")){if(u.length>0&&(t&&d("Cannot mix ; and , as delimiter types"),n=!0),!(a=p.detachedRuleset()||p.expression())){if(!e)return f.restore(),c.args=[],c;d("could not understand value for named argument")}o=r=g.name}else{if(!e&&f.$str("...")){c.variadic=!0,f.$char(";")&&!t&&(t=!0),(t?h:m).push({name:s.name,variadic:!0});break}e||(r=o=g.name,a=null)}a&&u.push(a),m.push({name:o,value:a}),f.$char(",")||(f.$char(";")||t)&&(n&&d("Cannot mix ; and , as delimiter types"),t=!0,u.length>1&&(a=new i.Value(u)),h.push({name:r,value:a}),r=null,u=[],n=!1)}return f.forget(),c.args=t?h:m,c},definition:function(){var e,t,n,r,o=[],a=!1;if(!("."!==f.currentChar()&&"#"!==f.currentChar()||f.peek(/^[^{]*\}/)))if(f.save(),t=f.$re(/^([#.](?:[\w-]|\\(?:[A-Fa-f0-9]{1,6} ?|[^A-Fa-f0-9]))+)\s*\(/)){e=t[1];var s=this.args(!1);if(o=s.args,a=s.variadic,!f.$char(")"))return void f.restore("Missing closing ')'");if(f.commentStore.length=0,f.$str("when")&&(r=c(p.conditions,"expected condition")),n=p.block())return f.forget(),new i.mixin.Definition(e,o,n,r,a);f.restore()}else f.forget()}},entity:function(){var e=this.entities;return this.comment()||e.literal()||e.variable()||e.url()||e.call()||e.keyword()||e.javascript()},end:function(){return f.$char(";")||f.peek("}")},alpha:function(){var e;if(f.$re(/^opacity=/i))return e=f.$re(/^\d+/),e||(e=c(this.entities.variable,"Could not parse alpha")),u(")"),new i.Alpha(e)},element:function(){var e,t,n,r=f.i;return t=this.combinator(),e=f.$re(/^(?:\d+\.\d+|\d+)%/)||f.$re(/^(?:[.#]?|:*)(?:[\w-]|[^\x00-\x9f]|\\(?:[A-Fa-f0-9]{1,6} ?|[^A-Fa-f0-9]))+/)||f.$char("*")||f.$char("&")||this.attribute()||f.$re(/^\([^&()@]+\)/)||f.$re(/^[\.#:](?=@)/)||this.entities.variableCurly(),e||(f.save(),f.$char("(")?(n=this.selector())&&f.$char(")")?(e=new i.Paren(n),f.forget()):f.restore("Missing closing ')'"):f.forget()),e?new i.Element(t,e,r,l):void 0},combinator:function(){var e=f.currentChar();if("/"===e){f.save();var t=f.$re(/^\/[a-z]+\//i);if(t)return f.forget(),new i.Combinator(t);f.restore()}if(">"===e||"+"===e||"~"===e||"|"===e||"^"===e){for(f.i++,"^"===e&&"^"===f.currentChar()&&(e="^^",f.i++);f.isWhitespace();)f.i++;return new i.Combinator(e)}return new i.Combinator(f.isWhitespace(-1)?" ":null)},lessSelector:function(){return this.selector(!0)},selector:function(e){for(var t,n,r,o,a,s,u,h=f.i;(e&&(n=this.extend())||e&&(s=f.$str("when"))||(o=this.element()))&&(s?u=c(this.conditions,"expected condition"):u?d("CSS guard can only be used at the end of selector"):n?a=a?a.concat(n):n:(a&&d("Extend can only be used at the end of selector"),r=f.currentChar(),t?t.push(o):t=[o],o=null),"{"!==r&&"}"!==r&&";"!==r&&","!==r&&")"!==r););return t?new i.Selector(t,a,u,h,l):void(a&&d("Extend must be used to extend a selector, it cannot be used on its own"))},attribute:function(){if(f.$char("[")){var e,t,n,r=this.entities;return(e=r.variableCurly())||(e=c(/^(?:[_A-Za-z0-9-\*]*\|)?(?:[_A-Za-z0-9-]|\\.)+/)),n=f.$re(/^[|~*$^]?=/),n&&(t=r.quoted()||f.$re(/^[0-9]+%/)||f.$re(/^[\w-]+/)||r.variableCurly()),u("]"),new i.Attribute(e,n,t)}},block:function(){var e;return f.$char("{")&&(e=this.primary())&&f.$char("}")?e:void 0},blockRuleset:function(){var e=this.block();return e&&(e=new i.Ruleset(null,e)),e},detachedRuleset:function(){var e=this.blockRuleset();return e?new i.DetachedRuleset(e):void 0},ruleset:function(){var e,n,r,o;for(f.save(),t.dumpLineNumbers&&(o=h(f.i));(n=this.lessSelector())&&(e?e.push(n):e=[n],f.commentStore.length=0,n.condition&&e.length>1&&d("Guards are only currently allowed on a single selector."),f.$char(","));)n.condition&&d("Guards are only currently allowed on a single selector."),f.commentStore.length=0;if(e&&(r=this.block())){f.forget();var a=new i.Ruleset(e,r,t.strictImports);return t.dumpLineNumbers&&(a.debugInfo=o),a}f.restore()},rule:function(e){var n,r,o,a,s,c=f.i,u=f.currentChar();if("."!==u&&"#"!==u&&"&"!==u&&":"!==u)if(f.save(),n=this.variable()||this.ruleProperty()){if(s="string"==typeof n,s&&(r=this.detachedRuleset()),f.commentStore.length=0,!r){a=!s&&n.length>1&&n.pop().value;var d=!e&&(t.compress||s);if(d&&(r=this.value()),!r&&(r=this.anonymousValue()))return f.forget(),new i.Rule(n,r,!1,a,c,l);d||r||(r=this.value()),o=this.important()}if(r&&this.end())return f.forget(),new i.Rule(n,r,o,a,c,l);if(f.restore(),r&&!e)return this.rule(!0)}else f.forget()},anonymousValue:function(){var e=f.$re(/^([^@+\/'"*`(;{}-]*);/);return e?new i.Anonymous(e[1]):void 0},import:function(){var e,t,n=f.i,r=f.$re(/^@import?\s+/);if(r){var o=(r?this.importOptions():null)||{};if(e=this.entities.quoted()||this.entities.url())return t=this.mediaFeatures(),f.$char(";")||(f.i=n,d("missing semi-colon or unrecognised media features on import")),t=t&&new i.Value(t),new i.Import(e,t,o,n,l);f.i=n,d("malformed import statement")}},importOptions:function(){var e,t,n,i={};if(!f.$char("("))return null;do{if(e=this.importOption()){switch(t=e,n=!0,t){case"css":t="less",n=!1;break;case"once":t="multiple",n=!1}if(i[t]=n,!f.$char(","))break}}while(e);return u(")"),i},importOption:function(){var e=f.$re(/^(less|css|multiple|once|inline|reference|optional)/);return e?e[1]:void 0},mediaFeature:function(){var e,t,n=this.entities,r=[];f.save();do{if(e=n.keyword()||n.variable())r.push(e);else if(f.$char("(")){if(t=this.property(),e=this.value(),!f.$char(")"))return f.restore("Missing closing ')'"),null;if(t&&e)r.push(new i.Paren(new i.Rule(t,e,null,null,f.i,l,!0)));else{if(!e)return f.restore("badly formed media feature definition"),null;r.push(new i.Paren(e))}}}while(e);return f.forget(),r.length>0?new i.Expression(r):void 0},mediaFeatures:function(){var e,t=this.entities,n=[];do{if(e=this.mediaFeature()){if(n.push(e),!f.$char(","))break}else if((e=t.variable())&&(n.push(e),!f.$char(",")))break}while(e);return n.length>0?n:null},media:function(){var e,n,r,o;return t.dumpLineNumbers&&(o=h(f.i)),f.save(),f.$str("@media")?(e=this.mediaFeatures(),(n=this.block())?(f.forget(),r=new i.Media(n,e,f.i,l),t.dumpLineNumbers&&(r.debugInfo=o),r):void f.restore("media definitions require block statements after any features")):void f.restore()},plugin:function(){var e,t=f.i;if(f.$re(/^@plugin?\s+/)){var n={plugin:!0};if(e=this.entities.quoted()||this.entities.url())return f.$char(";")||(f.i=t,d("missing semi-colon on plugin")),new i.Import(e,null,n,t,l);f.i=t,d("malformed plugin statement")}},directive:function(){var e,n,r,o,a,s,c,u=f.i,p=!0,m=!0;if("@"===f.currentChar()){if(n=this.import()||this.plugin()||this.media())return n;if(f.save(),e=f.$re(/^@[a-z-]+/)){switch(o=e,"-"==e.charAt(1)&&e.indexOf("-",2)>0&&(o="@"+e.slice(e.indexOf("-",2)+1)),o){case"@counter-style":a=!0,p=!0;break;case"@charset":a=!0,p=!1;break;case"@namespace":s=!0,p=!1;break;case"@keyframes":a=!0;break;case"@host":case"@page":c=!0;break;case"@document":case"@supports":c=!0,m=!1}return f.commentStore.length=0,a?(n=this.entity())||d("expected "+e+" identifier"):s?(n=this.expression())||d("expected "+e+" expression"):c&&(n=(f.$re(/^[^{;]+/)||"").trim())&&(n=new i.Anonymous(n)),p&&(r=this.blockRuleset()),r||!p&&n&&f.$char(";")?(f.forget(),new i.Directive(e,n,r,u,l,t.dumpLineNumbers?h(u):null,!1,m)):void f.restore("directive options not recognised")}}},value:function(){var e,t=[];do{if((e=this.expression())&&(t.push(e),!f.$char(",")))break}while(e);return t.length>0?new i.Value(t):void 0},important:function(){return"!"===f.currentChar()?f.$re(/^! *important/):void 0},sub:function(){var e,t;return f.save(),f.$char("(")?(e=this.addition(),e&&f.$char(")")?(f.forget(),t=new i.Expression([e]),t.parens=!0,t):void f.restore("Expected ')'")):void f.restore()},multiplication:function(){var e,t,n,r,o;if(e=this.operand()){for(o=f.isWhitespace(-1);!f.peek(/^\/[*\/]/);){if(f.save(),!(n=f.$char("/")||f.$char("*"))){f.forget();break}if(!(t=this.operand())){f.restore();break}f.forget(),e.parensInOp=!0,t.parensInOp=!0,r=new i.Operation(n,[r||e,t],o),o=f.isWhitespace(-1)}return r||e}},addition:function(){var e,t,n,r,o;if(e=this.multiplication()){for(o=f.isWhitespace(-1);(n=f.$re(/^[-+]\s+/)||!o&&(f.$char("+")||f.$char("-")))&&(t=this.multiplication());)e.parensInOp=!0,t.parensInOp=!0,r=new i.Operation(n,[r||e,t],o),o=f.isWhitespace(-1);return r||e}},conditions:function(){var e,t,n,r=f.i;if(e=this.condition()){for(;f.peek(/^,\s*(not\s*)?\(/)&&f.$char(",")&&(t=this.condition());)n=new i.Condition("or",n||e,t,r);return n||e}},condition:function(){var e,t,n,r,o=this.entities,a=f.i,s=!1;return f.$str("not")&&(s=!0),u("("),e=this.addition()||o.keyword()||o.quoted(),e?(f.$char(">")?r=f.$char("=")?">=":">":f.$char("<")?r=f.$char("=")?"<=":"<":f.$char("=")&&(r=f.$char(">")?"=>":f.$char("<")?"=<":"="),r?(t=this.addition()||o.keyword()||o.quoted(),t?n=new i.Condition(r,e,t,a,s):d("expected expression")):n=new i.Condition("=",e,new i.Keyword("true"),a,s),u(")"),f.$str("and")?new i.Condition("and",n,this.condition()):n):void 0},operand:function(){var e,t=this.entities;f.peek(/^-[@\(]/)&&(e=f.$char("-"));var n=this.sub()||t.dimension()||t.color()||t.variable()||t.call();return e&&(n.parensInOp=!0,n=new i.Negative(n)),n},expression:function(){var e,t,n=[];do{e=this.comment(),e?n.push(e):(e=this.addition()||this.entity())&&(n.push(e),f.peek(/^\/[\/*]/)||(t=f.$char("/"))&&n.push(new i.Anonymous(t)))}while(e);return n.length>0?new i.Expression(n):void 0},property:function(){var e=f.$re(/^(\*?-?[_a-zA-Z0-9-]+)\s*:/);return e?e[1]:void 0},ruleProperty:function(){function e(e){var t=f.i,n=f.$re(e);return n?(o.push(t),r.push(n[1])):void 0}var t,n,r=[],o=[];f.save();var a=f.$re(/^([_a-zA-Z0-9-]+)\s*:/);if(a)return r=[new i.Keyword(a[1])],f.forget(),r;for(e(/^(\*?)/);e(/^((?:[\w-]+)|(?:@\{[\w-]+\}))/););if(r.length>1&&e(/^((?:\+_|\+)?)\s*:/)){for(f.forget(),""===r[0]&&(r.shift(),o.shift()),n=0;r.length>n;n++)t=r[n],r[n]="@"!==t.charAt(0)?new i.Keyword(t):new i.Variable("@"+t.slice(2,-1),o[n],l);return r}f.restore()}}}};s.serializeVars=function(e){var t="";for(var n in e)if(Object.hasOwnProperty.call(e,n)){var i=e[n];t+=("@"===n[0]?"":"@")+n+": "+i+(";"===String(i).slice(-1)?"":";")}return t},t.exports=s},{"../less-error":30,"../tree":60,"../utils":81,"../visitors":85,"./parser-input":35}],37:[function(e,t){var n=function(e){this.less=e,this.visitors=[],this.preProcessors=[],this.postProcessors=[],this.installedPlugins=[],this.fileManagers=[]};n.prototype.addPlugins=function(e){if(e)for(var t=0;e.length>t;t++)this.addPlugin(e[t])},n.prototype.addPlugin=function(e){this.installedPlugins.push(e),e.install(this.less,this)},n.prototype.addVisitor=function(e){this.visitors.push(e)},n.prototype.addPreProcessor=function(e,t){var n;for(n=0;this.preProcessors.length>n&&!(this.preProcessors[n].priority>=t);n++);this.preProcessors.splice(n,0,{preProcessor:e,priority:t})},n.prototype.addPostProcessor=function(e,t){var n;for(n=0;this.postProcessors.length>n&&!(this.postProcessors[n].priority>=t);n++);this.postProcessors.splice(n,0,{postProcessor:e,priority:t})},n.prototype.addFileManager=function(e){this.fileManagers.push(e)},n.prototype.getPreProcessors=function(){for(var e=[],t=0;this.preProcessors.length>t;t++)e.push(this.preProcessors[t].preProcessor);return e},n.prototype.getPostProcessors=function(){for(var e=[],t=0;this.postProcessors.length>t;t++)e.push(this.postProcessors[t].postProcessor);return e},n.prototype.getVisitors=function(){return this.visitors},n.prototype.getFileManagers=function(){return this.fileManagers},t.exports=n},{}],38:[function(e,t){var n=e("../less-error"),i=e("../tree");(t.exports=function(e,t){this.fileInfo=t}).prototype.eval=function(e,t){var r,o={};r={add:function(e,t){o[e]=t},addMultiple:function(e){Object.keys(e).forEach(function(t){o[t]=e[t]})}};try{new Function("functions","tree","fileInfo",e)(r,i,this.fileInfo)}catch(e){t(new n({message:"Plugin evaluation error: '"+e.name+": "+e.message.replace(/["]/g,"'")+"'",filename:this.fileInfo.filename}),null)}t(null,{functions:o})}},{"../less-error":30,"../tree":60}],39:[function(e,t){var n;t.exports=function(t,i){var r=function(t,o,a){if("function"==typeof o&&(a=o,o={}),!a){n||(n="undefined"==typeof Promise?e("promise"):Promise);var s=this;return new n(function(e,n){r.call(s,t,o,function(t,i){t?n(t):e(i)})})}this.parse(t,o,function(e,t,n,r){if(e)return a(e);var o;try{o=new i(t,n).toCSS(r)}catch(e){return a(e)}a(null,o)})};return r}},{promise:void 0}],40:[function(e,t){t.exports=function(e,t){var n=function(e){this.options=e};return n.prototype.toCSS=function(t,n,i){var r=new e({contentsIgnoredCharsMap:i.contentsIgnoredChars,rootNode:t,contentsMap:i.contents,sourceMapFilename:this.options.sourceMapFilename,sourceMapURL:this.options.sourceMapURL,outputFilename:this.options.sourceMapOutputFilename,sourceMapBasepath:this.options.sourceMapBasepath,sourceMapRootpath:this.options.sourceMapRootpath,outputSourceFiles:this.options.outputSourceFiles,sourceMapGenerator:this.options.sourceMapGenerator,sourceMapFileInline:this.options.sourceMapFileInline}),o=r.toCSS(n);return this.sourceMap=r.sourceMap,this.sourceMapURL=r.sourceMapURL,this.options.sourceMapInputFilename&&(this.sourceMapInputFilename=r.normalizeFilename(this.options.sourceMapInputFilename)),o+this.getCSSAppendage()},n.prototype.getCSSAppendage=function(){var e=this.sourceMapURL;if(this.options.sourceMapFileInline){if(void 0===this.sourceMap)return"";e="data:application/json;base64,"+t.encodeBase64(this.sourceMap)}return e?"/*# sourceMappingURL="+e+" */":""},n.prototype.getExternalSourceMap=function(){return this.sourceMap},n.prototype.setExternalSourceMap=function(e){this.sourceMap=e},n.prototype.isInline=function(){return this.options.sourceMapFileInline},n.prototype.getSourceMapURL=function(){return this.sourceMapURL},n.prototype.getOutputFilename=function(){return this.options.sourceMapOutputFilename},n.prototype.getInputFilename=function(){return this.sourceMapInputFilename},n}},{}],41:[function(e,t){t.exports=function(e){var t=function(t){
this._css=[],this._rootNode=t.rootNode,this._contentsMap=t.contentsMap,this._contentsIgnoredCharsMap=t.contentsIgnoredCharsMap,t.sourceMapFilename&&(this._sourceMapFilename=t.sourceMapFilename.replace(/\\/g,"/")),this._outputFilename=t.outputFilename,this.sourceMapURL=t.sourceMapURL,t.sourceMapBasepath&&(this._sourceMapBasepath=t.sourceMapBasepath.replace(/\\/g,"/")),t.sourceMapRootpath?(this._sourceMapRootpath=t.sourceMapRootpath.replace(/\\/g,"/"),"/"!==this._sourceMapRootpath.charAt(this._sourceMapRootpath.length-1)&&(this._sourceMapRootpath+="/")):this._sourceMapRootpath="",this._outputSourceFiles=t.outputSourceFiles,this._sourceMapGeneratorConstructor=e.getSourceMapGenerator(),this._lineNumber=0,this._column=0};return t.prototype.normalizeFilename=function(e){return e=e.replace(/\\/g,"/"),this._sourceMapBasepath&&0===e.indexOf(this._sourceMapBasepath)&&(e=e.substring(this._sourceMapBasepath.length),("\\"===e.charAt(0)||"/"===e.charAt(0))&&(e=e.substring(1))),(this._sourceMapRootpath||"")+e},t.prototype.add=function(e,t,n,i){if(e){var r,o,a,s,l;if(t){var c=this._contentsMap[t.filename];this._contentsIgnoredCharsMap[t.filename]&&(n-=this._contentsIgnoredCharsMap[t.filename],0>n&&(n=0),c=c.slice(this._contentsIgnoredCharsMap[t.filename])),c=c.substring(0,n),o=c.split("\n"),s=o[o.length-1]}if(r=e.split("\n"),a=r[r.length-1],t)if(i)for(l=0;r.length>l;l++)this._sourceMapGenerator.addMapping({generated:{line:this._lineNumber+l+1,column:0===l?this._column:0},original:{line:o.length+l,column:0===l?s.length:0},source:this.normalizeFilename(t.filename)});else this._sourceMapGenerator.addMapping({generated:{line:this._lineNumber+1,column:this._column},original:{line:o.length,column:s.length},source:this.normalizeFilename(t.filename)});1===r.length?this._column+=a.length:(this._lineNumber+=r.length-1,this._column=a.length),this._css.push(e)}},t.prototype.isEmpty=function(){return 0===this._css.length},t.prototype.toCSS=function(e){if(this._sourceMapGenerator=new this._sourceMapGeneratorConstructor({file:this._outputFilename,sourceRoot:null}),this._outputSourceFiles)for(var t in this._contentsMap)if(this._contentsMap.hasOwnProperty(t)){var n=this._contentsMap[t];this._contentsIgnoredCharsMap[t]&&(n=n.slice(this._contentsIgnoredCharsMap[t])),this._sourceMapGenerator.setSourceContent(this.normalizeFilename(t),n)}if(this._rootNode.genCSS(e,this),this._css.length>0){var i,r=JSON.stringify(this._sourceMapGenerator.toJSON());this.sourceMapURL?i=this.sourceMapURL:this._sourceMapFilename&&(i=this._sourceMapFilename),this.sourceMapURL=i,this.sourceMap=r}return this._css.join("")},t}},{}],42:[function(e,t){var n=e("./contexts"),i=e("./visitors"),r=e("./tree");t.exports=function(e,t){t=t||{};var o,a=t.variables,s=new n.Eval(t);"object"!=typeof a||Array.isArray(a)||(a=Object.keys(a).map(function(e){var t=a[e];return t instanceof r.Value||(t instanceof r.Expression||(t=new r.Expression([t])),t=new r.Value([t])),new r.Rule("@"+e,t,!1,null,0)}),s.frames=[new r.Ruleset(null,a)]);var l,c=[],u=[new i.JoinSelectorVisitor,new i.ExtendVisitor,new i.ToCSSVisitor({compress:Boolean(t.compress)})];if(t.pluginManager){var d=t.pluginManager.getVisitors();for(l=0;d.length>l;l++){var h=d[l];h.isPreEvalVisitor?c.push(h):h.isPreVisitor?u.splice(0,0,h):u.push(h)}}for(l=0;c.length>l;l++)c[l].run(e);for(o=e.eval(s),l=0;u.length>l;l++)u[l].run(o);return o}},{"./contexts":10,"./tree":60,"./visitors":85}],43:[function(e,t){var n=e("./node"),i=function(e){this.value=e};i.prototype=new n,i.prototype.type="Alpha",i.prototype.accept=function(e){this.value=e.visit(this.value)},i.prototype.eval=function(e){return this.value.eval?new i(this.value.eval(e)):this},i.prototype.genCSS=function(e,t){t.add("alpha(opacity="),this.value.genCSS?this.value.genCSS(e,t):t.add(this.value),t.add(")")},t.exports=i},{"./node":68}],44:[function(e,t){var n=e("./node"),i=function(e,t,n,i,r){this.value=e,this.index=t,this.mapLines=i,this.currentFileInfo=n,this.rulesetLike=void 0!==r&&r};i.prototype=new n,i.prototype.type="Anonymous",i.prototype.eval=function(){return new i(this.value,this.index,this.currentFileInfo,this.mapLines,this.rulesetLike)},i.prototype.compare=function(e){return e.toCSS&&this.toCSS()===e.toCSS()?0:void 0},i.prototype.isRulesetLike=function(){return this.rulesetLike},i.prototype.genCSS=function(e,t){t.add(this.value,this.currentFileInfo,this.index,this.mapLines)},t.exports=i},{"./node":68}],45:[function(e,t){var n=e("./node"),i=function(e,t){this.key=e,this.value=t};i.prototype=new n,i.prototype.type="Assignment",i.prototype.accept=function(e){this.value=e.visit(this.value)},i.prototype.eval=function(e){return this.value.eval?new i(this.key,this.value.eval(e)):this},i.prototype.genCSS=function(e,t){t.add(this.key+"="),this.value.genCSS?this.value.genCSS(e,t):t.add(this.value)},t.exports=i},{"./node":68}],46:[function(e,t){var n=e("./node"),i=function(e,t,n){this.key=e,this.op=t,this.value=n};i.prototype=new n,i.prototype.type="Attribute",i.prototype.eval=function(e){return new i(this.key.eval?this.key.eval(e):this.key,this.op,this.value&&this.value.eval?this.value.eval(e):this.value)},i.prototype.genCSS=function(e,t){t.add(this.toCSS(e))},i.prototype.toCSS=function(e){var t=this.key.toCSS?this.key.toCSS(e):this.key;return this.op&&(t+=this.op,t+=this.value.toCSS?this.value.toCSS(e):this.value),"["+t+"]"},t.exports=i},{"./node":68}],47:[function(e,t){var n=e("./node"),i=e("../functions/function-caller"),r=function(e,t,n,i){this.name=e,this.args=t,this.index=n,this.currentFileInfo=i};r.prototype=new n,r.prototype.type="Call",r.prototype.accept=function(e){this.args&&(this.args=e.visitArray(this.args))},r.prototype.eval=function(e){var t,n=this.args.map(function(t){return t.eval(e)}),o=new i(this.name,e,this.index,this.currentFileInfo);if(o.isValid())try{if(null!=(t=o.call(n)))return t}catch(e){throw{type:e.type||"Runtime",message:"error evaluating function `"+this.name+"`"+(e.message?": "+e.message:""),index:this.index,filename:this.currentFileInfo.filename}}return new r(this.name,n,this.index,this.currentFileInfo)},r.prototype.genCSS=function(e,t){t.add(this.name+"(",this.currentFileInfo,this.index);for(var n=0;this.args.length>n;n++)this.args[n].genCSS(e,t),this.args.length>n+1&&t.add(", ");t.add(")")},t.exports=r},{"../functions/function-caller":20,"./node":68}],48:[function(e,t){function n(e,t){return Math.min(Math.max(e,0),t)}function i(e){return"#"+e.map(function(e){return e=n(Math.round(e),255),(16>e?"0":"")+e.toString(16)}).join("")}var r=e("./node"),o=e("../data/colors"),a=function(e,t){this.rgb=Array.isArray(e)?e:6==e.length?e.match(/.{2}/g).map(function(e){return parseInt(e,16)}):e.split("").map(function(e){return parseInt(e+e,16)}),this.alpha="number"==typeof t?t:1};a.prototype=new r,a.prototype.type="Color",a.prototype.luma=function(){var e=this.rgb[0]/255,t=this.rgb[1]/255,n=this.rgb[2]/255;return e=.03928>=e?e/12.92:Math.pow((e+.055)/1.055,2.4),t=.03928>=t?t/12.92:Math.pow((t+.055)/1.055,2.4),n=.03928>=n?n/12.92:Math.pow((n+.055)/1.055,2.4),.2126*e+.7152*t+.0722*n},a.prototype.genCSS=function(e,t){t.add(this.toCSS(e))},a.prototype.toCSS=function(e,t){var i,r,o=e&&e.compress&&!t;if(this.value)return this.value;if(1>(r=this.fround(e,this.alpha)))return"rgba("+this.rgb.map(function(e){return n(Math.round(e),255)}).concat(n(r,1)).join(","+(o?"":" "))+")";if(i=this.toRGB(),o){var a=i.split("");a[1]===a[2]&&a[3]===a[4]&&a[5]===a[6]&&(i="#"+a[1]+a[3]+a[5])}return i},a.prototype.operate=function(e,t,n){for(var i=[],r=this.alpha*(1-n.alpha)+n.alpha,o=0;3>o;o++)i[o]=this._operate(e,t,this.rgb[o],n.rgb[o]);return new a(i,r)},a.prototype.toRGB=function(){return i(this.rgb)},a.prototype.toHSL=function(){var e,t,n=this.rgb[0]/255,i=this.rgb[1]/255,r=this.rgb[2]/255,o=this.alpha,a=Math.max(n,i,r),s=Math.min(n,i,r),l=(a+s)/2,c=a-s;if(a===s)e=t=0;else{switch(t=l>.5?c/(2-a-s):c/(a+s),a){case n:e=(i-r)/c+(r>i?6:0);break;case i:e=(r-n)/c+2;break;case r:e=(n-i)/c+4}e/=6}return{h:360*e,s:t,l:l,a:o}},a.prototype.toHSV=function(){var e,t,n=this.rgb[0]/255,i=this.rgb[1]/255,r=this.rgb[2]/255,o=this.alpha,a=Math.max(n,i,r),s=Math.min(n,i,r),l=a,c=a-s;if(t=0===a?0:c/a,a===s)e=0;else{switch(a){case n:e=(i-r)/c+(r>i?6:0);break;case i:e=(r-n)/c+2;break;case r:e=(n-i)/c+4}e/=6}return{h:360*e,s:t,v:l,a:o}},a.prototype.toARGB=function(){return i([255*this.alpha].concat(this.rgb))},a.prototype.compare=function(e){return e.rgb&&e.rgb[0]===this.rgb[0]&&e.rgb[1]===this.rgb[1]&&e.rgb[2]===this.rgb[2]&&e.alpha===this.alpha?0:void 0},a.fromKeyword=function(e){var t,n=e.toLowerCase();return o.hasOwnProperty(n)?t=new a(o[n].slice(1)):"transparent"===n&&(t=new a([0,0,0],0)),t?(t.value=e,t):void 0},t.exports=a},{"../data/colors":11,"./node":68}],49:[function(e,t){var n=e("./node"),i=function(e){" "===e?(this.value=" ",this.emptyOrWhitespace=!0):(this.value=e?e.trim():"",this.emptyOrWhitespace=""===this.value)};i.prototype=new n,i.prototype.type="Combinator";var r={"":!0," ":!0,"|":!0};i.prototype.genCSS=function(e,t){var n=e.compress||r[this.value]?"":" ";t.add(n+this.value+n)},t.exports=i},{"./node":68}],50:[function(e,t){var n=e("./node"),i=e("./debug-info"),r=function(e,t,n,i){this.value=e,this.isLineComment=t,this.currentFileInfo=i};r.prototype=new n,r.prototype.type="Comment",r.prototype.genCSS=function(e,t){this.debugInfo&&t.add(i(e,this),this.currentFileInfo,this.index),t.add(this.value)},r.prototype.isSilent=function(e){var t=this.currentFileInfo&&this.currentFileInfo.reference&&!this.isReferenced,n=e.compress&&"!"!==this.value[2];return this.isLineComment||t||n},r.prototype.markReferenced=function(){this.isReferenced=!0},t.exports=r},{"./debug-info":52,"./node":68}],51:[function(e,t){var n=e("./node"),i=function(e,t,n,i,r){this.op=e.trim(),this.lvalue=t,this.rvalue=n,this.index=i,this.negate=r};i.prototype=new n,i.prototype.type="Condition",i.prototype.accept=function(e){this.lvalue=e.visit(this.lvalue),this.rvalue=e.visit(this.rvalue)},i.prototype.eval=function(e){var t=function(e,t,i){switch(e){case"and":return t&&i;case"or":return t||i;default:switch(n.compare(t,i)){case-1:return"<"===e||"=<"===e||"<="===e;case 0:return"="===e||">="===e||"=<"===e||"<="===e;case 1:return">"===e||">="===e;default:return!1}}}(this.op,this.lvalue.eval(e),this.rvalue.eval(e));return this.negate?!t:t},t.exports=i},{"./node":68}],52:[function(e,t){var n=function(e,t,i){var r="";if(e.dumpLineNumbers&&!e.compress)switch(e.dumpLineNumbers){case"comments":r=n.asComment(t);break;case"mediaquery":r=n.asMediaQuery(t);break;case"all":r=n.asComment(t)+(i||"")+n.asMediaQuery(t)}return r};n.asComment=function(e){return"/* line "+e.debugInfo.lineNumber+", "+e.debugInfo.fileName+" */\n"},n.asMediaQuery=function(e){var t=e.debugInfo.fileName;return/^[a-z]+:\/\//i.test(t)||(t="file://"+t),"@media -sass-debug-info{filename{font-family:"+t.replace(/([.:\/\\])/g,function(e){return"\\"==e&&(e="/"),"\\"+e})+"}line{font-family:\\00003"+e.debugInfo.lineNumber+"}}\n"},t.exports=n},{}],53:[function(e,t){var n=e("./node"),i=e("../contexts"),r=function(e,t){this.ruleset=e,this.frames=t};r.prototype=new n,r.prototype.type="DetachedRuleset",r.prototype.evalFirst=!0,r.prototype.accept=function(e){this.ruleset=e.visit(this.ruleset)},r.prototype.eval=function(e){var t=this.frames||e.frames.slice(0);return new r(this.ruleset,t)},r.prototype.callEval=function(e){return this.ruleset.eval(this.frames?new i.Eval(e,this.frames.concat(e.frames)):e)},t.exports=r},{"../contexts":10,"./node":68}],54:[function(e,t){var n=e("./node"),i=e("../data/unit-conversions"),r=e("./unit"),o=e("./color"),a=function(e,t){this.value=parseFloat(e),this.unit=t&&t instanceof r?t:new r(t?[t]:void 0)};a.prototype=new n,a.prototype.type="Dimension",a.prototype.accept=function(e){this.unit=e.visit(this.unit)},a.prototype.eval=function(){return this},a.prototype.toColor=function(){return new o([this.value,this.value,this.value])},a.prototype.genCSS=function(e,t){if(e&&e.strictUnits&&!this.unit.isSingular())throw new Error("Multiple units in dimension. Correct the units or use the unit function. Bad unit: "+this.unit.toString());var n=this.fround(e,this.value),i=String(n);if(0!==n&&1e-6>n&&n>-1e-6&&(i=n.toFixed(20).replace(/0+$/,"")),e&&e.compress){if(0===n&&this.unit.isLength())return void t.add(i);n>0&&1>n&&(i=i.substr(1))}t.add(i),this.unit.genCSS(e,t)},a.prototype.operate=function(e,t,n){var i=this._operate(e,t,this.value,n.value),r=this.unit.clone();if("+"===t||"-"===t)if(0===r.numerator.length&&0===r.denominator.length)r=n.unit.clone(),this.unit.backupUnit&&(r.backupUnit=this.unit.backupUnit);else if(0===n.unit.numerator.length&&0===r.denominator.length);else{if(n=n.convertTo(this.unit.usedUnits()),e.strictUnits&&n.unit.toString()!==r.toString())throw new Error("Incompatible units. Change the units or use the unit function. Bad units: '"+r.toString()+"' and '"+n.unit.toString()+"'.");i=this._operate(e,t,this.value,n.value)}else"*"===t?(r.numerator=r.numerator.concat(n.unit.numerator).sort(),r.denominator=r.denominator.concat(n.unit.denominator).sort(),r.cancel()):"/"===t&&(r.numerator=r.numerator.concat(n.unit.denominator).sort(),r.denominator=r.denominator.concat(n.unit.numerator).sort(),r.cancel());return new a(i,r)},a.prototype.compare=function(e){var t,i;if(e instanceof a){if(this.unit.isEmpty()||e.unit.isEmpty())t=this,i=e;else if(t=this.unify(),i=e.unify(),0!==t.unit.compare(i.unit))return;return n.numericCompare(t.value,i.value)}},a.prototype.unify=function(){return this.convertTo({length:"px",duration:"s",angle:"rad"})},a.prototype.convertTo=function(e){var t,n,r,o,s,l=this.value,c=this.unit.clone(),u={};if("string"==typeof e){for(t in i)i[t].hasOwnProperty(e)&&(u={},u[t]=e);e=u}s=function(e,t){return r.hasOwnProperty(e)?(t?l/=r[e]/r[o]:l*=r[e]/r[o],o):e};for(n in e)e.hasOwnProperty(n)&&(o=e[n],r=i[n],c.map(s));return c.cancel(),new a(l,c)},t.exports=a},{"../data/unit-conversions":13,"./color":48,"./node":68,"./unit":77}],55:[function(e,t){var n=e("./node"),i=e("./selector"),r=e("./ruleset"),o=function(e,t,n,r,o,a,s,l){var c;if(this.name=e,this.value=t,n)for(Array.isArray(n)?this.rules=n:(this.rules=[n],this.rules[0].selectors=new i([],null,null,this.index,o).createEmptySelectors()),c=0;this.rules.length>c;c++)this.rules[c].allowImports=!0;this.index=r,this.currentFileInfo=o,this.debugInfo=a,this.isReferenced=s,this.isRooted=l||!1};o.prototype=new n,o.prototype.type="Directive",o.prototype.accept=function(e){var t=this.value,n=this.rules;n&&(this.rules=e.visitArray(n)),t&&(this.value=e.visit(t))},o.prototype.isRulesetLike=function(){return this.rules||!this.isCharset()},o.prototype.isCharset=function(){return"@charset"===this.name},o.prototype.genCSS=function(e,t){var n=this.value,i=this.rules;t.add(this.name,this.currentFileInfo,this.index),n&&(t.add(" "),n.genCSS(e,t)),i?this.outputRuleset(e,t,i):t.add(";")},o.prototype.eval=function(e){var t,n,i=this.value,r=this.rules;return t=e.mediaPath,n=e.mediaBlocks,e.mediaPath=[],e.mediaBlocks=[],i&&(i=i.eval(e)),r&&(r=[r[0].eval(e)],r[0].root=!0),e.mediaPath=t,e.mediaBlocks=n,new o(this.name,i,r,this.index,this.currentFileInfo,this.debugInfo,this.isReferenced,this.isRooted)},o.prototype.variable=function(e){return this.rules?r.prototype.variable.call(this.rules[0],e):void 0},o.prototype.find=function(){return this.rules?r.prototype.find.apply(this.rules[0],arguments):void 0},o.prototype.rulesets=function(){return this.rules?r.prototype.rulesets.apply(this.rules[0]):void 0},o.prototype.markReferenced=function(){var e,t;if(this.isReferenced=!0,this.rules)for(t=this.rules,e=0;t.length>e;e++)t[e].markReferenced&&t[e].markReferenced()},o.prototype.getIsReferenced=function(){return!this.currentFileInfo||!this.currentFileInfo.reference||this.isReferenced},o.prototype.outputRuleset=function(e,t,n){var i,r=n.length;if(e.tabLevel=1+(0|e.tabLevel),e.compress){for(t.add("{"),i=0;r>i;i++)n[i].genCSS(e,t);return t.add("}"),void e.tabLevel--}var o="\n"+Array(e.tabLevel).join("  "),a=o+"  ";if(r){for(t.add(" {"+a),n[0].genCSS(e,t),i=1;r>i;i++)t.add(a),n[i].genCSS(e,t);t.add(o+"}")}else t.add(" {"+o+"}");e.tabLevel--},t.exports=o},{"./node":68,"./ruleset":74,"./selector":75}],56:[function(e,t){var n=e("./node"),i=e("./paren"),r=e("./combinator"),o=function(e,t,n,i){this.combinator=e instanceof r?e:new r(e),this.value="string"==typeof t?t.trim():t||"",this.index=n,this.currentFileInfo=i};o.prototype=new n,o.prototype.type="Element",o.prototype.accept=function(e){var t=this.value;this.combinator=e.visit(this.combinator),"object"==typeof t&&(this.value=e.visit(t))},o.prototype.eval=function(e){return new o(this.combinator,this.value.eval?this.value.eval(e):this.value,this.index,this.currentFileInfo)},o.prototype.genCSS=function(e,t){t.add(this.toCSS(e),this.currentFileInfo,this.index)},o.prototype.toCSS=function(e){e=e||{};var t=this.value,n=e.firstSelector;return t instanceof i&&(e.firstSelector=!0),t=t.toCSS?t.toCSS(e):t,e.firstSelector=n,""===t&&"&"===this.combinator.value.charAt(0)?"":this.combinator.toCSS(e)+t},t.exports=o},{"./combinator":49,"./node":68,"./paren":70}],57:[function(e,t){var n=e("./node"),i=e("./paren"),r=e("./comment"),o=function(e){if(this.value=e,!e)throw new Error("Expression requires an array parameter")};o.prototype=new n,o.prototype.type="Expression",o.prototype.accept=function(e){this.value=e.visitArray(this.value)},o.prototype.eval=function(e){var t,n=this.parens&&!this.parensInOp,r=!1;return n&&e.inParenthesis(),this.value.length>1?t=new o(this.value.map(function(t){return t.eval(e)})):1===this.value.length?(this.value[0].parens&&!this.value[0].parensInOp&&(r=!0),t=this.value[0].eval(e)):t=this,n&&e.outOfParenthesis(),this.parens&&this.parensInOp&&!e.isMathOn()&&!r&&(t=new i(t)),t},o.prototype.genCSS=function(e,t){for(var n=0;this.value.length>n;n++)this.value[n].genCSS(e,t),this.value.length>n+1&&t.add(" ")},o.prototype.throwAwayComments=function(){this.value=this.value.filter(function(e){return!(e instanceof r)})},t.exports=o},{"./comment":50,"./node":68,"./paren":70}],58:[function(e,t){var n=e("./node"),i=function e(t,n,i){switch(this.selector=t,this.option=n,this.index=i,this.object_id=e.next_id++,this.parent_ids=[this.object_id],n){case"all":this.allowBefore=!0,this.allowAfter=!0;break;default:this.allowBefore=!1,this.allowAfter=!1}};i.next_id=0,i.prototype=new n,i.prototype.type="Extend",i.prototype.accept=function(e){this.selector=e.visit(this.selector)},i.prototype.eval=function(e){return new i(this.selector.eval(e),this.option,this.index)},i.prototype.clone=function(){return new i(this.selector,this.option,this.index)},i.prototype.findSelfSelectors=function(e){var t,n,i=[];for(t=0;e.length>t;t++)n=e[t].elements,t>0&&n.length&&""===n[0].combinator.value&&(n[0].combinator.value=" "),i=i.concat(e[t].elements);this.selfSelectors=[{elements:i}]},t.exports=i},{"./node":68}],59:[function(e,t){var n=e("./node"),i=e("./media"),r=e("./url"),o=e("./quoted"),a=e("./ruleset"),s=e("./anonymous"),l=function(e,t,n,i,r){if(this.options=n,this.index=i,this.path=e,this.features=t,this.currentFileInfo=r,void 0!==this.options.less||this.options.inline)this.css=!this.options.less||this.options.inline;else{var o=this.getPath();o&&/[#\.\&\?\/]css([\?;].*)?$/.test(o)&&(this.css=!0)}};l.prototype=new n,l.prototype.type="Import",l.prototype.accept=function(e){this.features&&(this.features=e.visit(this.features)),this.path=e.visit(this.path),this.options.plugin||this.options.inline||!this.root||(this.root=e.visit(this.root))},l.prototype.genCSS=function(e,t){this.css&&void 0===this.path.currentFileInfo.reference&&(t.add("@import ",this.currentFileInfo,this.index),this.path.genCSS(e,t),this.features&&(t.add(" "),this.features.genCSS(e,t)),t.add(";"))},l.prototype.getPath=function(){return this.path instanceof r?this.path.value.value:this.path.value},l.prototype.isVariableImport=function(){var e=this.path;return e instanceof r&&(e=e.value),!(e instanceof o)||e.containsVariables()},l.prototype.evalForImport=function(e){var t=this.path;return t instanceof r&&(t=t.value),new l(t.eval(e),this.features,this.options,this.index,this.currentFileInfo)},l.prototype.evalPath=function(e){var t=this.path.eval(e),n=this.currentFileInfo&&this.currentFileInfo.rootpath;if(!(t instanceof r)){if(n){var i=t.value;i&&e.isPathRelative(i)&&(t.value=n+i)}t.value=e.normalizePath(t.value)}return t},l.prototype.eval=function(e){var t,n,r=this.features&&this.features.eval(e);if(this.options.plugin)return n=e.frames[0]&&e.frames[0].functionRegistry,n&&this.root&&this.root.functions&&n.addMultiple(this.root.functions),[];if(this.skip&&("function"==typeof this.skip&&(this.skip=this.skip()),this.skip))return[];if(this.options.inline){var o=new s(this.root,0,{filename:this.importedFilename},!0,!0);return this.features?new i([o],this.features.value):[o]}if(this.css){var c=new l(this.evalPath(e),r,this.options,this.index);if(!c.css&&this.error)throw this.error;return c}return t=new a(null,this.root.rules.slice(0)),t.evalImports(e),this.features?new i(t.rules,this.features.value):t.rules},t.exports=l},{"./anonymous":44,"./media":64,"./node":68,"./quoted":71,"./ruleset":74,"./url":78}],60:[function(e,t){var n={};n.Node=e("./node"),n.Alpha=e("./alpha"),n.Color=e("./color"),n.Directive=e("./directive"),n.DetachedRuleset=e("./detached-ruleset"),n.Operation=e("./operation"),n.Dimension=e("./dimension"),n.Unit=e("./unit"),n.Keyword=e("./keyword"),n.Variable=e("./variable"),n.Ruleset=e("./ruleset"),n.Element=e("./element"),n.Attribute=e("./attribute"),n.Combinator=e("./combinator"),n.Selector=e("./selector"),n.Quoted=e("./quoted"),n.Expression=e("./expression"),n.Rule=e("./rule"),n.Call=e("./call"),n.URL=e("./url"),n.Import=e("./import"),n.mixin={Call:e("./mixin-call"),Definition:e("./mixin-definition")},n.Comment=e("./comment"),n.Anonymous=e("./anonymous"),n.Value=e("./value"),n.JavaScript=e("./javascript"),n.Assignment=e("./assignment"),n.Condition=e("./condition"),n.Paren=e("./paren"),n.Media=e("./media"),n.UnicodeDescriptor=e("./unicode-descriptor"),n.Negative=e("./negative"),n.Extend=e("./extend"),n.RulesetCall=e("./ruleset-call"),t.exports=n},{"./alpha":43,"./anonymous":44,"./assignment":45,"./attribute":46,"./call":47,"./color":48,"./combinator":49,"./comment":50,"./condition":51,"./detached-ruleset":53,"./dimension":54,"./directive":55,"./element":56,"./expression":57,"./extend":58,"./import":59,"./javascript":61,"./keyword":63,"./media":64,"./mixin-call":65,"./mixin-definition":66,"./negative":67,"./node":68,"./operation":69,"./paren":70,"./quoted":71,"./rule":72,"./ruleset":74,"./ruleset-call":73,"./selector":75,"./unicode-descriptor":76,"./unit":77,"./url":78,"./value":79,"./variable":80}],61:[function(e,t){var n=e("./js-eval-node"),i=e("./dimension"),r=e("./quoted"),o=e("./anonymous"),a=function(e,t,n,i){this.escaped=t,this.expression=e,this.index=n,this.currentFileInfo=i};a.prototype=new n,a.prototype.type="JavaScript",a.prototype.eval=function(e){var t=this.evaluateJavaScript(this.expression,e);return"number"==typeof t?new i(t):"string"==typeof t?new r('"'+t+'"',t,this.escaped,this.index):new o(Array.isArray(t)?t.join(", "):t)},t.exports=a},{"./anonymous":44,"./dimension":54,"./js-eval-node":62,"./quoted":71}],62:[function(e,t){var n=e("./node"),i=e("./variable"),r=function(){};r.prototype=new n,r.prototype.evaluateJavaScript=function(e,t){var n,r=this,o={};if(void 0!==t.javascriptEnabled&&!t.javascriptEnabled)throw{message:"You are using JavaScript, which has been disabled.",filename:this.currentFileInfo.filename,index:this.index};e=e.replace(/@\{([\w-]+)\}/g,function(e,n){return r.jsify(new i("@"+n,r.index,r.currentFileInfo).eval(t))});try{e=new Function("return ("+e+")")}catch(t){throw{message:"JavaScript evaluation error: "+t.message+" from `"+e+"`",filename:this.currentFileInfo.filename,index:this.index}}var a=t.frames[0].variables();for(var s in a)a.hasOwnProperty(s)&&(o[s.slice(1)]={value:a[s].value,toJS:function(){return this.value.eval(t).toCSS()}});try{n=e.call(o)}catch(e){throw{message:"JavaScript evaluation error: '"+e.name+": "+e.message.replace(/["]/g,"'")+"'",filename:this.currentFileInfo.filename,index:this.index}}return n},r.prototype.jsify=function(e){return Array.isArray(e.value)&&e.value.length>1?"["+e.value.map(function(e){return e.toCSS()}).join(", ")+"]":e.toCSS()},t.exports=r},{"./node":68,"./variable":80}],63:[function(e,t){var n=e("./node"),i=function(e){this.value=e};i.prototype=new n,i.prototype.type="Keyword",i.prototype.genCSS=function(e,t){if("%"===this.value)throw{type:"Syntax",message:"Invalid % without number"};t.add(this.value)},i.True=new i("true"),i.False=new i("false"),t.exports=i},{"./node":68}],64:[function(e,t){var n=e("./ruleset"),i=e("./value"),r=e("./selector"),o=e("./anonymous"),a=e("./expression"),s=e("./directive"),l=function(e,t,o,a){this.index=o,this.currentFileInfo=a;var s=new r([],null,null,this.index,this.currentFileInfo).createEmptySelectors();this.features=new i(t),this.rules=[new n(s,e)],this.rules[0].allowImports=!0};l.prototype=new s,l.prototype.type="Media",l.prototype.isRulesetLike=!0,l.prototype.accept=function(e){this.features&&(this.features=e.visit(this.features)),this.rules&&(this.rules=e.visitArray(this.rules))},l.prototype.genCSS=function(e,t){t.add("@media ",this.currentFileInfo,this.index),this.features.genCSS(e,t),this.outputRuleset(e,t,this.rules)},l.prototype.eval=function(e){e.mediaBlocks||(e.mediaBlocks=[],e.mediaPath=[]);var t=new l(null,[],this.index,this.currentFileInfo);this.debugInfo&&(this.rules[0].debugInfo=this.debugInfo,t.debugInfo=this.debugInfo);var n=!1;e.strictMath||(n=!0,e.strictMath=!0);try{t.features=this.features.eval(e)}finally{n&&(e.strictMath=!1)}return e.mediaPath.push(t),e.mediaBlocks.push(t),this.rules[0].functionRegistry=e.frames[0].functionRegistry.inherit(),e.frames.unshift(this.rules[0]),t.rules=[this.rules[0].eval(e)],e.frames.shift(),e.mediaPath.pop(),0===e.mediaPath.length?t.evalTop(e):t.evalNested(e)},l.prototype.evalTop=function(e){var t=this;if(e.mediaBlocks.length>1){var i=new r([],null,null,this.index,this.currentFileInfo).createEmptySelectors();t=new n(i,e.mediaBlocks),t.multiMedia=!0}return delete e.mediaBlocks,delete e.mediaPath,t},l.prototype.evalNested=function(e){var t,r,s=e.mediaPath.concat([this]);for(t=0;s.length>t;t++)r=s[t].features instanceof i?s[t].features.value:s[t].features,s[t]=Array.isArray(r)?r:[r];return this.features=new i(this.permute(s).map(function(e){for(e=e.map(function(e){return e.toCSS?e:new o(e)}),t=e.length-1;t>0;t--)e.splice(t,0,new o("and"));return new a(e)})),new n([],[])},l.prototype.permute=function(e){if(0===e.length)return[];if(1===e.length)return e[0];for(var t=[],n=this.permute(e.slice(1)),i=0;n.length>i;i++)for(var r=0;e[0].length>r;r++)t.push([e[0][r]].concat(n[i]));return t},l.prototype.bubbleSelectors=function(e){e&&(this.rules=[new n(e.slice(0),[this.rules[0]])])},t.exports=l},{"./anonymous":44,"./directive":55,"./expression":57,"./ruleset":74,"./selector":75,"./value":79}],65:[function(e,t){var n=e("./node"),i=e("./selector"),r=e("./mixin-definition"),o=e("../functions/default"),a=function(e,t,n,r,o){this.selector=new i(e),this.arguments=t&&t.length?t:null,this.index=n,this.currentFileInfo=r,this.important=o};a.prototype=new n,a.prototype.type="MixinCall",a.prototype.accept=function(e){this.selector&&(this.selector=e.visit(this.selector)),this.arguments&&(this.arguments=e.visitArray(this.arguments))},a.prototype.eval=function(e){var t,n,i,a,s,l,c,u,d,h,p,f,m,g,v,b=[],y=!1,w=[],_=[],S=-1,k=0,x=1,C=2;for(a=this.arguments&&this.arguments.map(function(t){return{name:t.name,value:t.value.eval(e)}}),v=function(t){return t.matchArgs(null,e)},s=0;e.frames.length>s;s++)if((t=e.frames[s].find(this.selector,null,v)).length>0){for(d=!0,l=0;t.length>l;l++){for(n=t[l].rule,i=t[l].path,u=!1,c=0;e.frames.length>c;c++)if(!(n instanceof r)&&n===(e.frames[c].originalRuleset||e.frames[c])){u=!0;break}u||n.matchArgs(a,e)&&(p={mixin:n,group:function(t,n){var i,r;for(c=0;2>c;c++){for(_[c]=!0,o.value(c),i=0;n.length>i&&_[c];i++)r=n[i],r.matchCondition&&(_[c]=_[c]&&r.matchCondition(null,e));t.matchCondition&&(_[c]=_[c]&&t.matchCondition(a,e))}return _[0]||_[1]?_[0]!=_[1]?_[1]?x:C:k:S}(n,i)},p.group!==S&&w.push(p),y=!0)}for(o.reset(),m=[0,0,0],l=0;w.length>l;l++)m[w[l].group]++;if(m[k]>0)f=C;else if(f=x,m[x]+m[C]>1)throw{type:"Runtime",message:"Ambiguous use of `default()` found when matching for `"+this.format(a)+"`",index:this.index,filename:this.currentFileInfo.filename};for(l=0;w.length>l;l++)if((p=w[l].group)===k||p===f)try{n=w[l].mixin,n instanceof r||(g=n.originalRuleset||n,n=new r("",[],n.rules,null,!1),n.originalRuleset=g),Array.prototype.push.apply(b,n.evalCall(e,a,this.important).rules)}catch(e){throw{message:e.message,index:this.index,filename:this.currentFileInfo.filename,stack:e.stack}}if(y){if(!this.currentFileInfo||!this.currentFileInfo.reference)for(s=0;b.length>s;s++)h=b[s],h.markReferenced&&h.markReferenced();return b}}throw d?{type:"Runtime",message:"No matching definition was found for `"+this.format(a)+"`",index:this.index,filename:this.currentFileInfo.filename}:{type:"Name",message:this.selector.toCSS().trim()+" is undefined",index:this.index,filename:this.currentFileInfo.filename}},a.prototype.format=function(e){return this.selector.toCSS().trim()+"("+(e?e.map(function(e){var t="";return e.name&&(t+=e.name+":"),t+=e.value.toCSS?e.value.toCSS():"???"}).join(", "):"")+")"},t.exports=a},{"../functions/default":19,"./mixin-definition":66,"./node":68,"./selector":75}],66:[function(e,t){var n=e("./selector"),i=e("./element"),r=e("./ruleset"),o=e("./rule"),a=e("./expression"),s=e("../contexts"),l=function(e,t,r,o,a,s){this.name=e,this.selectors=[new n([new i(null,e,this.index,this.currentFileInfo)])],this.params=t,this.condition=o,this.variadic=a,this.arity=t.length,this.rules=r,this._lookups={},this.required=t.reduce(function(e,t){return!t.name||t.name&&!t.value?e+1:e},0),this.frames=s};l.prototype=new r,l.prototype.type="MixinDefinition",l.prototype.evalFirst=!0,l.prototype.accept=function(e){this.params&&this.params.length&&(this.params=e.visitArray(this.params)),this.rules=e.visitArray(this.rules),this.condition&&(this.condition=e.visit(this.condition))},l.prototype.evalParams=function(e,t,n,i){var l,c,u,d,h,p,f,m,g=new r(null,null),v=this.params.slice(0),b=0;if(t.frames&&t.frames[0]&&t.frames[0].functionRegistry&&(g.functionRegistry=t.frames[0].functionRegistry.inherit()),t=new s.Eval(t,[g].concat(t.frames)),n)for(n=n.slice(0),b=n.length,u=0;b>u;u++)if(c=n[u],p=c&&c.name){for(f=!1,d=0;v.length>d;d++)if(!i[d]&&p===v[d].name){i[d]=c.value.eval(e),g.prependRule(new o(p,c.value.eval(e))),f=!0;break}if(f){n.splice(u,1),u--;continue}throw{type:"Runtime",message:"Named argument for "+this.name+" "+n[u].name+" not found"}}for(m=0,u=0;v.length>u;u++)if(!i[u]){if(c=n&&n[m],p=v[u].name)if(v[u].variadic){for(l=[],d=m;b>d;d++)l.push(n[d].value.eval(e));g.prependRule(new o(p,new a(l).eval(e)))}else{if(h=c&&c.value)h=h.eval(e);else{if(!v[u].value)throw{type:"Runtime",message:"wrong number of arguments for "+this.name+" ("+b+" for "+this.arity+")"};h=v[u].value.eval(t),g.resetCache()}g.prependRule(new o(p,h)),i[u]=h}if(v[u].variadic&&n)for(d=m;b>d;d++)i[d]=n[d].value.eval(e);m++}return g},l.prototype.makeImportant=function(){var e=this.rules?this.rules.map(function(e){return e.makeImportant?e.makeImportant(!0):e}):this.rules;return new l(this.name,this.params,e,this.condition,this.variadic,this.frames)},l.prototype.eval=function(e){return new l(this.name,this.params,this.rules,this.condition,this.variadic,this.frames||e.frames.slice(0))},l.prototype.evalCall=function(e,t,n){var i,l,c=[],u=this.frames?this.frames.concat(e.frames):e.frames,d=this.evalParams(e,new s.Eval(e,u),t,c);return d.prependRule(new o("@arguments",new a(c).eval(e))),i=this.rules.slice(0),l=new r(null,i),l.originalRuleset=this,l=l.eval(new s.Eval(e,[this,d].concat(u))),n&&(l=l.makeImportant()),l},
l.prototype.matchCondition=function(e,t){return!(this.condition&&!this.condition.eval(new s.Eval(t,[this.evalParams(t,new s.Eval(t,this.frames?this.frames.concat(t.frames):t.frames),e,[])].concat(this.frames||[]).concat(t.frames))))},l.prototype.matchArgs=function(e,t){var n,i=e&&e.length||0;if(this.variadic){if(this.required-1>i)return!1}else{if(this.required>i)return!1;if(i>this.params.length)return!1}n=Math.min(i,this.arity);for(var r=0;n>r;r++)if(!this.params[r].name&&!this.params[r].variadic&&e[r].value.eval(t).toCSS()!=this.params[r].value.eval(t).toCSS())return!1;return!0},t.exports=l},{"../contexts":10,"./element":56,"./expression":57,"./rule":72,"./ruleset":74,"./selector":75}],67:[function(e,t){var n=e("./node"),i=e("./operation"),r=e("./dimension"),o=function(e){this.value=e};o.prototype=new n,o.prototype.type="Negative",o.prototype.genCSS=function(e,t){t.add("-"),this.value.genCSS(e,t)},o.prototype.eval=function(e){return e.isMathOn()?new i("*",[new r(-1),this.value]).eval(e):new o(this.value.eval(e))},t.exports=o},{"./dimension":54,"./node":68,"./operation":69}],68:[function(e,t){var n=function(){};n.prototype.toCSS=function(e){var t=[];return this.genCSS(e,{add:function(e){t.push(e)},isEmpty:function(){return 0===t.length}}),t.join("")},n.prototype.genCSS=function(e,t){t.add(this.value)},n.prototype.accept=function(e){this.value=e.visit(this.value)},n.prototype.eval=function(){return this},n.prototype._operate=function(e,t,n,i){switch(t){case"+":return n+i;case"-":return n-i;case"*":return n*i;case"/":return n/i}},n.prototype.fround=function(e,t){var n=e&&e.numPrecision;return null==n?t:Number((t+2e-16).toFixed(n))},n.compare=function(e,t){if(e.compare&&"Quoted"!==t.type&&"Anonymous"!==t.type)return e.compare(t);if(t.compare)return-t.compare(e);if(e.type===t.type){if(e=e.value,t=t.value,!Array.isArray(e))return e===t?0:void 0;if(e.length===t.length){for(var i=0;e.length>i;i++)if(0!==n.compare(e[i],t[i]))return;return 0}}},n.numericCompare=function(e,t){return t>e?-1:e===t?0:e>t?1:void 0},t.exports=n},{}],69:[function(e,t){var n=e("./node"),i=e("./color"),r=e("./dimension"),o=function(e,t,n){this.op=e.trim(),this.operands=t,this.isSpaced=n};o.prototype=new n,o.prototype.type="Operation",o.prototype.accept=function(e){this.operands=e.visit(this.operands)},o.prototype.eval=function(e){var t=this.operands[0].eval(e),n=this.operands[1].eval(e);if(e.isMathOn()){if(t instanceof r&&n instanceof i&&(t=t.toColor()),n instanceof r&&t instanceof i&&(n=n.toColor()),!t.operate)throw{type:"Operation",message:"Operation on an invalid type"};return t.operate(e,this.op,n)}return new o(this.op,[t,n],this.isSpaced)},o.prototype.genCSS=function(e,t){this.operands[0].genCSS(e,t),this.isSpaced&&t.add(" "),t.add(this.op),this.isSpaced&&t.add(" "),this.operands[1].genCSS(e,t)},t.exports=o},{"./color":48,"./dimension":54,"./node":68}],70:[function(e,t){var n=e("./node"),i=function(e){this.value=e};i.prototype=new n,i.prototype.type="Paren",i.prototype.genCSS=function(e,t){t.add("("),this.value.genCSS(e,t),t.add(")")},i.prototype.eval=function(e){return new i(this.value.eval(e))},t.exports=i},{"./node":68}],71:[function(e,t){var n=e("./node"),i=e("./js-eval-node"),r=e("./variable"),o=function(e,t,n,i,r){this.escaped=null==n||n,this.value=t||"",this.quote=e.charAt(0),this.index=i,this.currentFileInfo=r};o.prototype=new i,o.prototype.type="Quoted",o.prototype.genCSS=function(e,t){this.escaped||t.add(this.quote,this.currentFileInfo,this.index),t.add(this.value),this.escaped||t.add(this.quote)},o.prototype.containsVariables=function(){return this.value.match(/(`([^`]+)`)|@\{([\w-]+)\}/)},o.prototype.eval=function(e){function t(e,t,n){var i=e;do{e=i,i=e.replace(t,n)}while(e!==i);return i}var n=this,i=this.value,a=function(t,i){return String(n.evaluateJavaScript(i,e))},s=function(t,i){var a=new r("@"+i,n.index,n.currentFileInfo).eval(e,!0);return a instanceof o?a.value:a.toCSS()};return i=t(i,/`([^`]+)`/g,a),i=t(i,/@\{([\w-]+)\}/g,s),new o(this.quote+i+this.quote,i,this.escaped,this.index,this.currentFileInfo)},o.prototype.compare=function(e){return"Quoted"!==e.type||this.escaped||e.escaped?e.toCSS&&this.toCSS()===e.toCSS()?0:void 0:n.numericCompare(this.value,e.value)},t.exports=o},{"./js-eval-node":62,"./node":68,"./variable":80}],72:[function(e,t){function n(e,t){var n,i="",r=t.length,o={add:function(e){i+=e}};for(n=0;r>n;n++)t[n].eval(e).genCSS(e,o);return i}var i=e("./node"),r=e("./value"),o=e("./keyword"),a=function(e,t,n,o,a,s,l,c){this.name=e,this.value=t instanceof i?t:new r([t]),this.important=n?" "+n.trim():"",this.merge=o,this.index=a,this.currentFileInfo=s,this.inline=l||!1,this.variable=void 0!==c?c:e.charAt&&"@"===e.charAt(0)};a.prototype=new i,a.prototype.type="Rule",a.prototype.genCSS=function(e,t){t.add(this.name+(e.compress?":":": "),this.currentFileInfo,this.index);try{this.value.genCSS(e,t)}catch(e){throw e.index=this.index,e.filename=this.currentFileInfo.filename,e}t.add(this.important+(this.inline||e.lastRule&&e.compress?"":";"),this.currentFileInfo,this.index)},a.prototype.eval=function(e){var t,i=!1,r=this.name,s=this.variable;"string"!=typeof r&&(r=1===r.length&&r[0]instanceof o?r[0].value:n(e,r),s=!1),"font"!==r||e.strictMath||(i=!0,e.strictMath=!0);try{if(e.importantScope.push({}),t=this.value.eval(e),!this.variable&&"DetachedRuleset"===t.type)throw{message:"Rulesets cannot be evaluated on a property.",index:this.index,filename:this.currentFileInfo.filename};var l=this.important,c=e.importantScope.pop();return!l&&c.important&&(l=c.important),new a(r,t,l,this.merge,this.index,this.currentFileInfo,this.inline,s)}catch(e){throw"number"!=typeof e.index&&(e.index=this.index,e.filename=this.currentFileInfo.filename),e}finally{i&&(e.strictMath=!1)}},a.prototype.makeImportant=function(){return new a(this.name,this.value,"!important",this.merge,this.index,this.currentFileInfo,this.inline)},t.exports=a},{"./keyword":63,"./node":68,"./value":79}],73:[function(e,t){var n=e("./node"),i=e("./variable"),r=function(e){this.variable=e};r.prototype=new n,r.prototype.type="RulesetCall",r.prototype.eval=function(e){return new i(this.variable).eval(e).callEval(e)},t.exports=r},{"./node":68,"./variable":80}],74:[function(e,t){var n=e("./node"),i=e("./rule"),r=e("./selector"),o=e("./element"),a=e("./paren"),s=e("../contexts"),l=e("../functions/function-registry"),c=e("../functions/default"),u=e("./debug-info"),d=function(e,t,n){this.selectors=e,this.rules=t,this._lookups={},this.strictImports=n};d.prototype=new n,d.prototype.type="Ruleset",d.prototype.isRuleset=!0,d.prototype.isRulesetLike=!0,d.prototype.accept=function(e){this.paths?e.visitArray(this.paths,!0):this.selectors&&(this.selectors=e.visitArray(this.selectors)),this.rules&&this.rules.length&&(this.rules=e.visitArray(this.rules))},d.prototype.eval=function(e){var t,n,r,o,a=this.selectors,s=!1;if(a&&(n=a.length)){for(t=[],c.error({type:"Syntax",message:"it is currently only allowed in parametric mixin guards,"}),o=0;n>o;o++)r=a[o].eval(e),t.push(r),r.evaldCondition&&(s=!0);c.reset()}else s=!0;var u,h,p=this.rules?this.rules.slice(0):null,f=new d(t,p,this.strictImports);f.originalRuleset=this,f.root=this.root,f.firstRoot=this.firstRoot,f.allowImports=this.allowImports,this.debugInfo&&(f.debugInfo=this.debugInfo),s||(p.length=0),f.functionRegistry=function(e){for(var t,n=0,i=e.length;n!==i;++n)if(t=e[n].functionRegistry)return t;return l}(e.frames).inherit();var m=e.frames;m.unshift(f);var g=e.selectors;g||(e.selectors=g=[]),g.unshift(this.selectors),(f.root||f.allowImports||!f.strictImports)&&f.evalImports(e);var v=f.rules,b=v?v.length:0;for(o=0;b>o;o++)v[o].evalFirst&&(v[o]=v[o].eval(e));var y=e.mediaBlocks&&e.mediaBlocks.length||0;for(o=0;b>o;o++)"MixinCall"===v[o].type?(p=v[o].eval(e).filter(function(e){return!(e instanceof i&&e.variable)||!f.variable(e.name)}),v.splice.apply(v,[o,1].concat(p)),b+=p.length-1,o+=p.length-1,f.resetCache()):"RulesetCall"===v[o].type&&(p=v[o].eval(e).rules.filter(function(e){return!(e instanceof i&&e.variable)}),v.splice.apply(v,[o,1].concat(p)),b+=p.length-1,o+=p.length-1,f.resetCache());for(o=0;v.length>o;o++)u=v[o],u.evalFirst||(v[o]=u=u.eval?u.eval(e):u);for(o=0;v.length>o;o++)if((u=v[o])instanceof d&&u.selectors&&1===u.selectors.length&&u.selectors[0].isJustParentSelector()){v.splice(o--,1);for(var w=0;u.rules.length>w;w++)(h=u.rules[w])instanceof i&&h.variable||v.splice(++o,0,h)}if(m.shift(),g.shift(),e.mediaBlocks)for(o=y;e.mediaBlocks.length>o;o++)e.mediaBlocks[o].bubbleSelectors(t);return f},d.prototype.evalImports=function(e){var t,n,i=this.rules;if(i)for(t=0;i.length>t;t++)"Import"===i[t].type&&(n=i[t].eval(e),n&&n.length?(i.splice.apply(i,[t,1].concat(n)),t+=n.length-1):i.splice(t,1,n),this.resetCache())},d.prototype.makeImportant=function(){return new d(this.selectors,this.rules.map(function(e){return e.makeImportant?e.makeImportant():e}),this.strictImports)},d.prototype.matchArgs=function(e){return!e||0===e.length},d.prototype.matchCondition=function(e,t){var n=this.selectors[this.selectors.length-1];return!!n.evaldCondition&&!(n.condition&&!n.condition.eval(new s.Eval(t,t.frames)))},d.prototype.resetCache=function(){this._rulesets=null,this._variables=null,this._lookups={}},d.prototype.variables=function(){return this._variables||(this._variables=this.rules?this.rules.reduce(function(e,t){if(t instanceof i&&!0===t.variable&&(e[t.name]=t),"Import"===t.type&&t.root&&t.root.variables){var n=t.root.variables();for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])}return e},{}):{}),this._variables},d.prototype.variable=function(e){return this.variables()[e]},d.prototype.rulesets=function(){if(!this.rules)return[];var e,t,n=[],i=this.rules,r=i.length;for(e=0;r>e;e++)t=i[e],t.isRuleset&&n.push(t);return n},d.prototype.prependRule=function(e){var t=this.rules;t?t.unshift(e):this.rules=[e]},d.prototype.find=function(e,t,n){t=t||this;var i,o,a=[],s=e.toCSS();return s in this._lookups?this._lookups[s]:(this.rulesets().forEach(function(s){if(s!==t)for(var l=0;s.selectors.length>l;l++)if(i=e.match(s.selectors[l])){if(e.elements.length>i){if(!n||n(s)){o=s.find(new r(e.elements.slice(i)),t,n);for(var c=0;o.length>c;++c)o[c].path.push(s);Array.prototype.push.apply(a,o)}}else a.push({rule:s,path:[]});break}}),this._lookups[s]=a,a)},d.prototype.genCSS=function(e,t){var n,i,r,o,a,s=[],l=[];e.tabLevel=e.tabLevel||0,this.root||e.tabLevel++;var c,d=e.compress?"":Array(e.tabLevel+1).join("  "),h=e.compress?"":Array(e.tabLevel).join("  "),p=0,f=0;for(n=0;this.rules.length>n;n++)o=this.rules[n],"Comment"===o.type?(f===n&&f++,l.push(o)):o.isCharset&&o.isCharset()?(l.splice(p,0,o),p++,f++):"Import"===o.type?(l.splice(f,0,o),f++):l.push(o);if(l=s.concat(l),!this.root){(r=u(e,this,h))&&(t.add(r),t.add(h));var m,g=this.paths,v=g.length;for(c=e.compress?",":",\n"+h,n=0;v>n;n++)if(a=g[n],m=a.length)for(n>0&&t.add(c),e.firstSelector=!0,a[0].genCSS(e,t),e.firstSelector=!1,i=1;m>i;i++)a[i].genCSS(e,t);t.add((e.compress?"{":" {\n")+d)}for(n=0;l.length>n;n++){o=l[n],n+1===l.length&&(e.lastRule=!0);var b=e.lastRule;(function(e){return"boolean"==typeof e.isRulesetLike?e.isRulesetLike:"function"==typeof e.isRulesetLike&&e.isRulesetLike()})(o)&&(e.lastRule=!1),o.genCSS?o.genCSS(e,t):o.value&&t.add(o.value.toString()),e.lastRule=b,e.lastRule?e.lastRule=!1:t.add(e.compress?"":"\n"+d)}this.root||(t.add(e.compress?"}":"\n"+h+"}"),e.tabLevel--),t.isEmpty()||e.compress||!this.firstRoot||t.add("\n")},d.prototype.markReferenced=function(){var e;if(this.selectors)for(e=0;this.selectors.length>e;e++)this.selectors[e].markReferenced();if(this.rules)for(e=0;this.rules.length>e;e++)this.rules[e].markReferenced&&this.rules[e].markReferenced()},d.prototype.getIsReferenced=function(){var e,t,n,i;if(this.paths)for(e=0;this.paths.length>e;e++)for(n=this.paths[e],t=0;n.length>t;t++)if(n[t].getIsReferenced&&n[t].getIsReferenced())return!0;if(this.selectors)for(e=0;this.selectors.length>e;e++)if(i=this.selectors[e],i.getIsReferenced&&i.getIsReferenced())return!0;return!1},d.prototype.joinSelectors=function(e,t,n){for(var i=0;n.length>i;i++)this.joinSelector(e,t,n[i])},d.prototype.joinSelector=function(e,t,n){function i(e,t){var n,i;if(0===e.length)n=new a(e[0]);else{var s=[];for(i=0;e.length>i;i++)s.push(new o(null,e[i],t.index,t.currentFileInfo));n=new a(new r(s))}return n}function s(e,t){var n;return n=new o(null,e,t.index,t.currentFileInfo),new r([n])}function l(e,t,n){var r,a,h,p,f,m,g,v,b,y,w=!1;for(p=[],f=[[]],r=0;n.elements.length>r;r++)if(v=n.elements[r],"&"!==v.value){var _=function(e){var t;return"Paren"!==e.value.type?null:(t=e.value.value,"Selector"!==t.type?null:t)}(v);if(null!=_){d(p,f);var S,k=[],x=[];for(S=l(k,t,_),w=w||S,h=0;k.length>h;h++){var C=s(i(k[h],v),v);u(f,[C],v,n,x)}f=x,p=[]}else p.push(v)}else{for(w=!0,m=[],d(p,f),a=0;f.length>a;a++)if(g=f[a],0===t.length)g.length>0&&g[0].elements.push(new o(v.combinator,"",v.index,v.currentFileInfo)),m.push(g);else for(h=0;t.length>h;h++){var I=c(g,t[h],v,n);m.push(I)}f=m,p=[]}for(d(p,f),r=0;f.length>r;r++)(b=f[r].length)>0&&(e.push(f[r]),y=f[r][b-1],f[r][b-1]=y.createDerived(y.elements,n.extendList));return w}function c(e,t,n,i){var r,a,s;if(r=[],e.length>0?(r=e.slice(0),a=r.pop(),s=i.createDerived(a.elements.slice(0))):s=i.createDerived([]),t.length>0){var l=n.combinator,c=t[0].elements[0];l.emptyOrWhitespace&&!c.combinator.emptyOrWhitespace&&(l=c.combinator),s.elements.push(new o(l,c.value,n.index,n.currentFileInfo)),s.elements=s.elements.concat(t[0].elements.slice(1))}return 0!==s.elements.length&&r.push(s),t.length>1&&(r=r.concat(t.slice(1))),r}function u(e,t,n,i,r){var o;for(o=0;e.length>o;o++){var a=c(e[o],t,n,i);r.push(a)}return r}function d(e,t){var n,i;if(0!==e.length){if(0===t.length)return void t.push([new r(e)]);for(n=0;t.length>n;n++)i=t[n],i.length>0?i[i.length-1]=i[i.length-1].createDerived(i[i.length-1].elements.concat(e)):i.push(new r(e))}}var h,p;if(p=[],!l(p,t,n))if(t.length>0)for(p=[],h=0;t.length>h;h++)p.push(t[h].concat(n));else p=[[n]];for(h=0;p.length>h;h++)e.push(p[h])},t.exports=d},{"../contexts":10,"../functions/default":19,"../functions/function-registry":21,"./debug-info":52,"./element":56,"./node":68,"./paren":70,"./rule":72,"./selector":75}],75:[function(e,t){var n=e("./node"),i=e("./element"),r=function(e,t,n,i,r,o){this.elements=e,this.extendList=t,this.condition=n,this.currentFileInfo=r||{},this.isReferenced=o,n||(this.evaldCondition=!0)};r.prototype=new n,r.prototype.type="Selector",r.prototype.accept=function(e){this.elements&&(this.elements=e.visitArray(this.elements)),this.extendList&&(this.extendList=e.visitArray(this.extendList)),this.condition&&(this.condition=e.visit(this.condition))},r.prototype.createDerived=function(e,t,n){n=null!=n?n:this.evaldCondition;var i=new r(e,t||this.extendList,null,this.index,this.currentFileInfo,this.isReferenced);return i.evaldCondition=n,i.mediaEmpty=this.mediaEmpty,i},r.prototype.createEmptySelectors=function(){var e=new i("","&",this.index,this.currentFileInfo),t=[new r([e],null,null,this.index,this.currentFileInfo)];return t[0].mediaEmpty=!0,t},r.prototype.match=function(e){var t,n,i=this.elements,r=i.length;if(e.CacheElements(),0===(t=e._elements.length)||t>r)return 0;for(n=0;t>n;n++)if(i[n].value!==e._elements[n])return 0;return t},r.prototype.CacheElements=function(){if(!this._elements){var e=this.elements.map(function(e){return e.combinator.value+(e.value.value||e.value)}).join("").match(/[,&#\*\.\w-]([\w-]|(\\.))*/g);e?"&"===e[0]&&e.shift():e=[],this._elements=e}},r.prototype.isJustParentSelector=function(){return!this.mediaEmpty&&1===this.elements.length&&"&"===this.elements[0].value&&(" "===this.elements[0].combinator.value||""===this.elements[0].combinator.value)},r.prototype.eval=function(e){var t=this.condition&&this.condition.eval(e),n=this.elements,i=this.extendList;return n=n&&n.map(function(t){return t.eval(e)}),i=i&&i.map(function(t){return t.eval(e)}),this.createDerived(n,i,t)},r.prototype.genCSS=function(e,t){var n,i;if(e&&e.firstSelector||""!==this.elements[0].combinator.value||t.add(" ",this.currentFileInfo,this.index),!this._css)for(n=0;this.elements.length>n;n++)i=this.elements[n],i.genCSS(e,t)},r.prototype.markReferenced=function(){this.isReferenced=!0},r.prototype.getIsReferenced=function(){return!this.currentFileInfo.reference||this.isReferenced},r.prototype.getIsOutput=function(){return this.evaldCondition},t.exports=r},{"./element":56,"./node":68}],76:[function(e,t){var n=e("./node"),i=function(e){this.value=e};i.prototype=new n,i.prototype.type="UnicodeDescriptor",t.exports=i},{"./node":68}],77:[function(e,t){var n=e("./node"),i=e("../data/unit-conversions"),r=function(e,t,n){this.numerator=e?e.slice(0).sort():[],this.denominator=t?t.slice(0).sort():[],n?this.backupUnit=n:e&&e.length&&(this.backupUnit=e[0])};r.prototype=new n,r.prototype.type="Unit",r.prototype.clone=function(){return new r(this.numerator.slice(0),this.denominator.slice(0),this.backupUnit)},r.prototype.genCSS=function(e,t){var n=e&&e.strictUnits;1===this.numerator.length?t.add(this.numerator[0]):!n&&this.backupUnit?t.add(this.backupUnit):!n&&this.denominator.length&&t.add(this.denominator[0])},r.prototype.toString=function(){var e,t=this.numerator.join("*");for(e=0;this.denominator.length>e;e++)t+="/"+this.denominator[e];return t},r.prototype.compare=function(e){return this.is(e.toString())?0:void 0},r.prototype.is=function(e){return this.toString().toUpperCase()===e.toUpperCase()},r.prototype.isLength=function(){return Boolean(this.toCSS().match(/px|em|%|in|cm|mm|pc|pt|ex/))},r.prototype.isEmpty=function(){return 0===this.numerator.length&&0===this.denominator.length},r.prototype.isSingular=function(){return 1>=this.numerator.length&&0===this.denominator.length},r.prototype.map=function(e){var t;for(t=0;this.numerator.length>t;t++)this.numerator[t]=e(this.numerator[t],!1);for(t=0;this.denominator.length>t;t++)this.denominator[t]=e(this.denominator[t],!0)},r.prototype.usedUnits=function(){var e,t,n={};t=function(t){return e.hasOwnProperty(t)&&!n[r]&&(n[r]=t),t};for(var r in i)i.hasOwnProperty(r)&&(e=i[r],this.map(t));return n},r.prototype.cancel=function(){var e,t,n={};for(t=0;this.numerator.length>t;t++)e=this.numerator[t],n[e]=(n[e]||0)+1;for(t=0;this.denominator.length>t;t++)e=this.denominator[t],n[e]=(n[e]||0)-1;this.numerator=[],this.denominator=[];for(e in n)if(n.hasOwnProperty(e)){var i=n[e];if(i>0)for(t=0;i>t;t++)this.numerator.push(e);else if(0>i)for(t=0;-i>t;t++)this.denominator.push(e)}this.numerator.sort(),this.denominator.sort()},t.exports=r},{"../data/unit-conversions":13,"./node":68}],78:[function(e,t){var n=e("./node"),i=function(e,t,n,i){this.value=e,this.currentFileInfo=n,this.index=t,this.isEvald=i};i.prototype=new n,i.prototype.type="Url",i.prototype.accept=function(e){this.value=e.visit(this.value)},i.prototype.genCSS=function(e,t){t.add("url("),this.value.genCSS(e,t),t.add(")")},i.prototype.eval=function(e){var t,n=this.value.eval(e);if(!this.isEvald&&(t=this.currentFileInfo&&this.currentFileInfo.rootpath,t&&"string"==typeof n.value&&e.isPathRelative(n.value)&&(n.quote||(t=t.replace(/[\(\)'"\s]/g,function(e){return"\\"+e})),n.value=t+n.value),n.value=e.normalizePath(n.value),e.urlArgs&&!n.value.match(/^\s*data:/))){var r=-1===n.value.indexOf("?")?"?":"&",o=r+e.urlArgs;-1!==n.value.indexOf("#")?n.value=n.value.replace("#",o+"#"):n.value+=o}return new i(n,this.index,this.currentFileInfo,!0)},t.exports=i},{"./node":68}],79:[function(e,t){var n=e("./node"),i=function(e){if(this.value=e,!e)throw new Error("Value requires an array argument")};i.prototype=new n,i.prototype.type="Value",i.prototype.accept=function(e){this.value&&(this.value=e.visitArray(this.value))},i.prototype.eval=function(e){return 1===this.value.length?this.value[0].eval(e):new i(this.value.map(function(t){return t.eval(e)}))},i.prototype.genCSS=function(e,t){var n;for(n=0;this.value.length>n;n++)this.value[n].genCSS(e,t),this.value.length>n+1&&t.add(e&&e.compress?",":", ")},t.exports=i},{"./node":68}],80:[function(e,t){var n=e("./node"),i=function(e,t,n){this.name=e,this.index=t,this.currentFileInfo=n||{}};i.prototype=new n,i.prototype.type="Variable",i.prototype.eval=function(e){var t,n=this.name;if(0===n.indexOf("@@")&&(n="@"+new i(n.slice(1),this.index,this.currentFileInfo).eval(e).value),this.evaluating)throw{type:"Name",message:"Recursive variable definition for "+n,filename:this.currentFileInfo.filename,index:this.index};if(this.evaluating=!0,t=this.find(e.frames,function(t){var i=t.variable(n);if(i){if(i.important){e.importantScope[e.importantScope.length-1].important=i.important}return i.value.eval(e)}}))return this.evaluating=!1,t;throw{type:"Name",message:"variable "+n+" is undefined",filename:this.currentFileInfo.filename,index:this.index}},i.prototype.find=function(e,t){for(var n,i=0;e.length>i;i++)if(n=t.call(e,e[i]))return n;return null},t.exports=i},{"./node":68}],81:[function(e,t){t.exports={getLocation:function(e,t){for(var n=e+1,i=null,r=-1;--n>=0&&"\n"!==t.charAt(n);)r++;return"number"==typeof e&&(i=(t.slice(0,e).match(/\n/g)||"").length),{line:i,column:r}}}},{}],82:[function(e,t){var n=e("../tree"),i=e("./visitor"),r=e("../logger"),o=function(){this._visitor=new i(this),this.contexts=[],this.allExtendsStack=[[]]};o.prototype={run:function(e){return e=this._visitor.visit(e),e.allExtends=this.allExtendsStack[0],e},visitRule:function(e,t){t.visitDeeper=!1},visitMixinDefinition:function(e,t){t.visitDeeper=!1},visitRuleset:function(e){if(!e.root){var t,i,r,o,a=[],s=e.rules,l=s?s.length:0;for(t=0;l>t;t++)e.rules[t]instanceof n.Extend&&(a.push(s[t]),e.extendOnEveryPath=!0);var c=e.paths;for(t=0;c.length>t;t++){var u=c[t],d=u[u.length-1],h=d.extendList;for(o=h?h.slice(0).concat(a):a,o&&(o=o.map(function(e){return e.clone()})),i=0;o.length>i;i++)this.foundExtends=!0,r=o[i],r.findSelfSelectors(u),r.ruleset=e,0===i&&(r.firstExtendOnThisSelectorPath=!0),this.allExtendsStack[this.allExtendsStack.length-1].push(r)}this.contexts.push(e.selectors)}},visitRulesetOut:function(e){e.root||(this.contexts.length=this.contexts.length-1)},visitMedia:function(e){e.allExtends=[],this.allExtendsStack.push(e.allExtends)},visitMediaOut:function(){this.allExtendsStack.length=this.allExtendsStack.length-1},visitDirective:function(e){e.allExtends=[],this.allExtendsStack.push(e.allExtends)},visitDirectiveOut:function(){this.allExtendsStack.length=this.allExtendsStack.length-1}};var a=function(){this._visitor=new i(this)};a.prototype={run:function(e){var t=new o;if(this.extendIndicies={},t.run(e),!t.foundExtends)return e;e.allExtends=e.allExtends.concat(this.doExtendChaining(e.allExtends,e.allExtends)),this.allExtendsStack=[e.allExtends];var n=this._visitor.visit(e);return this.checkExtendsForNonMatched(e.allExtends),n},checkExtendsForNonMatched:function(e){var t=this.extendIndicies;e.filter(function(e){return!e.hasFoundMatches&&1==e.parent_ids.length}).forEach(function(e){var n="_unknown_";try{n=e.selector.toCSS({})}catch(e){}t[e.index+" "+n]||(t[e.index+" "+n]=!0,r.warn("extend '"+n+"' has no matches"))})},doExtendChaining:function(e,t,i){var r,o,a,s,l,c,u,d,h=[],p=this;for(i=i||0,r=0;e.length>r;r++)for(o=0;t.length>o;o++)c=e[r],u=t[o],c.parent_ids.indexOf(u.object_id)>=0||(l=[u.selfSelectors[0]],a=p.findMatch(c,l),a.length&&(c.hasFoundMatches=!0,c.selfSelectors.forEach(function(e){s=p.extendSelector(a,l,e),d=new n.Extend(u.selector,u.option,0),d.selfSelectors=s,s[s.length-1].extendList=[d],h.push(d),d.ruleset=u.ruleset,d.parent_ids=d.parent_ids.concat(u.parent_ids,c.parent_ids),u.firstExtendOnThisSelectorPath&&(d.firstExtendOnThisSelectorPath=!0,u.ruleset.paths.push(s))})));if(h.length){if(this.extendChainCount++,i>100){var f="{unable to calculate}",m="{unable to calculate}";try{f=h[0].selfSelectors[0].toCSS(),m=h[0].selector.toCSS()}catch(e){}throw{message:"extend circular reference detected. One of the circular extends is currently:"+f+":extend("+m+")"}}return h.concat(p.doExtendChaining(h,t,i+1))}return h},visitRule:function(e,t){t.visitDeeper=!1},visitMixinDefinition:function(e,t){t.visitDeeper=!1},visitSelector:function(e,t){t.visitDeeper=!1},visitRuleset:function(e){if(!e.root){var t,n,i,r,o=this.allExtendsStack[this.allExtendsStack.length-1],a=[],s=this;for(i=0;o.length>i;i++)for(n=0;e.paths.length>n;n++)if(r=e.paths[n],!e.extendOnEveryPath){var l=r[r.length-1].extendList;l&&l.length||(t=this.findMatch(o[i],r),t.length&&(o[i].hasFoundMatches=!0,o[i].selfSelectors.forEach(function(e){a.push(s.extendSelector(t,r,e))})))}e.paths=e.paths.concat(a)}},findMatch:function(e,t){var n,i,r,o,a,s,l,c=this,u=e.selector.elements,d=[],h=[];for(n=0;t.length>n;n++)for(i=t[n],r=0;i.elements.length>r;r++)for(o=i.elements[r],(e.allowBefore||0===n&&0===r)&&d.push({pathIndex:n,index:r,matched:0,initialCombinator:o.combinator}),s=0;d.length>s;s++)l=d[s],a=o.combinator.value,""===a&&0===r&&(a=" "),!c.isElementValuesEqual(u[l.matched].value,o.value)||l.matched>0&&u[l.matched].combinator.value!==a?l=null:l.matched++,l&&(l.finished=l.matched===u.length,l.finished&&!e.allowAfter&&(i.elements.length>r+1||t.length>n+1)&&(l=null)),l?l.finished&&(l.length=u.length,l.endPathIndex=n,l.endPathElementIndex=r+1,d.length=0,h.push(l)):(d.splice(s,1),s--);return h},isElementValuesEqual:function(e,t){if("string"==typeof e||"string"==typeof t)return e===t;if(e instanceof n.Attribute)return e.op===t.op&&e.key===t.key&&(e.value&&t.value?(e=e.value.value||e.value,t=t.value.value||t.value,e===t):!e.value&&!t.value);if(e=e.value,t=t.value,e instanceof n.Selector){if(!(t instanceof n.Selector)||e.elements.length!==t.elements.length)return!1;for(var i=0;e.elements.length>i;i++){if(e.elements[i].combinator.value!==t.elements[i].combinator.value&&(0!==i||(e.elements[i].combinator.value||" ")!==(t.elements[i].combinator.value||" ")))return!1;if(!this.isElementValuesEqual(e.elements[i].value,t.elements[i].value))return!1}return!0}return!1},extendSelector:function(e,t,i){var r,o,a,s,l,c=0,u=0,d=[];for(r=0;e.length>r;r++)s=e[r],o=t[s.pathIndex],a=new n.Element(s.initialCombinator,i.elements[0].value,i.elements[0].index,i.elements[0].currentFileInfo),s.pathIndex>c&&u>0&&(d[d.length-1].elements=d[d.length-1].elements.concat(t[c].elements.slice(u)),u=0,c++),l=o.elements.slice(u,s.index).concat([a]).concat(i.elements.slice(1)),c===s.pathIndex&&r>0?d[d.length-1].elements=d[d.length-1].elements.concat(l):(d=d.concat(t.slice(c,s.pathIndex)),d.push(new n.Selector(l))),c=s.endPathIndex,(u=s.endPathElementIndex)>=t[c].elements.length&&(u=0,c++);return t.length>c&&u>0&&(d[d.length-1].elements=d[d.length-1].elements.concat(t[c].elements.slice(u)),c++),d=d.concat(t.slice(c,t.length))},visitRulesetOut:function(){},visitMedia:function(e){var t=e.allExtends.concat(this.allExtendsStack[this.allExtendsStack.length-1]);t=t.concat(this.doExtendChaining(t,e.allExtends)),this.allExtendsStack.push(t)},visitMediaOut:function(){var e=this.allExtendsStack.length-1;this.allExtendsStack.length=e},visitDirective:function(e){var t=e.allExtends.concat(this.allExtendsStack[this.allExtendsStack.length-1]);t=t.concat(this.doExtendChaining(t,e.allExtends)),this.allExtendsStack.push(t)},visitDirectiveOut:function(){var e=this.allExtendsStack.length-1;this.allExtendsStack.length=e}},t.exports=a},{"../logger":31,"../tree":60,"./visitor":88}],83:[function(e,t){function n(e){this.imports=[],this.variableImports=[],this._onSequencerEmpty=e,this._currentDepth=0}n.prototype.addImport=function(e){var t=this,n={callback:e,args:null,isReady:!1};return this.imports.push(n),function(){n.args=Array.prototype.slice.call(arguments,0),n.isReady=!0,t.tryRun()}},n.prototype.addVariableImport=function(e){this.variableImports.push(e)},n.prototype.tryRun=function(){this._currentDepth++;try{for(;;){for(;this.imports.length>0;){var e=this.imports[0];if(!e.isReady)return;this.imports=this.imports.slice(1),e.callback.apply(null,e.args)}if(0===this.variableImports.length)break;var t=this.variableImports[0];this.variableImports=this.variableImports.slice(1),t()}}finally{this._currentDepth--}0===this._currentDepth&&this._onSequencerEmpty&&this._onSequencerEmpty()},t.exports=n},{}],84:[function(e,t){var n=e("../contexts"),i=e("./visitor"),r=e("./import-sequencer"),o=function(e,t){this._visitor=new i(this),this._importer=e,this._finish=t,this.context=new n.Eval,this.importCount=0,this.onceFileDetectionMap={},this.recursionDetector={},this._sequencer=new r(this._onSequencerEmpty.bind(this))};o.prototype={isReplacing:!1,run:function(e){try{this._visitor.visit(e)}catch(e){this.error=e}this.isFinished=!0,this._sequencer.tryRun()},_onSequencerEmpty:function(){this.isFinished&&this._finish(this.error)},visitImport:function(e,t){var i=e.options.inline;if(!e.css||i){var r=new n.Eval(this.context,this.context.frames.slice(0)),o=r.frames[0];this.importCount++,e.isVariableImport()?this._sequencer.addVariableImport(this.processImportNode.bind(this,e,r,o)):this.processImportNode(e,r,o)}t.visitDeeper=!1},processImportNode:function(e,t,n){var i,r=e.options.inline;try{i=e.evalForImport(t)}catch(t){t.filename||(t.index=e.index,t.filename=e.currentFileInfo.filename),e.css=!0,e.error=t}if(!i||i.css&&!r)this.importCount--,this.isFinished&&this._sequencer.tryRun();else{i.options.multiple&&(t.importMultiple=!0);for(var o=void 0===i.css,a=0;n.rules.length>a;a++)if(n.rules[a]===e){n.rules[a]=i;break}var s=this.onImported.bind(this,i,t),l=this._sequencer.addImport(s);this._importer.push(i.getPath(),o,i.currentFileInfo,i.options,l)}},onImported:function(e,t,n,i,r,o){n&&(n.filename||(n.index=e.index,n.filename=e.currentFileInfo.filename),this.error=n);var a=this,s=e.options.inline,l=e.options.plugin,c=r||o in a.recursionDetector;if(t.importMultiple||(e.skip=!!c||function(){return o in a.onceFileDetectionMap||(a.onceFileDetectionMap[o]=!0,!1)}),i&&(e.root=i,e.importedFilename=o,!(s||l||!t.importMultiple&&c))){a.recursionDetector[o]=!0;var u=this.context;this.context=t;try{this._visitor.visit(i)}catch(n){this.error=n}this.context=u}a.importCount--,a.isFinished&&a._sequencer.tryRun()},visitRule:function(e,t){"DetachedRuleset"===e.value.type?this.context.frames.unshift(e):t.visitDeeper=!1},visitRuleOut:function(e){"DetachedRuleset"===e.value.type&&this.context.frames.shift()},visitDirective:function(e){this.context.frames.unshift(e)},visitDirectiveOut:function(){this.context.frames.shift()},visitMixinDefinition:function(e){this.context.frames.unshift(e)},visitMixinDefinitionOut:function(){this.context.frames.shift()},visitRuleset:function(e){this.context.frames.unshift(e)},visitRulesetOut:function(){this.context.frames.shift()},visitMedia:function(e){this.context.frames.unshift(e.rules[0])},visitMediaOut:function(){this.context.frames.shift()}},t.exports=o},{"../contexts":10,"./import-sequencer":83,"./visitor":88}],85:[function(e,t){var n={Visitor:e("./visitor"),ImportVisitor:e("./import-visitor"),ExtendVisitor:e("./extend-visitor"),JoinSelectorVisitor:e("./join-selector-visitor"),ToCSSVisitor:e("./to-css-visitor")};t.exports=n},{"./extend-visitor":82,"./import-visitor":84,"./join-selector-visitor":86,"./to-css-visitor":87,"./visitor":88}],86:[function(e,t){var n=e("./visitor"),i=function(){this.contexts=[[]],this._visitor=new n(this)};i.prototype={run:function(e){return this._visitor.visit(e)},visitRule:function(e,t){t.visitDeeper=!1},visitMixinDefinition:function(e,t){t.visitDeeper=!1},visitRuleset:function(e){var t,n=this.contexts[this.contexts.length-1],i=[];this.contexts.push(i),e.root||(t=e.selectors,t&&(t=t.filter(function(e){return e.getIsOutput()}),e.selectors=t.length?t:t=null,t&&e.joinSelectors(i,n,t)),t||(e.rules=null),e.paths=i)},visitRulesetOut:function(){this.contexts.length=this.contexts.length-1},visitMedia:function(e){var t=this.contexts[this.contexts.length-1];e.rules[0].root=0===t.length||t[0].multiMedia},visitDirective:function(e){var t=this.contexts[this.contexts.length-1];e.rules&&e.rules.length&&(e.rules[0].root=e.isRooted||0===t.length||null)}},t.exports=i},{
"./visitor":88}],87:[function(e,t){var n=e("../tree"),i=e("./visitor"),r=function(e){this._visitor=new i(this),this._context=e};r.prototype={isReplacing:!0,run:function(e){return this._visitor.visit(e)},visitRule:function(e){return e.variable?void 0:e},visitMixinDefinition:function(e){e.frames=[]},visitExtend:function(){},visitComment:function(e){return e.isSilent(this._context)?void 0:e},visitMedia:function(e,t){return e.accept(this._visitor),t.visitDeeper=!1,e.rules.length?e:void 0},visitImport:function(e){return void 0!==e.path.currentFileInfo.reference&&e.css?void 0:e},visitDirective:function(e,t){if("@charset"===e.name){if(!e.getIsReferenced())return;if(this.charset){if(e.debugInfo){var i=new n.Comment("/* "+e.toCSS(this._context).replace(/\n/g,"")+" */\n");return i.debugInfo=e.debugInfo,this._visitor.visit(i)}return}this.charset=!0}if(e.rules&&e.rules.length){if(this._mergeRules(e.rules[0].rules),e.accept(this._visitor),t.visitDeeper=!1,e.getIsReferenced())return e;if(!e.rules||!e.rules.length)return;if(function(e){var t,n=e.rules;1!==n.length||n[0].paths&&0!==n[0].paths.length||(n=n[0].rules);for(var i=0;n.length>i;i++)if(t=n[i],t.getIsReferenced&&t.getIsReferenced())return!0;return!1}(e))return e.markReferenced(),e}else if(e.getIsReferenced())return e},checkPropertiesInRoot:function(e){for(var t,i=0;e.length>i;i++)if((t=e[i])instanceof n.Rule&&!t.variable)throw{message:"properties must be inside selector blocks, they cannot be in the root.",index:t.index,filename:t.currentFileInfo?t.currentFileInfo.filename:null}},visitRuleset:function(e,t){var i,r=[];if(e.firstRoot&&this.checkPropertiesInRoot(e.rules),e.root)e.accept(this._visitor),t.visitDeeper=!1,(e.firstRoot||e.rules&&e.rules.length>0)&&r.splice(0,0,e);else{e.paths&&(e.paths=e.paths.filter(function(e){var t;for(" "===e[0].elements[0].combinator.value&&(e[0].elements[0].combinator=new n.Combinator("")),t=0;e.length>t;t++)if(e[t].getIsReferenced()&&e[t].getIsOutput())return!0;return!1}));for(var o=e.rules,a=o?o.length:0,s=0;a>s;)i=o[s],i&&i.rules?(r.push(this._visitor.visit(i)),o.splice(s,1),a--):s++;a>0?e.accept(this._visitor):e.rules=null,t.visitDeeper=!1,o=e.rules,o&&(this._mergeRules(o),o=e.rules),o&&(this._removeDuplicateRules(o),o=e.rules),o&&o.length>0&&e.paths.length>0&&r.splice(0,0,e)}return 1===r.length?r[0]:r},_removeDuplicateRules:function(e){if(e){var t,i,r,o={};for(r=e.length-1;r>=0;r--)if((i=e[r])instanceof n.Rule)if(o[i.name]){(t=o[i.name])instanceof n.Rule&&(t=o[i.name]=[o[i.name].toCSS(this._context)]);var a=i.toCSS(this._context);-1!==t.indexOf(a)?e.splice(r,1):t.push(a)}else o[i.name]=i}},_mergeRules:function(e){if(e){for(var t,i,r,o={},a=0;e.length>a;a++)(i=e[a])instanceof n.Rule&&i.merge&&(r=[i.name,i.important?"!":""].join(","),o[r]?e.splice(a--,1):o[r]=[],o[r].push(i));Object.keys(o).map(function(e){function r(e){return new n.Expression(e.map(function(e){return e.value}))}if(t=o[e],t.length>1){i=t[0];var a=[],s=[];t.map(function(e){"+"===e.merge&&(s.length>0&&a.push(r(s)),s=[]),s.push(e)}),a.push(r(s)),i.value=function(e){return new n.Value(e.map(function(e){return e}))}(a)}})}}},t.exports=r},{"../tree":60,"./visitor":88}],88:[function(e,t){function n(e){return e}function i(e,t){var n,r;for(n in e)if(e.hasOwnProperty(n))switch(typeof(r=e[n])){case"function":r.prototype&&r.prototype.type&&(r.prototype.typeIndex=t++);break;case"object":t=i(r,t)}return t}var r=e("../tree"),o={visitDeeper:!0},a=!1,s=function(e){this._implementation=e,this._visitFnCache=[],a||(i(r,1),a=!0)};s.prototype={visit:function(e){if(!e)return e;var t=e.typeIndex;if(!t)return e;var i,r=this._visitFnCache,a=this._implementation,s=t<<1,l=1|s,c=r[s],u=r[l],d=o;if(d.visitDeeper=!0,c||(i="visit"+e.type,c=a[i]||n,u=a[i+"Out"]||n,r[s]=c,r[l]=u),c!==n){var h=c.call(a,e,d);a.isReplacing&&(e=h)}return d.visitDeeper&&e&&e.accept&&e.accept(this),u!=n&&u.call(a,e),e},visitArray:function(e,t){if(!e)return e;var n,i=e.length;if(t||!this._implementation.isReplacing){for(n=0;i>n;n++)this.visit(e[n]);return e}var r=[];for(n=0;i>n;n++){var o=this.visit(e[n]);void 0!==o&&(o.splice?o.length&&this.flatten(o,r):r.push(o))}return r},flatten:function(e,t){t||(t=[]);var n,i,r,o,a,s;for(i=0,n=e.length;n>i;i++)if(void 0!==(r=e[i]))if(r.splice)for(a=0,o=r.length;o>a;a++)void 0!==(s=r[a])&&(s.splice?s.length&&this.flatten(s,t):t.push(s));else t.push(r);return t}},t.exports=s},{"../tree":60}],89:[function(e,t){function n(){if(!a){a=!0;for(var e,t=o.length;t;){e=o,o=[];for(var n=-1;++n<t;)e[n]();t=o.length}a=!1}}function i(){}var r=t.exports={},o=[],a=!1;r.nextTick=function(e){o.push(e),a||setTimeout(n,0)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=i,r.addListener=i,r.once=i,r.off=i,r.removeListener=i,r.removeAllListeners=i,r.emit=i,r.binding=function(){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},{}],90:[function(e,t){"use strict";function n(e){function t(e){return null===l?void u.push(e):void o(function(){var t=l?e.onFulfilled:e.onRejected;if(null===t)return void(l?e.resolve:e.reject)(c);var n;try{n=t(c)}catch(t){return void e.reject(t)}e.resolve(n)})}function n(e){try{if(e===d)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var t=e.then;if("function"==typeof t)return void r(t.bind(e),n,a)}l=!0,c=e,s()}catch(e){a(e)}}function a(e){l=!1,c=e,s()}function s(){for(var e=0,n=u.length;n>e;e++)t(u[e]);u=null}if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");var l=null,c=null,u=[],d=this;this.then=function(e,n){return new d.constructor(function(r,o){t(new i(e,n,r,o))})},r(e,n,a)}function i(e,t,n,i){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=i}function r(e,t,n){var i=!1;try{e(function(e){i||(i=!0,t(e))},function(e){i||(i=!0,n(e))})}catch(e){if(i)return;i=!0,n(e)}}var o=e("asap");t.exports=n},{asap:92}],91:[function(e,t){"use strict";function n(e){this.then=function(t){return"function"!=typeof t?this:new i(function(n,i){r(function(){try{n(t(e))}catch(e){i(e)}})})}}var i=e("./core.js"),r=e("asap");t.exports=i,n.prototype=i.prototype;var o=new n(!0),a=new n(!1),s=new n(null),l=new n(void 0),c=new n(0),u=new n("");i.resolve=function(e){if(e instanceof i)return e;if(null===e)return s;if(void 0===e)return l;if(!0===e)return o;if(!1===e)return a;if(0===e)return c;if(""===e)return u;if("object"==typeof e||"function"==typeof e)try{var t=e.then;if("function"==typeof t)return new i(t.bind(e))}catch(e){return new i(function(t,n){n(e)})}return new n(e)},i.all=function(e){var t=Array.prototype.slice.call(e);return new i(function(e,n){function i(o,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var s=a.then;if("function"==typeof s)return void s.call(a,function(e){i(o,e)},n)}t[o]=a,0==--r&&e(t)}catch(e){n(e)}}if(0===t.length)return e([]);for(var r=t.length,o=0;t.length>o;o++)i(o,t[o])})},i.reject=function(e){return new i(function(t,n){n(e)})},i.race=function(e){return new i(function(t,n){e.forEach(function(e){i.resolve(e).then(t,n)})})},i.prototype.catch=function(e){return this.then(null,e)}},{"./core.js":90,asap:92}],92:[function(e,t){(function(e){function n(){for(;r.next;){r=r.next;var e=r.task;r.task=void 0;var t=r.domain;t&&(r.domain=void 0,t.enter());try{e()}catch(e){if(l)throw t&&t.exit(),setTimeout(n,0),t&&t.enter(),e;setTimeout(function(){throw e},0)}t&&t.exit()}a=!1}function i(t){o=o.next={task:t,domain:l&&e.domain,next:null},a||(a=!0,s())}var r={task:void 0,next:null},o=r,a=!1,s=void 0,l=!1;if(void 0!==e&&e.nextTick)l=!0,s=function(){e.nextTick(n)};else if("function"==typeof setImmediate)s="undefined"!=typeof window?setImmediate.bind(window,n):function(){setImmediate(n)};else if("undefined"!=typeof MessageChannel){var c=new MessageChannel;c.port1.onmessage=n,s=function(){c.port2.postMessage(0)}}else s=function(){setTimeout(n,0)};t.exports=i}).call(this,e("_process"))},{_process:89}],93:[function(){"function"!=typeof Promise.prototype.done&&(Promise.prototype.done=function(){(arguments.length?this.then.apply(this,arguments):this).then(null,function(e){setTimeout(function(){throw e},0)})})},{}],94:[function(e){e("asap"),"undefined"==typeof Promise&&(Promise=e("./lib/core.js"),e("./lib/es6-extensions.js")),e("./polyfill-done.js")},{"./lib/core.js":90,"./lib/es6-extensions.js":91,"./polyfill-done.js":93,asap:92}]},{},[2])(2)});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/services/dynamic-style.service",["require","exports","angular","underscore","less"],function(e,t,n,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=__importDefault(n),i=__importDefault(i),r=__importDefault(r);var o=function(){function e(e){var t=this;this.delimiter="-",this.cssVariables={},this.exclusions=["body-backgroundLayoutImage-displayType","body-backgroundLayoutImage-fileName","body-backgroundLayoutImage-isBackground","body-backgroundLayoutImage-originalHeight","body-backgroundLayoutImage-originalWidth","body-backgroundLayoutImage-type"],this.emptyImage="'data:image/png;base64,'",this.isCssColor=function(e){return e.toLowerCase().indexOf("color")>-1},this.missingHash=function(e){return"#"!==e[0]},this.wrapInHash=function(e,n){return null===n?null:(t.isCssColor(e)&&t.missingHash(n)?"#":"")+n},this.missingSingles=function(e){return 0===e.trim().toLowerCase().indexOf("'")||"none"!==e},this.wrapInSingles=function(e,n){return e.toLowerCase().indexOf("href")>-1?null===n||void 0===n||"null"===n||"none"===n?t.emptyImage:0===n.length?t.emptyImage:t.missingSingles(n)?"'"+n+"'":n:n},this.parseCssVariables=function(e,i){n.default.forEach(e,function(e,n){var r=(i?i+t.delimiter:"")+n;$.inArray(r,t.exclusions)>-1||("object"==typeof e?t.parseCssVariables(e,r):"string"==typeof e?(e="body-backgroundLayoutImage-href"===r?t.wrapInSingles(r,e):t.wrapInHash(r,e),t.cssVariables["@"+r]=e):t.cssVariables["@"+r]=t.wrapInHash(r,e))})},this.build=function(){i.default.isEmpty(t.cssVariables)||r.default.modifyVars(t.cssVariables)},this.update=function(e){var n=Object.keys(e)[0],i=e[n];i=t.wrapInHash(n,i),i=t.wrapInSingles(n,i),t.cssVariables[n]=i,t.build()},this.parseCssVariables(e.model.styles,""),this.build()}return e}();t.DynamicStylesService=o}),define("ts/modules/emailbuilder/services/template-name.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){var t=this;this.setName=function(e){var n=void 0!==e&&e.length>0;t.name=n?e:t.emailBuilderConfig.template.name},this.resetName=function(){t.name=t.emailBuilderConfig.template.name},this.name=e.template.name,this.emailBuilderConfig=e}return e}();t.TemplateNameService=n}),define("ts/modules/emailbuilder/services/link-validation.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=/^\(?(?:(https?|ftp):)?(\/\/([\w\u0080-\uFFFF\$-\.!:;=~]*@)?([\w\u0080-\uFFFF\$-\.!;=~]*|\[[a-fA-F0-9\:\.]*\])(\:\d*)?|\/[\w\u0080-\uFFFF\$-\.!;=@~]+|[\w\u0080-\uFFFF\$-\.!;=@~]+|)((?:\/[\w\u0080-\uFFFF\$-\.!:;=@~]*)*)(\?[^#]*)?(#.*)?\)?$/,i=/^(mailto:)?((?:[\w\u0080-\uFFFF\$-\-!:;=~]+|\"(?:[\w\u0080-\uFFFF\ !\$-\.\:-\>\[-\]@~]|\\\\|\\\")+\")(?:\.(?:[\w\u0080-\uFFFF\$-\-!:;=~]+|\"(?:[\w\u0080-\uFFFF\ !\$-\.\:-\>\[-\]@~]|\\\\|\\\")+\"))*@([\w\u0080-\uFFFF\$-\.!;=~]*|\[[a-fA-F0-9\:\.]*\]))$/,r=/^(([^\[\]]*\[[^,\[\]]*(,\s*fallback\s*=[^\[\]]*)?\])+[^\[\]]*)$/,o=/^((tel|sms):)(\+?\(?[0-9]+\)?[0-9-. ]+)$/,a=function(){function e(e){var t=this;this.isUrl=function(e,n){void 0===n&&(n=function(){return!1});var i=t.getUrlRegExp().exec(e.toLowerCase()),r=!!i&&i.input===i[0];return!r&&n&&(r=n(e)),r},this.isEmail=function(e,n){void 0===n&&(n=function(){return!1});var i=t.getEmailRegExp().exec(e.toLowerCase()),r=!!i&&i.input===i[0];return!r&&n&&(r=n(e)),r},this.isPhone=function(e){var n=t.getPhoneRegExp().exec(e.toLowerCase());return!!n&&n.input===n[0]},this.isValidLink=function(e,n){void 0===n&&(n=function(){return!1});var i=t.isEmail(e,n),r=t.isUrl(e,n),o=i||r;return!o&&t.config.phoneLinkEnabled&&(o=t.isPhone(e)),!o&&n&&(o=n(e)),o},this.hasValidVariable=function(e){var t=r.exec(e);return!!t&&t.input===t[0]},this.getUrlRegExp=function(){return n},this.getEmailRegExp=function(){return i},this.getPhoneRegExp=function(){return o},this.config=e}return e}();t.LinkValidationService=a}),define("ts/modules/emailbuilder/services/link-model",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n){var i=this;this.matchUrl=function(e,t){var n=e.match(i.linkValidationService.getUrlRegExp()),r=n[1];return"//"===e.substring(0,2)?t=n[0]:r?t=n[4]:e="http://"+e,{rawValue:e,display:t}},this.matchEmail=function(e,t){var n=e.match(i.linkValidationService.getEmailRegExp());return n[1]?t=n[2]:e="mailto:"+e,{rawValue:e,display:t}},this.matchPhone=function(e,t){var n=e.match(i.linkValidationService.getPhoneRegExp());return n[1]&&(t=n[3]),{rawValue:e,display:t}},this.linkValidationService=e;var r=e.hasValidVariable(t),o=e.isUrl(t);this.isEmail=e.isEmail(t),this.isPhone=n&&e.isPhone(t),this.raw=t,this.display=t,this.href="",this.isValid=this.isEmail||o||this.isPhone||r;var a={rawValue:t,display:this.display};this.isEmail?a=this.matchEmail(t,this.display):this.isPhone?a=this.matchPhone(t,this.display):o&&(a=this.matchUrl(t,this.display)),this.href=a.rawValue,this.display=a.display}return e}();t.LinkModel=n}),define("ts/modules/emailbuilder/services/link-model-provider.service",["require","exports","./link-model"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){var i=this;this.getModelFor=function(e){return new n.LinkModel(i.linkValidationService,e,i.config.phoneLinkEnabled)},this.linkValidationService=e,this.config=t}return e}();t.LinkModelProviderService=i}),define("ts/modules/emailbuilder/services/public-canvas.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){var n=this;this.createAccount=function(e){return n.$http.post(n.config.urls.createAccount,{user:e})},this.sendDownloadLink=function(e){return n.$http.post(n.config.urls.downloadEmail,{emailAddress:e})},this.$http=e,this.config=t}return e}();t.PublicCanvasService=n}),define("ts/modules/emailbuilder/services/email-model-comparison.service",["require","exports","vendor/jsondiffpatch.umd.slim","vendor/object_hash"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){var e=this;this.excludedProperties={config:!0,$$hashKey:!0,isActive:!0,contentVersionId:!0,src:!0,state:!0,cssClasses:!0,hasMissingBackground:!0,displayHeight:!0,vmlWidth:!0,vmlHeight:!0,lines:!0},this.propertyFilter=function(t,n){return(!t.substring||"temp"!==t.substring(0,4)||"template"===t.substring(0,8))&&!e.excludedProperties[t]},this.options={excludeKeys:function(t){return!e.propertyFilter(t,null)}},this.ObjectsAreEqual=function(t,n){return void 0!==t&&void 0!==n&&i(t,e.options)===i(n,e.options)},this.getHash=function(t){return i(t,e.options)},this.getDiffs=function(t,n){return e.diffPatcher.diff(t,n)},this.patch=function(t,n){return e.diffPatcher.patch(t,n)},this.unpatch=function(t,n){return e.diffPatcher.unpatch(t,n)},this.diffPatcher=new n.DiffPatcher({objectHash:function(e){return e.uiId},propertyFilter:this.propertyFilter})}return e}();t.EmailModelComparisonService=r});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/services/services.module",["require","exports","config","vendor/raven/raven","vendor/raven/plugins/angular","angular","./active-content.service","./color.service","./content-block.service","./content-provider.service","./content-version.service","./email.service","./lock-level.service","./login.service","./max-image-width.service","./model-activity.service","./model-validation.service","./notification.service","./personalisation.service","./preload-image.service","./preview-html.service","./raven.service","./recent-color.service","./save.service","./analytics.service","./analytics.validation.service","./tracking-snapshot-compare.service","./view-port.service","./crop-area-calculator.service","./file-extension.service","./model-activity-tracker.service","./content-block-id.service","./undo.service","./ui-id.service","./section-separator-selector.service","./web-worker.service","./getfeedback-connector.service","./available-section-selector.service","./screenshot.service","./logo-best-fit.service","./item-width.service","./onboarding.service","./image-builder.service","./dropzone-dimensions.service","./check-on-preview.service","./image-validation.service","./async-file-uploader.service","./test-email.service","./translation.service","./image-manager.service","./next-button-style.service","./style-factory.service","./dynamic-style.service","./template-name.service","./link-validation.service","./link-model-provider.service","./public-canvas.service","./email-model-comparison.service"],function(e,t,n,i,r,o,a,s,l,c,u,d,h,p,f,m,g,v,b,y,w,_,S,k,x,C,I,P,T,E,M,D,$,B,A,L,O,F,j,R,N,z,U,q,H,V,W,Y,X,G,K,J,Q,Z,ee,te,ne,ie){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=__importDefault(o);var re=[];n.canvasSentryMonitoring&&n.canvasSentryUrl&&(i.config(n.canvasSentryUrl,{ignoreUrls:[/\/vendor\/ckeditor/],ignoreErrors:[/\$rootScope:inprog/]}).addPlugin(r,o.default).install(),re.push("ngRaven"));var oe=o.default.module("emailbuilder.services",re);t.module=oe,oe.service("ActiveContentService",["LockLevelService","EmailBuilderConfig",a.ActiveContentService]),oe.service("WebWorkerService",[L.WebWorkerService]),oe.service("TestEmailService",["$http","EmailBuilderConfig",Y.TestEmailService]),oe.service("TranslationService",["EmailBuilderConfig",X.TranslationService]),oe.service("ColorService",[s.ColorService]),oe.service("ContentBlockIdService",[D.ContentBlockIdService]),oe.service("ContentBlockService",["ModelActivityService","LinkValidationService","MaxImageWidthService","EmailBuilderConfig","$httpParamSerializer","CountdownDateService",l.ContentBlockService]),oe.service("ContentProviderService",["UiIdService","NextButtonStyleService","ContentBlockIdService",c.ContentProviderService]),oe.service("ContentVersionService",[u.ContentVersionService]),oe.service("EmailService",["ContentProviderService","ModelActivityService","ActiveContentService","AvailableSectionSelectorService","$timeout","StyleFactoryService","SectionIdService","LockLevelService","ContentBlockService","ContentBlockIdService","UiIdService",d.EmailService]),oe.service("LockLevelService",["$rootScope","EmailBuilderConfig","AnalyticsService",h.LockLevelService]),oe.service("LoginService",["$http","EmailBuilderConfig",p.LoginService]),oe.service("MaxImageWidthService",["$window","EmailBuilderConfig",f.MaxImageWidthService]),oe.service("ModelActivityService",[m.ModelActivityService]),oe.service("ModelValidationService",["LockLevelService","ContentBlockService","EmailBuilderConfig",g.ModelValidationService]),oe.service("NotificationService",["$http","LockLevelService","EmailBuilderConfig",v.NotificationService]),oe.service("PersonalisationService",[b.PersonalisationService]),oe.service("PreloadImageService",["EmailBuilderConfig",y.PreloadImageService]),oe.service("PreviewHtmlService",["$http","$q","EmailBuilderConfig",w.PreviewHtmlService]),oe.service("RavenService",["$document","EmailBuilderConfig",_.RavenService]),oe.service("RecentColorService",["$rootScope","$http","EmailBuilderConfig",S.RecentColorService]),oe.service("SaveService",["TemplateNameService","EmailService","ContentVersionService","ModelActivityService","$http","$q","$window","EmailBuilderConfig","AnalyticsService","UndoService","$timeout","$rootScope",k.SaveService]),oe.service("AnalyticsService",["$http","EmailBuilderConfig","AnalyticsValidationService",x.AnalyticsService]),oe.service("AnalyticsValidationService",["EmailBuilderConfig",C.AnalyticsValidationService]),oe.service("ViewPortService",["$window","$document",P.ViewPortService]),oe.service("CropAreaCalculatorService",[T.CropAreaCalculatorService]),oe.service("FileExtensionService",[E.FileExtensionService]),oe.service("TrackingSnapshotCompareService",["EmailModelComparisonService",I.TrackingSnapshotCompareService]),oe.service("ModelActivityTrackerService",["AnalyticsService","ModelActivityService","$rootScope",M.ModelActivityTrackerService]),oe.service("EmailModelComparisonService",[ie.EmailModelComparisonService]),oe.service("UndoService",["EmailBuilderConfig","EmailService","$rootScope","ModelActivityService","EmailModelComparisonService",$.UndoService]),oe.service("UiIdService",[B.UiIdService]),oe.service("SectionSeparatorSelectorService",["$parse","EmailBuilderConfig",A.SectionSeparatorSelectorService]),oe.service("GetFeedbackConnectorService",["$http","EmailBuilderConfig",O.GetFeedbackConnectorService]),oe.service("AvailableSectionSelectorService",["EmailBuilderConfig",F.AvailableSectionSelectorService]),oe.service("ScreenshotService",["$http","EmailBuilderConfig",j.ScreenshotService]),oe.service("LogoBestFitService",["EmailBuilderConfig",R.LogoBestFitService]),oe.service("ItemWidthService",["AvailableSectionSelectorService",N.ItemWidthService]),oe.service("CheckOnPreviewService",["SaveService",H.CheckOnPreviewService]),oe.service("OnboardingService",["$http","EmailBuilderConfig","$q",z.OnboardingService]),oe.service("ImageBuilderService",["ItemWidthService","EmailBuilderConfig",U.ImageBuilderService]),oe.service("DropzoneDimensionsService",[q.DropzoneDimensionsService]),oe.service("ImageValidationService",["EmailBuilderConfig",V.ImageValidationService]),oe.service("AsyncFileUploaderService",["WebWorkerService","AntiforgeryService",W.AsyncFileUploaderService]),oe.service("NextButtonStyleService",[K.NextButtonStyleService]),oe.service("StyleFactoryService",[J.StyleFactoryService]),oe.service("TemplateNameService",["EmailBuilderConfig",Z.TemplateNameService]),oe.service("DynamicStylesService",["EmailService",Q.DynamicStylesService]),oe.service("ImageManagerService",["AsyncFileUploaderService","ImageValidationService","$rootScope","$q","ModelActivityService","MaxImageWidthService","ImageBuilderService","LogoBestFitService","EmailBuilderConfig",G.ImageManagerService]),oe.service("PublicCanvasService",["$http","EmailBuilderConfig",ne.PublicCanvasService]),oe.service("LinkValidationService",["EmailBuilderConfig",ee.LinkValidationService]),oe.service("LinkModelProviderService",["LinkValidationService","EmailBuilderConfig",te.LinkModelProviderService])}),define("vendor/text!ts/modules/emailbuilder/sidebar/background-email-image-uploader.directive.html",[],function(){return'<div>\r\n    <div class="c-image-controls-container">\r\n        <figure ng-click="$event.stopPropagation()" ng-class="{ \'is-empty\' : !emailBackgroundStatus.hasSrc,  \'has-uploaded\' : emailBackgroundStatus.hasSrc, \'is-uploading\' : emailBackgroundStatus.loading }" class="c-image-controls__uploaded-image hmb-uploaded-image--background hmb-uploaded-image">\r\n            <div id="emb-js-message"></div>\r\n            <div>\r\n                <label class="u-visually-hide" for="background-email-upload">Upload background image for email</label>\r\n                <input emb-file-upload file="backgroundImage" class="emb-invisible-input js-file-input" id="background-email-upload" name="file" type="file" accepts="image/*">\r\n            </div>\r\n            <button class="c-button c-button--choose-file">Choose file\r\n            </button>\r\n            <div ng-show="emailBackgroundStatus.loading" aria-hidden="true" class="loading-circle">\r\n                <span class="loading-circle__spinner"></span>\r\n            </div>\r\n            <div ng-show="emailBackgroundStatus.hasSrc" class="c-image-controls__image-container emb-js-preview-holder">\r\n            </div>\r\n        </figure>\r\n        <div ng-show="emailBackgroundStatus.hasSrc" class="c-image-controls__actions">\r\n            <div class="emb-replacer" ng-click="$event.stopPropagation()">\r\n                <div class="c-image-controls__upload-container">\r\n                    <label class="u-visually-hide" for="background-email-replace">Replace existing background image for email</label>\r\n                    <input emb-file-upload file="backgroundImage" class="c-image-controls__upload-area js-file-input" id="background-email-replace" name="file" type="file" accepts="image/*">\r\n                    <button class="c-image-controls__button c-image-controls__button--replace">Replace</button>\r\n                </div>\r\n            </div>\r\n            <button class="c-image-controls__button c-image-controls__button--delete" ng-click="deleteBackgroundEmailImage()">Delete</button>\r\n        </div>\r\n    </div>\r\n    <p class="c-sidebar__text l-gap--top-medium">Background images <a href="/help-doc/campus-background-images" target="_blank" rel="noopener" title="aren\'t supported in some email clients">aren\'t supported in some email clients</a>, including most versions of Outlook. Pick a background color similar to the image as a fallback.</p>\r\n    <hr ng-show="emailBackgroundStatus.hasSrc" class="c-sidebar__rule">\r\n    <div class="checkbox-options c-image-controls__checkbox-option-container" ng-show="emailBackgroundStatus.hasSrc">\r\n        <input class="checkbox-options__input emb-checkbox" id="email-background-repeat" type="checkbox"\r\n            ng-true-value="\'repeat\'" ng-false-value="\'no-repeat\'"\r\n            ng-checked="email.styles.body.backgroundLayoutImage.backgroundRepeat === \'repeat\'"\r\n            ng-model="email.styles.body.backgroundLayoutImage.backgroundRepeat"\r\n            ng-change="emailBackgroundStatus.updateRepeat(\'body-backgroundLayoutImage-backgroundRepeat\', email.styles.body.backgroundLayoutImage.backgroundRepeat)"\r\n            emb-save-on-model-change />\r\n        <label class="c-sidebar__label checkbox-options__label c-image-controls__checkbox-option" for="email-background-repeat">Repeat the background image</label>\r\n    </div>\r\n</div>\r\n'}),define("ts/modules/emailbuilder/sidebar/background-email-image-uploader.directive",["require","exports","vendor/text!ts/modules/emailbuilder/sidebar/background-email-image-uploader.directive.html"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t,i,r,o){var a=this;this.restrict="AE",this.require="ngModel",this.template=n,this.scope={backgroundImage:"=",emailBackgroundStatus:"="},this.updateEmailModel=function(e,t){e.backgroundImage.href!==t.$modelValue&&t.$setViewValue(e.backgroundImage.href)},this.displayThumbnail=function(e,t){void 0!==e.tempWidth&&void 0!==e.tempHeight||a.imageBuilderService.resize(e),a.thumbnailService.create({image:e,container:t,width:134,height:85,direction:{v:"center",h:"center"}})},this.resetUpload=function(e){e.val("")},this.deleteBackgroundEmailImage=function(e,t,n,i){a.contentBlockService.resetBlock(e),a.resetUpload(t),e.href=null,e.fileName=null,e.backgroundRepeat="no-repeat",a.updateEmailModel(n,i),n.emailBackgroundStatus.hasSrc=!1},this.link=function(e,t,n,i){e.uploadCount=0,a.$rootScope.$on("content:email-background-activated",function(n,r){r.email.styles.body=a.styleFactoryService.addBackgroundEmailStyle(r.email.styles.body);var o=r.email.styles.body.backgroundLayoutImage,s=t.find("input.js-file-input");e.deleteBackgroundEmailImage=function(){a.deleteBackgroundEmailImage(o,s,e,i)},o.hasOwnProperty("type")&&"image"===o.type&&(e.$on("upload:start",function(t,n){o===n.block&&(e.emailBackgroundStatus.loading=!0,e.uploadCount=0)}),e.$watch(function(e){return a.contentBlockService.getBlockSrc(e.backgroundImage)},function(){var n=t.find(".emb-js-preview-holder"),r=a.contentBlockService.hasBlockSrc(o);if(a.resetUpload(s),r){e.uploadCount+=1;var l=a.contentBlockService.getBlockSrc(o);o.href=l,1===e.uploadCount&&(a.displayThumbnail(o,n),a.updateEmailModel(e,i))}else n.empty(),e.uploadCount=0;e.emailBackgroundStatus.loading=!1,e.emailBackgroundStatus.hasSrc=r}))})},this.$rootScope=e,this.thumbnailService=t,this.imageBuilderService=i,this.styleFactoryService=r,this.contentBlockService=o}return e.factory=function(t,n,i,r,o){return new e(t,n,i,r,o)},e}();t.BackgroundEmailImageUploader=i}),define("vendor/text!ts/modules/emailbuilder/sidebar/background-layout-image-uploader.directive.html",[],function(){
return'<div>\r\n    <div class="l-grid l-grid--vertical-spacing">\r\n        <div class="l-grid__item l-grid__item--100">\r\n            <div class="c-image-controls-container">\r\n                <figure ng-click="$event.stopPropagation()" ng-class="{ \'is-empty\' : !layoutBackgroundStatus.hasSrc,  \'has-uploaded\' : layoutBackgroundStatus.hasSrc, \'is-uploading\' : layoutBackgroundStatus.loading }" class="c-image-controls__uploaded-image hmb-uploaded-image--background hmb-uploaded-image">\r\n                    <div id="emb-js-message">\r\n                    </div>\r\n                    <div>\r\n                        <label class="u-visually-hide" for="background-upload">Upload background image</label>\r\n                        <input emb-file-upload file="backgroundImage" class="emb-invisible-input js-file-input qa-background-upload" id="background-upload" name="file" type="file" accepts="image/*">\r\n                    </div>\r\n                    <button class="c-button c-button--choose-file">Choose file</button>\r\n                    <div ng-show="layoutBackgroundStatus.loading" aria-hidden="true" class="loading-circle">\r\n                        <span class="loading-circle__spinner"></span>\r\n                    </div>\r\n                    <div ng-show="layoutBackgroundStatus.hasSrc" class="c-image-controls__image-container emb-js-preview-holder">\r\n                    </div>\r\n                </figure>\r\n                <div ng-show="layoutBackgroundStatus.hasSrc && !layoutBackgroundStatus.loading " class="c-image-controls__actions">\r\n                    <div class="emb-replacer" ng-click="$event.stopPropagation()">\r\n                        <div class="c-image-controls__upload-container">\r\n                            <label class="u-visually-hide" for="background-replace">Replace existing background image</label>\r\n                            <input emb-file-upload file="backgroundImage" id="background-replace" class="c-image-controls__upload-area js-file-input" name="file" type="file" accepts="image/*">\r\n                            <button class="c-image-controls__button c-image-controls__button--replace">Replace\r\n                        </button>\r\n                        </div>\r\n                    </div>\r\n                    <button class="c-image-controls__button c-image-controls__button--delete" ng-click="deleteBackgroundLayoutImage()">Delete</button>\r\n                </div>\r\n            </div>\r\n            <p class="c-sidebar__text l-gap--top-medium">Background images <a href="/help-doc/campus-background-images" target="_blank" rel="noopener" title="aren\'t supported in some email clients">aren\'t supported in some email clients</a>, including most versions of Outlook. Pick a background color similar to the image as a fallback.</p>  \r\n        </div>\r\n        <div class="l-grid__item l-grid__item--100" ng-if="imageRenderingEnabled && layoutBackgroundStatus.hasSrc && !layoutBackgroundStatus.loading" class="c-image-controls-container">\r\n            <div class="l-grid l-grid--gutter">\r\n                <div class="l-grid__item l-grid__item--50">\r\n                    <cm-segmented-control\r\n                        group-name="image-size"\r\n                        group-legend="Size"\r\n                        group-class-name="c-segmented-control--image-size"\r\n                        ng-model="section.style.backgroundLayoutImage.size"\r\n                        ng-change="trackBackgroundImageSizeSelection()"\r\n                        emb-save-on-model-change>\r\n                        <cm-segmented-control-item\r\n                            item-name="Original"\r\n                            item-value="original"\r\n                            segment-id="original"\r\n                            class-names="c-segmented-control--image-size-original"\r\n                            is-default>\r\n                        </cm-segmented-control-item>\r\n                        <cm-segmented-control-item\r\n                            item-name="Cover"\r\n                            item-value="cover"\r\n                            segment-id="cover"\r\n                            class="qa-background-cover"\r\n                            class-names="c-segmented-control--image-size-cover">\r\n                        </cm-segmented-control-item>\r\n                    </cm-segmented-control>\r\n                </div>\r\n                <div class="l-grid__item l-grid__item--50" id="email-background-repeat">\r\n                    <cm-segmented-control\r\n                        group-name="image-repeat"\r\n                        group-legend="Repeat"\r\n                        group-class-name="c-segmented-control--image-repeat"\r\n                        ng-model="backgroundImage.backgroundRepeat"\r\n                        ng-change="trackBackgroundImageRepeatSelection()"\r\n                        emb-save-on-model-change>\r\n                        <cm-segmented-control-item\r\n                            item-name="Don&apos;t repeat"\r\n                            item-value="no-repeat"\r\n                            segment-id="no-repeat"\r\n                            class-names="c-segmented-control--image-repeat-no-repeat"\r\n                            is-default>\r\n                        </cm-segmented-control-item>\r\n                        <cm-segmented-control-item\r\n                            item-name="Tiled pattern"\r\n                            item-value="repeat"\r\n                            segment-id="repeat"\r\n                            class="qa-background-repeat"\r\n                            class-names="c-segmented-control--image-repeat-tiled">\r\n                        </cm-segmented-control-item>\r\n                    </cm-segmented-control>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div ng-if="imageRenderingEnabled && layoutBackgroundStatus.hasSrc && !layoutBackgroundStatus.loading && backgroundImage.backgroundRepeat === \'no-repeat\'" class="l-grid__item l-grid__item--100">\r\n            <emb-image-focal-point-selector model="backgroundImage"></emb-image-focal-point-selector>\r\n        </div>\r\n    </div>\r\n    <hr ng-show="sectionBorderEnabled || (layoutBackgroundStatus.hasSrc && !imageRenderingEnabled)" ng-class="{ \'l-offset--top-medium\': imageRenderingEnabled }" class="c-sidebar__rule">\r\n    <div class="checkbox-options c-image-controls__checkbox-option-container" ng-show="layoutBackgroundStatus.hasSrc" ng-if="!imageRenderingEnabled">\r\n        <input id="section-background-repeat" class="checkbox-options__input" type="checkbox"\r\n            ng-true-value="\'repeat\'" ng-false-value="\'no-repeat\'"\r\n            ng-checked="backgroundImage.backgroundRepeat === \'repeat\'"\r\n            ng-model="backgroundImage.backgroundRepeat"\r\n            emb-save-on-model-change />\r\n        <label class="c-sidebar__label checkbox-options__label c-image-controls__checkbox-option" for="section-background-repeat">Repeat the background image</label>\r\n    </div>\r\n</div>\r\n'}),define("ts/modules/emailbuilder/sidebar/background-layout-image-uploader.directive",["require","exports","vendor/text!ts/modules/emailbuilder/sidebar/background-layout-image-uploader.directive.html","../services/analytics.service"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t,r,o,a,s,l){var c=this;this.restrict="AE",this.template=n,this.scope={backgroundImage:"=",layoutBackgroundStatus:"=",section:"="},this.displayThumbnail=function(e,t){c.thumbnailService.create({image:e,container:t,width:134,height:85,direction:{v:"center",h:"center"}})},this.resetUpload=function(e){e.val("")},this.deleteBackgroundLayoutImage=function(e,t,n){c.contentBlockService.resetBlock(e),c.resetUpload(t),e.href=null,e.fileName=null,e.backgroundRepeat="repeat",e.position={xPercent:0,yPercent:0},n.layoutBackgroundStatus.hasSrc=!1},this.link=function(e,t,n){e.sectionBorderEnabled=c.emailService.model.isBlueprint,e.imageRenderingEnabled=c.emailService.model.isBlueprint&&c.emailConfig.sectionBackgroundImageRenderingEnabled,e.placeholder=t.find(".emb-js-preview-holder");var r=e.section;r.style=c.styleFactoryService.addBackgroundLayoutStyle(r.style);var o=r.style.backgroundLayoutImage,a=t.find("input.js-file-input");e.deleteBackgroundLayoutImage=function(){c.deleteBackgroundLayoutImage(o,a,e)},e.trackBackgroundImageSizeSelection=function(){if(e.section.style.backgroundLayoutImage.size){var t="original"===e.section.style.backgroundLayoutImage.size?"Original":"Cover",n={eventName:i.AnalyticsEventName.UsedSetting,publicProperties:{"Section Background Size":t}};c.analyticsService.trackClientLevel(n)}},e.trackBackgroundImageRepeatSelection=function(){var t="repeat"===e.backgroundImage.backgroundRepeat,n={eventName:i.AnalyticsEventName.UsedSetting,publicProperties:{"Section Background Repeat":t}};c.analyticsService.trackClientLevel(n)},o.hasOwnProperty("type")&&"image"===o.type&&(e.$on("upload:start",function(t,n){o===n.block&&(e.layoutBackgroundStatus.loading=!0)}),e.$watch(function(e){return c.contentBlockService.getBlockSrc(e.backgroundImage)},function(){var t=c.contentBlockService.hasBlockSrc(o);if(c.resetUpload(a),t){c.displayThumbnail(o,e.placeholder);var n=c.contentBlockService.getBlockSrc(o);o.href=n}else e.placeholder.empty();e.layoutBackgroundStatus.loading=!1,e.layoutBackgroundStatus.hasSrc=t}))},this.$rootScope=e,this.thumbnailService=t,this.styleFactoryService=r,this.emailService=o,this.contentBlockService=a,this.analyticsService=s,this.emailConfig=l}return e.factory=function(t,n,i,r,o,a,s){return new e(t,n,i,r,o,a,s)},e}();t.BackgroundLayoutImageUploader=r}),define("vendor/text!ts/modules/emailbuilder/sidebar/button-properties.directive.html",[],function(){return'<section class="emb-js-property-pane emb-pane emb-reset emb-button-properties" ng-show="editor == \'button\'">\r\n    <form name="contentFormButton" novalidate="novalidate" ng-submit="close()">\r\n        <div class="l-sidebar-inner">\r\n            <div class="c-sidebar__intro">\r\n                <h2 class="c-sidebar__heading-primary">Edit button</h2>\r\n            </div>\r\n            <div class="sidebar__accordion-item">\r\n                <div class="sidebar__form--accordion">\r\n                    <ul role="tablist" class="l-grid l-grid--inline-block l-grid--vertical-spacing">\r\n                        <li class="l-grid__item l-grid__item--100">\r\n                            <label class="c-sidebar__label" for="emb-form-btn-text">Button text</label>\r\n\r\n                            <input class="c-input ng-dirty" cs-focus="editor == \'button\' && !showContent && !contentFormButton.btnLink.focused && (active.content.tempIsNew || contentFormButton.btnTxt.$invalid || contentFormButton.btnLink.$valid)"\r\n                                   select-when="Text here"\r\n                                   ng-focus="contentFormButton.btnTxt.focused = true"\r\n                                   ng-blur="contentFormButton.btnTxt.focused = false"\r\n                                   ng-model="active.content.text"\r\n                                   emb-save-on-blur\r\n                                   ng-required="true"\r\n                                   id="emb-form-btn-text"\r\n                                   name="btnTxt" type="text" />\r\n                        </li>\r\n\r\n                        <li class="l-grid__item l-grid__item--100">\r\n                            <label class="c-sidebar__label" for="emb-form-btn-url">Button link</label>\r\n                            <input class="ng-dirty c-input"\r\n                                   cs-focus="editor == \'button\' && !showContent && !active.content.tempIsNew && contentFormButton.btnTxt.$valid && !contentFormButton.btnTxt.focused && contentFormButton.btnLink.$invalid"\r\n                                   emb-sync-href="active.content"\r\n                                   ng-focus="contentFormButton.btnLink.focused = true"\r\n                                   ng-blur="contentFormButton.btnLink.focused = false"\r\n                                   ng-change="active.content.tempIsNew = false"\r\n                                   ng-model="active.content.tempHref"\r\n                                   ng-model-options="{ allowInvalid: true }"\r\n                                   emb-save-on-blur\r\n                                   ng-required="true"\r\n                                   cs-valid-url\r\n                                   name="btnLink"\r\n                                   id="emb-form-btn-url"\r\n                                   type="text"\r\n                                   placeholder="{{linkPlaceholderText}}" />\r\n                        </li>\r\n\r\n                        \x3c!-- NEW BUTTON STYLES AFTER BUTTON FLEXIBILITY IS SWITCHED ON (The Blueprint only) --\x3e\r\n                        <li class="l-grid__item l-grid__item--100 c-segmented-control--button-size" ng-if="::canEditStyles && buttonSizeAppearanceEnabled">\r\n                            <cm-segmented-control\r\n                                group-name="button-size"\r\n                                group-legend="Button size"\r\n                                group-class-name="c-segmented-control--button-size"\r\n                                ng-model="active.content.buttonSize"\r\n                                emb-save-on-model-change>\r\n                                <cm-segmented-control-item\r\n                                    item-name="Small" \r\n                                    item-value="small"\r\n                                    segment-id="small"\r\n                                    class-names="c-segmented-control--button-size-small"\r\n                                    is-default>\r\n                                </cm-segmented-control-item>\r\n                                <cm-segmented-control-item\r\n                                    item-name="Medium"\r\n                                    item-value="medium"\r\n                                    segment-id="medium"\r\n                                    class-names="c-segmented-control--button-size-medium">\r\n                                </cm-segmented-control-item>\r\n                                <cm-segmented-control-item\r\n                                    item-name="Large"\r\n                                    item-value="large"\r\n                                    segment-id="large"\r\n                                    class-names="c-segmented-control--button-size-large">\r\n                                </cm-segmented-control-item>\r\n                            </cm-segmented-control>\r\n                        </li>\r\n\r\n                        <li class="l-grid__item l-grid__item--100 c-segmented-control--button-properties" ng-show="::canEditStyles && buttonStyleAppearanceEnabled">\r\n                            <cm-segmented-control\r\n                                group-name="button-style-appearance"\r\n                                group-legend="Button style"\r\n                                group-class-name="c-segmented-control--button-style"\r\n                                ng-model="active.content.buttonStyleAppearance"\r\n                                emb-save-on-model-change>\r\n                                <cm-segmented-control-item\r\n                                    item-name="Flat"\r\n                                    item-value="flat"\r\n                                    segment-id="flat"\r\n                                    class-names="c-segmented-control--button-style-flat"\r\n                                    is-default>\r\n                                </cm-segmented-control-item>\r\n                                <cm-segmented-control-item \r\n                                    item-name="Shadow"\r\n                                    item-value="shadow"\r\n                                    segment-id="shadow"\r\n                                    class-names="c-segmented-control--button-style-shadow">\r\n                                </cm-segmented-control-item>\r\n                                <cm-segmented-control-item\r\n                                    item-name="Depth"\r\n                                    item-value="depth"\r\n                                    segment-id="depth"\r\n                                    class-names="c-segmented-control--button-style-depth">\r\n                                </cm-segmented-control-item>\r\n                                <cm-segmented-control-item\r\n                                    item-name="Ghost"\r\n                                    item-value="ghost"\r\n                                    segment-id="ghost"\r\n                                    class-names="c-segmented-control--button-style-ghost">\r\n                                </cm-segmented-control-item>\r\n                            </cm-segmented-control>\r\n                        </li>\r\n\r\n                        \x3c!-- BUTTON CORNERS AND ALIGNMENT AFTER BUTTON FLEXIBILITY IS SWITCHED ON --\x3e\r\n\r\n                        <li class="l-grid__item l-grid__item--100"\r\n                            ng-if="::canEditStyles && buttonFlexibilityEnabled">\r\n                            <div class="l-grid l-grid--gutter">\r\n                                <div class="l-grid__item l-grid__item--50">\r\n                                    <cm-segmented-control\r\n                                        group-name="button-corner"\r\n                                        group-legend="Corner"\r\n                                        group-class-name="c-segmented-control--button-corner-style"\r\n                                        ng-model="active.content.borderRadius"\r\n                                        emb-save-on-model-change>\r\n                                        <cm-segmented-control-item\r\n                                            item-name="Square"\r\n                                            item-value="0"\r\n                                            segment-id="corner-square"\r\n                                            class-names="c-segmented-control--button-corner-square">\r\n                                        </cm-segmented-control-item>\r\n                                        <cm-segmented-control-item\r\n                                            item-name="Round"\r\n                                            item-value="{{borderRadiusForRoundedButtonCorners}}"\r\n                                            segment-id="corner-round"\r\n                                            class-names="c-segmented-control--button-corner-round"\r\n                                            is-default>\r\n                                        </cm-segmented-control-item>\r\n                                    </cm-segmented-control>\r\n                                </div>\r\n                                <div class="l-grid__item l-grid__item--50">\r\n                                    <cm-segmented-control\r\n                                        group-name="button-alignment"\r\n                                        group-legend="Alignment"\r\n                                        group-class-name="c-segmented-control--button-alignment"\r\n                                        ng-model="active.content.halign"\r\n                                        emb-save-on-model-change>\r\n                                        <cm-segmented-control-item\r\n                                            item-name="Left"\r\n                                            item-value="left"\r\n                                            segment-id="align-left"\r\n                                            class-names="c-segmented-control--button-align-left">\r\n                                        </cm-segmented-control-item>\r\n                                        <cm-segmented-control-item\r\n                                            item-name="Center"\r\n                                            item-value="center"\r\n                                            segment-id="align-center"\r\n                                            class-names="c-segmented-control--button-align-center">\r\n                                        </cm-segmented-control-item>\r\n                                        <cm-segmented-control-item\r\n                                            item-name="Right"\r\n                                            item-value="right"\r\n                                            segment-id="align-right"\r\n                                            class-names="c-segmented-control--button-align-right">\r\n                                        </cm-segmented-control-item>\r\n                                        <cm-segmented-control-item\r\n                                            item-name="Full width"\r\n                                            item-value="full"\r\n                                            segment-id="align-full"\r\n                                            class-names="c-segmented-control--button-align-full">\r\n                                        </cm-segmented-control-item>\r\n                                    </cm-segmented-control>\r\n                                </div>\r\n                            </div>\r\n                        </li>\r\n\r\n                        \x3c!-- BUTTON COLOR AND TEXT COLOR BEFORE BUTTON FLEXIBILITY IS SWITCHED ON --\x3e\r\n\r\n                        <li class="l-grid__item l-grid__item--100"\r\n                            ng-if="::!buttonFlexibilityEnabled"\r\n                            ng-show="canEditStyles">\r\n                            <label class="c-sidebar__label">Button color</label>\r\n                            <div class="c-colorpicker ff-colorpicker--recent c-colorpicker--light c-colorpicker--input">\r\n                                <div cs-color-picker cs-viewport="#emb-js-sidebar" ng-model="active.content.tempBackgroundColor"></div>\r\n                            </div>\r\n                        </li>\r\n                        <li class="l-grid__item l-grid__item--100"\r\n                            ng-if="::!buttonFlexibilityEnabled"\r\n                            ng-show="canEditStyles">\r\n                            <label class="c-sidebar__label">Text color</label>\r\n                            <div class="c-colorpicker ff-colorpicker--recent c-colorpicker--light c-colorpicker--input">\r\n                                <div cs-color-picker cs-viewport="#emb-js-sidebar" ng-model="active.content.tempTextColor"></div>\r\n                            </div>\r\n                        </li>\r\n\r\n                        <li class="l-grid__item l-grid__item--50"\r\n                            ng-if="::!buttonFlexibilityEnabled"\r\n                            ng-show="canEditStyles">\r\n                            <cm-segmented-control\r\n                                group-name="non-blueprint-button-alignment"\r\n                                group-legend="Alignment"\r\n                                group-class-name="c-segmented-control--alignment"\r\n                                ng-model="active.content.halign"\r\n                                emb-save-on-model-change>\r\n                                <cm-segmented-control-item\r\n                                    item-name="Left"\r\n                                    item-value="left"\r\n                                    segment-id="non-blueprint-button-left"\r\n                                    class-names="c-segmented-control--alignment-left">\r\n                                </cm-segmented-control-item>\r\n                                <cm-segmented-control-item\r\n                                    item-name="Center"\r\n                                    item-value="center"\r\n                                    segment-id="non-blueprint-button-center"\r\n                                    class-names="c-segmented-control--alignment-center"\r\n                                    is-default>\r\n                                </cm-segmented-control-item>\r\n                                <cm-segmented-control-item\r\n                                    item-name="Right"\r\n                                    item-value="right"\r\n                                    segment-id="non-blueprint-button-right"\r\n                                    class-names="c-segmented-control--alignment-right">\r\n                                </cm-segmented-control-item>\r\n                            </cm-segmented-control>\r\n                        </li>\r\n\r\n                        \x3c!-- BUTTON FONT AND TEXT COLOR AFTER BUTTON FLEXIBILITY IS SWITCHED ON --\x3e\r\n\r\n                        <li class="l-grid__item l-grid__item--100"\r\n                            ng-if="::buttonFlexibilityEnabled"\r\n                            ng-show="canEditStyles">\r\n                            <label class="c-sidebar__label">Text style</label>\r\n                            <div class="c-colorpicker ff-colorpicker--recent c-colorpicker--light c-colorpicker--select">\r\n                                <div cs-color-picker class="qa-button-text-color" cs-viewport="#emb-js-sidebar" ng-model="active.content.tempTextColor"></div>\r\n                                \x3c!-- ng-model needs to be different (for the actual button) --\x3e\r\n                                <div class="qa-button-font-family" cs-dropdown-class="l-select-container--font-family" cs-dropdown="availablefonts" cs-child ng-model="active.content.fontFamily" emb-save-on-model-change></div>\r\n                            </div>\r\n                        </li>\r\n\r\n                        \x3c!-- BUTTON COLOR AFTER BUTTON FLEXIBILITY IS SWITCHED ON --\x3e\r\n\r\n                        <li class="l-grid__item l-grid__item--100"\r\n                            ng-if="::buttonFlexibilityEnabled"\r\n                            ng-show="canEditStyles">\r\n                            <label class="c-sidebar__label">Color</label>\r\n                            <div class="c-colorpicker ff-colorpicker--recent c-colorpicker--light c-colorpicker--input">\r\n                                <div cs-color-picker class="qa-button-background-color" cs-viewport="#emb-js-sidebar" ng-model="active.content.tempBackgroundColor"></div>\r\n                            </div>\r\n                        </li>\r\n                    </ul>\r\n                    <p ng-if="::buttonStyleAppearanceEnabled" class="c-sidebar__text l-gap--top-medium" ng-show="canEditStyles">Some email clients may display buttons differently. We recommend testing before sending your campaign.</p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <footer class="hmb-dismiss-container">\r\n            <input type="submit" value="Done editing" class="c-button c-button--primary c-button--large" ng-click="close()">\r\n        </footer>\r\n    </form>\r\n</section>'}),define("ts/modules/emailbuilder/sidebar/button-properties.directive",["require","exports","vendor/text!ts/modules/emailbuilder/sidebar/button-properties.directive.html","../constants"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){var r=this;this.restrict="E",this.template=n,this.link=function(e,t){e.availablefonts=r.emailBuilderConfig.fonts,e.buttonFlexibilityEnabled=r.emailBuilderConfig.email.isBlueprint,e.buttonSizeAppearanceEnabled=r.emailBuilderConfig.email.isBlueprint,e.buttonStyleAppearanceEnabled=r.emailBuilderConfig.email.isBlueprint,e.borderRadiusForRoundedButtonCorners=r.emailBuilderConfig.settings.borderRadiusForRoundedButtonCorners,e.linkPlaceholderText=r.emailBuilderConfig.phoneLinkEnabled?i.LINK_PLACEHOLDER_TEXT:"http://";var n=e.active.content;delete n.tempHref;var o=function(){var t=e.contentFormButton;return{hasText:t.btnTxt.$error.required,hasLink:t.btnLink.$error.required,hasValidUrl:t.btnLink.$error.url}},a=function(){var t=e.contentFormButton,i=[];t.btnTxt.$error.required&&!t.btnLink.$error.required&&i.push("btnNoText"),t.btnLink.$error.required&&!t.btnTxt.$error.required&&i.push("btnNoLink"),t.btnLink.$error.url&&i.push("btnInvalidLink"),t.btnTxt.$error.required&&t.btnLink.$error.required&&i.push("btnNoLinkNoText"),n.tempValidation=i,n.tempIsValid=!i.length},s=r.lockLevelService.getLocks(e.email.sections[n.tempContainer.sectionIndex].permissions);e.canEditStyles=s.canEditContentItemStyles,e.$watch(o,a,!0)},this.lockLevelService=e,this.emailBuilderConfig=t}return e.factory=function(t,n){return new e(t,n)},e}();t.ButtonProperties=r}),define("vendor/text!ts/modules/emailbuilder/sidebar/code-properties.directive.html",[],function(){return'<section class="emb-js-property-pane emb-pane emb-reset emb-eventcode-properties" ng-show="editor == \'code\'">\n    <div class="c-sidebar__intro">\n        <h2 class="c-sidebar__heading-primary">Edit code</h2>\n        <div class="c-sidebar__intro-text">\n            <a ng-href="{{sampleEventPageUrl}}" target="_blank" class="c-sidebar__intro-text-link" ng-click="trackEventPageClick()">Edit sample event data</a>\n        </div>\n    </div>\n    <div class="sidebar__accordion-item">\n        <div class="sidebar__form--accordion">\n            <div class="c-sidebar__info">\n                <p>Insert subscriber event data into email content by prefixing trigger event property names with &ldquo;triggerEvent&rdquo;, for example: <code class="u-enable-select-text">triggerEvent.order_number</code></p>\n                <p><strong>Note:</strong> Script, style, and custom field personalization tags will be removed from the code content. Inline CSS can be used.</p>\n            </div>\n        </div>\n    </div>\n    <footer class="hmb-dismiss-container">\n        <input type="submit" value="Done editing" class="c-button c-button--primary c-button--large" ng-click="close()">\n    </footer>\n</section>'}),define("ts/modules/emailbuilder/sidebar/code-properties.directive",["require","exports","vendor/text!ts/modules/emailbuilder/sidebar/code-properties.directive.html"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){var t=this;this.restrict="E",this.template=n,this.link=function(e){e.sampleEventPageUrl=t.emailBuilderConfig.urls.sampleEventPageUrl},this.emailBuilderConfig=e}return e.factory=function(t){return new e(t)},e}();t.CodeProperties=i});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/sidebar/crop-stage.animation",["require","exports","angular","../constants","vendor/jquery.easing"],function(e,t,n,i){"use strict";function r(e){function t(){var t=e.innerWidth-o,n=Math.max(t/2,a);return{fullStageWidth:t,cropStageWidth:n,condensedEmailStageWidth:Math.min(t/2,t-a),cropStageOnscreenLeft:o,cropStageOffscreenLeft:o-n}}return{addClass:function(e,r,o){if("ng-hide"!==r)return void o();var a=t(),l=n.default.element(i.EMAIL_BODY_SELECTOR);l.css({width:a.cropStageWidth,maxWidth:u}),l.stop().animate({width:a.fullStageWidth},{duration:c,easing:s,always:function(){l.css({width:u,maxWidth:u}),o()}}),e.stop().animate({left:a.cropStageOffscreenLeft},c,s,function(){o()})},removeClass:function(e,r,o){if("ng-hide"!==r)return void o();var c=t(),u=n.default.element(i.EMAIL_BODY_SELECTOR);u.css({width:c.fullStageWidth}),u.stop().animate({width:c.condensedEmailStageWidth},l,s,function(){u.css({width:"50%",maxWidth:"calc(100% - "+a+"px)"}),o()}),e.css({left:c.cropStageOffscreenLeft}),e.stop().animate({left:c.cropStageOnscreenLeft
},l,s,o)}}}Object.defineProperty(t,"__esModule",{value:!0}),n=__importDefault(n);var o=321,a=400,s="easeOutQuad",l=500,c=300,u="";t.CropStageAnimation=r}),define("vendor/text!ts/modules/emailbuilder/sidebar/footer-properties.directive.html",[],function(){return'<section class="emb-js-property-pane emb-pane sidebar--footer-properties emb-reset" ng-show="editor == \'footer\'">\r\n    <div class="sidebar--footer-controls" ng-submit="close()">\r\n        <div class="c-sidebar__intro">\r\n            <h2 class="c-sidebar__heading-primary">Footer settings</h2>\r\n            <div ng-show="email.footer.permissions.lockLevel === \'full\' && showFooterPermissionsMessage">\r\n                <p class="c-sidebar__text c-sidebar__text--intro">The footer is <strong>locked</strong>.</p>\r\n                <p class="c-sidebar__text c-sidebar__text--intro">To make changes to the footer, please contact the template creator.</p>\r\n            </div>\r\n        </div>\r\n        <div class="emb-customize">\r\n            <h3 id="emb-js-footer-companyDetails" class="sidebar__heading sidebar__heading--secondary"\r\n                ng-class="{\'emb-selected\': currentFooterSetting == \'companyDetails\'}"\r\n                ng-click="currentFooterSetting = \'companyDetails\'" ng-hide="hideFooterSettings">\r\n                Company details\r\n            </h3>\r\n            <div class="sidebar__accordion-item emb-accordion-item hmb-image-sidebar emb-sidebar-accordion-header emb-js-animation-allowed"\r\n                 ng-class="{\'emb-accordion-anim\': currentFooterSetting == \'companyDetails\'}"\r\n                 ng-show="currentFooterSetting === \'companyDetails\'">\r\n\r\n                <div class="emb-content-accordion-zoom">\r\n                    <form name="footerCompanyDetails" novalidate="novalidate" class="sidebar__form--accordion">\r\n                        <ul role="tablist" class="l-grid l-grid--inline-block checkbox-options__list checkbox-options__list--inputs">\r\n                            <li class="l-grid__item l-grid__item--100 l-grid l-grid--inline-block" ng-repeat="(key, value) in ::templateOptions.webLinkOptions" data-company-weblinks>\r\n                                <div class="l-grid__item l-fixed--checkbox l-offset--top-small l-offset--right-small">\r\n                                    <div id="emb-js-company-details-{{::key | lowercase}}" cs-checkbox ng-model="emailModel.webLinks[key].on" checkbox-id="weblinks-{{::key}}" class="checkbox-options" emb-save-on-model-change></div>\r\n                                </div>\r\n                                <div class="l-grid__item l-grid__item--100 l-max--checkbox-input">\r\n                                    <label for="url-{{::key | lowercase}}" class="u-visually-hide">URL for {{::key}}</label>\r\n                                    <input id="url-{{::key | lowercase}}" ng-disabled="!emailModel.webLinks[key].on" class="c-input input-url input-url--{{::key | lowercase}}" ng-model="emailModel.webLinks[key].href" name="href" type="text" placeholder="http://" emb-save-on-blur ng-keypress="handleEnter($event)" />\r\n                                </div>\r\n                            </li>\r\n                        </ul>\r\n                    </form>\r\n                </div>\r\n            </div>\r\n\r\n            <h3 id="emb-js-footer-sharingEmail" class="sidebar__heading sidebar__heading--secondary"\r\n                ng-class="{\'emb-selected\': currentFooterSetting == \'sharingEmail\'}"\r\n                ng-click="currentFooterSetting = \'sharingEmail\'" ng-show="allowShareLinks && !hideFooterSettings">\r\n                Share this email\r\n            </h3>\r\n            <div class="sidebar__accordion-item emb-accordion-item hmb-image-sidebar emb-js-animation-allowed"\r\n                 ng-class="{\'emb-accordion-anim\': currentFooterSetting == \'sharingEmail\'}"\r\n                 ng-show="currentFooterSetting === \'sharingEmail\' && !hideFooterSettings"\r\n                 ng-if="::allowShareLinks">\r\n                <div class="emb-content-accordion-zoom">\r\n                    <form name="footerSharingEmail" novalidate="novalidate" class="sidebar__form--accordion">\r\n                        <ul class="checkbox-options__list">\r\n                            <li ng-repeat="(type, label) in ::templateOptions.socialOptions" data-social-type>\r\n                                \x3c!-- share by social networks --\x3e\r\n                                <div id="emb-js-social-{{::type}}" cs-checkbox ng-model="emailModel.social[type].on"\r\n                                class="checkbox-options checkbox-options--facebook-share"\r\n                                label="{{::label}}" emb-save-on-model-change></div>\r\n                                <div ng-if="::type == \'fblike\'" ng-class="{\'c-dropdown-options-container\': emailModel.social.fblike.on}" cs-dropdown-class="c-dropdown-">\r\n                                    <div ng-init="likeList = [\'Like a URL\', \'Like this email\']" cs-dropdown="likeList" cs-dropdown-class="c-dropdown-container" ng-model="emailModel.social.fblike.type" ng-show="emailModel.social.fblike.on"></div>\r\n                                    <label class="u-visually-hide" for="facebook-url">Facebook URL</label>\r\n                                    <input id="facebook-url"\r\n                                           name="facebook-url"\r\n                                           placeholder="http://"\r\n                                           type="text"\r\n                                           class="c-input"\r\n                                           cs-valid-url\r\n                                           ng-model="emailModel.social.fblike.tempHref"\r\n                                           emb-sync-href="emailModel.social.fblike"\r\n                                           emb-save-on-blur\r\n                                           ng-show="emailModel.social.fblike.on && emailModel.social.fblike.type == \'Like a URL\'"\r\n                                           cs-focus="emailModel.social.fblike.on && emailModel.social.fblike.type == \'Like a URL\'">\r\n                                </div>\r\n                            </li>\r\n                            <li>\r\n                                \x3c!-- share by email i.e. forward to a friend --\x3e\r\n                                <div id="emb-js-share-forwardtoafriend" cs-checkbox ng-model="emailModel.social.forwardtoafriend.on"\r\n                                class="checkbox-options"\r\n                                label="{{::templateOptions.shareOptions.forwardtoafriend}}" emb-save-on-model-change></div>\r\n                            </li>\r\n                        </ul>\r\n                    </form>\r\n                </div>\r\n            </div>\r\n\r\n            <h3 id="emb-js-footer-otherSettings" class="sidebar__heading sidebar__heading--secondary"\r\n                ng-class="{\'emb-selected\': currentFooterSetting == \'otherSettings\'}"\r\n                ng-click="currentFooterSetting = \'otherSettings\'" ng-hide="hideFooterSettings">\r\n                Other settings\r\n            </h3>\r\n            <div class="sidebar__accordion-item emb-accordion-item hmb-image-sidebar emb-js-animation-allowed"\r\n                 ng-class="{\'emb-accordion-anim\': currentFooterSetting == \'otherSettings\'}"\r\n                 ng-show="currentFooterSetting === \'otherSettings\'">\r\n                <div class="emb-content-accordion-zoom">\r\n                    <form name="footerOtherSettings" novalidate="novalidate" class="sidebar__form--accordion">\r\n                        <ul class="checkbox-options__list">\r\n                            <li ng-if="::templateOptions.optionalTexts.permission">\r\n                                \x3c!-- explanation text --\x3e\r\n                                <div id="emb-js-explanation-text" cs-reverse-checkbox ng-model="emailModel.editableText.permission.isDisabled"\r\n                                     class="checkbox-options"\r\n                                     label="{{::templateOptions.optionalTexts.permission}}" emb-save-on-model-change></div>\r\n                            </li>\r\n                            <li ng-if="::allowShareLinks">\r\n                                \x3c!-- preferences link --\x3e\r\n                                <div id="emb-js-share-preferences" cs-checkbox ng-model="emailModel.social.preferences.on"\r\n                                     class="checkbox-options"\r\n                                     label="{{::templateOptions.shareOptions.preferences}}" emb-save-on-model-change></div>\r\n                            </li>\r\n                            <li ng-if="templateBadgeFeatureFlag">\r\n                                \x3c!-- template badge --\x3e\r\n                                <div id="emb-js-optional-template-badge" cs-checkbox ng-model="emailModel.templateBadge.displayBadge"\r\n                                     class="checkbox-options"\r\n                                     label="Made with Campaign Monitor" emb-save-on-model-change></div>\r\n                            </li>\r\n                        </ul>\r\n                    </form>\r\n                </div>\r\n            </div>\r\n\r\n            <h3 id="emb-js-footer-footerLocking" class="sidebar__heading sidebar__heading--secondary qa-footer-content-locking"\r\n                ng-class="{\'emb-selected\': currentFooterSetting == \'permissions\'}"\r\n                ng-click="currentFooterSetting = \'permissions\'"\r\n                ng-show="showFooterPermissions">\r\n                Footer content locking\r\n            </h3>\r\n            <div class="sidebar__accordion-item emb-accordion-item hmb-image-sidebar emb-js-animation-allowed"\r\n                 ng-class="{\'emb-accordion-anim\': currentFooterSetting == \'permissions\'}"\r\n                 ng-show="currentFooterSetting === \'permissions\' && showFooterPermissions">\r\n                <div class="emb-content-accordion-zoom">\r\n                    <form class="sidebar__form--accordion" name="permissions" novalidate="novalidate">\r\n                        <ul role="tablist" class="l-grid l-grid--inline-block l-grid--vertical-spacing">\r\n                            <li class="l-grid__item l-grid__item--100">\r\n                                <label class="c-sidebar__label">Footer editing restrictions</label>\r\n                                <div class="c-dropdown-options-container" cs-dropdown-class="c-dropdown">\r\n                                    <div cs-dropdown="footerLockLevels" cs-dropdown-class="l-select-container--small l-select-container--permissions"\r\n                                         ng-model="email.footer.permissions.lockLevel" emb-save-on-model-change\r\n                                         ng-change="footerPermissionsChanged(email.footer)"></div>\r\n                                </div>\r\n                                <p ng-show="email.footer.permissions.lockLevel !== \'none\'" class="c-sidebar__text l-gap--top-medium">To make changes to the footer, select Unlock everything.</p>\r\n                            </li>\r\n                        </ul>\r\n                    </form>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</section>'});var __spreadArrays=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var i=Array(e),r=0,t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,r++)i[r]=o[a];return i},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/sidebar/footer-properties.directive",["require","exports","vendor/text!ts/modules/emailbuilder/sidebar/footer-properties.directive.html","angular","../services/analytics.service"],function(e,t,n,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=__importDefault(i);var o={facebook:"Company Facebook",twitter:"Company Twitter",youtube:"Company YouTube",instagram:"Company Instagram",linkedin:"Company LinkedIn",website:"Company Website",pinterest:"Company Pinterest"},a={forwardtoafriend:"Forward To A Friend",tweet:"Twitter Share",linkedinshare:"LinkedIn Share",preferences:"Edit Subscription"},s={permission:"Explanation Text"},l=function(){function e(e,t,l,c,u,d,h){var p=this;this.restrict="E",this.template=n,this.link=function(e){var t=p.emailBuilderConfig;e.templateOptions=p.emailBuilderConfig.template,e.emailModel=p.emailService.model,e.allowShareLinks=t.allowShareLinks,e.templateBadgeFeatureFlag=t.templateBadge,e.footerLockLevels=t.footerLockLevels,e.showFooterPermissions=t.canvasSectionPermissions&&t.mode.templateWithContent,e.showFooterPermissionsMessage=t.canvasSectionPermissions&&!t.mode.templateWithContent;var n=function(t){var n=p.lockLevelService.getLocks(t);e.hideFooterSettings=n.anyLocking},l={webLinks:e.emailModel.webLinks,social:e.emailModel.social,editableText:e.emailModel.editableText},c=function(e,t){return p.trackingSnapshotCompareService.compareObjectPropertiesWithTrackingValueMap(e,t,o)},u=function(e,t){var n=p.trackingSnapshotCompareService.compareObjectPropertiesWithTrackingValueMap(e,t,a);if(!p.emailModelComparisonService.ObjectsAreEqual(e.fblike,t.fblike))switch(t.fblike.type){case"Like this email":n.push("Facebook Share - Like Email");break;case"Like a URL":n.push("Facebook Share - Like URL")}return n},d=function(e,t){var n=p.trackingSnapshotCompareService.compareObjectPropertiesWithTrackingValueMap(e,t,s);return e.address.contents!==t.address.contents?__spreadArrays(["Street Address"],n):n};n(p.emailService.model.footer.permissions),e.footerPermissionsChanged=function(e){p.lockLevelService.permissionsChanged("footer",e.permissions),n(e.permissions)};var h=!1;p.$rootScope.$on("sidebar:footerPropertiesOpened",function(){if(!p.emailBuilderConfig.mode.publicCanvas&&!h){h=!0;var e=i.default.copy(l),t=p.$rootScope.$on("content:deactivated",function(n,i){h=!1;var o=e,a=l,s=c(o.webLinks,a.webLinks),f=u(o.social,a.social),m=d(o.editableText,a.editableText),g=__spreadArrays(s,f,m);if(g.length>0){var v={"Updated Element":g};p.analyticsService.trackClientLevel({eventName:r.AnalyticsEventName.UpdatedFooter,publicProperties:v})}t()})}})},this.$rootScope=e,this.emailService=t,this.lockLevelService=l,this.emailBuilderConfig=c,this.trackingSnapshotCompareService=u,this.analyticsService=d,this.emailModelComparisonService=h}return e.factory=function(t,n,i,r,o,a,s){return new e(t,n,i,r,o,a,s)},e}();t.FooterProperties=l}),define("vendor/text!ts/modules/emailbuilder/sidebar/general-properties.directive.html",[],function(){return'<section class="c-sidebar__build emb-pane emb-js-property-pane emb-reset emb-top emb-sidebar-anim emb-js-animation-allowed" ng-mouseenter="hovered = true" ng-mouseleave="hovered = false" ng-click="close();" ng-class="{\'emb-hovered\' : hovered && !hoveredLevel2 && level2, \'emb-js-offscreen\': !showContent }">\r\n    <div class="c-sidebar__intro">\r\n        <h2 class="c-sidebar__heading-primary">Build</h2>\r\n        <button ng-click="switchPanes(\'customize\');$event.stopPropagation()" class="c-sidebar-settings-icon qa-customize-tab" ng-if="mode.customisable || standardClientHasEditingPermissions">\r\n            <span class="c-sidebar-settings-icon__text">Settings</span>\r\n        </button>\r\n    </div>\r\n    <ol class="l-parent-offset--right-small l-parent-offset--bottom-medium l-tiles-container l-gap--side-left l-gap--top" ng-show="currentPane == \'content-tiles\'">\r\n        <li class="l-tile-container emb-content-tile-wrap"\r\n            ng-repeat="content in generalContentTypes"\r\n            ng-hide="content.title == \'Survey\' && (!surveysEnabled || isIFramed)"\r\n            ng-mousedown="item.tileActive = \'active\'"\r\n            ng-mouseout="item.tileActive = \'inactive\'">\r\n            <div emb-tile\r\n                    item="content"\r\n                    name="{{content.title}}"\r\n                    type="content"\r\n                    subtype="{{content.type}}"\r\n                    class="l-tile emb-content-tile"\r\n                    connect-to=".emb-js-content-container,.emb-js-content-dropzone"></div>\r\n        </li>\r\n    </ol>\r\n    <h2 class="l-gap--side-left l-gap--top c-sidebar__text--content-type-category" ng-if="showAdvancedContentTypes">Advanced</h2>\r\n    <ol class="l-parent-offset--right-small l-parent-offset--bottom-medium l-tiles-container l-gap--side-left" ng-show="currentPane == \'content-tiles\'">\r\n        <li class="l-tile-container emb-content-tile-wrap"\r\n            ng-repeat="content in advancedContentTypes"\r\n            ng-hide="content.title == \'Survey\' && (!surveysEnabled || isIFramed)"\r\n            ng-mousedown="item.tileActive = \'active\'"\r\n            ng-mouseout="item.tileActive = \'inactive\'">\r\n            <div emb-tile\r\n                    item="content"\r\n                    name="{{content.title}}"\r\n                    type="content"\r\n                    subtype="{{content.type}}"\r\n                    class="l-tile emb-content-tile"\r\n                    connect-to=".emb-js-content-container,.emb-js-content-dropzone"></div>\r\n        </li>\r\n    </ol>\r\n    \r\n    <div cs-custom-scroll1 ng-class="{ \'emb-customize-colorsAndFonts\': currentCustomize == \'colorsAndFonts\' }" class="ng-hide" ng-show="currentPane == \'customize\'" ng-click="$event.stopPropagation()">\r\n        <emb-sidebar-settings></emb-sidebar-settings>\r\n        <footer class="hmb-dismiss-container">\r\n            <input type="submit" value="Done editing" class="c-button c-button--primary c-button--large" ng-click="switchPanes(\'content-tiles\');$event.stopPropagation()">\r\n        </footer>\r\n    </div>\r\n</section>'}),define("ts/modules/emailbuilder/sidebar/general-properties.directive",["require","exports","vendor/text!ts/modules/emailbuilder/sidebar/general-properties.directive.html"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){var i=this;this.template=n,this.restrict="E",this.initialise=function(e){e.generalContentTypes=i.emailBuilderConfig.template.contentTypes.filter(function(e){return"code"!==e.type}),e.advancedContentTypes=i.emailBuilderConfig.template.contentTypes.filter(function(e){return"code"===e.type}),e.showAdvancedContentTypes=e.advancedContentTypes.length>0},this.link=function(e,t,n){i.initialise(e);var r=function(t){var n=i.lockLevelService.getLocks(t);e.hideHeaderSettings=n.anyLocking,e.standardClientHasEditingPermissions=!e.mode.customisable&&n.canEditContentItems};r(e.email.header.permissions),e.$on("permissionsChanged:header",function(e,t){r(t)})},this.lockLevelService=e,this.emailBuilderConfig=t}return e.factory=function(t,n){return new e(t,n)},e}();t.GeneralProperties=i}),define("vendor/text!ts/modules/emailbuilder/sidebar/header-settings.directive.html",[],function(){return'<div>\n    <div ng-show="inboxPreviewTextEnabled">\n        <div ng-show="showPreheaderTextarea" id="inbox-preview-settings">\n            <h2 class="c-sidebar__heading c-sidebar__heading--has-subtext" id="preheader-text">\n                Preheader text\n            </h2>\n            <form name="preheader-text" class="c-sidebar__form">\n                <p class="c-sidebar__text c-sidebar__text--settings">\n                    A short sentence that\'s displayed as an email preview in <a href="/help-doc/campus-email-builder-preheader-text" target="_blank" rel="noopener" title="some inboxes">some inboxes</a>\n                </p>\n                <ul role="tablist" class="l-grid l-grid--inline-block l-grid--vertical-spacing">\n                    <li class="l-grid__item l-grid__item--100">\n                        <textarea class="c-sidebar__form-textarea qa-preheader-textarea" aria-labelledby="preheader-text" placeholder="Type your preheader text here" rows="2" emb-save-on-blur ng-model="email.previewText.contents" ng-focus="onPreheaderFocus()" ng-blur="onPreheaderBlur()"></textarea>\n                    </li>\n                </ul>\n            </form>\n        </div>\n        <form id="preheader-webversion-settings" name="webversion" novalidate="novalidate" ng-if="(template.optionalTexts.preheader || template.shareOptions.webversion)" class="c-sidebar__form form--webversion"\n        ng-hide="hidePreheaderAndWebversionSettings">\n            <ul class="checkbox-options__list l-grid l-grid--inline-block">\n                <li class="l-grid__item l-grid__item--100">\n                    <div class="checkbox-options" cs-checkbox ng-model="email.previewText.showInPreheader" label="Include in email body" is-disabled="checkboxesDisabled" emb-save-on-model-change></div>\n                    <hr class="c-sidebar__rule">\n                </li>\n                <li class="l-grid__item l-grid__item--100" ng-if="template.shareOptions.webversion">\n                    <div class="checkbox-options" id="emb-js-share-webversion" cs-checkbox ng-model="email.social.webversion.on" label="{{template.shareOptions.webversion}}" is-disabled="checkboxesDisabled" emb-save-on-model-change></div>\n                </li>\n            </ul>\n        </form>\n    </div>\n    <div ng-show="canvasSectionPermissions && mode.templateWithContent">\n        <h2 class="c-sidebar__heading qa-header-content-locking">\n            Header content locking\n        </h2>\n        <form class="c-sidebar__form" name="permissions" novalidate="novalidate">\n            <ul role="tablist" class="l-grid l-grid--inline-block l-grid--vertical-spacing">\n                <li class="l-grid__item l-grid__item--100">\n                    <label class="c-sidebar__label">Header editing restrictions</label>\n                    <div class="c-dropdown-options-container" cs-dropdown-class="c-dropdown">\n                        <div cs-dropdown="headerLockLevels" cs-dropdown-class="l-select-container--small l-select-container--permissions"\n                             ng-model="email.header.permissions.lockLevel" emb-save-on-model-change\n                             ng-change="headerPermissionsChanged(email.header.permissions)"></div>\n                    </div>\n                    <p ng-show="showUnlockEverythingMessage" class="c-sidebar__text l-gap--top-medium">To make changes to the header, select "Unlock everything".</p>\n                </li>\n            </ul>\n        </form>\n    </div>\n</div>'}),define("ts/modules/emailbuilder/sidebar/header-settings.directive",["require","exports","vendor/text!ts/modules/emailbuilder/sidebar/header-settings.directive.html","../services/analytics.service"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t,r){var o=this;this.lastUsedPreheaderText="",this.template=n,this.restrict="E",this.migratePreheader=function(e){if(e.inboxPreviewTextEnabled&&!e.email.previewText.isUsed){if(!e.email.editableText.preheader||e.email.editableText.preheader.isDisabled||e.email.editableText.preheader.isPlaceholder)e.email.previewText.contents="";else{var t=$("<div></div>").append(e.email.editableText.preheader.contents).text();e.email.previewText.contents=t}e.email.previewText.isUsed=!0,e.email.previewText.showInPreheader=!0}},this.link=function(e,t,n){e.headerLockLevels=o.emailBuilderConfig.headerLockLevels;var r=function(t){var n=o.locklevelService.getLocks(t);e.hideHeaderSettings=n.anyLocking,e.hidePreheaderAndWebversionSettings=e.mode.templateWithContent&&n.anyLocking||!e.mode.templateWithContent&&!n.canEditContentItems,e.checkboxesDisabled=n.anyLocking,e.showPreheaderTextarea="full"!==t.lockLevel,e.showUnlockEverythingMessage="none"!==t.lockLevel};e.headerPermissionsChanged=function(e){o.locklevelService.permissionsChanged("header",e)},r(e.email.header.permissions),e.$on("permissionsChanged:header",function(e,t){r(t)}),e.onPreheaderFocus=function(){o.lastUsedPreheaderText=e.email.previewText.contents},e.onPreheaderBlur=function(){o.lastUsedPreheaderText!==e.email.previewText.contents&&o.analyticsService.trackClientLevel({eventName:i.AnalyticsEventName.UpdatedPreheader})},o.migratePreheader(e)},this.locklevelService=e,this.analyticsService=t,this.emailBuilderConfig=r}return e.factory=function(t,n,i){return new e(t,n,i)},e}();t.HeaderSettings=r}),define("vendor/text!ts/modules/emailbuilder/sidebar/image-block-uploader.directive.html",[],function(){return'<div class="c-image-controls-container l-gap--bottom-medium" ng-class="{ \'l-gap--bottom-none\' : active.content.state.initial }">\r\n    <figure ng-click="$event.stopPropagation()" ng-class="{ \'is-empty\' : active.content.state.initial,  \'has-uploaded\' : active.content.state.hasSrc, \'is-uploading\' : active.content.state.uploading || active.content.state.thirdPartyUrlTyping }" class="hmb-uploaded-image c-image-controls__uploaded-image">\r\n        <div id="emb-js-message">\r\n        </div>\r\n        <div class="emb-js-image-upload" ng-hide="active.content.state.thirdPartyUrl || active.content.state.thirdPartyUrlError">\r\n            <label class="u-visually-hide" for="upload-image">Upload an image</label>\r\n            <input id="upload-image" emb-file-upload file="active.content" class="emb-invisible-input js-file-input" name="file" type="file" accepts="image/*">\r\n        </div>\r\n        <button class="c-button c-button--choose-file">\r\n            Choose file\r\n        </button>\r\n        <div ng-show="active.content.state.uploading || active.content.state.thirdPartyUrlTyping" aria-hidden="true" class="loading-circle">\r\n            <span class="loading-circle__spinner"></span>\r\n        </div>\r\n        <div ng-show="active.content.state.hasSrc && !active.content.state.thirdPartyUrlError" class="c-image-controls__image-container emb-js-preview-holder" >\r\n        </div>\r\n        <div ng-show="active.content.state.thirdPartyUrlError" class="c-image-controls__image-container img-error">\r\n            <div class="emb-image-error"></div>\r\n            <div class="emb-image-error-text">Unable to load image</div>\r\n        </div>\r\n    </figure>\r\n    <span ng-show="active.content.state.hasSrc" class="hmb-upload-actions">\r\n        <button ng-show="active.content.state.fileUploaded && imageBlockCropEnabled" ng-click="launchCrop(); $event.preventDefault();" class="hmb-crop">\r\n            Crop\r\n        </button>\r\n        <div class="emb-replacer" ng-click="$event.stopPropagation()" ng-show="active.content.state.fileUploaded">\r\n            <div class="emb-js-image-upload">\r\n                <label class="u-visually-hide" for="replace-image">Replace existing image</label>\r\n                <input id="replace-image" emb-file-upload file="active.content" class="emb-invisible-input js-file-input" name="file" type="file" accepts="image/*">\r\n            </div>\r\n            <button class="hmb-replace hmb-has-invisible-input">\r\n                Replace\r\n            </button>\r\n        </div>\r\n        <button class="hmb-delete" ng-click="delete()"\r\n                ng-if="canDelete">\r\n            Delete\r\n        </button>\r\n    </span>\r\n</div>\r\n'}),define("ts/modules/emailbuilder/sidebar/image-block-uploader.directive",["require","exports","vendor/text!ts/modules/emailbuilder/sidebar/image-block-uploader.directive.html"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t,i,r,o){var a=this;this.restrict="AE",this.template=n,this.create=function(e,t){a.thumbnailService.create({image:e,container:t,width:121,height:85,direction:{v:"center",h:"center"}})},this.displayThumbnail=function(e,t){void 0!==e.tempWidth&&void 0!==e.tempHeight||a.imageBuilderService.resize(e),a.create(e,t)},this.resetUpload=function(e){e.val("")},this.deleteImage=function(e,t,n){a.contentBlockService.resetBlock(e.active.content),a.resetUpload(t),a.$rootScope.$broadcast("image:deleted",{block:n})},this.link=function(e,t,n){var i,r,o,s=t.find("input.js-file-input");a.$rootScope.$on("content:activated",function(n,l){var c=l.block;if(c.hasOwnProperty("type")&&"image"===c.type){e.delete=function(){a.deleteImage(e,s,c)},e.launchCrop=function(){a.$rootScope.$emit("imageBlock:cropStaged",c)},r=e.$on("upload:start",function(){e.uploading=!0});var u=t.find(".emb-js-preview-holder");o=e.$on("thirdPartyImage:success",function(e,t){a.create(t.block,u)}),i=e.$watch("active.content.src",function(){var t=a.contentBlockService.hasBlockSrc(c);a.resetUpload(s),u.find("img").attr("src",""),u.empty(),t&&a.displayThumbnail(c,u),e.image=c})}});var l=function(){r&&(r(),r=void 0),i&&(i(),i=void 0),o&&(o(),o=void 0)};a.$rootScope.$on("content:deactivated",l),a.$rootScope.$on("content:replaced",l)},this.$rootScope=e,this.thumbnailService=t,this.imageBuilderService=i,this.contentBlockService=r,this.emailBuilderConfig=o}return e.factory=function(t,n,i,r,o){return new e(t,n,i,r,o)},e}();t.ImageBlockUploader=i}),define("vendor/text!ts/modules/emailbuilder/sidebar/image-properties.directive.html",[],function(){
return'<section class="emb-js-property-pane hmb-image-sidebar emb-pane emb-reset" ng-show="editor == \'image\'">\r\n    <form name="form-image-properties" novalidate="novalidate" ng-submit="close()" class="l-sidebar-inner">\r\n        <div class="c-sidebar__intro">\r\n            <h2 class="c-sidebar__heading-primary hmb-empty">\r\n                <span ng-show="active.content.state.initial">Add an image</span>\r\n                <span ng-show="active.content.state.fileUploaded || active.content.state.thirdPartyUrl || active.content.state.thirdPartyUrlError || active.content.state.thirdPartyUrlTyping">Edit image</span>\r\n                <span ng-show="active.content.state.uploading">Uploading&hellip;</span>\r\n            </h2>\r\n        </div>\r\n        <div class="sidebar__accordion-item">\r\n            <div class="sidebar__form--accordion">\r\n                <header class="p hmb-empty">\r\n                    <div emb-image-block-uploader></div>\r\n                </header>\r\n                <div class="l-gap--bottom-large" ng-show="!active.content.state.fileUploaded && !active.content.state.uploading && thirdPartyImagesEnabled" ng-class="{ \'l-gap--top-medium\': !active.content.state.fileUploaded && thirdPartyImagesEnabled, \'l-gap--bottom-medium\': imageBlockResizeEnabled }">\r\n                    <span class="u-separator-text" ng-show="active.content.state.initial">OR</span>\r\n                    <label class="c-sidebar__label" for="qa-image-url">Enter image URL</label>\r\n                    <input id="qa-image-url" class="c-input" emb-sync-href="active.content" targetModel="thirdPartyUrl" ng-model="active.content.tempThirdPartyUrl" cs-valid-url name="thirdPartyUrl" type="text" placeholder="http://" emb-save-on-blur />\r\n                    <ul ng-show="active.content.state.thirdPartyUrlError" ng-class="{ \'is-visible\' :  active.content.state.thirdPartyUrlError }" class="c-sidebar__validation-helper-text">\r\n                        <li>Check that the image is available and the URL is correct</li>\r\n                        <li>The image must be available to set its dimensions correctly</li>\r\n                    </ul>\r\n                </div>\r\n                <section class="emb-secondary-container">\r\n                    <hr class="c-sidebar__rule" ng-if="imageBlockResizeEnabled && imageActive && active.content.state.fileUploaded">\r\n                    <ul role="tablist" class="l-grid l-grid--inline-block l-grid--vertical-spacing" ng-class="{ \'hmb-secondary-actions\' : !active.content.state.initial, \'hmb-secondary-actions u-hide-all\' : active.content.state.initial, \'hmb-top-override\' : !active.content.state.fileUploaded && !active.content.state.uploading && thirdPartyImagesEnabled }" style="width: 100%">\r\n                        <li class="l-grid__item l-grid__item--100">\r\n                            <label class="c-sidebar__label" for="image-link">Link <span class="c-sidebar__label--optional">(optional)</span></label>\r\n                            <input class="c-input" id="image-link" emb-sync-href="active.content" ng-model="active.content.tempHref" cs-valid-url name="href" type="text" placeholder="{{linkPlaceholderText}}" emb-save-on-blur/>\r\n                        </li>\r\n                        <li class="l-grid__item l-grid__item--100">\r\n                            <label class="c-sidebar__label ">Alt text</label>\r\n                            <input class="c-input" name="alt" ng-model="active.content.alt" type="text" emb-save-on-blur/>\r\n                        </li>\r\n                        <li class="l-grid__item l-grid__item--100" ng-if="imageBlockResizeEnabled && imageActive && active.content.state.fileUploaded">\r\n                            <div class="c-slider">\r\n                                <label class="c-sidebar__label">Size</label>\r\n                                <div class="c-sidebar__label c-sidebar__label--slider">\r\n                                    <div ng-if="active.content.displayWidth === containerWidth">Full width</div>\r\n                                    <div ng-if="active.content.displayWidth < containerWidth" emb-image-dimensions="active.content.displayWidth" emb-image-dimensions-slave="active.content.displayHeight" emb-image-dimensions-numerator="active.content.tempHeight" emb-image-dimensions-denominator="active.content.tempWidth"></div>\r\n                                </div>\r\n                                <div cs-slider="active.content.displayWidth" cs-slider-min="1" cs-slider-max="maxImageWidth" ng-model="active.content.displayWidth"></div>\r\n                            </div>\r\n                        </li>\r\n                        <li class="l-grid__item l-grid__item--50" ng-show="showImageAlignmentOptions" ng-if="canEditStyles">\r\n                            <cm-segmented-control\r\n                                group-name="image-alignment"\r\n                                group-legend="Alignment"\r\n                                group-class-name="c-segmented-control--alignment"\r\n                                ng-model="active.content.halign"\r\n                                emb-save-on-model-change>\r\n                                <cm-segmented-control-item\r\n                                    item-name="Left"\r\n                                    item-value="left"\r\n                                    segment-id="image-left"\r\n                                    class-names="c-segmented-control--alignment-left">\r\n                                </cm-segmented-control-item>\r\n                                <cm-segmented-control-item\r\n                                    item-name="Center"\r\n                                    item-value="center"\r\n                                    segment-id="image-center"\r\n                                    class-names="c-segmented-control--alignment-center"\r\n                                    is-default>\r\n                                </cm-segmented-control-item>\r\n                                <cm-segmented-control-item\r\n                                    item-name="Right"\r\n                                    item-value="right"\r\n                                    segment-id="image-right"\r\n                                    class-names="c-segmented-control--alignment-right">\r\n                                </cm-segmented-control-item>\r\n                            </cm-segmented-control>\r\n                        </li>\r\n                        <li class="l-grid__item l-grid__item--100" ng-show="canEditStyles">\r\n                            <div class="checkbox-options" cs-checkbox ng-model="addSpacing" label="Add image spacing" emb-save-on-model-change></div>\r\n                        </li>\r\n                    </ul>\r\n                    <hr class="c-sidebar__rule" ng-if="imageFlexibilityEnabled" ng-class="{ \'l-offset--top-large\': !showImageAlignmentOptions }">\r\n                    <ul role="tablist" class="l-grid l-grid--inline-block l-grid--vertical-spacing" ng-if="imageFlexibilityEnabled">\r\n                        <li class="l-grid__item l-grid__item--100">\r\n                            <div class="l-grid l-grid--gutter">\r\n                                <div class="l-grid__item l-grid__item--50">\r\n                                    <label class="c-sidebar__label">Horizontal spacing</label>\r\n                                    <div cs-dropdown="languages" ng-model="email.language" cs-dropdown-class="l-select-container--image-spacing" emb-save-on-model-change></div>\r\n                                </div>\r\n                                <div class="l-grid__item l-grid__item--50">\r\n                                    <label class="c-sidebar__label">Vertical spacing</label>\r\n                                    <div cs-dropdown="languages" ng-model="email.language" cs-dropdown-class="l-select-container--image-spacing" emb-save-on-model-change></div>\r\n                                </div>\r\n                            </div>\r\n                        </li>\r\n                    </ul>\r\n                </section>\r\n            </div>\r\n        </div>\r\n    </form>\r\n    <footer class="hmb-dismiss-container">\r\n        <input type="submit" value="Done editing" class="c-button c-button--primary c-button--large" ng-click="close()">\r\n    </footer>\r\n</section>'}),define("ts/modules/emailbuilder/sidebar/image-properties.directive",["require","exports","vendor/text!ts/modules/emailbuilder/sidebar/image-properties.directive.html","../services/analytics.service","../constants"],function(e,t,n,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){var e=this;this.listeners=[],this.add=function(t){e.listeners.push(t)},this.clear=function(){for(var t=0;t<e.listeners.length;t++)e.listeners[t]&&e.listeners[t]();e.listeners=[]}}return e}(),a=function(){function e(e,t,a,s,l,c,u,d){var h=this;this.restrict="E",this.template=n,this.link=function(e){e.imageActive=!1,e.addSpacing=!1,e.showImageAlignmentOptions=!1,e.thirdPartyImagesEnabled=h.emailBuilderConfig.canvasThirdPartyImageUrlEnabled,e.imageFlexibilityEnabled=!1,e.imageBlockResizeEnabled=h.emailBuilderConfig.email.isBlueprint,e.imageBlockCropEnabled=h.emailBuilderConfig.email.isBlueprint,e.linkPlaceholderText=h.emailBuilderConfig.phoneLinkEnabled?r.LINK_PLACEHOLDER_TEXT:"http://";var t=new o,n=function(t){e.addSpacing=!t.isFullWidth,e.src=h.contentBlockService.hasBlockSrc(t)?h.contentBlockService.getBlockSrc(t):""},a=function(t){var n=h.itemWidthService.getBlockWidth(t);e.containerWidth=n,e.maxImageWidth=0===t.tempWidth?n:Math.min(n,t.tempWidth),e.showImageAlignmentOptions=!0;var i=e.imageBlockResizeEnabled||t.tempWidth<n;e.showImageAlignmentOptions=h.contentBlockService.hasBlockSrc(t)&&i&&!t.state.thirdPartyUrlError},s=h.$rootScope.$on("content:activated",function(r,o){var s=o.block;if(s.hasOwnProperty("type")&&"image"===s.type){var l=h.lockLevelService.getLocks(e.email.sections[s.tempContainer.sectionIndex].permissions);if(e.canEditStyles=l.canEditContentItemStyles,e.canDelete=l.canDeleteContentItems&&!e.imageBlockResizeEnabled,n(s),a(s),t.add(e.$watch("addSpacing",function(){s.isFullWidth=!e.addSpacing;var t=e.email.sections[s.tempContainer.sectionIndex].content[s.tempContainer.columnIndex];h.emailService.dropzoneHasPadding(t)})),t.add(e.$watch("active.content.tempWidth",function(){a(s)})),t.add(e.$watch(function(e){return h.contentBlockService.getBlockSrc(e.active.content)},function(){h.contentBlockService.hasBlockSrc(s)||h.$rootScope.$broadcast("image:deleted",{block:s})})),e.imageBlockResizeEnabled){var c,u;t.add(e.$on("slider:load",function(e,t){t!==u&&(c=t,u=c)})),t.add(e.$on("slider:slide",function(e,t){u=t}));var d=function(e){var t=h.fileExtensionService.getFileExtension(e);h.analyticsService.trackClientLevel({eventName:i.AnalyticsEventName.EditedImage,publicProperties:{"Edit Type":"Resize","File Extension":t}})};t.add(function(){c!==u&&d(s.fileName)})}e.imageBlockCropEnabled&&t.add(e.$watch("active.content.crop",function(e){e&&a(s)},!0)),e.imageActive=!0}});e.$on("$destroy",s);var l=h.$rootScope.$on("content:deactivated",function(n,i){e.imageActive=!1,t.clear()});e.$on("$destroy",l);var c=h.$rootScope.$on("content:replaced",function(){e.imageActive=!1,t.clear()});e.$on("$destroy",c)},this.$rootScope=e,this.emailService=t,this.itemWidthService=a,this.lockLevelService=s,this.contentBlockService=l,this.emailBuilderConfig=c,this.fileExtensionService=u,this.analyticsService=d}return e.factory=function(t,n,i,r,o,a,s,l){return new e(t,n,i,r,o,a,s,l)},e}();t.ImageProperties=a}),define("vendor/text!ts/modules/emailbuilder/sidebar/image-crop-properties.directive.html",[],function(){return'<section class="emb-js-property-pane hmb-image-sidebar emb-pane emb-reset">\n    <form name="form-image-properties" novalidate="novalidate" ng-submit="close()" class="l-sidebar-inner">\n        <div class="c-sidebar__intro">\n            <h2 class="c-sidebar__heading-primary hmb-empty">\n                <span>Crop image</span>\n            </h2>\n        </div>\n        <div class="sidebar__accordion-item">\n            <div class="sidebar__form--accordion">\n                <ul role="tablist" class="l-grid l-grid--inline-block l-grid--vertical-spacing">\n                    <li class="l-grid__item l-grid__item--100">\n                        <div class="l-grid l-grid--gutter">\n                            <div class="l-grid__item l-grid__item--50">\n                                <label class="c-sidebar__label" for="crop-width">Width</label>\n                                <input class="c-input" name="crop-width" type="number" id="crop-width" ng-model="width" ng-model-options="{ debounce: 500 }" ng-change="widthChanged(width);" min="1" />\n                            </div>\n                            <div class="l-grid__item l-grid__item--50">\n                                <label class="c-sidebar__label" for="crop-height">Height</label>\n                                <input class="c-input" name="crop-height" type="number" id="crop-height" ng-model="height" ng-model-options="{ debounce: 500 }" ng-change="heightChanged(height);" min="1" />\n                            </div>\n                        </div>\n                    </li>\n                    <li class="l-grid__item l-grid__item--100">\n                        <div class="l-grid">\n                            <div class="l-grid__item l-grid__item--100">\n                                <label class="c-sidebar__label" for="aspect-ratio">Aspect ratio</label>\n                                <select id="aspect-ratio" ng-options="aspectRatio.display group by aspectRatio.group for aspectRatio in aspectRatios track by aspectRatio.display" ng-model="selectedAspectRatio" ng-change="aspectRatioChanged()" class="c-sidebar__select"></select>\n                            </div>\n                        </div>\n                    </li>\n                </ul>\n            </div>\n        </div>\n    </form>\n    <footer class="hmb-dismiss-container">\n        <button ng-click="close();" class="c-button c-button--primary c-button--large">Done cropping</button>\n        <button ng-click="cancel();" class="c-button c-button--grey c-button--large">Cancel</button>\n    </footer>\n</section>\n<div class="c-crop__stage js-crop-area emb-js-animation-allowed" ng-show="showStage">\n    <div class="emb-loading">\n        <span></span>\n        <span></span>\n        <span></span>\n    </div>\n\n    <div class="crop__canvas-container js-crop-container">\n        <canvas class="js-crop-canvas"></canvas>\n    </div>\n</div>\n'}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define("vendor/cropperjs/cropper",t):e.Cropper=t()}(this,function(){"use strict";function e(e){return"number"==typeof e&&!G(e)}function t(e){return void 0===e}function n(e){return"object"===(void 0===e?"undefined":V(e))&&null!==e}function i(e){if(!n(e))return!1;try{var t=e.constructor,i=t.prototype;return t&&i&&K.call(i,"isPrototypeOf")}catch(e){return!1}}function r(e){return"function"==typeof e}function o(t,i){if(t&&r(i))if(Array.isArray(t)||e(t.length)){var o=t.length,a=void 0;for(a=0;a<o&&!1!==i.call(t,t[a],a,t);a+=1);}else n(t)&&Object.keys(t).forEach(function(e){i.call(t,t[e],e,t)});return t}function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e11;return Q.test(e)?Math.round(e*t)/t:e}function s(t,n){var i=t.style;o(n,function(t,n){Z.test(n)&&e(t)&&(t+="px"),i[n]=t})}function l(e,t){return e.classList?e.classList.contains(t):e.className.indexOf(t)>-1}function c(t,n){if(n){if(e(t.length))return void o(t,function(e){c(e,n)});if(t.classList)return void t.classList.add(n);var i=t.className.trim();i?i.indexOf(n)<0&&(t.className=i+" "+n):t.className=n}}function u(t,n){if(n)return e(t.length)?void o(t,function(e){u(e,n)}):t.classList?void t.classList.remove(n):void(t.className.indexOf(n)>=0&&(t.className=t.className.replace(n,"")))}function d(t,n,i){if(n)return e(t.length)?void o(t,function(e){d(e,n,i)}):void(i?c(t,n):u(t,n))}function h(e){return e.replace(ee,"$1-$2").toLowerCase()}function p(e,t){return n(e[t])?e[t]:e.dataset?e.dataset[t]:e.getAttribute("data-"+h(t))}function f(e,t,i){n(i)?e[t]=i:e.dataset?e.dataset[t]=i:e.setAttribute("data-"+h(t),i)}function m(e,t){if(n(e[t]))try{delete e[t]}catch(n){e[t]=void 0}else if(e.dataset)try{delete e.dataset[t]}catch(n){e.dataset[t]=void 0}else e.removeAttribute("data-"+h(t))}function g(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=n;t.trim().split(te).forEach(function(t){if(!ne){var o=e.listeners;o&&o[t]&&o[t][n]&&(r=o[t][n],delete o[t][n],0===Object.keys(o[t]).length&&delete o[t],0===Object.keys(o).length&&delete e.listeners)}e.removeEventListener(t,r,i)})}function v(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=n;t.trim().split(te).forEach(function(t){if(i.once&&!ne){var o=e.listeners,a=void 0===o?{}:o;r=function(){for(var o=arguments.length,s=Array(o),l=0;l<o;l++)s[l]=arguments[l];delete a[t][n],e.removeEventListener(t,r,i),n.apply(e,s)},a[t]||(a[t]={}),a[t][n]&&e.removeEventListener(t,a[t][n],i),a[t][n]=r,e.listeners=a}e.addEventListener(t,r,i)})}function b(e,t,n){var i=void 0;return r(Event)&&r(CustomEvent)?i=new CustomEvent(t,{detail:n,bubbles:!0,cancelable:!0}):(i=document.createEvent("CustomEvent"),i.initCustomEvent(t,!0,!0,n)),e.dispatchEvent(i)}function y(e){var t=e.getBoundingClientRect();return{left:t.left+(window.pageXOffset-document.documentElement.clientLeft),top:t.top+(window.pageYOffset-document.documentElement.clientTop)}}function w(e){var t=e.match(re);return t&&(t[1]!==ie.protocol||t[2]!==ie.hostname||t[3]!==ie.port)}function _(e){var t="timestamp="+(new Date).getTime();return e+(-1===e.indexOf("?")?"?":"&")+t}function S(t){var n=t.rotate,i=t.scaleX,r=t.scaleY,o=t.translateX,a=t.translateY,s=[];e(o)&&0!==o&&s.push("translateX("+o+"px)"),e(a)&&0!==a&&s.push("translateY("+a+"px)"),e(n)&&0!==n&&s.push("rotate("+n+"deg)"),e(i)&&1!==i&&s.push("scaleX("+i+")"),e(r)&&1!==r&&s.push("scaleY("+r+")");var l=s.length?s.join(" "):"none";return{WebkitTransform:l,msTransform:l,transform:l}}function k(e){var t=J({},e),n=[];return o(e,function(e,i){delete t[i],o(t,function(t){var i=Math.abs(e.startX-t.startX),r=Math.abs(e.startY-t.startY),o=Math.abs(e.endX-t.endX),a=Math.abs(e.endY-t.endY),s=Math.sqrt(i*i+r*r),l=Math.sqrt(o*o+a*a),c=(l-s)/s;n.push(c)})}),n.sort(function(e,t){return Math.abs(e)<Math.abs(t)}),n[0]}function x(e,t){var n=e.pageX,i=e.pageY,r={endX:n,endY:i};return t?r:J({startX:n,startY:i},r)}function C(e){var t=0,n=0,i=0;return o(e,function(e){var r=e.startX,o=e.startY;t+=r,n+=o,i+=1}),t/=i,n/=i,{pageX:t,pageY:n}}function I(e){var t=e.aspectRatio,n=e.height,i=e.width,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"contain",o=function(e){return oe(e)&&e>0};if(o(i)&&o(n)){var a=n*t;"contain"===r&&a>i||"cover"===r&&a<i?n=i/t:i=n*t}else o(i)?n=i/t:o(n)&&(i=n*t);return{width:i,height:n}}function P(e){var t=e.width,n=e.height,i=e.degree;if(90===(i=Math.abs(i)%180))return{width:n,height:t};var r=i%90*Math.PI/180,o=Math.sin(r),a=Math.cos(r),s=t*a+n*o,l=t*o+n*a;return i>90?{width:l,height:s}:{width:s,height:l}}function T(e,t,n,i){var r=t.aspectRatio,o=t.naturalWidth,s=t.naturalHeight,l=t.rotate,c=void 0===l?0:l,u=t.scaleX,d=void 0===u?1:u,h=t.scaleY,p=void 0===h?1:h,f=n.aspectRatio,m=n.naturalWidth,g=n.naturalHeight,v=i.fillColor,b=void 0===v?"transparent":v,y=i.imageSmoothingEnabled,w=void 0===y||y,_=i.imageSmoothingQuality,S=void 0===_?"low":_,k=i.maxWidth,x=void 0===k?1/0:k,C=i.maxHeight,P=void 0===C?1/0:C,T=i.minWidth,E=void 0===T?0:T,M=i.minHeight,D=void 0===M?0:M,$=document.createElement("canvas"),B=$.getContext("2d"),A=I({aspectRatio:f,width:x,height:P}),L=I({aspectRatio:f,width:E,height:D},"cover"),O=Math.min(A.width,Math.max(L.width,m)),F=Math.min(A.height,Math.max(L.height,g)),j=I({aspectRatio:r,width:x,height:P}),R=I({aspectRatio:r,width:E,height:D},"cover"),N=Math.min(j.width,Math.max(R.width,o)),z=Math.min(j.height,Math.max(R.height,s)),U=[-N/2,-z/2,N,z];return $.width=a(O),$.height=a(F),B.fillStyle=b,B.fillRect(0,0,O,F),B.save(),B.translate(O/2,F/2),B.rotate(c*Math.PI/180),B.scale(d,p),B.imageSmoothingEnabled=w,B.imageSmoothingQuality=S,B.drawImage.apply(B,[e].concat(X(U.map(function(e){return Math.floor(a(e))})))),B.restore(),$}function E(e,t,n){var i="",r=void 0;for(n+=t,r=t;r<n;r+=1)i+=ae(e.getUint8(r));return i}function M(e){var t=e.replace(se,""),n=atob(t),i=new ArrayBuffer(n.length),r=new Uint8Array(i);return o(r,function(e,t){r[t]=n.charCodeAt(t)}),i}function D(e,t){var n=new Uint8Array(e),i="";return r(n.forEach)?n.forEach(function(e){i+=ae(e)}):o(n,function(e){i+=ae(e)}),"data:"+t+";base64,"+btoa(i)}function $(e){var t=new DataView(e),n=void 0,i=void 0,r=void 0,o=void 0;if(255===t.getUint8(0)&&216===t.getUint8(1))for(var a=t.byteLength,s=2;s<a;){if(255===t.getUint8(s)&&225===t.getUint8(s+1)){r=s;break}s+=1}if(r){var l=r+4,c=r+10;if("Exif"===E(t,l,4)){var u=t.getUint16(c);if(((i=18761===u)||19789===u)&&42===t.getUint16(c+2,i)){var d=t.getUint32(c+4,i);d>=8&&(o=c+d)}}}if(o){var h=t.getUint16(o,i),p=void 0,f=void 0;for(f=0;f<h;f+=1)if(p=o+12*f+2,274===t.getUint16(p,i)){p+=8,n=t.getUint16(p,i),t.setUint16(p,1,i);break}}return n}function B(e){var t=0,n=1,i=1;switch(e){case 2:n=-1;break;case 3:t=-180;break;case 4:i=-1;break;case 5:t=90,i=-1;break;case 6:t=90;break;case 7:t=90,n=-1;break;case 8:t=-90}return{rotate:t,scaleX:n,scaleY:i}}var A="undefined"!=typeof window,L=A?window:{},O="cropper-hidden",F=L.PointerEvent?"pointerdown":"touchstart mousedown",j=L.PointerEvent?"pointermove":"touchmove mousemove",R=L.PointerEvent?"pointerup pointercancel":"touchend touchcancel mouseup",N=/^(?:e|w|s|n|se|sw|ne|nw|all|crop|move|zoom)$/,z=/^data:/,U=/^data:image\/jpeg;base64,/,q=/^(?:img|canvas)$/i,H={viewMode:0,dragMode:"crop",initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},W=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},Y=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),X=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)},G=Number.isNaN||L.isNaN,K=Object.prototype.hasOwnProperty,J=Object.assign||function(e){for(var t=arguments.length,i=Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return n(e)&&i.length>0&&i.forEach(function(t){n(t)&&Object.keys(t).forEach(function(n){e[n]=t[n]})}),e},Q=/\.\d*(?:0|9){12}\d*$/i,Z=/^(?:width|height|left|top|marginLeft|marginTop)$/,ee=/([a-z\d])([A-Z])/g,te=/\s\s*/,ne=function(){var e=!1;if(A){var t=!1,n=function(){},i=Object.defineProperty({},"once",{get:function(){return e=!0,t},set:function(e){t=e}});L.addEventListener("test",n,i),L.removeEventListener("test",n,i)}return e}(),ie=L.location,re=/^(https?:)\/\/([^:\/?#]+):?(\d*)/i,oe=Number.isFinite||L.isFinite,ae=String.fromCharCode,se=/^data:.*,/,le={render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var e=this.element,t=this.options,n=this.container,i=this.cropper;c(i,O),u(e,O);var r={width:Math.max(n.offsetWidth,Number(t.minContainerWidth)||200),height:Math.max(n.offsetHeight,Number(t.minContainerHeight)||100)};this.containerData=r,s(i,{width:r.width,height:r.height}),c(e,O),u(i,O)},initCanvas:function(){var e=this.containerData,t=this.imageData,n=this.options.viewMode,i=Math.abs(t.rotate)%180==90,r=i?t.naturalHeight:t.naturalWidth,o=i?t.naturalWidth:t.naturalHeight,a=r/o,s=e.width,l=e.height;e.height*a>e.width?3===n?s=e.height*a:l=e.width/a:3===n?l=e.width/a:s=e.height*a;var c={aspectRatio:a,naturalWidth:r,naturalHeight:o,width:s,height:l};c.left=(e.width-s)/2,c.top=(e.height-l)/2,c.oldLeft=c.left,c.oldTop=c.top,this.canvasData=c,this.limited=1===n||2===n,this.limitCanvas(!0,!0),this.initialImageData=J({},t),this.initialCanvasData=J({},c)},limitCanvas:function(e,t){var n=this.options,i=this.containerData,r=this.canvasData,o=this.cropBoxData,a=n.viewMode,s=r.aspectRatio,l=this.cropped&&o;if(e){var c=Number(n.minCanvasWidth)||0,u=Number(n.minCanvasHeight)||0;a>1?(c=Math.max(c,i.width),u=Math.max(u,i.height),3===a&&(u*s>c?c=u*s:u=c/s)):a>0&&(c?c=Math.max(c,l?o.width:0):u?u=Math.max(u,l?o.height:0):l&&(c=o.width,u=o.height,u*s>c?c=u*s:u=c/s));var d=I({aspectRatio:s,width:c,height:u});c=d.width,u=d.height,r.minWidth=c,r.minHeight=u,r.maxWidth=1/0,r.maxHeight=1/0}if(t)if(a>(l?0:1)){var h=i.width-r.width,p=i.height-r.height;r.minLeft=Math.min(0,h),r.minTop=Math.min(0,p),r.maxLeft=Math.max(0,h),r.maxTop=Math.max(0,p),l&&this.limited&&(r.minLeft=Math.min(o.left,o.left+(o.width-r.width)),r.minTop=Math.min(o.top,o.top+(o.height-r.height)),r.maxLeft=o.left,r.maxTop=o.top,2===a&&(r.width>=i.width&&(r.minLeft=Math.min(0,h),r.maxLeft=Math.max(0,h)),r.height>=i.height&&(r.minTop=Math.min(0,p),r.maxTop=Math.max(0,p))))}else r.minLeft=-r.width,r.minTop=-r.height,r.maxLeft=i.width,r.maxTop=i.height},renderCanvas:function(e,t){var n=this.canvasData,i=this.imageData;if(t){var r=P({width:i.naturalWidth*Math.abs(i.scaleX||1),height:i.naturalHeight*Math.abs(i.scaleY||1),degree:i.rotate||0}),o=r.width,a=r.height,l=n.width*(o/n.naturalWidth),c=n.height*(a/n.naturalHeight);n.left-=(l-n.width)/2,n.top-=(c-n.height)/2,n.width=l,n.height=c,n.aspectRatio=o/a,n.naturalWidth=o,n.naturalHeight=a,this.limitCanvas(!0,!1)}(n.width>n.maxWidth||n.width<n.minWidth)&&(n.left=n.oldLeft),(n.height>n.maxHeight||n.height<n.minHeight)&&(n.top=n.oldTop),n.width=Math.min(Math.max(n.width,n.minWidth),n.maxWidth),n.height=Math.min(Math.max(n.height,n.minHeight),n.maxHeight),this.limitCanvas(!1,!0),n.left=Math.min(Math.max(n.left,n.minLeft),n.maxLeft),n.top=Math.min(Math.max(n.top,n.minTop),n.maxTop),n.oldLeft=n.left,n.oldTop=n.top,s(this.canvas,J({width:n.width,height:n.height},S({translateX:n.left,translateY:n.top}))),this.renderImage(e),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(e){var t=this.canvasData,n=this.imageData,i=n.naturalWidth*(t.width/t.naturalWidth),r=n.naturalHeight*(t.height/t.naturalHeight);J(n,{width:i,height:r,left:(t.width-i)/2,top:(t.height-r)/2}),s(this.image,J({width:n.width,height:n.height},S(J({translateX:n.left,translateY:n.top},n)))),e&&this.output()},initCropBox:function(){var e=this.options,t=this.canvasData,n=e.aspectRatio||e.initialAspectRatio,i=Number(e.autoCropArea)||.8,r={width:t.width,height:t.height};n&&(t.height*n>t.width?r.height=r.width/n:r.width=r.height*n),this.cropBoxData=r,this.limitCropBox(!0,!0),r.width=Math.min(Math.max(r.width,r.minWidth),r.maxWidth),r.height=Math.min(Math.max(r.height,r.minHeight),r.maxHeight),r.width=Math.max(r.minWidth,r.width*i),r.height=Math.max(r.minHeight,r.height*i),r.left=t.left+(t.width-r.width)/2,r.top=t.top+(t.height-r.height)/2,r.oldLeft=r.left,r.oldTop=r.top,this.initialCropBoxData=J({},r)},limitCropBox:function(e,t){var n=this.options,i=this.containerData,r=this.canvasData,o=this.cropBoxData,a=this.limited,s=n.aspectRatio;if(e){var l=Number(n.minCropBoxWidth)||0,c=Number(n.minCropBoxHeight)||0,u=a?Math.min(i.width,r.width,r.width+r.left,i.width-r.left):i.width,d=a?Math.min(i.height,r.height,r.height+r.top,i.height-r.top):i.height;l=Math.min(l,i.width),c=Math.min(c,i.height),s&&(l&&c?c*s>l?c=l/s:l=c*s:l?c=l/s:c&&(l=c*s),d*s>u?d=u/s:u=d*s),o.minWidth=Math.min(l,u),o.minHeight=Math.min(c,d),o.maxWidth=u,o.maxHeight=d}t&&(a?(o.minLeft=Math.max(0,r.left),o.minTop=Math.max(0,r.top),o.maxLeft=Math.min(i.width,r.left+r.width)-o.width,o.maxTop=Math.min(i.height,r.top+r.height)-o.height):(o.minLeft=0,o.minTop=0,o.maxLeft=i.width-o.width,o.maxTop=i.height-o.height))},renderCropBox:function(){var e=this.options,t=this.containerData,n=this.cropBoxData;(n.width>n.maxWidth||n.width<n.minWidth)&&(n.left=n.oldLeft),(n.height>n.maxHeight||n.height<n.minHeight)&&(n.top=n.oldTop),n.width=Math.min(Math.max(n.width,n.minWidth),n.maxWidth),n.height=Math.min(Math.max(n.height,n.minHeight),n.maxHeight),this.limitCropBox(!1,!0),n.left=Math.min(Math.max(n.left,n.minLeft),n.maxLeft),n.top=Math.min(Math.max(n.top,n.minTop),n.maxTop),n.oldLeft=n.left,n.oldTop=n.top,e.movable&&e.cropBoxMovable&&f(this.face,"cropperAction",n.width>=t.width&&n.height>=t.height?"move":"all"),s(this.cropBox,J({width:n.width,height:n.height},S({translateX:n.left,translateY:n.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),b(this.element,"crop",this.getData())}},ce={initPreview:function(){var e=this.crossOrigin,t=this.options.preview,n=e?this.crossOriginUrl:this.url,i=document.createElement("img");if(e&&(i.crossOrigin=e),i.src=n,this.viewBox.appendChild(i),this.viewBoxImage=i,t){var r=t;"string"==typeof t?r=this.element.ownerDocument.querySelectorAll(t):t.querySelector&&(r=[t]),this.previews=r,o(r,function(t){var i=document.createElement("img");f(t,"cropperPreview",{width:t.offsetWidth,height:t.offsetHeight,html:t.innerHTML}),e&&(i.crossOrigin=e),i.src=n,i.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',t.innerHTML="",t.appendChild(i)})}},resetPreview:function(){o(this.previews,function(e){var t=p(e,"cropperPreview");s(e,{width:t.width,height:t.height}),e.innerHTML=t.html,m(e,"cropperPreview")})},preview:function(){var e=this.imageData,t=this.canvasData,n=this.cropBoxData,i=n.width,r=n.height,a=e.width,l=e.height,c=n.left-t.left-e.left,u=n.top-t.top-e.top;this.cropped&&!this.disabled&&(s(this.viewBoxImage,J({width:a,height:l},S(J({translateX:-c,translateY:-u},e)))),o(this.previews,function(t){var n=p(t,"cropperPreview"),o=n.width,d=n.height,h=o,f=d,m=1;i&&(m=o/i,f=r*m),r&&f>d&&(m=d/r,h=i*m,f=d),s(t,{width:h,height:f}),s(t.getElementsByTagName("img")[0],J({width:a*m,height:l*m},S(J({translateX:-c*m,translateY:-u*m},e))))}))}},ue={bind:function(){var e=this.element,t=this.options,n=this.cropper;r(t.cropstart)&&v(e,"cropstart",t.cropstart),r(t.cropmove)&&v(e,"cropmove",t.cropmove),r(t.cropend)&&v(e,"cropend",t.cropend),r(t.crop)&&v(e,"crop",t.crop),r(t.zoom)&&v(e,"zoom",t.zoom),v(n,F,this.onCropStart=this.cropStart.bind(this)),t.zoomable&&t.zoomOnWheel&&v(n,"wheel mousewheel DOMMouseScroll",this.onWheel=this.wheel.bind(this)),t.toggleDragModeOnDblclick&&v(n,"dblclick",this.onDblclick=this.dblclick.bind(this)),v(e.ownerDocument,j,this.onCropMove=this.cropMove.bind(this)),v(e.ownerDocument,R,this.onCropEnd=this.cropEnd.bind(this)),t.responsive&&v(window,"resize",this.onResize=this.resize.bind(this))},unbind:function(){var e=this.element,t=this.options,n=this.cropper;r(t.cropstart)&&g(e,"cropstart",t.cropstart),r(t.cropmove)&&g(e,"cropmove",t.cropmove),r(t.cropend)&&g(e,"cropend",t.cropend),r(t.crop)&&g(e,"crop",t.crop),
r(t.zoom)&&g(e,"zoom",t.zoom),g(n,F,this.onCropStart),t.zoomable&&t.zoomOnWheel&&g(n,"wheel mousewheel DOMMouseScroll",this.onWheel),t.toggleDragModeOnDblclick&&g(n,"dblclick",this.onDblclick),g(e.ownerDocument,j,this.onCropMove),g(e.ownerDocument,R,this.onCropEnd),t.responsive&&g(window,"resize",this.onResize)}},de={resize:function(){var e=this.options,t=this.container,n=this.containerData,i=Number(e.minContainerWidth)||200,r=Number(e.minContainerHeight)||100;if(!(this.disabled||n.width<=i||n.height<=r)){var a=t.offsetWidth/n.width;if(1!==a||t.offsetHeight!==n.height){var s=void 0,l=void 0;e.restore&&(s=this.getCanvasData(),l=this.getCropBoxData()),this.render(),e.restore&&(this.setCanvasData(o(s,function(e,t){s[t]=e*a})),this.setCropBoxData(o(l,function(e,t){l[t]=e*a})))}}},dblclick:function(){this.disabled||"none"===this.options.dragMode||this.setDragMode(l(this.dragBox,"cropper-crop")?"move":"crop")},wheel:function(e){var t=this,n=Number(this.options.wheelZoomRatio)||.1,i=1;this.disabled||(e.preventDefault(),this.wheeling||(this.wheeling=!0,setTimeout(function(){t.wheeling=!1},50),e.deltaY?i=e.deltaY>0?1:-1:e.wheelDelta?i=-e.wheelDelta/120:e.detail&&(i=e.detail>0?1:-1),this.zoom(-i*n,e)))},cropStart:function(e){if(!this.disabled){var t=this.options,n=this.pointers,i=void 0;e.changedTouches?o(e.changedTouches,function(e){n[e.identifier]=x(e)}):n[e.pointerId||0]=x(e),i=Object.keys(n).length>1&&t.zoomable&&t.zoomOnTouch?"zoom":p(e.target,"cropperAction"),N.test(i)&&!1!==b(this.element,"cropstart",{originalEvent:e,action:i})&&(e.preventDefault(),this.action=i,this.cropping=!1,"crop"===i&&(this.cropping=!0,c(this.dragBox,"cropper-modal")))}},cropMove:function(e){var t=this.action;if(!this.disabled&&t){var n=this.pointers;e.preventDefault(),!1!==b(this.element,"cropmove",{originalEvent:e,action:t})&&(e.changedTouches?o(e.changedTouches,function(e){J(n[e.identifier],x(e,!0))}):J(n[e.pointerId||0],x(e,!0)),this.change(e))}},cropEnd:function(e){if(!this.disabled){var t=this.action,n=this.pointers;e.changedTouches?o(e.changedTouches,function(e){delete n[e.identifier]}):delete n[e.pointerId||0],t&&(e.preventDefault(),Object.keys(n).length||(this.action=""),this.cropping&&(this.cropping=!1,d(this.dragBox,"cropper-modal",this.cropped&&this.options.modal)),b(this.element,"cropend",{originalEvent:e,action:t}))}}},he={change:function(e){var t=this.options,n=this.canvasData,i=this.containerData,r=this.cropBoxData,a=this.pointers,s=this.action,l=t.aspectRatio,c=r.left,d=r.top,h=r.width,p=r.height,f=c+h,m=d+p,g=0,v=0,b=i.width,w=i.height,_=!0,S=void 0;!l&&e.shiftKey&&(l=h&&p?h/p:1),this.limited&&(g=r.minLeft,v=r.minTop,b=g+Math.min(i.width,n.width,n.left+n.width),w=v+Math.min(i.height,n.height,n.top+n.height));var x=a[Object.keys(a)[0]],C={x:x.endX-x.startX,y:x.endY-x.startY},I=function(e){switch(e){case"e":f+C.x>b&&(C.x=b-f);break;case"w":c+C.x<g&&(C.x=g-c);break;case"n":d+C.y<v&&(C.y=v-d);break;case"s":m+C.y>w&&(C.y=w-m)}};switch(s){case"all":c+=C.x,d+=C.y;break;case"e":if(C.x>=0&&(f>=b||l&&(d<=v||m>=w))){_=!1;break}I("e"),h+=C.x,h<0&&(s="w",h=-h,c-=h),l&&(p=h/l,d+=(r.height-p)/2);break;case"n":if(C.y<=0&&(d<=v||l&&(c<=g||f>=b))){_=!1;break}I("n"),p-=C.y,d+=C.y,p<0&&(s="s",p=-p,d-=p),l&&(h=p*l,c+=(r.width-h)/2);break;case"w":if(C.x<=0&&(c<=g||l&&(d<=v||m>=w))){_=!1;break}I("w"),h-=C.x,c+=C.x,h<0&&(s="e",h=-h,c-=h),l&&(p=h/l,d+=(r.height-p)/2);break;case"s":if(C.y>=0&&(m>=w||l&&(c<=g||f>=b))){_=!1;break}I("s"),p+=C.y,p<0&&(s="n",p=-p,d-=p),l&&(h=p*l,c+=(r.width-h)/2);break;case"ne":if(l){if(C.y<=0&&(d<=v||f>=b)){_=!1;break}I("n"),p-=C.y,d+=C.y,h=p*l}else I("n"),I("e"),C.x>=0?f<b?h+=C.x:C.y<=0&&d<=v&&(_=!1):h+=C.x,C.y<=0?d>v&&(p-=C.y,d+=C.y):(p-=C.y,d+=C.y);h<0&&p<0?(s="sw",p=-p,h=-h,d-=p,c-=h):h<0?(s="nw",h=-h,c-=h):p<0&&(s="se",p=-p,d-=p);break;case"nw":if(l){if(C.y<=0&&(d<=v||c<=g)){_=!1;break}I("n"),p-=C.y,d+=C.y,h=p*l,c+=r.width-h}else I("n"),I("w"),C.x<=0?c>g?(h-=C.x,c+=C.x):C.y<=0&&d<=v&&(_=!1):(h-=C.x,c+=C.x),C.y<=0?d>v&&(p-=C.y,d+=C.y):(p-=C.y,d+=C.y);h<0&&p<0?(s="se",p=-p,h=-h,d-=p,c-=h):h<0?(s="ne",h=-h,c-=h):p<0&&(s="sw",p=-p,d-=p);break;case"sw":if(l){if(C.x<=0&&(c<=g||m>=w)){_=!1;break}I("w"),h-=C.x,c+=C.x,p=h/l}else I("s"),I("w"),C.x<=0?c>g?(h-=C.x,c+=C.x):C.y>=0&&m>=w&&(_=!1):(h-=C.x,c+=C.x),C.y>=0?m<w&&(p+=C.y):p+=C.y;h<0&&p<0?(s="ne",p=-p,h=-h,d-=p,c-=h):h<0?(s="se",h=-h,c-=h):p<0&&(s="nw",p=-p,d-=p);break;case"se":if(l){if(C.x>=0&&(f>=b||m>=w)){_=!1;break}I("e"),h+=C.x,p=h/l}else I("s"),I("e"),C.x>=0?f<b?h+=C.x:C.y>=0&&m>=w&&(_=!1):h+=C.x,C.y>=0?m<w&&(p+=C.y):p+=C.y;h<0&&p<0?(s="nw",p=-p,h=-h,d-=p,c-=h):h<0?(s="sw",h=-h,c-=h):p<0&&(s="ne",p=-p,d-=p);break;case"move":this.move(C.x,C.y),_=!1;break;case"zoom":this.zoom(k(a),e),_=!1;break;case"crop":if(!C.x||!C.y){_=!1;break}S=y(this.cropper),c=x.startX-S.left,d=x.startY-S.top,h=r.minWidth,p=r.minHeight,C.x>0?s=C.y>0?"se":"ne":C.x<0&&(c-=h,s=C.y>0?"sw":"nw"),C.y<0&&(d-=p),this.cropped||(u(this.cropBox,O),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0))}_&&(r.width=h,r.height=p,r.left=c,r.top=d,this.action=s,this.renderCropBox()),o(a,function(e){e.startX=e.endX,e.startY=e.endY})}},pe={crop:function(){return!this.ready||this.cropped||this.disabled||(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&c(this.dragBox,"cropper-modal"),u(this.cropBox,O),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.ready&&!this.disabled&&(this.imageData=J({},this.initialImageData),this.canvasData=J({},this.initialCanvasData),this.cropBoxData=J({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&(J(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),u(this.dragBox,"cropper-modal"),c(this.cropBox,O)),this},replace:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!this.disabled&&e&&(this.isImg&&(this.element.src=e),t?(this.url=e,this.image.src=e,this.ready&&(this.viewBoxImage.src=e,o(this.previews,function(t){t.getElementsByTagName("img")[0].src=e}))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(e))),this},enable:function(){return this.ready&&this.disabled&&(this.disabled=!1,u(this.cropper,"cropper-disabled")),this},disable:function(){return this.ready&&!this.disabled&&(this.disabled=!0,c(this.cropper,"cropper-disabled")),this},destroy:function(){var e=this.element;return p(e,"cropper")?(this.isImg&&this.replaced&&(e.src=this.originalUrl),this.uncreate(),m(e,"cropper"),this):this},move:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,i=this.canvasData,r=i.left,o=i.top;return this.moveTo(t(e)?e:r+Number(e),t(n)?n:o+Number(n))},moveTo:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,i=this.canvasData,r=!1;return t=Number(t),n=Number(n),this.ready&&!this.disabled&&this.options.movable&&(e(t)&&(i.left=t,r=!0),e(n)&&(i.top=n,r=!0),r&&this.renderCanvas(!0)),this},zoom:function(e,t){var n=this.canvasData;return e=Number(e),e=e<0?1/(1-e):1+e,this.zoomTo(n.width*e/n.naturalWidth,null,t)},zoomTo:function(t,n,r){var o=this.options,a=this.canvasData,s=a.width,l=a.height,c=a.naturalWidth,u=a.naturalHeight;if((t=Number(t))>=0&&this.ready&&!this.disabled&&o.zoomable){var d=c*t,h=u*t;if(!1===b(this.element,"zoom",{ratio:t,oldRatio:s/c,originalEvent:r}))return this;if(r){var p=this.pointers,f=y(this.cropper),m=p&&Object.keys(p).length?C(p):{pageX:r.pageX,pageY:r.pageY};a.left-=(d-s)*((m.pageX-f.left-a.left)/s),a.top-=(h-l)*((m.pageY-f.top-a.top)/l)}else i(n)&&e(n.x)&&e(n.y)?(a.left-=(d-s)*((n.x-a.left)/s),a.top-=(h-l)*((n.y-a.top)/l)):(a.left-=(d-s)/2,a.top-=(h-l)/2);a.width=d,a.height=h,this.renderCanvas(!0)}return this},rotate:function(e){return this.rotateTo((this.imageData.rotate||0)+Number(e))},rotateTo:function(t){return t=Number(t),e(t)&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=t%360,this.renderCanvas(!0,!0)),this},scaleX:function(t){var n=this.imageData.scaleY;return this.scale(t,e(n)?n:1)},scaleY:function(t){var n=this.imageData.scaleX;return this.scale(e(n)?n:1,t)},scale:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,i=this.imageData,r=!1;return t=Number(t),n=Number(n),this.ready&&!this.disabled&&this.options.scalable&&(e(t)&&(i.scaleX=t,r=!0),e(n)&&(i.scaleY=n,r=!0),r&&this.renderCanvas(!0,!0)),this},getData:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.options,n=this.imageData,i=this.canvasData,r=this.cropBoxData,a=void 0;if(this.ready&&this.cropped){a={x:r.left-i.left,y:r.top-i.top,width:r.width,height:r.height};var s=n.width/n.naturalWidth;if(o(a,function(e,t){a[t]=e/s}),e){var l=Math.round(a.y+a.height),c=Math.round(a.x+a.width);a.x=Math.round(a.x),a.y=Math.round(a.y),a.width=c-a.x,a.height=l-a.y}}else a={x:0,y:0,width:0,height:0};return t.rotatable&&(a.rotate=n.rotate||0),t.scalable&&(a.scaleX=n.scaleX||1,a.scaleY=n.scaleY||1),a},setData:function(t){var n=this.options,r=this.imageData,o=this.canvasData,a={};if(this.ready&&!this.disabled&&i(t)){var s=!1;n.rotatable&&e(t.rotate)&&t.rotate!==r.rotate&&(r.rotate=t.rotate,s=!0),n.scalable&&(e(t.scaleX)&&t.scaleX!==r.scaleX&&(r.scaleX=t.scaleX,s=!0),e(t.scaleY)&&t.scaleY!==r.scaleY&&(r.scaleY=t.scaleY,s=!0)),s&&this.renderCanvas(!0,!0);var l=r.width/r.naturalWidth;e(t.x)&&(a.left=t.x*l+o.left),e(t.y)&&(a.top=t.y*l+o.top),e(t.width)&&(a.width=t.width*l),e(t.height)&&(a.height=t.height*l),this.setCropBoxData(a)}return this},getContainerData:function(){return this.ready?J({},this.containerData):{}},getImageData:function(){return this.sized?J({},this.imageData):{}},getCanvasData:function(){var e=this.canvasData,t={};return this.ready&&o(["left","top","width","height","naturalWidth","naturalHeight"],function(n){t[n]=e[n]}),t},setCanvasData:function(t){var n=this.canvasData,r=n.aspectRatio;return this.ready&&!this.disabled&&i(t)&&(e(t.left)&&(n.left=t.left),e(t.top)&&(n.top=t.top),e(t.width)?(n.width=t.width,n.height=t.width/r):e(t.height)&&(n.height=t.height,n.width=t.height*r),this.renderCanvas(!0)),this},getCropBoxData:function(){var e=this.cropBoxData,t=void 0;return this.ready&&this.cropped&&(t={left:e.left,top:e.top,width:e.width,height:e.height}),t||{}},setCropBoxData:function(t){var n=this.cropBoxData,r=this.options.aspectRatio,o=void 0,a=void 0;return this.ready&&this.cropped&&!this.disabled&&i(t)&&(e(t.left)&&(n.left=t.left),e(t.top)&&(n.top=t.top),e(t.width)&&t.width!==n.width&&(o=!0,n.width=t.width),e(t.height)&&t.height!==n.height&&(a=!0,n.height=t.height),r&&(o?n.height=n.width/r:a&&(n.width=n.height*r)),this.renderCropBox()),this},getCroppedCanvas:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var t=this.canvasData,n=T(this.image,this.imageData,t,e);if(!this.cropped)return n;var i=this.getData(),r=i.x,o=i.y,s=i.width,l=i.height,c=n.width/Math.floor(t.naturalWidth);1!==c&&(r*=c,o*=c,s*=c,l*=c);var u=s/l,d=I({aspectRatio:u,width:e.maxWidth||1/0,height:e.maxHeight||1/0}),h=I({aspectRatio:u,width:e.minWidth||0,height:e.minHeight||0},"cover"),p=I({aspectRatio:u,width:e.width||(1!==c?n.width:s),height:e.height||(1!==c?n.height:l)}),f=p.width,m=p.height;f=Math.min(d.width,Math.max(h.width,f)),m=Math.min(d.height,Math.max(h.height,m));var g=document.createElement("canvas"),v=g.getContext("2d");g.width=a(f),g.height=a(m),v.fillStyle=e.fillColor||"transparent",v.fillRect(0,0,f,m);var b=e.imageSmoothingEnabled,y=void 0===b||b,w=e.imageSmoothingQuality;v.imageSmoothingEnabled=y,w&&(v.imageSmoothingQuality=w);var _=n.width,S=n.height,k=r,x=o,C=void 0,P=void 0,E=void 0,M=void 0,D=void 0,$=void 0;k<=-s||k>_?(k=0,C=0,E=0,D=0):k<=0?(E=-k,k=0,C=Math.min(_,s+k),D=C):k<=_&&(E=0,C=Math.min(s,_-k),D=C),C<=0||x<=-l||x>S?(x=0,P=0,M=0,$=0):x<=0?(M=-x,x=0,P=Math.min(S,l+x),$=P):x<=S&&(M=0,P=Math.min(l,S-x),$=P);var B=[k,x,C,P];if(D>0&&$>0){var A=f/s;B.push(E*A,M*A,D*A,$*A)}return v.drawImage.apply(v,[n].concat(X(B.map(function(e){return Math.floor(a(e))})))),g},setAspectRatio:function(e){var n=this.options;return this.disabled||t(e)||(n.aspectRatio=Math.max(0,e)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(e){var t=this.options,n=this.dragBox,i=this.face;if(this.ready&&!this.disabled){var r="crop"===e,o=t.movable&&"move"===e;e=r||o?e:"none",t.dragMode=e,f(n,"cropperAction",e),d(n,"cropper-crop",r),d(n,"cropper-move",o),t.cropBoxMovable||(f(i,"cropperAction",e),d(i,"cropper-crop",r),d(i,"cropper-move",o))}return this}},fe=L.Cropper,me=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(W(this,e),!t||!q.test(t.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=t,this.options=J({},H,i(n)&&n),this.cropped=!1,this.disabled=!1,this.pointers={},this.ready=!1,this.reloading=!1,this.replaced=!1,this.sized=!1,this.sizing=!1,this.init()}return Y(e,[{key:"init",value:function(){var e=this.element,t=e.tagName.toLowerCase(),n=void 0;if(!p(e,"cropper")){if(f(e,"cropper",this),"img"===t){if(this.isImg=!0,n=e.getAttribute("src")||"",this.originalUrl=n,!n)return;n=e.src}else"canvas"===t&&window.HTMLCanvasElement&&(n=e.toDataURL());this.load(n)}}},{key:"load",value:function(e){var t=this;if(e){this.url=e,this.imageData={};var n=this.element,i=this.options;if(i.rotatable||i.scalable||(i.checkOrientation=!1),!i.checkOrientation||!window.ArrayBuffer)return void this.clone();if(z.test(e))return void(U.test(e)?this.read(M(e)):this.clone());var r=new XMLHttpRequest;this.reloading=!0,this.xhr=r;var o=function(){t.reloading=!1,t.xhr=null};r.ontimeout=o,r.onabort=o,r.onerror=function(){o(),t.clone()},r.onload=function(){o(),t.read(r.response)},i.checkCrossOrigin&&w(e)&&n.crossOrigin&&(e=_(e)),r.open("get",e),r.responseType="arraybuffer",r.withCredentials="use-credentials"===n.crossOrigin,r.send()}}},{key:"read",value:function(e){var t=this.options,n=this.imageData,i=$(e),r=0,o=1,a=1;if(i>1){this.url=D(e,"image/jpeg");var s=B(i);r=s.rotate,o=s.scaleX,a=s.scaleY}t.rotatable&&(n.rotate=r),t.scalable&&(n.scaleX=o,n.scaleY=a),this.clone()}},{key:"clone",value:function(){var e=this.element,t=this.url,n=void 0,i=void 0;this.options.checkCrossOrigin&&w(t)&&(n=e.crossOrigin,n?i=t:(n="anonymous",i=_(t))),this.crossOrigin=n,this.crossOriginUrl=i;var r=document.createElement("img");n&&(r.crossOrigin=n),r.src=i||t,this.image=r,r.onload=this.start.bind(this),r.onerror=this.stop.bind(this),c(r,"cropper-hide"),e.parentNode.insertBefore(r,e.nextSibling)}},{key:"start",value:function(){var e=this,t=this.isImg?this.element:this.image;t.onload=null,t.onerror=null,this.sizing=!0;var n=L.navigator&&/(Macintosh|iPhone|iPod|iPad).*AppleWebKit/i.test(L.navigator.userAgent),i=function(t,n){J(e.imageData,{naturalWidth:t,naturalHeight:n,aspectRatio:t/n}),e.sizing=!1,e.sized=!0,e.build()};if(t.naturalWidth&&!n)return void i(t.naturalWidth,t.naturalHeight);var r=document.createElement("img"),o=document.body||document.documentElement;this.sizingImage=r,r.onload=function(){i(r.width,r.height),n||o.removeChild(r)},r.src=t.src,n||(r.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",o.appendChild(r))}},{key:"stop",value:function(){var e=this.image;e.onload=null,e.onerror=null,e.parentNode.removeChild(e),this.image=null}},{key:"build",value:function(){if(this.sized&&!this.ready){var e=this.element,t=this.options,n=this.image,i=e.parentNode,o=document.createElement("div");o.innerHTML='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>';var a=o.querySelector(".cropper-container"),s=a.querySelector(".cropper-canvas"),l=a.querySelector(".cropper-drag-box"),d=a.querySelector(".cropper-crop-box"),h=d.querySelector(".cropper-face");this.container=i,this.cropper=a,this.canvas=s,this.dragBox=l,this.cropBox=d,this.viewBox=a.querySelector(".cropper-view-box"),this.face=h,s.appendChild(n),c(e,O),i.insertBefore(a,e.nextSibling),this.isImg||u(n,"cropper-hide"),this.initPreview(),this.bind(),t.initialAspectRatio=Math.max(0,t.initialAspectRatio)||NaN,t.aspectRatio=Math.max(0,t.aspectRatio)||NaN,t.viewMode=Math.max(0,Math.min(3,Math.round(t.viewMode)))||0,c(d,O),t.guides||c(d.getElementsByClassName("cropper-dashed"),O),t.center||c(d.getElementsByClassName("cropper-center"),O),t.background&&c(a,"cropper-bg"),t.highlight||c(h,"cropper-invisible"),t.cropBoxMovable&&(c(h,"cropper-move"),f(h,"cropperAction","all")),t.cropBoxResizable||(c(d.getElementsByClassName("cropper-line"),O),c(d.getElementsByClassName("cropper-point"),O)),this.render(),this.ready=!0,this.setDragMode(t.dragMode),t.autoCrop&&this.crop(),this.setData(t.data),r(t.ready)&&v(e,"ready",t.ready,{once:!0}),b(e,"ready")}}},{key:"unbuild",value:function(){this.ready&&(this.ready=!1,this.unbind(),this.resetPreview(),this.cropper.parentNode.removeChild(this.cropper),u(this.element,O))}},{key:"uncreate",value:function(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?this.xhr.abort():this.image&&this.stop()}}],[{key:"noConflict",value:function(){return window.Cropper=fe,e}},{key:"setDefaults",value:function(e){J(H,i(e)&&e)}}]),e}();return J(me.prototype,le,ce,ue,de,he,pe),me});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/sidebar/image-crop-properties.directive",["require","exports","vendor/text!ts/modules/emailbuilder/sidebar/image-crop-properties.directive.html","vendor/cropperjs/cropper","angular","../services/analytics.service"],function(e,t,n,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=__importDefault(r);var a=1,s=1,l=function(){function e(e,t,l,c,u,d,h){var p=this;this.restrict="E",this.scope={},this.template=n,this.link=function(e,t,n){var r,o,l,c=t.find(".js-crop-canvas")[0],u=function(t){if(e.showStage){var n=t.getData(!0);r.crop={x:n.x,y:n.y,width:Math.max(n.width,a),height:Math.max(n.height,s)},r.tempAspectRatio=e.selectedAspectRatio}},d=new i(c,{viewMode:1,movable:!1,rotatable:!1,scalable:!0,zoomable:!0,zoomOnTouch:!1,zoomOnWheel:!1,checkCrossOrigin:!1,checkOrientation:!1,autoCropArea:1,crop:function(t){p.$timeout(function(){e.width=Math.max(Math.round(t.detail.width),a),e.height=Math.max(Math.round(t.detail.height),s),r&&u(d)})},ready:function(){if(r){var e=p.getScalingFactor(r,d);d.scale(e,e);var t=p.getZoomAbsoluteRatio(d);d.zoomTo(t),p.$rootScope.$broadcast("imageBlock:cropperReady",r)}o&&(d.crop(),d.setData(o))},cropend:function(){o=d.getData(!0),p.$timeout(function(){u(d)})}}),h=function(){p.resizeCropContainerDimensions(t,r,d)},f=p.$rootScope.$on("imageBlock:cropStaged",function(n,i){e.showStage=!0,t.focus(),r=i,o=i.crop,r.tempPreviousCrop=r.crop,l=r.tempAspectRatio,e.width=o?o.width:r.originalWidth,e.height=o?o.height:r.originalHeight,p.$timeout(function(){p.resizeCropContainerDimensions(t,r,d)}),p.$window.resize(h);var a=function(e,t){return t?a(t,e%t):e},s=a(r.originalWidth,r.originalHeight),c=r.originalWidth/s,u=r.originalHeight/s;e.aspectRatios=[{display:"Custom",group:"Aspect ratio"},{display:c+":"+u+" (original ratio)",group:"Aspect ratio",aspectRatio:{numerator:c,denominator:u}},{display:"1:1 (square)",group:"Common ratios",aspectRatio:{numerator:1,denominator:1}},{display:"16:9",group:"Common ratios",aspectRatio:{numerator:16,denominator:9}},{display:"4:3",group:"Common ratios",aspectRatio:{numerator:4,denominator:3}},{display:"3:4",group:"Common ratios",aspectRatio:{numerator:3,denominator:4}},{display:"2:3",group:"Common ratios",aspectRatio:{numerator:2,denominator:3}}];var f=r.tempAspectRatio||e.aspectRatios[0];e.selectedAspectRatio=f;var m=f.aspectRatio?f.aspectRatio.numerator/f.aspectRatio.denominator:NaN;d.setAspectRatio(m)});e.$on("$destroy",f),e.$on("sidebar:requestClose",function(){e.showStage&&e.close()}),e.widthChanged=function(e){e&&d.setData({width:e})},e.heightChanged=function(e){e&&d.setData({height:e})},e.close=function(){e.showStage=!1,d.destroy(),p.$window.off("resize",h),p.$rootScope.$broadcast("imageBlock:closeCropStage",r),p.trackCrop(r)},e.cancel=function(){r.crop=r.tempPreviousCrop,r.tempAspectRatio=l,e.close()},e.aspectRatioChanged=function(){var t=d.getData();if(!e.selectedAspectRatio.aspectRatio)return d.setAspectRatio(NaN),void d.setData({width:t.width,height:t.height,x:t.x,y:t.y});var n=t.width*t.height,i=e.selectedAspectRatio.aspectRatio;d.setAspectRatio(i.numerator/i.denominator);var r=Math.sqrt(n*i.numerator/i.denominator),o=r*i.denominator/i.numerator,a=t.x+(t.width-r)/2,s=t.y+(t.height-o)/2;d.setData({width:r,height:o,x:a,y:s}),u(d)}},this.resizeCropContainerDimensions=function(e,t,n){p.setCropContainerDimensions(e,t),p.replaceImage(t,n)},this.setCropContainerDimensions=function(e,t){var n=p.getCropAreaDimensions(e),i=p.cropAreaCalculatorService.getCropContainerDimensions(n,t);e.find(".js-crop-container").css("width",i.width+"px"),e.find(".js-crop-container").css("height",i.height+"px")},this.getCropAreaDimensions=function(e){return{width:e.find(".js-crop-area").width(),height:e.find(".js-crop-area").height()}},this.replaceImage=function(e,t){var n=p.emailBuilderConfig.urls.imagePrefix+e.fileName;t.replace(n)},this.trackCrop=function(e){if(p.cropDetailsHaveChanged(e.crop,e.tempPreviousCrop)){var t=p.fileExtensionService.getFileExtension(e.fileName);p.analyticsService.trackClientLevel({eventName:o.AnalyticsEventName.EditedImage,publicProperties:{"Edit Type":"Crop","File Extension":t}})}},this.cropDetailsHaveChanged=function(e,t){return!r.default.equals(e,t)},this.getScalingFactor=function(e,t){var n=t.getImageData();return n.naturalWidth===e.originalWidth?1:e.originalWidth>e.originalHeight?e.originalWidth/n.naturalWidth:e.originalHeight/n.naturalHeight},this.getZoomAbsoluteRatio=function(e){var t=e.getContainerData(),n=e.getCanvasData();return n.naturalWidth>n.naturalHeight?t.width/n.naturalWidth:t.height/n.naturalHeight},this.$rootScope=e,this.emailBuilderConfig=t,this.$timeout=l,this.$window=r.default.element(c),this.cropAreaCalculatorService=u,this.fileExtensionService=d,this.analyticsService=h}return e.factory=function(t,n,i,r,o,a,s){return new e(t,n,i,r,o,a,s)},e}();t.ImageCropProperties=l}),define("vendor/text!ts/modules/emailbuilder/sidebar/section-properties.directive.html",[],function(){
return'<section class="emb-js-property-pane emb-pane sidebar--section-properties emb-reset">\r\n    <div class="sidebar--section-controls" ng-submit="close()">\r\n\r\n        <div class="c-sidebar__intro">\r\n            <h2 class="c-sidebar__heading-primary">Section settings</h2>\r\n\r\n            <div ng-show="!mode.publicCanvas && !mode.templateWithContent && canvasSectionPermissions">\r\n                <div ng-show="section.permissions.lockLevel == \'partial\' || section.permissions.lockLevel == \'partial-removable\'">\r\n                    <p class="c-sidebar__text c-sidebar__text--intro">This section allows you to edit <strong>content only</strong>.</p>\r\n                    <p class="c-sidebar__text c-sidebar__text--intro">To make changes to this sections settings and design, please contact the template creator.</p>\r\n                </div>\r\n                <div ng-show="section.permissions.lockLevel == \'full\'">\r\n                    <p class="c-sidebar__text c-sidebar__text--intro">This section is <strong>locked</strong>.</p>\r\n                    <p class="c-sidebar__text c-sidebar__text--intro">To make changes to this sections settings and design, please contact the template creator.</p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <div class="emb-customize">\r\n            <h3 id="emb-js-section-spacing" class="sidebar__heading sidebar__heading--secondary qa-section-spacing"\r\n                ng-class="{\'emb-selected\': currentLayoutSetting == \'spacing\'}"\r\n                ng-click="currentLayoutSetting = \'spacing\'"\r\n                ng-hide="!email.isBlueprint || section.hideSectionSettings">\r\n                Layout and spacing\r\n            </h3>\r\n            <div class="sidebar__accordion-item emb-accordion-item emb-js-animation-allowed"\r\n                 ng-class="{\'emb-accordion-anim\': currentLayoutSetting == \'spacing\'}"\r\n                 ng-show="currentLayoutSetting === \'spacing\' && email.isBlueprint">\r\n                <div class="emb-content-accordion-zoom">\r\n\r\n                    <form name="form-spacing-properties" novalidate="novalidate" class="sidebar__form--accordion">\r\n                        <emb-section-spacing-properties section="section" layoutspacing="true" />\r\n                    </form>\r\n\r\n                </div>\r\n            </div>\r\n            <h3 id="emb-js-section-bg" class="sidebar__heading sidebar__heading--secondary"\r\n                ng-class="{\'emb-selected\': currentLayoutSetting == \'bg\' || !currentLayoutSetting }"\r\n                ng-click="currentLayoutSetting = \'bg\'"\r\n                ng-hide="section.hideSectionSettings">\r\n                {{ email.isBlueprint ? "Background and border" : "Background" }}\r\n            </h3>\r\n            <div class="sidebar__accordion-item emb-accordion-item emb-js-animation-allowed emb-accordion-anim"\r\n                 ng-class="{\'emb-accordion-anim\': currentLayoutSetting == \'bg\' || !currentLayoutSetting }"\r\n                 ng-show="currentLayoutSetting === \'bg\' || !currentLayoutSetting">\r\n                <div class="emb-content-accordion-zoom">\r\n\r\n                    <form name="bg" novalidate="novalidate" class="sidebar__form--accordion">\r\n\r\n                        <ul role="tablist" class="l-grid l-grid--inline-block l-grid--vertical-spacing">\r\n                            <li class="l-grid__item l-grid__item--100">\r\n                                <label class="c-sidebar__label">Background color</label>\r\n                                <div class="c-colorpicker ff-colorpicker--recent c-colorpicker--light c-colorpicker--input">\r\n                                    <div cs-color-picker cs-viewport="#emb-js-sidebar" ng-model="section.style.backgroundColor"></div>\r\n                                </div>\r\n                            </li>\r\n                            <li class="l-grid__item l-grid__item--100">\r\n                                <label class="c-sidebar__label">Background image</label>\r\n                                <div layout-background-status="layoutBackgroundStatus" emb-background-layout-image-uploader background-image="section.style.backgroundLayoutImage" section="section"></div>\r\n                                <div ng-show="email.isBlueprint" cs-checkbox cs-section="section" ng-model="section.bordered" label="Show a border for this section" class="checkbox-options" emb-save-on-model-change></div>\r\n                            </li>\r\n                        </ul>\r\n                    </form>\r\n                </div>\r\n            </div>\r\n\r\n            <div ng-show="!mode.publicCanvas && !mode.isTransactional && !mode.templateWithContent">\r\n                <h3 id="emb-js-section-segments" class="sidebar__heading sidebar__heading--secondary"\r\n                    ng-class="{\'emb-selected\': currentLayoutSetting == \'segments\' }"\r\n                    ng-click="currentLayoutSetting = \'segments\'">\r\n                    Who should see this?\r\n                </h3>\r\n                <div class="sidebar__accordion-item sidebar__accordion-item--last emb-accordion-item emb-js-animation-allowed"\r\n                     ng-class="{\'emb-accordion-anim\': currentLayoutSetting == \'segments\' }"\r\n                     ng-show="currentLayoutSetting == \'segments\'">\r\n                    <div class="emb-content-accordion-zoom">\r\n\r\n                        <form name="segments" novalidate="novalidate" class="sidebar__form--accordion">\r\n                            <div>\r\n                                <header class="emb-header-pane">\r\n                                    <p class="c-sidebar__text c-sidebar__text--settings">Target this part of your email at specific recipients and we\'ll only show it to them.</p>\r\n                                </header>\r\n                                <div class="emb-content sidebar-recipients__content">\r\n                                    <emb-segments section="section"></emb-segments>\r\n                                </div>\r\n                            </div>\r\n                        </form>\r\n\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <div ng-show="mode.templateWithContent && canvasSectionPermissions">\r\n                <h3 id="emb-js-section-permissions" class="sidebar__heading sidebar__heading--secondary qa-section-content-locking"\r\n                    ng-class="{\'emb-selected\': currentLayoutSetting == \'permissions\'}"\r\n                    ng-click="currentLayoutSetting = \'permissions\'">\r\n                    Content locking\r\n                </h3>\r\n                <div class="sidebar__accordion-item emb-accordion-item emb-js-animation-allowed"\r\n                     ng-class="{\'emb-accordion-anim\': currentLayoutSetting == \'permissions\'}"\r\n                     ng-show="currentLayoutSetting === \'permissions\'">\r\n                    <div class="emb-content-accordion-zoom">\r\n                        <form name="permissions" novalidate="novalidate" class="sidebar__form--accordion">\r\n                            <ul role="tablist" class="l-grid l-grid--inline-block l-grid--vertical-spacing">\r\n                                <li class="l-grid__item l-grid__item--100">\r\n                                    <label class="c-sidebar__label">Section editing restrictions</label>\r\n                                    <div class="c-dropdown-options-container" cs-dropdown-class="c-dropdown">\r\n                                        <div cs-dropdown="lockLevels" cs-dropdown-class="l-select-container--small l-select-container--permissions"\r\n                                             ng-model="section.permissions.lockLevel" emb-save-on-model-change\r\n                                             ng-change="sectionPermissionsChanged(section)"></div>\r\n                                    </div>\r\n                                    <p ng-show="section.permissions.lockLevel !== \'none\'" class="c-sidebar__text l-gap--top-medium">To make changes to this section, select Unlock everything.</p>\r\n                                </li>\r\n                            </ul>\r\n                        </form>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n        </div>\r\n    </div>\r\n</section>\r\n'}),define("ts/modules/emailbuilder/sidebar/section-properties.directive",["require","exports","vendor/text!ts/modules/emailbuilder/sidebar/section-properties.directive.html"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t,i,r){var o=this;this.currentLayoutSetting="",this.restrict="E",this.template=n,this.link=function(e){if(e.currentLayoutSetting=o.currentLayoutSetting,e.sectionPermissionsChanged=function(e){o.lockLevelService.permissionsChanged("section-"+e.uiId,e.permissions)},e.section.subType&&(e.currentLayoutSetting=e.section.subType),o.emailBuilderConfig.canvasSectionPermissions){o.lockLevelService.getLocks(e.section.permissions).anyLocking&&(o.emailBuilderConfig.mode.templateWithContent?e.currentLayoutSetting="permissions":e.currentLayoutSetting="segments")}!0===o.$rootScope.showMissingBackgroundModal&&(e.currentLayoutSetting="bg",o.viewPortService.scrollElementToTop("#"+e.section.uiId)),e.$on("$destroy",function(){o.currentLayoutSetting=e.currentLayoutSetting})},this.$rootScope=e,this.emailBuilderConfig=t,this.lockLevelService=i,this.viewPortService=r}return e.factory=function(t,n,i,r){return new e(t,n,i,r)},e}();t.SectionProperties=i}),define("vendor/text!ts/modules/emailbuilder/sidebar/segments.directive.html",[],function(){return'<form novalidate="novalidate" ng-submit="close()" class="segments">\r\n    <ol class="checkbox-options__list">\r\n        <li>\r\n            <div ng-show="!isAutoresponder" class="checkbox-options all-subscribers">\r\n                <input id="segments-all-subscribers"\r\n                       type="checkbox"\r\n                       class="checkbox-options__input"\r\n                       ng-change="allChanged(allSelected)"\r\n                       ng-model="allSelected"\r\n                       ng-disabled="!hasMultipleListsOrSegments && !targetingDeletedOnly"\r\n                       emb-save-on-model-change />\r\n                <label class="c-sidebar__label checkbox-options__label"\r\n                       for="segments-all-subscribers">All recipients</label>\r\n            </div>\r\n        </li>\r\n    </ol>\r\n    <p ng-if="!isAutoresponder && hasMultipleListsOrSegments" class="c-sidebar__text c-sidebar__text--heading">Or, the subscribers of:</p>\r\n    <p class="emb-help" ng-if="!isAutoresponder && !hasMultipleListsOrSegments">You need to create multiple lists or segments to start targeting sections of your email.</p>\r\n    <a href="#" class="c-sidebar__link" ng-click="allSelected=!allSelected;allChanged(allSelected);$event.preventDefault();" ng-hide="(lists.length <= maxNumberOfListsToShowByDefault || !allSelected || isAutoresponder)">\r\n        {{lists.length}} lists\r\n    </a>\r\n    <ol class="checkbox-options__list" ng-if="(lists.length <= maxNumberOfListsToShowByDefault || !allSelected ) && (isAutoresponder || hasMultipleListsOrSegments)">\r\n        <li ng-repeat="list in lists">\r\n            <span class="checkbox-options">\r\n                <input type="checkbox"\r\n                       id="list-header-item-{{::$index}}"\r\n                       class="checkbox-options__input"\r\n                       ng-click="listChanged(list, $event)"\r\n                       ng-checked="list.selected"\r\n                       ng-disabled="isAutoresponder && !list.segments.length && !targetingDeletedOnly"\r\n                       />\r\n                <label class="c-sidebar__label checkbox-options__label"\r\n                       for="list-header-item-{{::$index}}">{{ ::trim(list.title) }}</label>\r\n            </span>\r\n            <ol class="checkbox-options__list" ng-if="::list.segments">\r\n                <li ng-repeat="segment in ::list.segments">\r\n                    <input id="segment-{{::$parent.$index}}-item-{{::$index}}"\r\n                           type="checkbox"\r\n                           class="checkbox-options__input"\r\n                           ng-click="segmentChanged(segment, $event)"\r\n                           ng-checked="segment.selected"\r\n                           />\r\n                    <label class="c-sidebar__label checkbox-options__label"\r\n                           for="segment-{{::$parent.$index}}-item-{{::$index}}">{{ ::trim(segment.title) }}</label>\r\n                </li>\r\n            </ol>\r\n        </li>\r\n        <p class="emb-help" ng-if="::isAutoresponder && !lists[0].segments.length">You need to create segments within this list to start targeting sections of your email.</p>\r\n    </ol>\r\n</form>'});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/sidebar/segments.directive",["require","exports","vendor/text!ts/modules/emailbuilder/sidebar/segments.directive.html","angular"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=__importDefault(i);var r=function(){function e(e,t,r,o){var a=this;this.restrict="E",this.template=n,this.scope={section:"="},this.link=function(e,t,n){e.lists=i.default.copy(a.emailBuilderConfig.listsAndSegments),e.isAutoresponder=a.emailBuilderConfig.mode.autoresponder,e.hasMultipleListsOrSegments=a.emailBuilderConfig.hasMultipleListsOrSegments,e.maxNumberOfListsToShowByDefault=a.emailBuilderConfig.settings.maxNumberOfListsToShowByDefault;var r=function(t,n){if(t.length||n.length)return!1;var i=e.section;return!(!i.lists||!i.lists.length)||!(!i.segments||!i.segments.length)},o=function(t){void 0===t&&(t=!1);var n=[],o=[];i.default.forEach(e.lists,function(e){e.selected&&n.push(e.listId),i.default.forEach(e.segments,function(e){e.selected&&o.push(e.segmentId)})}),t||(e.isAutoresponder||(e.section.lists=0===n.length?null:n),e.section.segments=0===o.length?null:o,a.emailService.setUsedDynamicContent(),a.modelActivityService.contentUpdated()),e.targetingDeletedOnly=r(n,o),e.allSelected=!(e.targetingDeletedOnly||(n.length||o.length)&&a.emailBuilderConfig.hasMultipleListsOrSegments),e.allSelectedActive=(e.allSelected||e.targetingDeletedOnly)&&e.hasMultipleListsOrSegments,e.allSelected&&(e.section.lists=null,e.section.segments=null),!e.isAutoresponder||o.length||e.targetingDeletedOnly||(e.lists[0].selected=!0)},s=function(t){i.default.forEach(e.lists,function(e){t===e.listId&&i.default.forEach(e.segments,function(e){e.selected=!1})})},l=function(t){i.default.forEach(e.lists,function(e){i.default.forEach(e.segments,function(n){t===n.segmentId&&(e.selected=!1)})})},c=function(){var t=!1;i.default.forEach(e.lists[0].segments,function(e){if(e.selected)return void(t=!0)}),t||(e.lists[0].selected=!0)},u=function(){e.lists[0].segments[0].selected=!0};e.trim=function(e){return a.textTrimService.ellipsis(e,32)},e.listChanged=function(t,n){var i=n.currentTarget;t.selected=i.checked,i.checked?s(t.listId):e.isAutoresponder&&u(),o()},e.segmentChanged=function(t,n){var i=n.currentTarget;t.selected=i.checked,i.checked?l(t.segmentId):e.isAutoresponder&&c(),o()},e.allChanged=function(t){t?(i.default.forEach(e.lists,function(e){e.selected=!1,i.default.forEach(e.segments,function(e){e.selected=!1})}),o()):e.lists&&e.lists.length?(e.lists[0].selected=!0,o()):e.allSelected=!0},e.$watch("section",function(t){t&&(i.default.forEach(e.lists,function(e){e.selected=!!t.lists&&-1!==t.lists.indexOf(e.listId),i.default.forEach(e.segments,function(e){e.selected=!!t.segments&&-1!==t.segments.indexOf(e.segmentId)})}),o(!0))})},this.emailService=e,this.textTrimService=t,this.emailBuilderConfig=r,this.modelActivityService=o}return e.factory=function(t,n,i,r){return new e(t,n,i,r)},e}();t.Segments=r}),define("vendor/text!ts/modules/emailbuilder/sidebar/sidebar.directive.html",[],function(){return'<aside id="emb-js-sidebar" class="l-sidebar emb-sidebar" ng-cloak ng-controller="SidebarController"\n    ng-click="$event.stopPropagation();">\n    <emb-general-properties></emb-general-properties>\n    <div class="emb-sidebar-anim emb-js-animation-allowed emb-secondary-sidebar emb-js-secondary-sidebar"\n        ng-class="{ \'emb-js-offscreen\' : !level2, \'emb-hovered\' : hovered || hoveredLevel2 }"\n        ng-mouseenter="hoveredLevel2 = true" ng-mouseleave="hoveredLevel2 = false">\n        <emb-footer-properties></emb-footer-properties>\n        <div ng-if="!showContent && editor === \'section\'"\n            class="c-sidebar__properties-panel-anim emb-js-animation-allowed">\n            <emb-section-properties></emb-section-properties>\n        </div>\n        <emb-image-properties></emb-image-properties>\n        <emb-survey-properties></emb-survey-properties>\n        <div ng-if="!showContent && editor === \'button\'"\n            class="c-sidebar__properties-panel-anim emb-js-animation-allowed">\n            <emb-button-properties></emb-button-properties>\n        </div>\n        <div ng-if="!showContent && editor === \'video\'"\n            class="c-sidebar__properties-panel-anim emb-js-animation-allowed">\n            <emb-video-properties></emb-video-properties>\n        </div>\n        <emb-code-properties></emb-code-properties>\n        <emb-countdown-properties></emb-countdown-properties>\n    </div>\n    <div>\n        <emb-image-crop-properties></emb-image-crop-properties>\n    </div>\n</aside>'}),define("ts/modules/emailbuilder/sidebar/sidebar.directive",["require","exports","vendor/text!ts/modules/emailbuilder/sidebar/sidebar.directive.html"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this.restrict="E",this.template=n}return e.factory=function(){return new e},e}();t.Sidebar=i}),define("ts/modules/emailbuilder/sidebar/sidebar.animation",["require","exports","vendor/jquery.easing"],function(e,t){"use strict";function n(e,t,n){if("emb-js-offscreen"===t){var i=e.hasClass("emb-js-secondary-sidebar")?20:10,r=e.width()-i;e.stop().animate({left:0-r},void 0,function(){n(),e.addClass("emb-closed")})}else if("emb-hovered"===t&&e.hasClass("emb-closed")){var o=e.hasClass("emb-js-secondary-sidebar")?36:26,a=e.width()-o;e.stop().animate({left:0-a},200,"easeOutQuad",function(){n()})}else n()}function i(e,t,n){if("emb-js-offscreen"===t)e.removeClass("emb-closed"),e.stop().animate({left:0},void 0,n);else if("emb-hovered"===t&&e.hasClass("emb-closed")){var i=e.hasClass("emb-js-secondary-sidebar")?20:10,r=e.width()-i;e.stop().animate({left:0-r},200,"easeOutQuad",function(){n()})}else n()}function r(){return{addClass:n,removeClass:i}}Object.defineProperty(t,"__esModule",{value:!0}),t.SidebarAnimation=r}),define("vendor/text!ts/modules/emailbuilder/sidebar/sidebar-settings.directive.html",[],function(){
return'<div class="c-sidebar__settings qa-customize-sidebar">\n    <div class="c-sidebar__intro">\n        <h2 class="c-sidebar__heading-primary">Settings</h2>\n    </div>\n\n    <div ng-if="standardClientHasEditingPermissions">\n        <emb-header-settings></emb-header-settings>\n    </div>\n    <div ng-if="!standardClientHasEditingPermissions">\n\n        <h2 class="c-sidebar__heading"\n            ng-class="{\'emb-selected\': currentCustomize == \'header\'}"\n            ng-click="currentCustomize = \'header\'">\n            Logo\n            <span class="l-sidebar__selector emb-header-selector" ng-show="currentCustomize == \'header\'" ng-click="setHeaderActive();" ng-model="email.header.displayType" emb-select-group emb-save-on-model-change>\n                <a id="emb-js-header-image" data-value="image" class="emb-option">Image</a>\n                <a id="emb-js-header-text" data-value="text" class="emb-option">Text</a>\n                <a id="emb-js-header-none" data-value="none" class="emb-option">None</a>\n            </span>\n        </h2>\n        <div class="hmb-image-sidebar emb-sidebar-accordion-header"\n            ng-if="currentCustomize == \'header\'"\n            ng-hide="hideHeaderSettings && email.header.displayType === \'none\'">\n            <form name="logo" novalidate="novalidate" ng-hide="email.header.displayType === \'none\'" class="c-sidebar__form form--logo" ng-class="{ \'is-disabled\' : email.header.displayType === \'none\'}">\n                <ul role="tablist" class="l-grid l-grid--inline-block l-grid--vertical-spacing">\n                    <li class="l-grid__item l-grid__item--100" ng-if="showHeaderImageSlider()">\n                        <div class="c-slider">\n                            <label class="c-sidebar__label">Size</label>\n                            <div class="c-sidebar__label c-sidebar__label--slider">\n                                <div emb-image-dimensions="email.header.width" emb-image-dimensions-slave="email.header.height" emb-image-dimensions-numerator="email.header.originalHeight" emb-image-dimensions-denominator="email.header.originalWidth"></div>\n                            </div>\n                            <div cs-slider="email.header.width" cs-slider-min="10" cs-slider-max="maxLogoWidth" ng-model="email.header.width"></div>\n                        </div>\n                    </li>\n                    <li class="l-grid__item l-grid__item--50">\n                        \x3c!-- ng-show="configurableAlignment" --\x3e\n                        <div class="l-grid l-grid--gutter">\n                            <div class="l-grid__item l-grid__item--100">\n                                <cm-segmented-control\n                                    group-name="logo-alignment"\n                                    group-legend="Alignment"\n                                    group-class-name="c-segmented-control--alignment"\n                                    ng-model="email.header.halign"\n                                    emb-save-on-model-change>\n                                    <cm-segmented-control-item\n                                        item-name="Left"\n                                        item-value="left"\n                                        segment-id="logo-left"\n                                        class-names="c-segmented-control--alignment-left"\n                                        is-default>\n                                    </cm-segmented-control-item>\n                                    <cm-segmented-control-item\n                                        item-name="Center"\n                                        item-value="center"\n                                        segment-id="logo-center"\n                                        class-names="c-segmented-control--alignment-center">\n                                    </cm-segmented-control-item>\n                                    <cm-segmented-control-item\n                                        item-name="Right"\n                                        item-value="right"\n                                        segment-id="logo-right"\n                                        class-names="c-segmented-control--alignment-right">\n                                    </cm-segmented-control-item>\n                                </cm-segmented-control>\n                            </div>\n                        </div>\n                    </li>\n                    <li class="l-grid__item l-grid__item--100" ng-if="email.header.displayType !== \'none\'">\n                        <label class="c-sidebar__label" for="logo-link">Link <span class="c-sidebar__label--optional">(optional)</span></label>\n                        <input class="c-input" id="logo-link" emb-sync-href="email.header" ng-model="email.header.tempHref" cs-valid-url name="href" type="text" placeholder="http://" emb-save-on-blur ng-keypress="handleEnter($event)" />\n                    </li>\n                    <li class="l-grid__item l-grid__item--100" ng-if="email.header.displayType == \'text\'">\n                        <label class="c-sidebar__label">Color and font</label>\n                        <div class="c-colorpicker ff-colorpicker--recent c-colorpicker--light c-colorpicker--select">\n                            <div cs-color-picker="email.config.defaultStyles.logo.color" cs-viewport="#emb-js-sidebar" ng-model="email.styles.logo.color" emb-update-style></div>\n                            <div cs-dropdown-class="l-select-container--font-family" cs-dropdown="availablefonts" ng-model="email.styles.logo.fontFamily" emb-update-style emb-save-on-model-change></div>\n                        </div>\n                    </li>\n                    <li ng-if="email.header.displayType === \'image\' && !hasHeaderImageSrc()" class="l-grid__item l-grid__item--100">\n                        <label class="c-sidebar__label" for="sidebar-image-chooser">Image</label>\n                        <span class="emb-upload-img-text hmb-fake-input-box c-image-controls__uploaded-image hmb-uploaded-image is-empty">\n                            <span id="emb-js-message"></span>\n                            <input ng-click="setHeaderActive();" emb-file-upload file="email.header" class="emb-invisible-input" name="file" type="file" id="sidebar-image-chooser" accepts="image/*">\n                            <a class="c-button c-button--choose-file">\n                                Choose file\n                            </a>\n                            <span ng-show="showProgress" class="loading-circle">\n                                <span class="loading-circle__spinner"></span>\n                            </span>\n                        </span>\n                    </li>\n                    <li class="l-grid__item l-grid__item--100" ng-if="email.header.displayType === \'image\' && hasHeaderImageSrc()">\n                        <label class="c-sidebar__label" for="logo-alt-text">Alt text <span class="c-sidebar__label--optional">(shown when images are turned off)</span></label>\n                        <input class="c-input" id="logo-alt-text" name="alt" ng-model="email.header.alt" type="text" emb-save-on-blur ng-keypress="handleEnter($event)" />\n                    </li>\n                </ul>\n            </form>\n            <form ng-if="email.isBlueprint" ng-show="email.header.displayType !== \'none\'" class="c-sidebar__form" ng-class="{ \'is-disabled\' : email.header.displayType === \'none\'}">\n                <hr class="c-sidebar__rule">\n                <ul class="checkbox-options__list c-sidebar__form-list">\n                    <li>\n                        <div class="checkbox-options" id="emb-js-logo-padding" cs-checkbox ng-model="email.header.hasHorizontalLogoPadding" label="Add horizontal spacing" emb-save-on-model-change></div>\n                    </li>\n                </ul>\n            </form>\n            <form ng-hide="email.header.displayType === \'none\'" class="c-sidebar__form" ng-class="{ \'is-disabled\' : email.header.displayType === \'none\'}">\n\n                <hr class="c-sidebar__rule">\n\n                <ul role="tablist" class="l-grid l-grid--inline-block l-grid--vertical-spacing">\n                    <li class="l-grid__item l-grid__item--100">\n                        <div class="c-slider">\n                            <label class="c-sidebar__label">Top spacing</label>\n                            <div class="c-sidebar__label c-sidebar__label--slider">{{email.header.paddingTop}}</div>\n                            <div cs-slider="email.header.paddingTop" cs-slider-min="0" cs-slider-max="maxLogoVerticalPadding" ng-model="email.header.paddingTop"></div>\n                        </div>\n                    </li>\n                    <li class="l-grid__item l-grid__item--100">\n                        <div class="c-slider">\n                            <label class="c-sidebar__label">Bottom spacing</label>\n                            <div class="c-sidebar__label c-sidebar__label--slider">{{email.header.paddingBottom}}</div>\n                            <div cs-slider="email.header.paddingBottom" cs-slider-min="0" cs-slider-max="maxLogoVerticalPadding" ng-model="email.header.paddingBottom"></div>\n                        </div>\n                    </li>\n                </ul>\n            </form>\n            <form name="webversion" novalidate="novalidate" ng-if="(template.optionalTexts.preheader || template.shareOptions.webversion) && !inboxPreviewTextEnabled" class="c-sidebar__form form--webversion"\n            ng-hide="hideHeaderSettings">\n                <hr class="c-sidebar__rule c-sidebar__rule--no-margin" ng-hide="email.header.displayType === \'none\'">\n                <ul class="checkbox-options__list l-grid l-grid--inline-block">\n                    <li class="l-grid__item l-grid__item--100" ng-if="template.shareOptions.webversion">\n                        \x3c!-- link "No Images? Click here" i.e. go to web version --\x3e\n                        <div class="checkbox-options" id="emb-js-share-webversion" cs-checkbox ng-model="email.social.webversion.on" label="{{template.shareOptions.webversion}}" emb-save-on-model-change></div>\n                    </li>\n                    <li class="l-grid__item l-grid__item--100" ng-if="template.optionalTexts.preheader">\n                        \x3c!-- pre-header i.e. email summary --\x3e\n                        <div class="checkbox-options" id="emb-js-optional-preheader" cs-reverse-checkbox ng-model="email.editableText.preheader.isDisabled"\n                            reverse-checkbox="true" label="{{template.optionalTexts.preheader}}" emb-save-on-model-change></div>\n                    </li>\n                </ul>\n            </form>\n        </div>\n\n        <h2 class="c-sidebar__heading">\n            Colors and fonts\n        </h2>\n        <form class="c-sidebar__form" name="colorsAndFonts" novalidate="novalidate">\n            <ul role="tablist" class="l-grid l-grid--inline-block l-grid--vertical-spacing emb-colorpicker-parent">\n                <li class="l-grid__item l-grid__item--100">\n                    <label class="c-sidebar__label">Heading 1</label>\n                    <div class="c-colorpicker ff-colorpicker--recent c-colorpicker--light c-colorpicker--select">\n                        <div cs-color-picker="email.config.defaultStyles.h1.color" cs-viewport="#emb-js-sidebar" ng-model="email.styles.h1.color" emb-update-style></div>\n                        <div ng-model="email.styles.h1.fontSize" class="l-combined-select-container l-combined-select-container--font-size" cs-dropdown-class="l-select-container--font-size" cs-dropdown="email.config.availableFontSizes" cs-child emb-update-style emb-save-on-model-change></div>\n                        <div class="l-combined-select-container" cs-dropdown-class="l-select-container--font-family" cs-dropdown="availablefonts" cs-child ng-model="email.styles.h1.fontFamily" emb-update-style emb-save-on-model-change></div>\n                    </div>\n                </li>\n                <li class="l-grid__item l-grid__item--100">\n                    <label class="c-sidebar__label">Heading 2</label>\n                    <div class="c-colorpicker ff-colorpicker--recent c-colorpicker--light c-colorpicker--select">\n                        <div cs-color-picker="email.config.defaultStyles.h2.color" cs-viewport="#emb-js-sidebar" ng-model="email.styles.h2.color" emb-update-style></div>\n                        <div ng-model="email.styles.h2.fontSize" class="l-combined-select-container l-combined-select-container--font-size" cs-dropdown-class="l-select-container--font-size" cs-dropdown="email.config.availableFontSizes" cs-child emb-update-style emb-save-on-model-change></div>\n                        <div class="l-combined-select-container" cs-dropdown-class="l-select-container--font-family" cs-dropdown="availablefonts" cs-child ng-model="email.styles.h2.fontFamily" emb-update-style emb-save-on-model-change></div>\n                    </div>\n                </li>\n                <li class="l-grid__item l-grid__item--100">\n                    <label class="c-sidebar__label">Heading 3</label>\n                    <div class="c-colorpicker ff-colorpicker--recent c-colorpicker--light c-colorpicker--select">\n                        <div cs-color-picker="email.config.defaultStyles.h3.color" cs-viewport="#emb-js-sidebar" ng-model="email.styles.h3.color" emb-update-style></div>\n                        <div ng-model="email.styles.h3.fontSize" class="l-combined-select-container l-combined-select-container--font-size" cs-dropdown-class="l-select-container--font-size" cs-dropdown="email.config.availableFontSizes" cs-child emb-update-style emb-save-on-model-change></div>\n                        <div class="l-combined-select-container" cs-dropdown-class="l-select-container--font-family" cs-dropdown="availablefonts" cs-child ng-model="email.styles.h3.fontFamily" emb-update-style emb-save-on-model-change></div>\n                    </div>\n                </li>\n                <li class="l-grid__item l-grid__item--100">\n                    <label class="c-sidebar__label">Normal text</label>\n                    <div class="c-colorpicker ff-colorpicker--recent c-colorpicker--light c-colorpicker--select">\n                        <div cs-color-picker="email.config.defaultStyles.p.color" cs-viewport="#emb-js-sidebar" cs-child ng-model="email.styles.p.color" emb-update-style></div>\n                        <div ng-model="email.styles.p.fontSize" class="l-combined-select-container l-combined-select-container--font-size" cs-dropdown-class="l-select-container--font-size" cs-dropdown="email.config.availableFontSizes" cs-child emb-update-style emb-save-on-model-change></div>\n                        <div class="l-combined-select-container" cs-dropdown-class="l-select-container--font-family" cs-dropdown="availablefonts" cs-child ng-model="email.styles.p.fontFamily" emb-update-style emb-save-on-model-change></div>\n                    </div>\n                </li>\n                <li class="l-grid__item l-grid__item--100">\n                    <label class="c-sidebar__label">Header &amp; footer text</label>\n                    <div class="c-colorpicker ff-colorpicker--recent c-colorpicker--light c-colorpicker--select">\n                        <div cs-color-picker="email.config.defaultStyles.headerAndFooter.color" cs-viewport="#emb-js-sidebar" cs-child ng-model="email.styles.headerAndFooter.color" emb-update-style></div>\n                        <div cs-dropdown-class="l-select-container--font-family" cs-dropdown="availablefonts" cs-child ng-model="email.styles.headerAndFooter.fontFamily" emb-update-style emb-save-on-model-change></div>\n                    </div>\n                </li>\n                <li class="l-grid__item l-grid__item--100">\n                    <div class="l-grid l-grid--gutter l-grid--vertical-spacing">\n                        <div class="l-grid__item l-grid__item--100">\n                            <label class="c-sidebar__label">Button color</label>\n                            <div class="c-colorpicker ff-colorpicker--recent c-colorpicker--light c-colorpicker--input">\n                                <div cs-color-picker="email.config.defaultStyles.button.backgroundColor" cs-viewport="#emb-js-sidebar" ng-model="email.styles.button.backgroundColor" emb-update-style></div>\n                            </div>\n                        </div>\n                        <div class="l-grid__item l-grid__item--100">\n                            <label class="c-sidebar__label">Link color</label>\n                            <div class="c-colorpicker ff-colorpicker--recent c-colorpicker--light c-colorpicker--input">\n                                <div cs-color-picker="email.config.defaultStyles.link.color" cs-viewport="#emb-js-sidebar" ng-model="email.styles.link.color" emb-update-style></div>\n                            </div>\n                        </div>\n                    </div>\n                </li>\n                <li class="l-grid__item l-grid__item--100">\n                    <div class="l-grid l-grid--gutter l-grid--vertical-spacing">\n                        <div class="l-grid__item l-grid__item--100">\n                            <label class="c-sidebar__label">Button text</label>\n                            <div class="c-colorpicker ff-colorpicker--recent c-colorpicker--light c-colorpicker--input">\n                                <div cs-color-picker="email.config.defaultStyles.button.color" cs-viewport="#emb-js-sidebar" ng-model="email.styles.button.color" emb-update-style></div>\n                            </div>\n                        </div>\n                        <div class="l-grid__item l-grid__item--100">\n                            <label class="c-sidebar__label">Background color</label>\n                            <div class="c-colorpicker ff-colorpicker--recent c-colorpicker--light c-colorpicker--input">\n                                <div cs-color-picker="email.config.defaultStyles.body.backgroundColor" cs-viewport="#emb-js-sidebar" ng-model="email.styles.body.backgroundColor" emb-update-style="body, .wrapper, .emb-editor-canvas" emb-update-style-color-functions="[{ lessFunction: \'darken\', cssProperty: \'background-color\', cssSelector: \'.divider\' }, { lessFunction: \'mix\', cssProperty: \'background-color\', cssSelector: \'.footer__right a\' }, { lessFunction: \'darken\', cssProperty: \'border-left-color\', cssSelector: \'.emb-text-editor blockquote\' }]"></div>\n                            </div>\n                        </div>\n                    </div>\n                </li>\n                <li class="l-grid__item l-grid__item--100" ng-show="mode.emailBackgroundImageFeature">\n                    <label class="c-sidebar__label">Background image</label>\n                    <div class="hmb-background-upload hmb-background-upload--customize" emb-background-email-image-uploader email-background-status="emailBackgroundStatus" background-image="email.styles.body.backgroundLayoutImage" ng-model="email.styles.body.backgroundLayoutImage.href" emb-update-style emb-save-on-model-change></div>\n                </li>\n\n                <li class="l-grid__item l-grid__item--100" ng-if="::email.isBlueprint">\n                    <label class="c-sidebar__label">Section background</label>\n                    <div class="c-colorpicker ff-colorpicker--recent c-colorpicker--light c-colorpicker--input">\n                        <div cs-color-picker="email.config.defaultStyles.section.backgroundColor"\n                            cs-viewport="#emb-js-sidebar" ng-model="email.styles.section.backgroundColor" emb-update-style></div>\n                    </div>\n                </li>\n            </ul>\n        </form>\n\n        <h2 class="c-sidebar__heading">\n            Section spacing\n        </h2>\n        <form class="c-sidebar__form" name="spacing" novalidate="novalidate">\n            <ul role="tablist" class="l-grid l-grid--inline-block l-grid--vertical-spacing">\n                <li class="l-grid__item l-grid__item--100">\n                    <div class="c-slider">\n                        <label class="c-sidebar__label">Vertical spacing</label>\n                        <div class="c-sidebar__label c-sidebar__label--slider">\n                            <div>{{email.spacing.verticalSpacing === 0 ? "None" : email.spacing.verticalSpacing === 1 ? "Medium" : "Large" }}</div>\n                        </div>\n                        <div cs-slider="email.spacing.verticalSpacing" cs-slider-value="email.spacing.verticalSpacing" cs-slider-min="0" cs-slider-max="2" ng-model="email.spacing.verticalSpacing" data-steps="3"></div>\n                    </div>\n                </li>\n            </ul>\n        </form>\n\n        <emb-header-settings></emb-header-settings>\n\n        <h2 class="c-sidebar__heading">\n            Language\n        </h2>\n        <form name="general" novalidate="novalidate" class="c-sidebar__form">\n            <ul role="tablist" class="l-grid l-grid--inline-block l-grid--vertical-spacing">\n                <li class="l-grid__item l-grid__item--100">\n                    <label class="c-sidebar__label">Global email language</label>\n                    <div cs-dropdown="languages" ng-model="email.language" ng-change="onLanguageModelChanged()" emb-save-on-model-change></div>\n                </li>\n            </ul>\n        </form>\n    </div>\n</div>'}),define("ts/modules/emailbuilder/sidebar/sidebar-settings.directive",["require","exports","vendor/text!ts/modules/emailbuilder/sidebar/sidebar-settings.directive.html","../services/analytics.service"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={BrazilianPortuguese:"Brazilian Portuguese",SimplifiedChinese:"Simplified Chinese",TraditionalChinese:"Traditional Chinese","English (UK)":"English UK"},o=function(){function e(e,t,o,a){var s=this;this.lastUsedLanguage="",this.watchingForSidebarClose=!1,this.sidebarSettingsPaneName="customize",this.restrict="E",this.template=n,this.link=function(e,t,n){e.availablefonts=s.emailBuilderConfig.fonts,e.inboxPreviewTextEnabled=s.emailBuilderConfig.email.isBlueprint,e.maxLogoVerticalPadding=100,e.template=s.emailBuilderConfig.template,e.setHeaderActive=function(){s.$rootScope.$emit("content:activate",{block:e.email.header})},e.showHeaderImageSlider=function(){return"image"===e.email.header.displayType&&s.contentBlockService.hasBlockSrc(e.email.header)&&e.email.header.originalWidth>10},e.hasHeaderImageSrc=function(){return s.contentBlockService.hasBlockSrc(e.email.header)},s.$rootScope.$on("currentPane.switched",function(e,t){t===s.sidebarSettingsPaneName&&(s.lastUsedLanguage=s.emailBuilderConfig.email.language)}),e.onLanguageModelChanged=function(){if(!s.watchingForSidebarClose){var e=s.$rootScope.$on("sidebar:requestClose",function(){var t=s.emailBuilderConfig.email.language;if(s.lastUsedLanguage!==t){t in r&&(t=r[t]);var n={Language:t};s.analyticsService.trackClientLevel({eventName:i.AnalyticsEventName.UpdatedLanguage,publicProperties:n}),s.lastUsedLanguage=s.emailBuilderConfig.email.language}e(),s.watchingForSidebarClose=!1});s.watchingForSidebarClose=!0}}},this.$rootScope=e,this.contentBlockService=t,this.emailBuilderConfig=o,this.analyticsService=a}return e.factory=function(t,n,i,r){return new e(t,n,i,r)},e}();t.SidebarSettings=o});var __assign=this&&this.__assign||function(){return __assign=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},__assign.apply(this,arguments)},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/sidebar/thumbnail.service",["require","exports","angular"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=__importDefault(n);var i=function(){function e(e,t){var i=this;this.create=function(e){var t,n,r={position:"relative"};if("video"===e.image.type)t=e.image.originalWidth,n=e.image.originalHeight;else{var o=i.emailBuilderConfig.email.isBlueprint&&e.image.crop;t=o?e.image.crop.width:e.image.originalWidth,n=o?e.image.crop.height:e.image.originalHeight}if(!(t<e.width||n<e.height)){e.container.css({overflow:"hidden",padding:"0px"});var a=i.getProportion(t,n,e.width,e.height);r=__assign(__assign({},r),i.resize(t,n,e.width,e.height,e.direction,a))}i.showImage(e,r)},this.showImage=function(e,t){var r=n.default.element("<img />");r.hide();var o=e.image.thirdPartyUrl&&e.image.src?e.image.src:i.contentBlockService.getBlockSrc(e.image),a=/\?w=[0-9]*$/,s=/\?h=[0-9]*$/;o&&(null!==o.match(a)?o=o.replace(a,"?w="+Math.floor(t.width)):null!==o.match(s)&&(o=o.replace(s,"?h="+Math.floor(t.height))),r.attr({src:o}),r.css(__assign({},t)),setTimeout(function(){e.container.empty().append(r),r.show()},50))},this.getProportion=function(e,t,n,i){var r=n/e;return i/t>r&&(r=i/t),r},this.resize=function(e,t,n,i,r,o){var a=e*o,s=t*o,l=0,c=0;switch(r.v){case"center":l=(i-s)/2;break;case"bottom":l=i-s}switch(r.h){case"center":c=(n-a)/2;break;case"right":c=n-a}return{width:a,height:s,top:l,left:c}},this.contentBlockService=e,this.emailBuilderConfig=t}return e}();t.ThumbnailService=i}),define("ts/modules/emailbuilder/sidebar/sidebar.controller",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n,i){function r(r){var o,a,s={address:"companyDetails",permission:"otherSettings"};if(o=r.editableTextKey&&("address"===r.editableTextKey||"permission"===r.editableTextKey),a=r.editableTextKey&&"preheader"===r.editableTextKey||"webversion"===r.editableTextKey||"header"===r.type,r.hasSidebarEditor)e.showContent=!1,e.editor=r.type;else switch(r.type){case"footer":e.showContent=!1,e.editor=r.type,e.currentFooterSetting=r.subType,e.currentFooterSetting||(e.currentFooterSetting="companyDetails");n.getLocks(e.email.footer.permissions).anyLocking&&(i.mode.templateWithContent?e.currentFooterSetting="permissions":e.currentFooterSetting=""),t.$emit("sidebar:footerPropertiesOpened");break;case"header":e.showContent=!0,i.mode.templateWithContent&&i.canvasSectionPermissions&&"preheader"===r.subType?e.currentPane="customize":(r.displayType||"logo"===r.subType)&&(e.currentPane="customize",e.currentCustomize="header");break;case"floating":o&&(e.showContent=!1,e.editor="footer",e.currentFooterSetting=s[r.editableTextKey],t.$emit("sidebar:footerPropertiesOpened")),a&&i.mode.customisable&&(e.showContent=!0,e.currentPane="customize",e.currentCustomize="header");break;case"section":e.editor="section",e.showContent=!1,e.section=r;break;default:e.showContent=!0}"customize"===e.currentPane&&t.$emit("content:email-background-activated",{email:e.email})}function o(e){return!e.active.content.href}function a(){var t=e.contentFormSurvey,n=[];if(e.active.content&&"survey"===e.active.content.type){t.surveyBtnTxt.$error.required&&!o(e)&&n.push("surveyNoText"),o(e)&&!t.surveyBtnTxt.$error.required&&n.push("surveyNoLink"),t.surveyBtnTxt.$error.required&&o(e)&&n.push("surveyNoLinkNoText");var i=e.active.content;i.tempValidation=n,i.tempIsValid=!n.length}}function s(n){e.showContent=!0,e.currentPane=n,t.$broadcast("sidebar:requestClose")}e.showContent=!0,e.hovered=!1,e.currentPane="content-tiles",e.currentCustomize="header",e.level2=!0,e.level3=!0,e.close=function(){e.level2?t.$emit("content:deactivate"):t.$broadcast("sidebar:requestClose")},e.switchPanes=function(e){t.$emit("content:deactivate",e)},e.handleEnter=function(e){13===e.which&&($(e.target).blur(),e.preventDefault())},e.$watch("currentPane",function(e){t.$broadcast("currentPane.switched",e)}),t.$on("content:deactivated",function(t,n){s(n.tab||e.currentPane)}),t.$on("content:activated",function(e,n){t.$broadcast("sidebar:requestClose"),r(n.block),a()});var l=t.$on("imageBlock:cropStaged",function(){e.level2=!1});e.$on("$destroy",l);var c=t.$on("imageBlock:closeCropStage",function(t,n){e.level2=!0});e.$on("$destroy",c),e.$watch(function(){return e.active&&e.active.content&&"survey"===e.active.content.type&&e.active.content.href},a),t.$on("content.add",function(t,n){if("survey"===n.type){e.contentFormSurvey.$setPristine()}})}return e}();t.SidebarController=n}),define("vendor/text!ts/modules/emailbuilder/sidebar/countdown-properties.directive.html",[],function(){return'<section\n    class="emb-js-property-pane emb-pane emb-countdown-properties emb-js-animation-allowed emb-reset"\n    ng-if="!showContent && editor === \'countdown\'"\n>\n    <form name="contentExpiryDateForm">\n        <div class="c-sidebar__intro">\n            <h2 class="c-sidebar__heading-primary">Edit countdown</h2>\n        </div>\n        <div class="sidebar__accordion-item">\n            <div class="sidebar__form--accordion">\n                <ul role="tablist" class="l-grid l-grid--inline-block">\n                    <li class="l-grid__item l-grid__item--100">\n                        <emb-countdown-properties-expiry-date />\n                    </li>\n                    <li class="l-grid__item l-grid__item--100">\n                        <div class="l-grid">\n                            <div class="l-grid__item l-grid__item--100">\n                                <p class="c-sidebar__text l-gap--top-medium">\n                                    In {{companyName}}\'s time zone {{timeZone}}. <a href="/help-doc/campus-countdown-timers" target="_blank" rel="noopener" title="Learn More">Learn More</a>\n                                </p>\n                            </div>\n                        </div>\n                    </li>\n                </ul>\n            </div>\n        </div>\n        <footer class="hmb-dismiss-container">\n            <input type="submit" value="Done editing" class="c-button c-button--primary c-button--large" ng-click="close()" />\n        </footer>\n    </form>\n</section>\n'}),define("ts/modules/emailbuilder/sidebar/countdown-properties.directive",["require","exports","vendor/text!ts/modules/emailbuilder/sidebar/countdown-properties.directive.html"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){var t=this;this.template=n,this.link=function(e){e.timeZone=t.emailBuilderConfig.timeZone,e.companyName=t.emailBuilderConfig.companyName},this.emailBuilderConfig=e}return e.factory=function(t){return new e(t)},e}();t.CountdownProperties=i}),define("vendor/text!ts/modules/emailbuilder/sidebar/countdown-properties-expiry-date.directive.html",[],function(){return'<div class="l-grid l-grid--gutter l-grid--vertical-spacing">\n    <div class="l-grid__item l-grid__item--100">\n        <label class="c-sidebar__label" for="expiryDate">End date</label>\n        <input type="text" id="expiryDate" name="expiryDate" ng-model="viewDate" class="c-input c-input--date ng-dirty" required="required"  ng-blur="save()" emb-save-on-model-change />\n    </div>\n    <div class="l-grid__item l-grid__item--100">\n        <label class="c-sidebar__label" for="expiryTime">End time</label>\n        <input type="time" id="expiryTime" name="expiryTime" ng-model="viewTime" class="c-input c-input--time ng-dirty" required="required"  ng-blur="save()" emb-save-on-model-change ng-model-options="{ timeSecondsFormat: \'\' }" ng-keyup="handleSingleDigitHour()" placeholder="HH:MM" />\n    </div>\n</div>\n'}),function(e,t){"use strict";var n;if("object"==typeof exports){try{n=require("moment")}catch(e){}module.exports=t(n)}else"function"==typeof define&&define.amd?define("pikaday",["require"],function(e){try{n=e("moment")}catch(e){}return t(n)}):e.Pikaday=t(e.moment)}(this,function(e){"use strict"
;var t="function"==typeof e,n=!!window.addEventListener,i=window.document,r=window.setTimeout,o=function(e,t,i,r){n?e.addEventListener(t,i,!!r):e.attachEvent("on"+t,i)},a=function(e,t,i,r){n?e.removeEventListener(t,i,!!r):e.detachEvent("on"+t,i)},s=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},l=function(e,t){return-1!==(" "+e.className+" ").indexOf(" "+t+" ")},c=function(e,t){l(e,t)||(e.className=""===e.className?t:e.className+" "+t)},u=function(e,t){e.className=s((" "+e.className+" ").replace(" "+t+" "," "))},d=function(e){return/Array/.test(Object.prototype.toString.call(e))},h=function(e){return/Date/.test(Object.prototype.toString.call(e))&&!isNaN(e.getTime())},p=function(e){var t=e.getDay();return 0===t||6===t},f=function(e){return e%4==0&&e%100!=0||e%400==0},m=function(e,t){return[31,f(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},g=function(e){h(e)&&e.setHours(0,0,0,0)},v=function(e,t){return e.getTime()===t.getTime()},b=function(e,t,n){var i,r;for(i in t)r=void 0!==e[i],r&&"object"==typeof t[i]&&null!==t[i]&&void 0===t[i].nodeName?h(t[i])?n&&(e[i]=new Date(t[i].getTime())):d(t[i])?n&&(e[i]=t[i].slice(0)):e[i]=b({},t[i],n):!n&&r||(e[i]=t[i]);return e},y=function(e,t,n){var r;i.createEvent?(r=i.createEvent("HTMLEvents"),r.initEvent(t,!0,!1),r=b(r,n),e.dispatchEvent(r)):i.createEventObject&&(r=i.createEventObject(),r=b(r,n),e.fireEvent("on"+t,r))},w=function(e){return e.month<0&&(e.year-=Math.ceil(Math.abs(e.month)/12),e.month+=12),e.month>11&&(e.year+=Math.floor(Math.abs(e.month)/12),e.month-=12),e},_={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},S=function(e,t,n){for(t+=e.firstDay;t>=7;)t-=7;return n?e.i18n.weekdaysShort[t]:e.i18n.weekdays[t]},k=function(e){var t=[],n="false";if(e.isEmpty){if(!e.showDaysInNextAndPreviousMonths)return'<td class="is-empty"></td>';t.push("is-outside-current-month"),e.enableSelectionDaysInNextAndPreviousMonths||t.push("is-selection-disabled")}return e.isDisabled&&t.push("is-disabled"),e.isToday&&t.push("is-today"),e.isSelected&&(t.push("is-selected"),n="true"),e.hasEvent&&t.push("has-event"),e.isInRange&&t.push("is-inrange"),e.isStartRange&&t.push("is-startrange"),e.isEndRange&&t.push("is-endrange"),'<td data-day="'+e.day+'" class="'+t.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+e.year+'" data-pika-month="'+e.month+'" data-pika-day="'+e.day+'">'+e.day+"</button></td>"},x=function(e,t,n){var i=new Date(n,0,1);return'<td class="pika-week">'+Math.ceil(((new Date(n,t,e)-i)/864e5+i.getDay()+1)/7)+"</td>"},C=function(e,t,n,i){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(i?" is-selected":"")+'">'+(t?e.reverse():e).join("")+"</tr>"},I=function(e){return"<tbody>"+e.join("")+"</tbody>"},P=function(e){var t,n=[];for(e.showWeekNumber&&n.push("<th></th>"),t=0;t<7;t++)n.push('<th scope="col"><abbr title="'+S(e,t)+'">'+S(e,t,!0)+"</abbr></th>");return"<thead><tr>"+(e.isRTL?n.reverse():n).join("")+"</tr></thead>"},T=function(e,t,n,i,r,o){var a,s,l,c,u,h=e._o,p=n===h.minYear,f=n===h.maxYear,m='<div id="'+o+'" class="pika-title" role="heading" aria-live="assertive">',g=!0,v=!0;for(l=[],a=0;a<12;a++)l.push('<option value="'+(n===r?a-t:12+a-t)+'"'+(a===i?' selected="selected"':"")+(p&&a<h.minMonth||f&&a>h.maxMonth?'disabled="disabled"':"")+">"+h.i18n.months[a]+"</option>");for(c='<div class="pika-label">'+h.i18n.months[i]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",d(h.yearRange)?(a=h.yearRange[0],s=h.yearRange[1]+1):(a=n-h.yearRange,s=1+n+h.yearRange),l=[];a<s&&a<=h.maxYear;a++)a>=h.minYear&&l.push('<option value="'+a+'"'+(a===n?' selected="selected"':"")+">"+a+"</option>");return u='<div class="pika-label">'+n+h.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",h.showMonthAfterYear?m+=u+c:m+=c+u,p&&(0===i||h.minMonth>=i)&&(g=!1),f&&(11===i||h.maxMonth<=i)&&(v=!1),0===t&&(m+='<button class="pika-prev'+(g?"":" is-disabled")+'" type="button">'+h.i18n.previousMonth+"</button>"),t===e._o.numberOfMonths-1&&(m+='<button class="pika-next'+(v?"":" is-disabled")+'" type="button">'+h.i18n.nextMonth+"</button>"),m+="</div>"},E=function(e,t,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+P(e)+I(t)+"</table>"},M=function(a){var s=this,c=s.config(a);s._onMouseDown=function(e){if(s._v){e=e||window.event;var t=e.target||e.srcElement;if(t)if(l(t,"is-disabled")||(!l(t,"pika-button")||l(t,"is-empty")||l(t.parentNode,"is-disabled")?l(t,"pika-prev")?s.prevMonth():l(t,"pika-next")&&s.nextMonth():(s.setDate(new Date(t.getAttribute("data-pika-year"),t.getAttribute("data-pika-month"),t.getAttribute("data-pika-day"))),c.bound&&r(function(){s.hide(),c.blurFieldOnSelect&&c.field&&c.field.blur()},100))),l(t,"pika-select"))s._c=!0;else{if(!e.preventDefault)return e.returnValue=!1,!1;e.preventDefault()}}},s._onChange=function(e){e=e||window.event;var t=e.target||e.srcElement;t&&(l(t,"pika-select-month")?s.gotoMonth(t.value):l(t,"pika-select-year")&&s.gotoYear(t.value))},s._onKeyChange=function(e){if(e=e||window.event,s.isVisible())switch(e.keyCode){case 13:case 27:c.field&&c.field.blur();break;case 37:e.preventDefault(),s.adjustDate("subtract",1);break;case 38:s.adjustDate("subtract",7);break;case 39:s.adjustDate("add",1);break;case 40:s.adjustDate("add",7)}},s._onInputChange=function(n){var i;n.firedBy!==s&&(c.parse?i=c.parse(c.field.value,c.format):t?(i=e(c.field.value,c.format,c.formatStrict),i=i&&i.isValid()?i.toDate():null):i=new Date(Date.parse(c.field.value)),h(i)&&s.setDate(i),s._v||s.show())},s._onInputFocus=function(){s.show()},s._onInputClick=function(){s.show()},s._onInputBlur=function(){var e=i.activeElement;do{if(l(e,"pika-single"))return}while(e=e.parentNode);s._c||(s._b=r(function(){s.hide()},50)),s._c=!1},s._onClick=function(e){e=e||window.event;var t=e.target||e.srcElement,i=t;if(t){!n&&l(t,"pika-select")&&(t.onchange||(t.setAttribute("onchange","return;"),o(t,"change",s._onChange)));do{if(l(i,"pika-single")||i===c.trigger)return}while(i=i.parentNode);s._v&&t!==c.trigger&&i!==c.trigger&&s.hide()}},s.el=i.createElement("div"),s.el.className="pika-single"+(c.isRTL?" is-rtl":"")+(c.theme?" "+c.theme:""),o(s.el,"mousedown",s._onMouseDown,!0),o(s.el,"touchend",s._onMouseDown,!0),o(s.el,"change",s._onChange),c.keyboardInput&&o(i,"keydown",s._onKeyChange),c.field&&(c.container?c.container.appendChild(s.el):c.bound?i.body.appendChild(s.el):c.field.parentNode.insertBefore(s.el,c.field.nextSibling),o(c.field,"change",s._onInputChange),c.defaultDate||(t&&c.field.value?c.defaultDate=e(c.field.value,c.format).toDate():c.defaultDate=new Date(Date.parse(c.field.value)),c.setDefaultDate=!0));var u=c.defaultDate;h(u)?c.setDefaultDate?s.setDate(u,!0):s.gotoDate(u):s.gotoDate(new Date),c.bound?(this.hide(),s.el.className+=" is-bound",o(c.trigger,"click",s._onInputClick),o(c.trigger,"focus",s._onInputFocus),o(c.trigger,"blur",s._onInputBlur)):this.show()};return M.prototype={config:function(e){this._o||(this._o=b({},_,!0));var t=b(this._o,e,!0);t.isRTL=!!t.isRTL,t.field=t.field&&t.field.nodeName?t.field:null,t.theme="string"==typeof t.theme&&t.theme?t.theme:null,t.bound=!!(void 0!==t.bound?t.field&&t.bound:t.field),t.trigger=t.trigger&&t.trigger.nodeName?t.trigger:t.field,t.disableWeekends=!!t.disableWeekends,t.disableDayFn="function"==typeof t.disableDayFn?t.disableDayFn:null;var n=parseInt(t.numberOfMonths,10)||1;if(t.numberOfMonths=n>4?4:n,h(t.minDate)||(t.minDate=!1),h(t.maxDate)||(t.maxDate=!1),t.minDate&&t.maxDate&&t.maxDate<t.minDate&&(t.maxDate=t.minDate=!1),t.minDate&&this.setMinDate(t.minDate),t.maxDate&&this.setMaxDate(t.maxDate),d(t.yearRange)){var i=(new Date).getFullYear()-10;t.yearRange[0]=parseInt(t.yearRange[0],10)||i,t.yearRange[1]=parseInt(t.yearRange[1],10)||i}else t.yearRange=Math.abs(parseInt(t.yearRange,10))||_.yearRange,t.yearRange>100&&(t.yearRange=100);return t},toString:function(n){return n=n||this._o.format,h(this._d)?this._o.toString?this._o.toString(this._d,n):t?e(this._d).format(n):this._d.toDateString():""},getMoment:function(){return t?e(this._d):null},setMoment:function(n,i){t&&e.isMoment(n)&&this.setDate(n.toDate(),i)},getDate:function(){return h(this._d)?new Date(this._d.getTime()):null},setDate:function(e,t){if(!e)return this._d=null,this._o.field&&(this._o.field.value="",y(this._o.field,"change",{firedBy:this})),this.draw();if("string"==typeof e&&(e=new Date(Date.parse(e))),h(e)){var n=this._o.minDate,i=this._o.maxDate;h(n)&&e<n?e=n:h(i)&&e>i&&(e=i),this._d=new Date(e.getTime()),g(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),y(this._o.field,"change",{firedBy:this})),t||"function"!=typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate())}},gotoDate:function(e){var t=!0;if(h(e)){if(this.calendars){var n=new Date(this.calendars[0].year,this.calendars[0].month,1),i=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),r=e.getTime();i.setMonth(i.getMonth()+1),i.setDate(i.getDate()-1),t=r<n.getTime()||i.getTime()<r}t&&(this.calendars=[{month:e.getMonth(),year:e.getFullYear()}],"right"===this._o.mainCalendar&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(e,t){var n,i=this.getDate()||new Date,r=24*parseInt(t)*60*60*1e3;"add"===e?n=new Date(i.valueOf()+r):"subtract"===e&&(n=new Date(i.valueOf()-r)),this.setDate(n)},adjustCalendars:function(){this.calendars[0]=w(this.calendars[0]);for(var e=1;e<this._o.numberOfMonths;e++)this.calendars[e]=w({month:this.calendars[0].month+e,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(e){isNaN(e)||(this.calendars[0].month=parseInt(e,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(e){isNaN(e)||(this.calendars[0].year=parseInt(e,10),this.adjustCalendars())},setMinDate:function(e){e instanceof Date?(g(e),this._o.minDate=e,this._o.minYear=e.getFullYear(),this._o.minMonth=e.getMonth()):(this._o.minDate=_.minDate,this._o.minYear=_.minYear,this._o.minMonth=_.minMonth,this._o.startRange=_.startRange),this.draw()},setMaxDate:function(e){e instanceof Date?(g(e),this._o.maxDate=e,this._o.maxYear=e.getFullYear(),this._o.maxMonth=e.getMonth()):(this._o.maxDate=_.maxDate,this._o.maxYear=_.maxYear,this._o.maxMonth=_.maxMonth,this._o.endRange=_.endRange),this.draw()},setStartRange:function(e){this._o.startRange=e},setEndRange:function(e){this._o.endRange=e},draw:function(e){if(this._v||e){var t,n=this._o,i=n.minYear,o=n.maxYear,a=n.minMonth,s=n.maxMonth,l="";this._y<=i&&(this._y=i,!isNaN(a)&&this._m<a&&(this._m=a)),this._y>=o&&(this._y=o,!isNaN(s)&&this._m>s&&(this._m=s)),t="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2);for(var c=0;c<n.numberOfMonths;c++)l+='<div class="pika-lendar">'+T(this,c,this.calendars[c].year,this.calendars[c].month,this.calendars[0].year,t)+this.render(this.calendars[c].year,this.calendars[c].month,t)+"</div>";this.el.innerHTML=l,n.bound&&"hidden"!==n.field.type&&r(function(){n.trigger.focus()},1),"function"==typeof this._o.onDraw&&this._o.onDraw(this),n.bound&&n.field.setAttribute("aria-label",n.ariaLabel)}},adjustPosition:function(){var e,t,n,r,o,a,s,l,d,h,p,f;if(!this._o.container){if(this.el.style.position="absolute",e=this._o.trigger,t=e,n=this.el.offsetWidth,r=this.el.offsetHeight,o=window.innerWidth||i.documentElement.clientWidth,a=window.innerHeight||i.documentElement.clientHeight,s=window.pageYOffset||i.body.scrollTop||i.documentElement.scrollTop,p=!0,f=!0,"function"==typeof e.getBoundingClientRect)h=e.getBoundingClientRect(),l=h.left+window.pageXOffset,d=h.bottom+window.pageYOffset;else for(l=t.offsetLeft,d=t.offsetTop+t.offsetHeight;t=t.offsetParent;)l+=t.offsetLeft,d+=t.offsetTop;(this._o.reposition&&l+n>o||this._o.position.indexOf("right")>-1&&l-n+e.offsetWidth>0)&&(l=l-n+e.offsetWidth,p=!1),(this._o.reposition&&d+r>a+s||this._o.position.indexOf("top")>-1&&d-r-e.offsetHeight>0)&&(d=d-r-e.offsetHeight,f=!1),this.el.style.left=l+"px",this.el.style.top=d+"px",c(this.el,p?"left-aligned":"right-aligned"),c(this.el,f?"bottom-aligned":"top-aligned"),u(this.el,p?"right-aligned":"left-aligned"),u(this.el,f?"top-aligned":"bottom-aligned")}},render:function(e,t,n){var i=this._o,r=new Date,o=m(e,t),a=new Date(e,t,1).getDay(),s=[],l=[];g(r),i.firstDay>0&&(a-=i.firstDay)<0&&(a+=7);for(var c=0===t?11:t-1,u=11===t?0:t+1,d=0===t?e-1:e,f=11===t?e+1:e,b=m(d,c),y=o+a,w=y;w>7;)w-=7;y+=7-w;for(var _=!1,S=0,I=0;S<y;S++){var P=new Date(e,t,S-a+1),T=!!h(this._d)&&v(P,this._d),M=v(P,r),D=-1!==i.events.indexOf(P.toDateString()),$=S<a||S>=o+a,B=S-a+1,A=t,L=e,O=i.startRange&&v(i.startRange,P),F=i.endRange&&v(i.endRange,P),j=i.startRange&&i.endRange&&i.startRange<P&&P<i.endRange,R=i.minDate&&P<i.minDate||i.maxDate&&P>i.maxDate||i.disableWeekends&&p(P)||i.disableDayFn&&i.disableDayFn(P);$&&(S<a?(B=b+B,A=c,L=d):(B-=o,A=u,L=f));var N={day:B,month:A,year:L,hasEvent:D,isSelected:T,isToday:M,isDisabled:R,isEmpty:$,isStartRange:O,isEndRange:F,isInRange:j,showDaysInNextAndPreviousMonths:i.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:i.enableSelectionDaysInNextAndPreviousMonths};i.pickWholeWeek&&T&&(_=!0),l.push(k(N)),7==++I&&(i.showWeekNumber&&l.unshift(x(S-a,t,e)),s.push(C(l,i.isRTL,i.pickWholeWeek,_)),l=[],I=0,_=!1)}return E(i,s,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),u(this.el,"is-hidden"),this._o.bound&&(o(i,"click",this._onClick),this.adjustPosition()),"function"==typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){var e=this._v;!1!==e&&(this._o.bound&&a(i,"click",this._onClick),this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto",c(this.el,"is-hidden"),this._v=!1,void 0!==e&&"function"==typeof this._o.onClose&&this._o.onClose.call(this))},destroy:function(){var e=this._o;this.hide(),a(this.el,"mousedown",this._onMouseDown,!0),a(this.el,"touchend",this._onMouseDown,!0),a(this.el,"change",this._onChange),e.keyboardInput&&a(i,"keydown",this._onKeyChange),e.field&&(a(e.field,"change",this._onInputChange),e.bound&&(a(e.trigger,"click",this._onInputClick),a(e.trigger,"focus",this._onInputFocus),a(e.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},M});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/sidebar/countdown-properties-expiry-date.directive",["require","exports","vendor/text!ts/modules/emailbuilder/sidebar/countdown-properties-expiry-date.directive.html","pikaday"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=__importDefault(i);var r=function(){function e(e){var t=this;this.template=n,this.link=function(e,n){var r=e.active.content;if(!r.expiryDate){var o=t.countdownDateService.GetDefaultExpiry();r.expiryDate=t.countdownDateService.dateToString(o,o)}var a=t.countdownDateService.stringToDate(r.expiryDate);e.viewTime=a;var s=n.find("#expiryDate")[0],l=0,c=function(e){$(e.el).find(".pika-lendar").animate({left:0},100,function(){})},u=function(e,t){var n=t.map(function(e){var t=$(e).val();return null===t||void 0===t?0:Number(t)});return Math.min.apply(Math,n)},d=function(e){if(e.getDate()){var t=$(e.el).find(".pika-select-month");if(t&&!(t.length<1)){var n=u(0,t.toArray()),i=n>l,r=n<l;l=n;var o=$(".pika-lendar");o.css("left","0px"),i?(o.css("left","240px"),c(e)):r&&(o.css("left","-240px"),c(e))}}},h=new i.default({field:s,numberOfMonths:2,defaultDate:a,setDefaultDate:!0,maxDate:t.countdownDateService.GetMaxExpiry(),theme:"cm-theme",i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Su","Mo","Tu","We","Th","Fr","Sa"]},onOpen:function(){var e=t.countdownDateService.GetMinExpiry();h.setMinDate(e)},onDraw:function(){d(h)}});$(h.el).click(function(e){e.stopPropagation()});var p=e.contentExpiryDateForm;p.expiryTime.$validators.min=function(e,n){if(!e)return!1;var i=t.countdownDateService.GetMinExpiry(),r=h.getDate();return!t.countdownDateService.isSameDay(r,i)||(r.setHours(e.getHours()),r.setMinutes(e.getMinutes()),r.setSeconds(e.getSeconds()),r>i)},p.expiryDate.$validators.min=function(e,n){var i=t.countdownDateService.GetMinExpiry(),r=h.getDate();return!!t.countdownDateService.isSameDay(r,i)||r>i};var f=function(){r.tempValidation=[],t.countdownDateService.stringToDate(r.expiryDate)<t.countdownDateService.GetMinExpiry()&&r.tempValidation.push("countdownExpiredDate"),p.expiryTime.$validate(),r.tempIsValid=0===r.tempValidation.length};e.save=function(){var n=t.countdownDateService.stringToDate(r.expiryDate),i=h.getDate();e.handleSingleDigitHour(),p.expiryTime.$render(),p.expiryTime.$invalid&&(e.viewTime=n),r.expiryDate=t.countdownDateService.dateToString(i,e.viewTime),f(),h.setDate(i)},e.handleSingleDigitHour=function(){var e=/^\d:/,t=p.expiryTime.$viewValue;if(e.test(t)){var n="0"+p.expiryTime.$viewValue;p.expiryTime.$setViewValue(n)}},e.$on("$destroy",function(){h.destroy()})},this.countdownDateService=e}return e.factory=function(t){return new e(t)},e}();t.CountdownPropertiesExpiryDate=r}),define("ts/modules/emailbuilder/sidebar/get-feedback-metrics.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){var n=this;this.trackConnectionStart=function(){return n.$http({method:"POST",url:n.emailBuilderConfig.urls.trackGetFeedbackConnectionStart})},this.trackConnectionSuccess=function(){return n.$http({method:"POST",url:n.emailBuilderConfig.urls.trackGetFeedbackConnectionSuccess})},this.$http=e,this.emailBuilderConfig=t}return e}();t.GetFeedbackMetricsService=n}),define("ts/modules/emailbuilder/sidebar/text-trim.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.ellipsis=function(e,t){if(!e||t>=e.length)return e;var n=(e=e.substr(0,t+1)).lastIndexOf(" ");return e.substr(0,n>t/2?n:t)+""}}return e}();t.TextTrimService=n}),define("vendor/text!ts/modules/emailbuilder/sidebar/checkbox.directive.html",[],function(){return'<input class="checkbox-options__input emb-checkbox" ng-change="checkboxChanged(property)"\n       type="checkbox" id="emb-form-{{id}}" ng-model="property"\n       ng-disabled="isDisabled"/>\n<label class="c-sidebar__label checkbox-options__label" for="emb-form-{{id}}">{{label}}</label>'}),define("ts/modules/emailbuilder/sidebar/checkbox.directive",["require","exports","vendor/text!ts/modules/emailbuilder/sidebar/checkbox.directive.html","../string-utils"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){var r=this;this.restrict="A",this.template=n,this.require="ngModel",this.scope={property:"=ngModel",activeSection:"=csSection",isDisabled:"=isDisabled"},this.link=function(e,t,n,o){e.label=n.label,n.checkboxId&&""!==n.checkboxId?e.id=n.checkboxId:e.id=n.label.toLowerCase().replace(/[^a-z]+/g,i.replaceSpacedStrings),e.checkboxChanged=function(t){o.$setViewValue(t),r.$timeout(function(){r.$rootScope.$emit("checkbox:value-changed",e.activeSection,e.id)},0)}},this.$rootScope=e,this.$timeout=t}return e.factory=function(t,n){return new e(t,n)},e}();t.Checkbox=r}),define("vendor/text!ts/modules/emailbuilder/sidebar/reverse-checkbox.directive.html",[],function(){return'<input class="checkbox-options__input" ng-change="checkboxChanged(originalValue)"\r\n       type="checkbox" id="emb-form-{{id}}" ng-model="originalValue"\r\n       ng-true-value="false" ng-false-value="true" />\r\n<label class="c-sidebar__label checkbox-options__label" for="emb-form-{{id}}">{{label}}</label>'}),define("ts/modules/emailbuilder/sidebar/reverse-checkbox.directive",["require","exports","vendor/text!ts/modules/emailbuilder/sidebar/reverse-checkbox.directive.html","../string-utils"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){var r=this;this.restrict="A",this.template=n,this.require="ngModel",this.scope={},this.link=function(e,t,n,o){e.label=n.label,e.originalValue=o.$viewValue&&!0,n.checkboxId&&""!==n.checkboxId?e.id=n.checkboxId:e.id=n.label.toLowerCase().replace(/[^a-z]+/g,i.replaceSpacedStrings),e.checkboxChanged=function(t){o.$setViewValue(t),r.$timeout(function(){r.$rootScope.$emit("checkbox:value-changed",null,e.id)},0)},o.$render=function(){e.originalValue=o.$viewValue}},this.$rootScope=e,this.$timeout=t}return e.factory=function(t,n){return new e(t,n)},e}();t.ReverseCheckbox=r}),define("ts/modules/emailbuilder/sidebar/sidebar-accordion.animation",["require","exports","vendor/jquery.easing"],function(e,t){"use strict";function n(){return{addClass:function(e,t,n){if("emb-accordion-anim"===t){var i=e.height(),r=2e3>i?i:2e3;e.css({height:0}).addClass("emb-selected").animate({height:i},r,"easeOutQuad",function(){e.css({height:"auto"}),n()})}else n()},removeClass:function(e,t,n){"emb-accordion-anim"===t?e.stop().animate({height:0,opacity:0},200,"easeOutQuad",function(){e.removeClass("emb-selected").css({height:"auto",opacity:1}),n()}):n()}}}Object.defineProperty(t,"__esModule",{value:!0}),t.SidebarAccordionAnimation=n}),define("ts/modules/emailbuilder/sidebar/scroll-container-if.directive",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.restrict="A",this.scope={embScrollContainerIf:"=",embScrollContainerOffset:"="},this.link=function(e,t,n){for(var i=t.parent(),r=0;r<n.embScrollContainerParent;r++)i=i.parent();e.$watch("embScrollContainerIf",function(n,r){if(n){var o=t.position().top,a=i.scrollTop();if(o>0&&o<2*t.height())return;i.scrollTop(a+o-e.embScrollContainerOffset)}})}}return e.factory=function(){return new e},e}();t.ScrollContainerIf=n});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/sidebar/update-style.directive",["require","exports","angular","less"],function(e,t,n,i){"use strict";function r(e){return"@"+e.substring(o.length).replace(/\./g,"-")}Object.defineProperty(t,"__esModule",{value:!0}),n=__importDefault(n),i=__importDefault(i);var o="email.styles.",a={darken:function(e){var t=new i.default.tree.Color(e),n=new i.default.tree.Value(20);return i.default.functions.functionRegistry.get("darken")(t,n).toRGB()},mix:function(e){var t=new i.default.tree.Color(e),n=new i.default.tree.Color("000000"),r=new i.default.tree.Value(50);return i.default.functions.functionRegistry.get("mix")(t,n,r).toRGB()}},s=function(){function e(e,t,i,s,l){var c=this;this.restrict="A",this.require="ngModel",this.link=function(e,t,i,s){if(0!==i.ngModel.indexOf(o))throw"We only expect properties starting with "+o;var l={},u=function(e){var t={};t[r(i.ngModel)]=e,c.dynamicStylesService.update(t)},d=function(t){var r=i.ngModel.split(".").pop(),o=r.toLowerCase().indexOf("color")>-1;if(n.default.element(i.embUpdateStyle).css(r,(o?"#":"")+t),i.embUpdateStyleColorFunctions&&o)for(var s=c.$parse(i.embUpdateStyleColorFunctions)(e),d=0;d<s.length;d++){var h=s[d],p=a[h.lessFunction](t);n.default.element(h.cssSelector).css(h.cssProperty,p),c.$rootScope.$emit("backgroundColor:changed",t)}l[i.ngModel]&&c.$timeout.cancel(l[i.ngModel]),l[i.ngModel]=c.$timeout(function(){u(t)},1e3)},h=c.emailBuilderConfig.email.isBlueprint&&i.embUpdateStyle?d:u;e.$watch(function(){return s.$modelValue},function(e,t){e!==t&&h(e)})},this.dynamicStylesService=e,this.$parse=t,this.$timeout=i,this.$rootScope=s,this.emailBuilderConfig=l}return e.factory=function(t,n,i,r,o){return new e(t,n,i,r,o)},e}();t.UpdateStyle=s}),define("vendor/text!ts/modules/emailbuilder/sidebar/video-properties.directive.html",[],function(){return'<section class="emb-js-property-pane hmb-image-sidebar emb-pane emb-reset">\n    <form name="contentFormVideo" novalidate="novalidate" ng-submit="close()" class="l-sidebar-inner">\n        <div class="c-sidebar__intro">\n            <h2 class="c-sidebar__heading-primary hmb-empty">\n                <span ng-show="isInitialState">Add a video</span>\n                <span ng-show="!isInitialState">Edit video</span>\n            </h2>\n        </div>\n        <div class="sidebar__accordion-item">\n            <div class="sidebar__form--accordion">\n                <div class="l-gap--bottom-large">\n                        <label class="c-sidebar__label" for="qa-video-url">Enter Video URL</label>\n                        <input id="qa-video-url" class="c-input" emb-sync-href="active.content" targetmodel="videoUrl" ng-model="active.content.tempVideoUrl" cs-valid-url name="videoUrlTxt" ng-required="true" type="text" placeholder="https://vimeo.com/97889197" emb-save-on-blur/>\n                </div>\n                <header class="p hmb-empty c-image-controls-container l-gap--bottom-large" ng-show="!isInitialState">\n                    <div emb-video-embedder class="emb-video-embedder"></div>\n                </header>\n                <section class="emb-secondary-container">\n                    <ul role="tablist" class="l-grid l-grid--inline-block l-grid--vertical-spacing hmb-top-override" ng-class="{ \'hmb-secondary-actions\' : !isInitialState, \'u-hide-all\' : isInitialState }" style="width: 100%">\n                        <li class="l-grid__item l-grid__item--100">\n                            <label class="c-sidebar__label" for="video-alt-text">Alt text</label>\n                            <input class="c-input" id="video-alt-text" name="alt" ng-model="active.content.alt" type="text" emb-save-on-blur/>\n                        </li>\n                        <li class="l-grid__item l-grid__item--100" ng-show="canEditStyles">\n                            <div class="checkbox-options" cs-reverse-checkbox ng-model="active.content.isFullWidth" label="Add video spacing" emb-save-on-model-change></div>\n                        </li>\n                    </ul>\n                </section>\n            </div>\n        </div>\n    </form>\n    <footer class="hmb-dismiss-container">\n        <input type="submit" value="Done editing" class="c-button c-button--primary c-button--large" ng-click="close()">\n    </footer>\n</section>'}),define("ts/modules/emailbuilder/sidebar/video-properties.directive",["require","exports","vendor/text!ts/modules/emailbuilder/sidebar/video-properties.directive.html","../services/analytics.service"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="youtube.com",o="vimeo.com",a=function(){function e(e,t,a){var s=this;this.restrict="E",this.template=n,this.link=function(e){e.setInitialState=function(t){e.isInitialState=t};var t=e.active.content;e.isInitialState=s.currentVideoUiIsInInitialState(t);var n=s.lockLevelService.getLocks(e.email.sections[t.tempContainer.sectionIndex].permissions);e.canEditStyles=n.canEditContentItemStyles,e.canDelete=n.canDeleteContentItems,delete t.tempVideoUrl,e.$watch("active.content.isFullWidth",function(){var n=t.tempContainer;if(e.email.sections&&e.email.sections[n.sectionIndex]&&e.email.sections[n.sectionIndex].content&&e.email.sections[n.sectionIndex].content[n.columnIndex]){var i=e.email.sections[n.sectionIndex].content[n.columnIndex];s.emailService.dropzoneHasPadding(i)}}),e.$on("$destroy",function(){var e=!t.isFullWidth,n=t.tempVideoUrl;if(n){var i=n.href;i&&s.trackVideoContentSelected(e,i)}})},this.currentVideoUiIsInInitialState=function(e){return!e.videoUrl},this.trackVideoContentSelected=function(e,t){var n=s.getDomainResolutionResult(t);if(n.isDomainResolved){var r={eventName:i.AnalyticsEventName.AddedContent,publicProperties:{"Content Type":"Video",Domain:n.domain,"Added Image Spacing":e}};s.analyticsService.trackClientLevel(r)}},this.getDomainResolutionResult=function(e){return e=e.toLowerCase(),s.stringIncludes(e,o)?{domain:o,isDomainResolved:!0}:s.stringIncludes(e,r)?{domain:r,isDomainResolved:!0}:{domain:e,isDomainResolved:!1}},this.stringIncludes=function(e,t){return-1!==e.indexOf(t)},this.emailService=e,this.lockLevelService=t,this.analyticsService=a}return e.factory=function(t,n,i){return new e(t,n,i)},e}();t.VideoProperties=a}),define("vendor/text!ts/modules/emailbuilder/sidebar/video-embedder.directive.html",[],function(){return'<div>\n    <figure ng-click="$event.stopPropagation()" ng-class="{ \'is-empty\' : isInitialState,  \'has-uploaded\' : !isInitialState }" class="hmb-uploaded-image c-image-controls__uploaded-image">\n        <div id="emb-js-message">\n        </div>\n        <div ng-show="!isInitialState" class="c-image-controls__image-container emb-js-preview-holder">\n\n        </div>\n    </figure>\n    <span ng-show="!isInitialState" class="hmb-upload-actions">\n        <button type="button" class="hmb-delete" ng-click="delete()" ng-show="canDelete">\n            Delete\n        </button>\n    </span>\n</div>'}),define("ts/modules/emailbuilder/sidebar/video-embedder.directive",["require","exports","vendor/text!ts/modules/emailbuilder/sidebar/video-embedder.directive.html"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t,i,r){var o=this;this.restrict="A",this.template=n,this.link=function(e,t){var n=e.active.content;e.delete=function(){o.deleteImage(e,n)},e.$watch("active.content.videoUrl",function(i,r){i===r&&""===r||o.videoThumbnailService.getVideoThumbnailUrl(n.videoProvider,i).then(function(i){delete n.tempThirdPartyUrl,n.thirdPartyUrl=i.thumbnailUrl,delete n.tempHref,n.href=i.href,n.validVideoSelected=i.validVideoSelected,n.videoProvider=i.videoProvider,e.setInitialState(!1),o.setSidebarThumbnailImage(e,t,n),o.clearErrors(e)},function(t){delete n.tempThirdPartyUrl,n.thirdPartyUrl=t.thumbnailUrl,delete n.tempHref,n.href=t.href,n.validVideoSelected=t.validVideoSelected,n.videoProvider=t.videoProvider,t.errorCode?(e.setInitialState(!1),o.addError(e,t.errorCode)):(e.setInitialState(!0),o.clearErrors(e),o.addError(e,"videoNoLink"))})})},this.displayThumbnail=function(e,t,n){var i=new Image;i.onload=function(){t.originalWidth=i.width,t.originalHeight=i.height,o.imageBuilderService.resize(t),o.thumbnailService.create({image:t,container:n,width:121,height:85,direction:{v:"center",h:"center"}})},i.onerror=function(){t.thirdPartyUrl.match(/.*youtube\.com.*/i)?t.thirdPartyUrl=o.videoThumbnailService.youtubeGenericThumbnail:t.thirdPartyUrl.match(/.*vimeo\.com.*/i)?t.thirdPartyUrl=o.videoThumbnailService.vimeoGenericThumbnail:t.thirdPartyUrl=null,e.setInitialState(!1),o.addError(e,"videoProviderDown")},
i.src=t.thirdPartyUrl},this.deleteImage=function(e,t){e.setInitialState(!0),o.contentBlockService.resetBlock(t)},this.setSidebarThumbnailImage=function(e,t,n){var i=t.find(".emb-js-preview-holder");o.contentBlockService.hasBlockSrc(n)?o.displayThumbnail(e,n,i):(e.setInitialState(!0),i.find("img").attr({src:null}))},this.clearErrors=function(e){var t=e.active.content;t.tempValidation=[],t.tempIsValid=!0},this.addError=function(e,t){for(var n=e.active.content,i=n.tempValidation||[],r=[],o=0;o<i.length;o++){var a=i[o];a!==t&&r.push(a)}r.push(t),n.tempValidation=r,n.tempIsValid=!r.length},this.thumbnailService=e,this.contentBlockService=t,this.imageBuilderService=i,this.videoThumbnailService=r}return e.factory=function(t,n,i,r){return new e(t,n,i,r)},e}();t.VideoEmbedder=i}),define("vendor/text!ts/modules/emailbuilder/sidebar/dropdown.directive.html",[],function(){return'<div class="emb-js-dropdown" data-dropdown="true" ng-keydown="keyDown($event);" tabindex="0" style="outline: none;">\r\n    <div class="l-select-container emb-js-select-container emb-select-container {{csDropdownClass}}" ng-show="open" ng-mousedown="mousedown=true;" ng-mouseup="mousedown=false;" ng-class="{\'emb-mousedown\': mousedown}">\r\n        <ul class="emb-js-select-wrapper emb-select-list emb-reset">\r\n            <li ng-repeat="type in csDropdown" class="emb-select-option emb-js-option" ng-click="setValue(type); toggleOpen($event); $event.stopPropagation();" data-value="{{::type.value || type}}" data-display="{{::type.display || type}}" data-description="{{::type.description || type}}" data-selected="{{::(type.value || type) == currentValue}}" data-index="{{::$index}}" ng-style="::type.cssValues">\r\n                <span class="c-select-list__option">{{::type.display || type}}</span>\r\n                <span class="c-select-list__description" ng-if="::!!type.description">{{::type.description}}</span>\r\n            </li>\r\n        </ul>\r\n    </div>\r\n    <span class="l-select-container emb-js-selected-option emb-select-selected {{csDropdownClass}} qa-dropdown-click-zone" ng-click="toggleOpen($event);" data-value="{{currentValue}}">{{currentDisplay}}</span>\r\n</div>'}),function(e){"function"==typeof define&&define.amd?define("vendor/jquery.nicescroll",["jquery"],e):e(jQuery)}(function(e){var t=!1,n=!1,i=5e3,r=2e3,o=0,a=e,s=["ms","moz","webkit","o"],l=window.requestAnimationFrame||!1,c=window.cancelAnimationFrame||!1;if(!l)for(var u in s){var d=s[u];l||(l=window[d+"RequestAnimationFrame"]),c||(c=window[d+"CancelAnimationFrame"]||window[d+"CancelRequestAnimationFrame"])}var h=window.MutationObserver||window.WebKitMutationObserver||!1,p={zindex:"auto",cursoropacitymin:0,cursoropacitymax:1,cursorcolor:"#424242",cursorwidth:"5px",cursorborder:"1px solid #fff",cursorborderradius:"5px",scrollspeed:60,mousescrollstep:24,touchbehavior:!1,hwacceleration:!0,usetransition:!0,boxzoom:!1,dblclickzoom:!0,gesturezoom:!0,grabcursorenabled:!0,autohidemode:!0,background:"",iframeautoresize:!0,cursorminheight:32,preservenativescrolling:!0,railoffset:!1,bouncescroll:!0,spacebarenabled:!0,railpadding:{top:0,right:0,left:0,bottom:0},disableoutline:!0,horizrailenabled:!0,railalign:"right",railvalign:"bottom",enabletranslate3d:!0,enablemousewheel:!0,enablekeyboard:!0,smoothscroll:!0,sensitiverail:!0,enablemouselockapi:!0,cursorfixedheight:!1,directionlockdeadzone:6,hidecursordelay:400,nativeparentscrolling:!0,enablescrollonselection:!0,overflowx:!0,overflowy:!0,cursordragspeed:.3,rtlmode:"auto",cursordragontouch:!1,oneaxismousemode:"auto",scriptpath:function(){var e=document.getElementsByTagName("script"),t=e[e.length-1].src.split("?")[0];return t.split("/").length>0?t.split("/").slice(0,-1).join("/")+"/":""}()},f=!1,m=function(){if(f)return f;var e=document.createElement("DIV"),t={};t.haspointerlock="pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document,t.isopera="opera"in window,t.isopera12=t.isopera&&"getUserMedia"in navigator,t.isoperamini="[object OperaMini]"===Object.prototype.toString.call(window.operamini),t.isie="all"in document&&"attachEvent"in e&&!t.isopera,t.isieold=t.isie&&!("msInterpolationMode"in e.style),t.isie7=t.isie&&!t.isieold&&(!("documentMode"in document)||7==document.documentMode),t.isie8=t.isie&&"documentMode"in document&&8==document.documentMode,t.isie9=t.isie&&"performance"in window&&document.documentMode>=9,t.isie10=t.isie&&"performance"in window&&document.documentMode>=10,t.isie9mobile=/iemobile.9/i.test(navigator.userAgent),t.isie9mobile&&(t.isie9=!1),t.isie7mobile=!t.isie9mobile&&t.isie7&&/iemobile/i.test(navigator.userAgent),t.ismozilla="MozAppearance"in e.style,t.iswebkit="WebkitAppearance"in e.style,t.ischrome="chrome"in window,t.ischrome22=t.ischrome&&t.haspointerlock,t.ischrome26=t.ischrome&&"transition"in e.style,t.cantouch="ontouchstart"in document.documentElement||"ontouchstart"in window,t.hasmstouch=window.navigator.msPointerEnabled||!1,t.ismac=/^mac$/i.test(navigator.platform),t.isios=t.cantouch&&/iphone|ipad|ipod/i.test(navigator.platform),t.isios4=t.isios&&!("seal"in Object),t.isandroid=/android/i.test(navigator.userAgent),t.trstyle=!1,t.hastransform=!1,t.hastranslate3d=!1,t.transitionstyle=!1,t.hastransition=!1,t.transitionend=!1;for(var n=["transform","msTransform","webkitTransform","MozTransform","OTransform"],i=0;i<n.length;i++)if(void 0!==e.style[n[i]]){t.trstyle=n[i];break}t.hastransform=0!=t.trstyle,t.hastransform&&(e.style[t.trstyle]="translate3d(1px,2px,3px)",t.hastranslate3d=/translate3d/.test(e.style[t.trstyle])),t.transitionstyle=!1,t.prefixstyle="",t.transitionend=!1;for(var n=["transition","webkitTransition","MozTransition","OTransition","OTransition","msTransition","KhtmlTransition"],r=["","-webkit-","-moz-","-o-","-o","-ms-","-khtml-"],o=["transitionend","webkitTransitionEnd","transitionend","otransitionend","oTransitionEnd","msTransitionEnd","KhtmlTransitionEnd"],i=0;i<n.length;i++)if(n[i]in e.style){t.transitionstyle=n[i],t.prefixstyle=r[i],t.transitionend=o[i];break}return t.ischrome26&&(t.prefixstyle=r[1]),t.hastransition=t.transitionstyle,t.cursorgrabvalue=function(){var n=["-moz-grab","-webkit-grab","grab"];(t.ischrome&&!t.ischrome22||t.isie)&&(n=[]);for(var i=0;i<n.length;i++){var r=n[i];if(e.style.cursor=r,e.style.cursor==r)return r}return"url(http://www.google.com/intl/en_ALL/mapfiles/openhand.cur),n-resize"}(),t.hasmousecapture="setCapture"in e,t.hasMutationObserver=!1!==h,e=null,f=t,t},g=function(e,s){function u(){var e=y.doc.css(_.trstyle);return!(!e||"matrix"!=e.substr(0,6))&&e.replace(/^.*\((.*)\)$/g,"$1").replace(/px/g,"").split(/, +/)}function d(){var e=y.win;if("zIndex"in e)return e.zIndex();for(;e.length>0;){if(9==e[0].nodeType)return!1;var t=e.css("zIndex");if(!isNaN(t)&&0!=t)return parseInt(t);e=e.parent()}return!1}function f(e,t,n){var i=e.css(t),r=parseFloat(i);if(isNaN(r)){r=k[i]||0;var o=3==r?n?y.win.outerHeight()-y.win.innerHeight():y.win.outerWidth()-y.win.innerWidth():1;return y.isie8&&r&&(r+=1),o?r:0}return r}function g(e,t,n,i){y._bind(e,t,function(i){var i=i||window.event,r={original:i,target:i.target||i.srcElement,type:"wheel",deltaMode:"MozMousePixelScroll"==i.type?0:1,deltaX:0,deltaZ:0,preventDefault:function(){return i.preventDefault?i.preventDefault():i.returnValue=!1,!1},stopImmediatePropagation:function(){i.stopImmediatePropagation?i.stopImmediatePropagation():i.cancelBubble=!0}};return"mousewheel"==t?(r.deltaY=-.025*i.wheelDelta,i.wheelDeltaX&&(r.deltaX=-.025*i.wheelDeltaX)):r.deltaY=i.detail,n.call(e,r)},i)}function b(e,t,n){var i,r;if(0==e.deltaMode?(i=-Math.floor(e.deltaX*(y.opt.mousescrollstep/54)),r=-Math.floor(e.deltaY*(y.opt.mousescrollstep/54))):1==e.deltaMode&&(i=-Math.floor(e.deltaX*y.opt.mousescrollstep),r=-Math.floor(e.deltaY*y.opt.mousescrollstep)),t&&y.opt.oneaxismousemode&&0==i&&r&&(i=r,r=0),i&&(y.scrollmom&&y.scrollmom.stop(),y.lastdeltax+=i,y.debounced("mousewheelx",function(){var e=y.lastdeltax;y.lastdeltax=0,y.rail.drag||y.doScrollLeftBy(e)},15)),r){if(y.opt.nativeparentscrolling&&n&&!y.ispage&&!y.zoomactive)if(r<0){if(y.getScrollTop()>=y.page.maxh)return!0}else if(y.getScrollTop()<=0)return!0;y.scrollmom&&y.scrollmom.stop(),y.lastdeltay+=r,y.debounced("mousewheely",function(){var e=y.lastdeltay;y.lastdeltay=0,y.rail.drag||y.doScrollBy(e)},15)}return e.stopImmediatePropagation(),e.preventDefault()}var y=this;if(this.version="3.5.4",this.name="nicescroll",this.me=s,this.opt={doc:a("body"),win:!1},a.extend(this.opt,p),this.opt.snapbackspeed=80,e)for(var w in y.opt)void 0!==e[w]&&(y.opt[w]=e[w]);this.doc=y.opt.doc,this.iddoc=this.doc&&this.doc[0]?this.doc[0].id||"":"",this.ispage=/^BODY|HTML/.test(y.opt.win?y.opt.win[0].nodeName:this.doc[0].nodeName),this.haswrapper=!1!==y.opt.win,this.win=y.opt.win||(this.ispage?a(window):this.doc),this.docscroll=this.ispage&&!this.haswrapper?a(window):this.win,this.body=a("body"),this.viewport=!1,this.isfixed=!1,this.iframe=!1,this.isiframe="IFRAME"==this.doc[0].nodeName&&"IFRAME"==this.win[0].nodeName,this.istextarea="TEXTAREA"==this.win[0].nodeName,this.forcescreen=!1,this.canshowonmouseevent="scroll"!=y.opt.autohidemode,this.onmousedown=!1,this.onmouseup=!1,this.onmousemove=!1,this.onmousewheel=!1,this.onkeypress=!1,this.ongesturezoom=!1,this.onclick=!1,this.onscrollstart=!1,this.onscrollend=!1,this.onscrollcancel=!1,this.onzoomin=!1,this.onzoomout=!1,this.view=!1,this.page=!1,this.scroll={x:0,y:0},this.scrollratio={x:0,y:0},this.cursorheight=20,this.scrollvaluemax=0,this.isrtlmode=!1,this.scrollrunning=!1,this.scrollmom=!1,this.observer=!1,this.observerremover=!1;do{this.id="ascrail"+r++}while(document.getElementById(this.id));this.rail=!1,this.cursor=!1,this.cursorfreezed=!1,this.selectiondrag=!1,this.zoom=!1,this.zoomactive=!1,this.hasfocus=!1,this.hasmousefocus=!1,this.visibility=!0,this.locked=!1,this.hidden=!1,this.cursoractive=!0,this.wheelprevented=!1,this.overflowx=y.opt.overflowx,this.overflowy=y.opt.overflowy,this.nativescrollingarea=!1,this.checkarea=0,this.events=[],this.saved={},this.delaylist={},this.synclist={},this.lastdeltax=0,this.lastdeltay=0,this.detected=m();var _=a.extend({},this.detected);this.canhwscroll=_.hastransform&&y.opt.hwacceleration,this.ishwscroll=this.canhwscroll&&y.haswrapper,this.istouchcapable=!1,_.cantouch&&_.ischrome&&!_.isios&&!_.isandroid&&(this.istouchcapable=!0,_.cantouch=!1),_.cantouch&&_.ismozilla&&!_.isios&&!_.isandroid&&(this.istouchcapable=!0,_.cantouch=!1),y.opt.enablemouselockapi||(_.hasmousecapture=!1,_.haspointerlock=!1),this.delayed=function(e,t,n,i){var r=y.delaylist[e],o=(new Date).getTime();if(!i&&r&&r.tt)return!1;r&&r.tt&&clearTimeout(r.tt),r&&r.last+n>o&&!r.tt?y.delaylist[e]={last:o+n,tt:setTimeout(function(){y&&(y.delaylist[e].tt=0,t.call())},n)}:r&&r.tt||(y.delaylist[e]={last:o,tt:0},setTimeout(function(){t.call()},0))},this.debounced=function(e,t,n){var i=y.delaylist[e];(new Date).getTime();y.delaylist[e]=t,i||setTimeout(function(){var t=y.delaylist[e];y.delaylist[e]=!1,t.call()},n)};var S=!1;if(this.synched=function(e,t){return y.synclist[e]=t,function(){S||(l(function(){S=!1;for(e in y.synclist){var t=y.synclist[e];t&&t.call(y),y.synclist[e]=!1}}),S=!0)}(),e},this.unsynched=function(e){y.synclist[e]&&(y.synclist[e]=!1)},this.css=function(e,t){for(var n in t)y.saved.css.push([e,n,e.css(n)]),e.css(n,t[n])},this.scrollTop=function(e){return void 0===e?y.getScrollTop():y.setScrollTop(e)},this.scrollLeft=function(e){return void 0===e?y.getScrollLeft():y.setScrollLeft(e)},BezierClass=function(e,t,n,i,r,o,a){this.st=e,this.ed=t,this.spd=n,this.p1=i||0,this.p2=r||1,this.p3=o||0,this.p4=a||1,this.ts=(new Date).getTime(),this.df=this.ed-this.st},BezierClass.prototype={B2:function(e){return 3*e*e*(1-e)},B3:function(e){return 3*e*(1-e)*(1-e)},B4:function(e){return(1-e)*(1-e)*(1-e)},getNow:function(){var e=(new Date).getTime(),t=1-(e-this.ts)/this.spd,n=this.B2(t)+this.B3(t)+this.B4(t);return t<0?this.ed:this.st+Math.round(this.df*n)},update:function(e,t){return this.st=this.getNow(),this.ed=e,this.spd=t,this.ts=(new Date).getTime(),this.df=this.ed-this.st,this}},this.ishwscroll){this.doc.translate={x:0,y:0,tx:"0px",ty:"0px"},_.hastranslate3d&&_.isios&&this.doc.css("-webkit-backface-visibility","hidden"),this.getScrollTop=function(e){if(!e){var t=u();if(t)return 16==t.length?-t[13]:-t[5];if(y.timerscroll&&y.timerscroll.bz)return y.timerscroll.bz.getNow()}return y.doc.translate.y},this.getScrollLeft=function(e){if(!e){var t=u();if(t)return 16==t.length?-t[12]:-t[4];if(y.timerscroll&&y.timerscroll.bh)return y.timerscroll.bh.getNow()}return y.doc.translate.x},document.createEvent?this.notifyScrollEvent=function(e){var t=document.createEvent("UIEvents");t.initUIEvent("scroll",!1,!0,window,1),e.dispatchEvent(t)}:document.fireEvent?this.notifyScrollEvent=function(e){var t=document.createEventObject();e.fireEvent("onscroll"),t.cancelBubble=!0}:this.notifyScrollEvent=function(e,t){};_.hastranslate3d&&y.opt.enabletranslate3d?(this.setScrollTop=function(e,t){y.doc.translate.y=e,y.doc.translate.ty=-1*e+"px",y.doc.css(_.trstyle,"translate3d("+y.doc.translate.tx+","+y.doc.translate.ty+",0px)"),t||y.notifyScrollEvent(y.win[0])},this.setScrollLeft=function(e,t){y.doc.translate.x=e,y.doc.translate.tx=-1*e+"px",y.doc.css(_.trstyle,"translate3d("+y.doc.translate.tx+","+y.doc.translate.ty+",0px)"),t||y.notifyScrollEvent(y.win[0])}):(this.setScrollTop=function(e,t){y.doc.translate.y=e,y.doc.translate.ty=-1*e+"px",y.doc.css(_.trstyle,"translate("+y.doc.translate.tx+","+y.doc.translate.ty+")"),t||y.notifyScrollEvent(y.win[0])},this.setScrollLeft=function(e,t){y.doc.translate.x=e,y.doc.translate.tx=-1*e+"px",y.doc.css(_.trstyle,"translate("+y.doc.translate.tx+","+y.doc.translate.ty+")"),t||y.notifyScrollEvent(y.win[0])})}else this.getScrollTop=function(){return y.docscroll.scrollTop()},this.setScrollTop=function(e){return y.docscroll.scrollTop(e)},this.getScrollLeft=function(){return y.docscroll.scrollLeft()},this.setScrollLeft=function(e){return y.docscroll.scrollLeft(e)};this.getTarget=function(e){return!!e&&(e.target?e.target:!!e.srcElement&&e.srcElement)},this.hasParent=function(e,t){if(!e)return!1;for(var n=e.target||e.srcElement||e||!1;n&&n.id!=t;)n=n.parentNode||!1;return!1!==n};var k={thin:1,medium:3,thick:5};this.getOffset=function(){if(y.isfixed)return{top:parseFloat(y.win.css("top")),left:parseFloat(y.win.css("left"))};if(!y.viewport)return y.win.offset();var e=y.win.offset(),t=y.viewport.offset();return{top:e.top-t.top+y.viewport.scrollTop(),left:e.left-t.left+y.viewport.scrollLeft()}},this.updateScrollBar=function(e){if(y.ishwscroll)y.rail.css({height:y.win.innerHeight()}),y.railh&&y.railh.css({width:y.win.innerWidth()});else{var t=y.getOffset(),n={top:t.top,left:t.left};n.top+=f(y.win,"border-top-width",!0);y.win.outerWidth(),y.win.innerWidth();n.left+=y.rail.align?y.win.outerWidth()-f(y.win,"border-right-width")-y.rail.width:f(y.win,"border-left-width");var i=y.opt.railoffset;if(i&&(i.top&&(n.top+=i.top),y.rail.align&&i.left&&(n.left+=i.left)),y.locked||y.rail.css({top:n.top,left:n.left,height:e?e.h:y.win.innerHeight()}),y.zoom&&y.zoom.css({top:n.top+1,left:1==y.rail.align?n.left-20:n.left+y.rail.width+4}),y.railh&&!y.locked){var n={top:t.top,left:t.left},r=y.railh.align?n.top+f(y.win,"border-top-width",!0)+y.win.innerHeight()-y.railh.height:n.top+f(y.win,"border-top-width",!0),o=n.left+f(y.win,"border-left-width");y.railh.css({top:r,left:o,width:y.railh.width})}}},this.doRailClick=function(e,t,n){var i,r,o,a;y.locked||(y.cancelEvent(e),t?(i=n?y.doScrollLeft:y.doScrollTop,o=n?(e.pageX-y.railh.offset().left-y.cursorwidth/2)*y.scrollratio.x:(e.pageY-y.rail.offset().top-y.cursorheight/2)*y.scrollratio.y,i(o)):(i=n?y.doScrollLeftBy:y.doScrollBy,o=n?y.scroll.x:y.scroll.y,a=n?e.pageX-y.railh.offset().left:e.pageY-y.rail.offset().top,r=n?y.view.w:y.view.h,i(o>=a?r:-r)))},y.hasanimationframe=l,y.hascancelanimationframe=c,y.hasanimationframe?y.hascancelanimationframe||(c=function(){y.cancelAnimationFrame=!0}):(l=function(e){return setTimeout(e,15-Math.floor(+new Date/1e3)%16)},c=clearInterval),this.init=function(){function e(t){if(y.selectiondrag){if(t){var n=y.win.outerHeight(),i=t.pageY-y.selectiondrag.top;i>0&&i<n&&(i=0),i>=n&&(i-=n),y.selectiondrag.df=i}if(0!=y.selectiondrag.df){var r=2*-Math.floor(y.selectiondrag.df/6);y.doScrollBy(r),y.debounced("doselectionscroll",function(){e()},50)}}}function r(e){y.iframexd=!1;try{var t="contentDocument"in this?this.contentDocument:this.contentWindow.document;t.domain}catch(e){y.iframexd=!0,t=!1}if(y.iframexd)return"console"in window&&console.log("NiceScroll error: policy restriced iframe"),!0;if(y.forcescreen=!0,y.isiframe&&(y.iframe={doc:a(t),html:y.doc.contents().find("html")[0],body:y.doc.contents().find("body")[0]},y.getContentSize=function(){return{w:Math.max(y.iframe.html.scrollWidth,y.iframe.body.scrollWidth),h:Math.max(y.iframe.html.scrollHeight,y.iframe.body.scrollHeight)}},y.docscroll=a(y.iframe.body)),!_.isios&&y.opt.iframeautoresize&&!y.isiframe){y.win.scrollTop(0),y.doc.height("");var n=Math.max(t.getElementsByTagName("html")[0].scrollHeight,t.body.scrollHeight);y.doc.height(n)}y.lazyResize(30),_.isie7&&y.css(a(y.iframe.html),{"overflow-y":"hidden"}),y.css(a(y.iframe.body),{"overflow-y":"hidden"}),_.isios&&y.haswrapper&&y.css(a(t.body),{"-webkit-transform":"translate3d(0,0,0)"}),"contentWindow"in this?y.bind(this.contentWindow,"scroll",y.onscroll):y.bind(t,"scroll",y.onscroll),y.opt.enablemousewheel&&y.bind(t,"mousewheel",y.onmousewheel),y.opt.enablekeyboard&&y.bind(t,_.isopera?"keypress":"keydown",y.onkeypress),(_.cantouch||y.opt.touchbehavior)&&(y.bind(t,"mousedown",y.ontouchstart),y.bind(t,"mousemove",function(e){y.ontouchmove(e,!0)}),y.opt.grabcursorenabled&&_.cursorgrabvalue&&y.css(a(t.body),{cursor:_.cursorgrabvalue})),y.bind(t,"mouseup",y.ontouchend),y.zoom&&(y.opt.dblclickzoom&&y.bind(t,"dblclick",y.doZoom),y.ongesturezoom&&y.bind(t,"gestureend",y.ongesturezoom))}if(y.saved.css=[],_.isie7mobile)return!0;if(_.isoperamini)return!0;if(_.hasmstouch&&y.css(y.ispage?a("html"):y.win,{"-ms-touch-action":"none"}),y.zindex="auto",y.ispage||"auto"!=y.opt.zindex?y.zindex=y.opt.zindex:y.zindex=d()||"auto",y.ispage||"auto"==y.zindex||y.zindex>o&&(o=y.zindex),y.isie&&0==y.zindex&&"auto"==y.opt.zindex&&(y.zindex="auto"),!y.ispage||!_.cantouch&&!_.isieold&&!_.isie9mobile){var s=y.docscroll;y.ispage&&(s=y.haswrapper?y.win:y.doc),_.isie9mobile||y.css(s,{"overflow-y":"hidden"}),y.ispage&&_.isie7&&("BODY"==y.doc[0].nodeName?y.css(a("html"),{"overflow-y":"hidden"}):"HTML"==y.doc[0].nodeName&&y.css(a("body"),{"overflow-y":"hidden"})),!_.isios||y.ispage||y.haswrapper||y.css(a("body"),{"-webkit-overflow-scrolling":"touch"});var l=a(document.createElement("div"));l.css({position:"relative",top:0,float:"right",width:y.opt.cursorwidth,height:"0px","background-color":y.opt.cursorcolor,border:y.opt.cursorborder,"background-clip":"padding-box","-webkit-border-radius":y.opt.cursorborderradius,"-moz-border-radius":y.opt.cursorborderradius,"border-radius":y.opt.cursorborderradius}),l.hborder=parseFloat(l.outerHeight()-l.innerHeight()),y.cursor=l;var c=a(document.createElement("div"));c.attr("id",y.id),c.addClass("nicescroll-rails");var u,p,f=["left","right"];for(var m in f)p=f[m],u=y.opt.railpadding[p],u?c.css("padding-"+p,u+"px"):y.opt.railpadding[p]=0;c.append(l),c.width=Math.max(parseFloat(y.opt.cursorwidth),l.outerWidth())+y.opt.railpadding.left+y.opt.railpadding.right,c.css({width:c.width+"px",zIndex:y.zindex,background:y.opt.background,cursor:"default"}),c.visibility=!0,c.scrollable=!0,c.align="left"==y.opt.railalign?0:1,y.rail=c,y.rail.drag=!1;var g=!1;if(!y.opt.boxzoom||y.ispage||_.isieold||(g=document.createElement("div"),y.bind(g,"click",y.doZoom),y.zoom=a(g),y.zoom.css({cursor:"pointer","z-index":y.zindex,backgroundImage:"url("+y.opt.scriptpath+"zoomico.png)",height:18,width:18,backgroundPosition:"0px 0px"}),y.opt.dblclickzoom&&y.bind(y.win,"dblclick",y.doZoom),_.cantouch&&y.opt.gesturezoom&&(y.ongesturezoom=function(e){return e.scale>1.5&&y.doZoomIn(e),e.scale<.8&&y.doZoomOut(e),y.cancelEvent(e)},y.bind(y.win,"gestureend",y.ongesturezoom))),y.railh=!1,y.opt.horizrailenabled){y.css(s,{"overflow-x":"hidden"});var l=a(document.createElement("div"));l.css({position:"relative",top:0,height:y.opt.cursorwidth,width:"0px","background-color":y.opt.cursorcolor,border:y.opt.cursorborder,"background-clip":"padding-box","-webkit-border-radius":y.opt.cursorborderradius,"-moz-border-radius":y.opt.cursorborderradius,"border-radius":y.opt.cursorborderradius}),l.wborder=parseFloat(l.outerWidth()-l.innerWidth()),y.cursorh=l;var b=a(document.createElement("div"));b.attr("id",y.id+"-hr"),b.addClass("nicescroll-rails"),b.height=Math.max(parseFloat(y.opt.cursorwidth),l.outerHeight()),b.css({height:b.height+"px",zIndex:y.zindex,background:y.opt.background}),b.append(l),b.visibility=!0,b.scrollable=!0,b.align="top"==y.opt.railvalign?0:1,y.railh=b,y.railh.drag=!1}if(y.ispage)c.css({position:"fixed",top:"0px",height:"100%"}),c.align?c.css({right:"0px"}):c.css({left:"0px"}),y.body.append(c),y.railh&&(b.css({position:"fixed",left:"0px",width:"100%"}),b.align?b.css({bottom:"0px"}):b.css({top:"0px"}),y.body.append(b));else{if(y.ishwscroll){"static"==y.win.css("position")&&y.css(y.win,{position:"relative"});var w="HTML"==y.win[0].nodeName?y.body:y.win;y.zoom&&(y.zoom.css({position:"absolute",top:1,right:0,"margin-right":c.width+4}),w.append(y.zoom)),c.css({position:"absolute",top:0}),c.align?c.css({right:0}):c.css({left:0}),w.append(c),b&&(b.css({position:"absolute",left:0,bottom:0}),b.align?b.css({bottom:0}):b.css({top:0}),w.append(b))}else{y.isfixed="fixed"==y.win.css("position");var S=y.isfixed?"fixed":"absolute";y.isfixed||(y.viewport=y.getViewport(y.win[0])),y.viewport&&(y.body=y.viewport,0==/fixed|relative|absolute/.test(y.viewport.css("position"))&&y.css(y.viewport,{position:"relative"})),c.css({position:S}),y.zoom&&y.zoom.css({position:S}),y.updateScrollBar(),y.body.append(c),y.zoom&&y.body.append(y.zoom),y.railh&&(b.css({position:S}),y.body.append(b))}_.isios&&y.css(y.win,{"-webkit-tap-highlight-color":"rgba(0,0,0,0)","-webkit-touch-callout":"none"}),_.isie&&y.opt.disableoutline&&y.win.attr("hideFocus","true"),_.iswebkit&&y.opt.disableoutline&&y.win.css({outline:"none"})}if(!1===y.opt.autohidemode?(y.autohidedom=!1,y.rail.css({opacity:y.opt.cursoropacitymax}),y.railh&&y.railh.css({opacity:y.opt.cursoropacitymax})):!0===y.opt.autohidemode||"leave"===y.opt.autohidemode?(y.autohidedom=a().add(y.rail),_.isie8&&(y.autohidedom=y.autohidedom.add(y.cursor)),y.railh&&(y.autohidedom=y.autohidedom.add(y.railh)),y.railh&&_.isie8&&(y.autohidedom=y.autohidedom.add(y.cursorh))):"scroll"==y.opt.autohidemode?(y.autohidedom=a().add(y.rail),y.railh&&(y.autohidedom=y.autohidedom.add(y.railh))):"cursor"==y.opt.autohidemode?(y.autohidedom=a().add(y.cursor),y.railh&&(y.autohidedom=y.autohidedom.add(y.cursorh))):"hidden"==y.opt.autohidemode&&(y.autohidedom=!1,y.hide(),y.locked=!1),_.isie9mobile){y.scrollmom=new v(y),y.onmangotouch=function(e){var t=y.getScrollTop(),n=y.getScrollLeft();if(t==y.scrollmom.lastscrolly&&n==y.scrollmom.lastscrollx)return!0;var i=t-y.mangotouch.sy,r=n-y.mangotouch.sx;if(0!=Math.round(Math.sqrt(Math.pow(r,2)+Math.pow(i,2)))){var o=i<0?-1:1,a=r<0?-1:1,s=+new Date;if(y.mangotouch.lazy&&clearTimeout(y.mangotouch.lazy),s-y.mangotouch.tm>80||y.mangotouch.dry!=o||y.mangotouch.drx!=a)y.scrollmom.stop(),y.scrollmom.reset(n,t),y.mangotouch.sy=t,y.mangotouch.ly=t,y.mangotouch.sx=n,y.mangotouch.lx=n,y.mangotouch.dry=o,y.mangotouch.drx=a,y.mangotouch.tm=s;else{y.scrollmom.stop(),y.scrollmom.update(y.mangotouch.sx-r,y.mangotouch.sy-i),y.mangotouch.tm,y.mangotouch.tm=s;var l=Math.max(Math.abs(y.mangotouch.ly-t),Math.abs(y.mangotouch.lx-n));y.mangotouch.ly=t,y.mangotouch.lx=n,l>2&&(y.mangotouch.lazy=setTimeout(function(){y.mangotouch.lazy=!1,y.mangotouch.dry=0,y.mangotouch.drx=0,y.mangotouch.tm=0,y.scrollmom.doMomentum(30)},100))}}};var k=y.getScrollTop(),x=y.getScrollLeft();y.mangotouch={sy:k,ly:k,dry:0,sx:x,lx:x,drx:0,lazy:!1,tm:0},y.bind(y.docscroll,"scroll",y.onmangotouch)}else{if(_.cantouch||y.istouchcapable||y.opt.touchbehavior||_.hasmstouch){y.scrollmom=new v(y),y.ontouchstart=function(e){if(e.pointerType&&2!=e.pointerType)return!1;if(y.hasmoving=!1,!y.locked){if(_.hasmstouch)for(var t=!!e.target&&e.target;t;){var n=a(t).getNiceScroll();if(n.length>0&&n[0].me==y.me)break;if(n.length>0)return!1;if("DIV"==t.nodeName&&t.id==y.id)break;t=!!t.parentNode&&t.parentNode}y.cancelScroll();var t=y.getTarget(e);if(t){if(/INPUT/i.test(t.nodeName)&&/range/i.test(t.type))return y.stopPropagation(e)}if(!("clientX"in e)&&"changedTouches"in e&&(e.clientX=e.changedTouches[0].clientX,e.clientY=e.changedTouches[0].clientY),y.forcescreen){var i=e,e={original:e.original?e.original:e};e.clientX=i.screenX,e.clientY=i.screenY}if(y.rail.drag={x:e.clientX,y:e.clientY,sx:y.scroll.x,sy:y.scroll.y,st:y.getScrollTop(),sl:y.getScrollLeft(),pt:2,dl:!1},y.ispage||!y.opt.directionlockdeadzone)y.rail.drag.dl="f";else{var r={w:a(window).width(),h:a(window).height()},o={w:Math.max(document.body.scrollWidth,document.documentElement.scrollWidth),h:Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)},s=Math.max(0,o.h-r.h),l=Math.max(0,o.w-r.w);!y.rail.scrollable&&y.railh.scrollable?y.rail.drag.ck=s>0&&"v":y.rail.scrollable&&!y.railh.scrollable?y.rail.drag.ck=l>0&&"h":y.rail.drag.ck=!1,y.rail.drag.ck||(y.rail.drag.dl="f")}if(y.opt.touchbehavior&&y.isiframe&&_.isie){var c=y.win.position();y.rail.drag.x+=c.left,y.rail.drag.y+=c.top}if(y.hasmoving=!1,y.lastmouseup=!1,y.scrollmom.reset(e.clientX,e.clientY),!_.cantouch&&!this.istouchcapable&&!_.hasmstouch){if(!(!!t&&/INPUT|SELECT|TEXTAREA/i.test(t.nodeName)))return!y.ispage&&_.hasmousecapture&&t.setCapture(),y.opt.touchbehavior?(t.onclick&&!t._onclick&&(t._onclick=t.onclick,t.onclick=function(e){if(y.hasmoving)return!1;t._onclick.call(this,e)}),y.cancelEvent(e)):y.stopPropagation(e);/SUBMIT|CANCEL|BUTTON/i.test(a(t).attr("type"))&&(pc={tg:t,click:!1},y.preventclick=pc)}}},y.ontouchend=function(e){return(!e.pointerType||2==e.pointerType)&&(y.rail.drag&&2==y.rail.drag.pt&&(y.scrollmom.doMomentum(),y.rail.drag=!1,y.hasmoving&&(y.lastmouseup=!0,y.hideCursor(),_.hasmousecapture&&document.releaseCapture(),!_.cantouch))?y.cancelEvent(e):void 0)};var C=y.opt.touchbehavior&&y.isiframe&&!_.hasmousecapture;y.ontouchmove=function(e,t){if(e.pointerType&&2!=e.pointerType)return!1;if(y.rail.drag&&2==y.rail.drag.pt){if(_.cantouch&&void 0===e.original)return!0;y.hasmoving=!0,y.preventclick&&!y.preventclick.click&&(y.preventclick.click=y.preventclick.tg.onclick||!1,y.preventclick.tg.onclick=y.onpreventclick);if(e=a.extend({original:e},e),"changedTouches"in e&&(e.clientX=e.changedTouches[0].clientX,e.clientY=e.changedTouches[0].clientY),y.forcescreen){var n=e,e={original:e.original?e.original:e};e.clientX=n.screenX,e.clientY=n.screenY}var i=ofy=0;if(C&&!t){var r=y.win.position();i=-r.left,ofy=-r.top}var o=e.clientY+ofy,s=o-y.rail.drag.y,l=e.clientX+i,c=l-y.rail.drag.x,u=y.rail.drag.st-s;if(y.ishwscroll&&y.opt.bouncescroll?u<0?u=Math.round(u/2):u>y.page.maxh&&(u=y.page.maxh+Math.round((u-y.page.maxh)/2)):(u<0&&(u=0,o=0),u>y.page.maxh&&(u=y.page.maxh,o=0)),y.railh&&y.railh.scrollable){var d=y.rail.drag.sl-c;y.ishwscroll&&y.opt.bouncescroll?d<0?d=Math.round(d/2):d>y.page.maxw&&(d=y.page.maxw+Math.round((d-y.page.maxw)/2)):(d<0&&(d=0,l=0),d>y.page.maxw&&(d=y.page.maxw,l=0))}var h=!1;if(y.rail.drag.dl)h=!0,"v"==y.rail.drag.dl?d=y.rail.drag.sl:"h"==y.rail.drag.dl&&(u=y.rail.drag.st);else{var p=Math.abs(s),f=Math.abs(c),m=y.opt.directionlockdeadzone;if("v"==y.rail.drag.ck){if(p>m&&f<=.3*p)return y.rail.drag=!1,!0;f>m&&(y.rail.drag.dl="f",a("body").scrollTop(a("body").scrollTop()))}else if("h"==y.rail.drag.ck){if(f>m&&p<=.3*f)return y.rail.drag=!1,!0;p>m&&(y.rail.drag.dl="f",a("body").scrollLeft(a("body").scrollLeft()))}}if(y.synched("touchmove",function(){y.rail.drag&&2==y.rail.drag.pt&&(y.prepareTransition&&y.prepareTransition(0),y.rail.scrollable&&y.setScrollTop(u),y.scrollmom.update(l,o),y.railh&&y.railh.scrollable?(y.setScrollLeft(d),y.showCursor(u,d)):y.showCursor(u),_.isie10&&document.selection.clear())}),_.ischrome&&y.istouchcapable&&(h=!1),h)return y.cancelEvent(e)}}}y.onmousedown=function(e,t){if(!y.rail.drag||1==y.rail.drag.pt){if(y.locked)return y.cancelEvent(e);y.cancelScroll(),y.rail.drag={x:e.clientX,y:e.clientY,sx:y.scroll.x,sy:y.scroll.y,pt:1,hr:!!t};var n=y.getTarget(e);return!y.ispage&&_.hasmousecapture&&n.setCapture(),y.isiframe&&!_.hasmousecapture&&(y.saved.csspointerevents=y.doc.css("pointer-events"),y.css(y.doc,{"pointer-events":"none"})),y.hasmoving=!1,y.cancelEvent(e)}},y.onmouseup=function(e){if(y.rail.drag){if(_.hasmousecapture&&document.releaseCapture(),y.isiframe&&!_.hasmousecapture&&y.doc.css("pointer-events",y.saved.csspointerevents),1!=y.rail.drag.pt)return;return y.rail.drag=!1,y.hasmoving&&y.triggerScrollEnd(),y.cancelEvent(e)}},y.onmousemove=function(e){if(y.rail.drag){if(1!=y.rail.drag.pt)return;if(_.ischrome&&0==e.which)return y.onmouseup(e);if(y.cursorfreezed=!0,y.hasmoving=!0,y.rail.drag.hr){y.scroll.x=y.rail.drag.sx+(e.clientX-y.rail.drag.x),y.scroll.x<0&&(y.scroll.x=0);var t=y.scrollvaluemaxw;y.scroll.x>t&&(y.scroll.x=t)}else{y.scroll.y=y.rail.drag.sy+(e.clientY-y.rail.drag.y),y.scroll.y<0&&(y.scroll.y=0);var n=y.scrollvaluemax;y.scroll.y>n&&(y.scroll.y=n)}return y.synched("mousemove",function(){y.rail.drag&&1==y.rail.drag.pt&&(y.showCursor(),y.rail.drag.hr?y.doScrollLeft(Math.round(y.scroll.x*y.scrollratio.x),y.opt.cursordragspeed):y.doScrollTop(Math.round(y.scroll.y*y.scrollratio.y),y.opt.cursordragspeed))}),y.cancelEvent(e)}},_.cantouch||y.opt.touchbehavior?(y.onpreventclick=function(e){if(y.preventclick)return y.preventclick.tg.onclick=y.preventclick.click,y.preventclick=!1,y.cancelEvent(e)},y.bind(y.win,"mousedown",y.ontouchstart),y.onclick=!_.isios&&function(e){return!y.lastmouseup||(y.lastmouseup=!1,y.cancelEvent(e))},y.opt.grabcursorenabled&&_.cursorgrabvalue&&(y.css(y.ispage?y.doc:y.win,{cursor:_.cursorgrabvalue}),y.css(y.rail,{cursor:_.cursorgrabvalue}))):("getSelection"in document?y.hasTextSelected=function(){return document.getSelection().rangeCount>0}:"selection"in document?y.hasTextSelected=function(){return"None"!=document.selection.type}:y.hasTextSelected=function(){return!1},y.onselectionstart=function(e){y.ispage||(y.selectiondrag=y.win.offset())},y.onselectionend=function(e){y.selectiondrag=!1},y.onselectiondrag=function(t){y.selectiondrag&&y.hasTextSelected()&&y.debounced("selectionscroll",function(){e(t)},250)}),_.hasmstouch&&(y.css(y.rail,{"-ms-touch-action":"none"}),y.css(y.cursor,{"-ms-touch-action":"none"}),y.bind(y.win,"MSPointerDown",y.ontouchstart),y.bind(document,"MSPointerUp",y.ontouchend),y.bind(document,"MSPointerMove",y.ontouchmove),y.bind(y.cursor,"MSGestureHold",function(e){e.preventDefault()}),y.bind(y.cursor,"contextmenu",function(e){e.preventDefault()})),this.istouchcapable&&(y.bind(y.win,"touchstart",y.ontouchstart),y.bind(document,"touchend",y.ontouchend),y.bind(document,"touchcancel",y.ontouchend),y.bind(document,"touchmove",y.ontouchmove)),y.bind(y.cursor,"mousedown",y.onmousedown),y.bind(y.cursor,"mouseup",y.onmouseup),y.railh&&(y.bind(y.cursorh,"mousedown",function(e){y.onmousedown(e,!0)}),y.bind(y.cursorh,"mouseup",y.onmouseup)),(y.opt.cursordragontouch||!_.cantouch&&!y.opt.touchbehavior)&&(y.rail.css({cursor:"default"}),y.railh&&y.railh.css({cursor:"default"}),y.jqbind(y.rail,"mouseenter",function(){if(!y.win.is(":visible"))return!1;y.canshowonmouseevent&&y.showCursor(),y.rail.active=!0}),y.jqbind(y.rail,"mouseleave",function(){y.rail.active=!1,y.rail.drag||y.hideCursor()}),y.opt.sensitiverail&&(y.bind(y.rail,"click",function(e){y.doRailClick(e,!1,!1)}),y.bind(y.rail,"dblclick",function(e){y.doRailClick(e,!0,!1)}),y.bind(y.cursor,"click",function(e){y.cancelEvent(e)}),
y.bind(y.cursor,"dblclick",function(e){y.cancelEvent(e)})),y.railh&&(y.jqbind(y.railh,"mouseenter",function(){if(!y.win.is(":visible"))return!1;y.canshowonmouseevent&&y.showCursor(),y.rail.active=!0}),y.jqbind(y.railh,"mouseleave",function(){y.rail.active=!1,y.rail.drag||y.hideCursor()}),y.opt.sensitiverail&&(y.bind(y.railh,"click",function(e){y.doRailClick(e,!1,!0)}),y.bind(y.railh,"dblclick",function(e){y.doRailClick(e,!0,!0)}),y.bind(y.cursorh,"click",function(e){y.cancelEvent(e)}),y.bind(y.cursorh,"dblclick",function(e){y.cancelEvent(e)})))),_.cantouch||y.opt.touchbehavior?(y.bind(_.hasmousecapture?y.win:document,"mouseup",y.ontouchend),y.bind(document,"mousemove",y.ontouchmove),y.onclick&&y.bind(document,"click",y.onclick),y.opt.cursordragontouch&&(y.bind(y.cursor,"mousedown",y.onmousedown),y.bind(y.cursor,"mousemove",y.onmousemove),y.cursorh&&y.bind(y.cursorh,"mousedown",function(e){y.onmousedown(e,!0)}),y.cursorh&&y.bind(y.cursorh,"mousemove",y.onmousemove))):(y.bind(_.hasmousecapture?y.win:document,"mouseup",y.onmouseup),y.bind(document,"mousemove",y.onmousemove),y.onclick&&y.bind(document,"click",y.onclick),!y.ispage&&y.opt.enablescrollonselection&&(y.bind(y.win[0],"mousedown",y.onselectionstart),y.bind(document,"mouseup",y.onselectionend),y.bind(y.cursor,"mouseup",y.onselectionend),y.cursorh&&y.bind(y.cursorh,"mouseup",y.onselectionend),y.bind(document,"mousemove",y.onselectiondrag)),y.zoom&&(y.jqbind(y.zoom,"mouseenter",function(){y.canshowonmouseevent&&y.showCursor(),y.rail.active=!0}),y.jqbind(y.zoom,"mouseleave",function(){y.rail.active=!1,y.rail.drag||y.hideCursor()}))),y.opt.enablemousewheel&&(y.isiframe||y.bind(_.isie&&y.ispage?document:y.win,"mousewheel",y.onmousewheel),y.bind(y.rail,"mousewheel",y.onmousewheel),y.railh&&y.bind(y.railh,"mousewheel",y.onmousewheelhr)),y.ispage||_.cantouch||/HTML|^BODY/.test(y.win[0].nodeName)||(y.win.attr("tabindex")||y.win.attr({tabindex:i++}),y.jqbind(y.win,"focus",function(e){t=y.getTarget(e).id||!0,y.hasfocus=!0,y.canshowonmouseevent&&y.noticeCursor()}),y.jqbind(y.win,"blur",function(e){t=!1,y.hasfocus=!1}),y.jqbind(y.win,"mouseenter",function(e){n=y.getTarget(e).id||!0,y.hasmousefocus=!0,y.canshowonmouseevent&&y.noticeCursor()}),y.jqbind(y.win,"mouseleave",function(){n=!1,y.hasmousefocus=!1,y.rail.drag||y.hideCursor()}))}if(y.onkeypress=function(e){if(y.locked&&0==y.page.maxh)return!0;e=e||window.e;var i=y.getTarget(e);if(i&&/INPUT|TEXTAREA|SELECT|OPTION/.test(i.nodeName)){if(!(i.getAttribute("type")||i.type||!1)||!/submit|button|cancel/i.tp)return!0}if(a(i).attr("contenteditable"))return!0;if(y.hasfocus||y.hasmousefocus&&!t||y.ispage&&!t&&!n){var r=e.keyCode;if(y.locked&&27!=r)return y.cancelEvent(e);var o=e.ctrlKey||!1,s=e.shiftKey||!1,l=!1;switch(r){case 38:case 63233:y.doScrollBy(72),l=!0;break;case 40:case 63235:y.doScrollBy(-72),l=!0;break;case 37:case 63232:y.railh&&(o?y.doScrollLeft(0):y.doScrollLeftBy(72),l=!0);break;case 39:case 63234:y.railh&&(o?y.doScrollLeft(y.page.maxw):y.doScrollLeftBy(-72),l=!0);break;case 33:case 63276:y.doScrollBy(y.view.h),l=!0;break;case 34:case 63277:y.doScrollBy(-y.view.h),l=!0;break;case 36:case 63273:y.railh&&o?y.doScrollPos(0,0):y.doScrollTo(0),l=!0;break;case 35:case 63275:y.railh&&o?y.doScrollPos(y.page.maxw,y.page.maxh):y.doScrollTo(y.page.maxh),l=!0;break;case 32:y.opt.spacebarenabled&&(s?y.doScrollBy(y.view.h):y.doScrollBy(-y.view.h),l=!0);break;case 27:y.zoomactive&&(y.doZoom(),l=!0)}if(l)return y.cancelEvent(e)}},y.opt.enablekeyboard&&y.bind(document,_.isopera&&!_.isopera12?"keypress":"keydown",y.onkeypress),y.bind(document,"keydown",function(e){(e.ctrlKey||!1)&&(y.wheelprevented=!0)}),y.bind(document,"keyup",function(e){e.ctrlKey||!1||(y.wheelprevented=!1)}),y.bind(window,"resize",y.lazyResize),y.bind(window,"orientationchange",y.lazyResize),y.bind(window,"load",y.lazyResize),_.ischrome&&!y.ispage&&!y.haswrapper){var I=y.win.attr("style"),P=parseFloat(y.win.css("width"))+1;y.win.css("width",P),y.synched("chromefix",function(){y.win.attr("style",I)})}y.onAttributeChange=function(e){y.lazyResize(250)},y.ispage||y.haswrapper||(!1!==h?(y.observer=new h(function(e){e.forEach(y.onAttributeChange)}),y.observer.observe(y.win[0],{childList:!0,characterData:!1,attributes:!0,subtree:!1}),y.observerremover=new h(function(e){e.forEach(function(e){if(e.removedNodes.length>0)for(var t in e.removedNodes)if(e.removedNodes[t]==y.win[0])return y.remove()})}),y.observerremover.observe(y.win[0].parentNode,{childList:!0,characterData:!1,attributes:!1,subtree:!1})):(y.bind(y.win,_.isie&&!_.isie9?"propertychange":"DOMAttrModified",y.onAttributeChange),_.isie9&&y.win[0].attachEvent("onpropertychange",y.onAttributeChange),y.bind(y.win,"DOMNodeRemoved",function(e){e.target==y.win[0]&&y.remove()}))),!y.ispage&&y.opt.boxzoom&&y.bind(window,"resize",y.resizeZoom),y.istextarea&&y.bind(y.win,"mouseup",y.lazyResize),y.lazyResize(30)}"IFRAME"==this.doc[0].nodeName&&(this.doc[0].readyState&&"complete"==this.doc[0].readyState&&setTimeout(function(){r.call(y.doc[0],!1)},500),y.bind(this.doc,"load",r))},this.showCursor=function(e,t){y.cursortimeout&&(clearTimeout(y.cursortimeout),y.cursortimeout=0),y.rail&&(y.autohidedom&&(y.autohidedom.stop().css({opacity:y.opt.cursoropacitymax}),y.cursoractive=!0),y.rail.drag&&1==y.rail.drag.pt||(void 0!==e&&!1!==e&&(y.scroll.y=Math.round(1*e/y.scrollratio.y)),void 0!==t&&(y.scroll.x=Math.round(1*t/y.scrollratio.x))),y.cursor.css({height:y.cursorheight,top:y.scroll.y}),y.cursorh&&(!y.rail.align&&y.rail.visibility?y.cursorh.css({width:y.cursorwidth,left:y.scroll.x+y.rail.width}):y.cursorh.css({width:y.cursorwidth,left:y.scroll.x}),y.cursoractive=!0),y.zoom&&y.zoom.stop().css({opacity:y.opt.cursoropacitymax}))},this.hideCursor=function(e){y.cursortimeout||y.rail&&y.autohidedom&&(y.hasmousefocus&&"leave"==y.opt.autohidemode||(y.cursortimeout=setTimeout(function(){y.rail.active&&y.showonmouseevent||(y.autohidedom.stop().animate({opacity:y.opt.cursoropacitymin}),y.zoom&&y.zoom.stop().animate({opacity:y.opt.cursoropacitymin}),y.cursoractive=!1),y.cursortimeout=0},e||y.opt.hidecursordelay)))},this.noticeCursor=function(e,t,n){y.showCursor(t,n),y.rail.active||y.hideCursor(e)},this.getContentSize=y.ispage?function(){return{w:Math.max(document.body.scrollWidth,document.documentElement.scrollWidth),h:Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)}}:y.haswrapper?function(){return{w:y.doc.outerWidth()+parseInt(y.win.css("paddingLeft"))+parseInt(y.win.css("paddingRight")),h:y.doc.outerHeight()+parseInt(y.win.css("paddingTop"))+parseInt(y.win.css("paddingBottom"))}}:function(){return{w:y.docscroll[0].scrollWidth,h:y.docscroll[0].scrollHeight}},this.onResize=function(e,t){if(!y||!y.win)return!1;if(!y.haswrapper&&!y.ispage){if("none"==y.win.css("display"))return y.visibility&&y.hideRail().hideRailHr(),!1;y.hidden||y.visibility||y.showRail().showRailHr()}var n=y.page.maxh,i=y.page.maxw,r={h:y.view.h,w:y.view.w};if(y.view={w:y.ispage?y.win.width():parseInt(y.win[0].clientWidth),h:y.ispage?y.win.height():parseInt(y.win[0].clientHeight)},y.page=t||y.getContentSize(),y.page.maxh=Math.max(0,y.page.h-y.view.h),y.page.maxw=Math.max(0,y.page.w-y.view.w),y.page.maxh==n&&y.page.maxw==i&&y.view.w==r.w){if(y.ispage)return y;var o=y.win.offset();if(y.lastposition){var a=y.lastposition;if(a.top==o.top&&a.left==o.left)return y}y.lastposition=o}return 0==y.page.maxh?(y.hideRail(),y.scrollvaluemax=0,y.scroll.y=0,y.scrollratio.y=0,y.cursorheight=0,y.setScrollTop(0),y.rail.scrollable=!1):y.rail.scrollable=!0,0==y.page.maxw?(y.hideRailHr(),y.scrollvaluemaxw=0,y.scroll.x=0,y.scrollratio.x=0,y.cursorwidth=0,y.setScrollLeft(0),y.railh.scrollable=!1):y.railh.scrollable=!0,y.locked=0==y.page.maxh&&0==y.page.maxw,y.locked?(y.ispage||y.updateScrollBar(y.view),!1):(y.hidden||y.visibility?y.hidden||y.railh.visibility||y.showRailHr():y.showRail().showRailHr(),y.istextarea&&y.win.css("resize")&&"none"!=y.win.css("resize")&&(y.view.h-=20),y.cursorheight=Math.min(y.view.h,Math.round(y.view.h*(y.view.h/y.page.h))),y.cursorheight=y.opt.cursorfixedheight?y.opt.cursorfixedheight:Math.max(y.opt.cursorminheight,y.cursorheight),y.cursorwidth=Math.min(y.view.w,Math.round(y.view.w*(y.view.w/y.page.w))),y.cursorwidth=y.opt.cursorfixedheight?y.opt.cursorfixedheight:Math.max(y.opt.cursorminheight,y.cursorwidth),y.scrollvaluemax=y.view.h-y.cursorheight-y.cursor.hborder,y.railh&&(y.railh.width=y.page.maxh>0?y.view.w-y.rail.width:y.view.w,y.scrollvaluemaxw=y.railh.width-y.cursorwidth-y.cursorh.wborder),y.ispage||y.updateScrollBar(y.view),y.scrollratio={x:y.page.maxw/y.scrollvaluemaxw,y:y.page.maxh/y.scrollvaluemax},y.getScrollTop()>y.page.maxh?y.doScrollTop(y.page.maxh):(y.scroll.y=Math.round(y.getScrollTop()*(1/y.scrollratio.y)),y.scroll.x=Math.round(y.getScrollLeft()*(1/y.scrollratio.x)),y.cursoractive&&y.noticeCursor()),y.scroll.y&&0==y.getScrollTop()&&y.doScrollTo(Math.floor(y.scroll.y*y.scrollratio.y)),y)},this.resize=y.onResize,this.lazyResize=function(e){return e=isNaN(e)?30:e,y.delayed("resize",y.resize,e),y},this._bind=function(e,t,n,i){y.events.push({e:e,n:t,f:n,b:i,q:!1}),e.addEventListener?e.addEventListener(t,n,i||!1):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n},this.jqbind=function(e,t,n){y.events.push({e:e,n:t,f:n,q:!0}),a(e).bind(t,n)},this.bind=function(e,t,n,i){var r="jquery"in e?e[0]:e;if("mousewheel"==t)if("onwheel"in y.win)y._bind(r,"wheel",n,i||!1);else{var o=void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll";g(r,o,n,i||!1),"DOMMouseScroll"==o&&g(r,"MozMousePixelScroll",n,i||!1)}else if(r.addEventListener){if(_.cantouch&&/mouseup|mousedown|mousemove/.test(t)){var a="mousedown"==t?"touchstart":"mouseup"==t?"touchend":"touchmove";y._bind(r,a,function(e){if(e.touches){if(e.touches.length<2){var t=e.touches.length?e.touches[0]:e;t.original=e,n.call(this,t)}}else if(e.changedTouches){var t=e.changedTouches[0];t.original=e,n.call(this,t)}},i||!1)}y._bind(r,t,n,i||!1),_.cantouch&&"mouseup"==t&&y._bind(r,"touchcancel",n,i||!1)}else y._bind(r,t,function(e){return e=e||window.event||!1,e&&e.srcElement&&(e.target=e.srcElement),"pageY"in e||(e.pageX=e.clientX+document.documentElement.scrollLeft,e.pageY=e.clientY+document.documentElement.scrollTop),!1!==n.call(r,e)&&!1!==i||y.cancelEvent(e)})},this._unbind=function(e,t,n,i){e.removeEventListener?e.removeEventListener(t,n,i):e.detachEvent?e.detachEvent("on"+t,n):e["on"+t]=!1},this.unbindAll=function(){for(var e=0;e<y.events.length;e++){var t=y.events[e];t.q?t.e.unbind(t.n,t.f):y._unbind(t.e,t.n,t.f,t.b)}},this.cancelEvent=function(e){var e=e.original?e.original:e||(window.event||!1);return!!e&&(e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.preventManipulation&&e.preventManipulation(),e.cancelBubble=!0,e.cancel=!0,e.returnValue=!1,!1)},this.stopPropagation=function(e){var e=e.original?e.original:e||(window.event||!1);return!!e&&(e.stopPropagation?e.stopPropagation():(e.cancelBubble&&(e.cancelBubble=!0),!1))},this.showRail=function(){return 0==y.page.maxh||!y.ispage&&"none"==y.win.css("display")||(y.visibility=!0,y.rail.visibility=!0,y.rail.css("display","block")),y},this.showRailHr=function(){return y.railh?(0==y.page.maxw||!y.ispage&&"none"==y.win.css("display")||(y.railh.visibility=!0,y.railh.css("display","block")),y):y},this.hideRail=function(){return y.visibility=!1,y.rail.visibility=!1,y.rail.css("display","none"),y},this.hideRailHr=function(){return y.railh?(y.railh.visibility=!1,y.railh.css("display","none"),y):y},this.show=function(){return y.hidden=!1,y.locked=!1,y.showRail().showRailHr()},this.hide=function(){return y.hidden=!0,y.locked=!0,y.hideRail().hideRailHr()},this.toggle=function(){return y.hidden?y.show():y.hide()},this.remove=function(){y.stop(),y.cursortimeout&&clearTimeout(y.cursortimeout),y.doZoomOut(),y.unbindAll(),_.isie9&&y.win[0].detachEvent("onpropertychange",y.onAttributeChange),!1!==y.observer&&y.observer.disconnect(),!1!==y.observerremover&&y.observerremover.disconnect(),y.events=null,y.cursor&&y.cursor.remove(),y.cursorh&&y.cursorh.remove(),y.rail&&y.rail.remove(),y.railh&&y.railh.remove(),y.zoom&&y.zoom.remove();for(var e=0;e<y.saved.css.length;e++){var t=y.saved.css[e];t[0].css(t[1],void 0===t[2]?"":t[2])}y.saved=!1,y.me.data("__nicescroll","");var n=a.nicescroll;n.each(function(e){if(this&&this.id===y.id){delete n[e];for(var t=++e;t<n.length;t++,e++)n[e]=n[t];n.length--,n.length&&delete n[n.length]}});for(var i in y)y[i]=null,delete y[i];y=null},this.scrollstart=function(e){return this.onscrollstart=e,y},this.scrollend=function(e){return this.onscrollend=e,y},this.scrollcancel=function(e){return this.onscrollcancel=e,y},this.zoomin=function(e){return this.onzoomin=e,y},this.zoomout=function(e){return this.onzoomout=e,y},this.isScrollable=function(e){var t=e.target?e.target:e;if("OPTION"==t.nodeName)return!0;for(;t&&1==t.nodeType&&!/^BODY|HTML/.test(t.nodeName);){var n=a(t);if(/scroll|auto/.test(n.css("overflowY")||n.css("overflowX")||n.css("overflow")||""))return t.clientHeight!=t.scrollHeight;t=!!t.parentNode&&t.parentNode}return!1},this.getViewport=function(e){for(var t=!(!e||!e.parentNode)&&e.parentNode;t&&1==t.nodeType&&!/^BODY|HTML/.test(t.nodeName);){var n=a(t);if(/fixed|absolute/.test(n.css("position")))return n;if(/scroll|auto/.test(n.css("overflowY")||n.css("overflowX")||n.css("overflow")||"")&&t.clientHeight!=t.scrollHeight)return n;if(n.getNiceScroll().length>0)return n;t=!!t.parentNode&&t.parentNode}return!!t&&a(t)},this.triggerScrollEnd=function(){if(y.onscrollend){var e=y.getScrollLeft(),t=y.getScrollTop(),n={type:"scrollend",current:{x:e,y:t},end:{x:e,y:t}};y.onscrollend.call(y,n)}},this.onmousewheel=function(e){if(!y.wheelprevented){if(y.locked)return y.debounced("checkunlock",y.resize,250),!0;if(y.rail.drag)return y.cancelEvent(e);if("auto"==y.opt.oneaxismousemode&&0!=e.deltaX&&(y.opt.oneaxismousemode=!1),y.opt.oneaxismousemode&&0==e.deltaX&&!y.rail.scrollable)return!y.railh||!y.railh.scrollable||y.onmousewheelhr(e);var t=+new Date,n=!1;if(y.opt.preservenativescrolling&&y.checkarea+600<t&&(y.nativescrollingarea=y.isScrollable(e),n=!0),y.checkarea=t,y.nativescrollingarea)return!0;var i=b(e,!1,n);return i&&(y.checkarea=0),i}},this.onmousewheelhr=function(e){if(!y.wheelprevented){if(y.locked||!y.railh.scrollable)return!0;if(y.rail.drag)return y.cancelEvent(e);var t=+new Date,n=!1;return y.opt.preservenativescrolling&&y.checkarea+600<t&&(y.nativescrollingarea=y.isScrollable(e),n=!0),y.checkarea=t,!!y.nativescrollingarea||(y.locked?y.cancelEvent(e):b(e,!0,n))}},this.stop=function(){return y.cancelScroll(),y.scrollmon&&y.scrollmon.stop(),y.cursorfreezed=!1,y.scroll.y=Math.round(y.getScrollTop()*(1/y.scrollratio.y)),y.noticeCursor(),y},this.getTransitionSpeed=function(e){var t=Math.round(10*y.opt.scrollspeed),n=Math.min(t,Math.round(e/20*y.opt.scrollspeed));return n>20?n:0},y.opt.smoothscroll?y.ishwscroll&&_.hastransition&&y.opt.usetransition?(this.prepareTransition=function(e,t){var n=t?e>20?e:0:y.getTransitionSpeed(e),i=n?_.prefixstyle+"transform "+n+"ms ease-out":"";return y.lasttransitionstyle&&y.lasttransitionstyle==i||(y.lasttransitionstyle=i,y.doc.css(_.transitionstyle,i)),n},this.doScrollLeft=function(e,t){var n=y.scrollrunning?y.newscrolly:y.getScrollTop();y.doScrollPos(e,n,t)},this.doScrollTop=function(e,t){var n=y.scrollrunning?y.newscrollx:y.getScrollLeft();y.doScrollPos(n,e,t)},this.doScrollPos=function(e,t,n){var i=y.getScrollTop(),r=y.getScrollLeft();return((y.newscrolly-i)*(t-i)<0||(y.newscrollx-r)*(e-r)<0)&&y.cancelScroll(),0==y.opt.bouncescroll&&(t<0?t=0:t>y.page.maxh&&(t=y.page.maxh),e<0?e=0:e>y.page.maxw&&(e=y.page.maxw)),(!y.scrollrunning||e!=y.newscrollx||t!=y.newscrolly)&&(y.newscrolly=t,y.newscrollx=e,y.newscrollspeed=n||!1,!y.timer&&void(y.timer=setTimeout(function(){var n=y.getScrollTop(),i=y.getScrollLeft(),r={};r.x=e-i,r.y=t-n,r.px=i,r.py=n;var o=Math.round(Math.sqrt(Math.pow(r.x,2)+Math.pow(r.y,2))),a=y.newscrollspeed&&y.newscrollspeed>1?y.newscrollspeed:y.getTransitionSpeed(o);if(y.newscrollspeed&&y.newscrollspeed<=1&&(a*=y.newscrollspeed),y.prepareTransition(a,!0),y.timerscroll&&y.timerscroll.tm&&clearInterval(y.timerscroll.tm),a>0){if(!y.scrollrunning&&y.onscrollstart){var s={type:"scrollstart",current:{x:i,y:n},request:{x:e,y:t},end:{x:y.newscrollx,y:y.newscrolly},speed:a};y.onscrollstart.call(y,s)}_.transitionend?y.scrollendtrapped||(y.scrollendtrapped=!0,y.bind(y.doc,_.transitionend,y.onScrollTransitionEnd,!1)):(y.scrollendtrapped&&clearTimeout(y.scrollendtrapped),y.scrollendtrapped=setTimeout(y.onScrollTransitionEnd,a));var l=n,c=i;y.timerscroll={bz:new BezierClass(l,y.newscrolly,a,0,0,.58,1),bh:new BezierClass(c,y.newscrollx,a,0,0,.58,1)},y.cursorfreezed||(y.timerscroll.tm=setInterval(function(){y.showCursor(y.getScrollTop(),y.getScrollLeft())},60))}y.synched("doScroll-set",function(){y.timer=0,y.scrollendtrapped&&(y.scrollrunning=!0),y.setScrollTop(y.newscrolly),y.setScrollLeft(y.newscrollx),y.scrollendtrapped||y.onScrollTransitionEnd()})},50)))},this.cancelScroll=function(){if(!y.scrollendtrapped)return!0;var e=y.getScrollTop(),t=y.getScrollLeft();return y.scrollrunning=!1,_.transitionend||clearTimeout(_.transitionend),y.scrollendtrapped=!1,y._unbind(y.doc,_.transitionend,y.onScrollTransitionEnd),y.prepareTransition(0),y.setScrollTop(e),y.railh&&y.setScrollLeft(t),y.timerscroll&&y.timerscroll.tm&&clearInterval(y.timerscroll.tm),y.timerscroll=!1,y.cursorfreezed=!1,y.showCursor(e,t),y},this.onScrollTransitionEnd=function(){y.scrollendtrapped&&y._unbind(y.doc,_.transitionend,y.onScrollTransitionEnd),y.scrollendtrapped=!1,y.prepareTransition(0),y.timerscroll&&y.timerscroll.tm&&clearInterval(y.timerscroll.tm),y.timerscroll=!1;var e=y.getScrollTop(),t=y.getScrollLeft();if(y.setScrollTop(e),y.railh&&y.setScrollLeft(t),y.noticeCursor(!1,e,t),y.cursorfreezed=!1,e<0?e=0:e>y.page.maxh&&(e=y.page.maxh),t<0?t=0:t>y.page.maxw&&(t=y.page.maxw),e!=y.newscrolly||t!=y.newscrollx)return y.doScrollPos(t,e,y.opt.snapbackspeed);y.onscrollend&&y.scrollrunning&&y.triggerScrollEnd(),y.scrollrunning=!1}):(this.doScrollLeft=function(e,t){var n=y.scrollrunning?y.newscrolly:y.getScrollTop();y.doScrollPos(e,n,t)},this.doScrollTop=function(e,t){var n=y.scrollrunning?y.newscrollx:y.getScrollLeft();y.doScrollPos(n,e,t)},this.doScrollPos=function(e,t,n){function i(){if(y.cancelAnimationFrame)return!0;if(y.scrollrunning=!0,h=1-h)return y.timer=l(i)||1;var e=0,t=sy=y.getScrollTop();if(y.dst.ay){t=y.bzscroll?y.dst.py+y.bzscroll.getNow()*y.dst.ay:y.newscrolly;var n=t-sy;(n<0&&t<y.newscrolly||n>0&&t>y.newscrolly)&&(t=y.newscrolly),y.setScrollTop(t),t==y.newscrolly&&(e=1)}else e=1;var r=sx=y.getScrollLeft();if(y.dst.ax){r=y.bzscroll?y.dst.px+y.bzscroll.getNow()*y.dst.ax:y.newscrollx;var n=r-sx;(n<0&&r<y.newscrollx||n>0&&r>y.newscrollx)&&(r=y.newscrollx),y.setScrollLeft(r),r==y.newscrollx&&(e+=1)}else e+=1;2==e?(y.timer=0,y.cursorfreezed=!1,y.bzscroll=!1,y.scrollrunning=!1,t<0?t=0:t>y.page.maxh&&(t=y.page.maxh),r<0?r=0:r>y.page.maxw&&(r=y.page.maxw),r!=y.newscrollx||t!=y.newscrolly?y.doScrollPos(r,t):y.onscrollend&&y.triggerScrollEnd()):y.timer=l(i)||1}var t=void 0===t||!1===t?y.getScrollTop(!0):t;if(y.timer&&y.newscrolly==t&&y.newscrollx==e)return!0;y.timer&&c(y.timer),y.timer=0;var r=y.getScrollTop(),o=y.getScrollLeft();((y.newscrolly-r)*(t-r)<0||(y.newscrollx-o)*(e-o)<0)&&y.cancelScroll(),y.newscrolly=t,y.newscrollx=e,y.bouncescroll&&y.rail.visibility||(y.newscrolly<0?y.newscrolly=0:y.newscrolly>y.page.maxh&&(y.newscrolly=y.page.maxh)),y.bouncescroll&&y.railh.visibility||(y.newscrollx<0?y.newscrollx=0:y.newscrollx>y.page.maxw&&(y.newscrollx=y.page.maxw)),y.dst={},y.dst.x=e-o,y.dst.y=t-r,y.dst.px=o,y.dst.py=r;var a=Math.round(Math.sqrt(Math.pow(y.dst.x,2)+Math.pow(y.dst.y,2)));y.dst.ax=y.dst.x/a,y.dst.ay=y.dst.y/a;var s=0,u=a;0==y.dst.x?(s=r,u=t,y.dst.ay=1,y.dst.py=0):0==y.dst.y&&(s=o,u=e,y.dst.ax=1,y.dst.px=0);var d=y.getTransitionSpeed(a);if(n&&n<=1&&(d*=n),y.bzscroll=d>0&&(y.bzscroll?y.bzscroll.update(u,d):new BezierClass(s,u,d,0,1,0,1)),!y.timer){(r==y.page.maxh&&t>=y.page.maxh||o==y.page.maxw&&e>=y.page.maxw)&&y.checkContentSize();var h=1;if(y.cancelAnimationFrame=!1,y.timer=1,y.onscrollstart&&!y.scrollrunning){var p={type:"scrollstart",current:{x:o,y:r},request:{x:e,y:t},end:{x:y.newscrollx,y:y.newscrolly},speed:d};y.onscrollstart.call(y,p)}i(),(r==y.page.maxh&&t>=r||o==y.page.maxw&&e>=o)&&y.checkContentSize(),y.noticeCursor()}},this.cancelScroll=function(){return y.timer&&c(y.timer),y.timer=0,y.bzscroll=!1,y.scrollrunning=!1,y}):(this.doScrollLeft=function(e,t){var n=y.getScrollTop();y.doScrollPos(e,n,t)},this.doScrollTop=function(e,t){var n=y.getScrollLeft();y.doScrollPos(n,e,t)},this.doScrollPos=function(e,t,n){var i=e>y.page.maxw?y.page.maxw:e;i<0&&(i=0);var r=t>y.page.maxh?y.page.maxh:t;r<0&&(r=0),y.synched("scroll",function(){y.setScrollTop(r),y.setScrollLeft(i)})},this.cancelScroll=function(){}),this.doScrollBy=function(e,t){var n=0;if(t)n=Math.floor((y.scroll.y-e)*y.scrollratio.y);else{n=(y.timer?y.newscrolly:y.getScrollTop(!0))-e}if(y.bouncescroll){var i=Math.round(y.view.h/2);n<-i?n=-i:n>y.page.maxh+i&&(n=y.page.maxh+i)}return y.cursorfreezed=!1,py=y.getScrollTop(!0),n<0&&py<=0?y.noticeCursor():n>y.page.maxh&&py>=y.page.maxh?(y.checkContentSize(),y.noticeCursor()):void y.doScrollTop(n)},this.doScrollLeftBy=function(e,t){var n=0;if(t)n=Math.floor((y.scroll.x-e)*y.scrollratio.x);else{n=(y.timer?y.newscrollx:y.getScrollLeft(!0))-e}if(y.bouncescroll){var i=Math.round(y.view.w/2);n<-i?n=-i:n>y.page.maxw+i&&(n=y.page.maxw+i)}return y.cursorfreezed=!1,px=y.getScrollLeft(!0),n<0&&px<=0?y.noticeCursor():n>y.page.maxw&&px>=y.page.maxw?y.noticeCursor():void y.doScrollLeft(n)},this.doScrollTo=function(e,t){var n=t?Math.round(e*y.scrollratio.y):e;n<0?n=0:n>y.page.maxh&&(n=y.page.maxh),y.cursorfreezed=!1,y.doScrollTop(e)},this.checkContentSize=function(){var e=y.getContentSize();e.h==y.page.h&&e.w==y.page.w||y.resize(!1,e)},y.onscroll=function(e){y.rail.drag||y.cursorfreezed||y.synched("scroll",function(){y.scroll.y=Math.round(y.getScrollTop()*(1/y.scrollratio.y)),y.railh&&(y.scroll.x=Math.round(y.getScrollLeft()*(1/y.scrollratio.x))),y.noticeCursor()})},y.bind(y.docscroll,"scroll",y.onscroll),this.doZoomIn=function(e){if(!y.zoomactive){y.zoomactive=!0,y.zoomrestore={style:{}};var t=["position","top","left","zIndex","backgroundColor","marginTop","marginBottom","marginLeft","marginRight"],n=y.win[0].style;for(var i in t){var r=t[i];y.zoomrestore.style[r]=void 0!==n[r]?n[r]:""}y.zoomrestore.style.width=y.win.css("width"),y.zoomrestore.style.height=y.win.css("height"),y.zoomrestore.padding={w:y.win.outerWidth()-y.win.width(),h:y.win.outerHeight()-y.win.height()},_.isios4&&(y.zoomrestore.scrollTop=a(window).scrollTop(),a(window).scrollTop(0)),y.win.css({position:_.isios4?"absolute":"fixed",top:0,left:0,"z-index":o+100,margin:"0px"});var s=y.win.css("backgroundColor");return(""==s||/transparent|rgba\(0, 0, 0, 0\)|rgba\(0,0,0,0\)/.test(s))&&y.win.css("backgroundColor","#fff"),y.rail.css({"z-index":o+101}),y.zoom.css({"z-index":o+102}),y.zoom.css("backgroundPosition","0px -18px"),y.resizeZoom(),y.onzoomin&&y.onzoomin.call(y),y.cancelEvent(e)}},this.doZoomOut=function(e){if(y.zoomactive)return y.zoomactive=!1,y.win.css("margin",""),y.win.css(y.zoomrestore.style),_.isios4&&a(window).scrollTop(y.zoomrestore.scrollTop),y.rail.css({"z-index":y.zindex}),y.zoom.css({"z-index":y.zindex}),y.zoomrestore=!1,y.zoom.css("backgroundPosition","0px 0px"),y.onResize(),y.onzoomout&&y.onzoomout.call(y),y.cancelEvent(e)},this.doZoom=function(e){return y.zoomactive?y.doZoomOut(e):y.doZoomIn(e)},this.resizeZoom=function(){if(y.zoomactive){var e=y.getScrollTop();y.win.css({width:a(window).width()-y.zoomrestore.padding.w+"px",height:a(window).height()-y.zoomrestore.padding.h+"px"}),y.onResize(),y.setScrollTop(Math.min(y.page.maxh,e))}},this.init(),a.nicescroll.push(this)},v=function(e){var t=this;this.nc=e,this.lastx=0,this.lasty=0,this.speedx=0,this.speedy=0,this.lasttime=0,this.steptime=0,this.snapx=!1,this.snapy=!1,this.demulx=0,this.demuly=0,this.lastscrollx=-1,this.lastscrolly=-1,this.chkx=0,this.chky=0,this.timer=0,this.time=function(){return+new Date},this.reset=function(e,n){t.stop();var i=t.time();t.steptime=0,t.lasttime=i,t.speedx=0,t.speedy=0,t.lastx=e,t.lasty=n,t.lastscrollx=-1,t.lastscrolly=-1},this.update=function(e,n){var i=t.time();t.steptime=i-t.lasttime,t.lasttime=i;var r=n-t.lasty,o=e-t.lastx,a=t.nc.getScrollTop(),s=t.nc.getScrollLeft(),l=a+r,c=s+o;t.snapx=c<0||c>t.nc.page.maxw,t.snapy=l<0||l>t.nc.page.maxh,t.speedx=o,t.speedy=r,t.lastx=e,t.lasty=n},this.stop=function(){t.nc.unsynched("domomentum2d"),t.timer&&clearTimeout(t.timer),t.timer=0,t.lastscrollx=-1,t.lastscrolly=-1},this.doSnapy=function(e,n){var i=!1;n<0?(n=0,i=!0):n>t.nc.page.maxh&&(n=t.nc.page.maxh,i=!0),e<0?(e=0,i=!0):e>t.nc.page.maxw&&(e=t.nc.page.maxw,i=!0),i?t.nc.doScrollPos(e,n,t.nc.opt.snapbackspeed):t.nc.triggerScrollEnd()},this.doMomentum=function(e){var n=t.time(),i=e?n+e:t.lasttime,r=t.nc.getScrollLeft(),o=t.nc.getScrollTop(),a=t.nc.page.maxh,s=t.nc.page.maxw;t.speedx=s>0?Math.min(60,t.speedx):0,t.speedy=a>0?Math.min(60,t.speedy):0;var l=i&&n-i<=60;(o<0||o>a||r<0||r>s)&&(l=!1);var c=!(!t.speedy||!l)&&t.speedy,u=!(!t.speedx||!l)&&t.speedx;if(c||u){var d=Math.max(16,t.steptime);if(d>50){var h=d/50;t.speedx*=h,t.speedy*=h,d=50}t.demulxy=0,t.lastscrollx=t.nc.getScrollLeft(),t.chkx=t.lastscrollx,t.lastscrolly=t.nc.getScrollTop(),t.chky=t.lastscrolly;var p=t.lastscrollx,f=t.lastscrolly,m=function(){var e=t.time()-n>600?.04:.02;t.speedx&&(p=Math.floor(t.lastscrollx-t.speedx*(1-t.demulxy)),t.lastscrollx=p,(p<0||p>s)&&(e=.1)),t.speedy&&(f=Math.floor(t.lastscrolly-t.speedy*(1-t.demulxy)),t.lastscrolly=f,(f<0||f>a)&&(e=.1)),t.demulxy=Math.min(1,t.demulxy+e),t.nc.synched("domomentum2d",function(){if(t.speedx){t.nc.getScrollLeft()!=t.chkx&&t.stop(),t.chkx=p,t.nc.setScrollLeft(p)}if(t.speedy){t.nc.getScrollTop()!=t.chky&&t.stop(),t.chky=f,t.nc.setScrollTop(f)}t.timer||(t.nc.hideCursor(),t.doSnapy(p,f))}),t.demulxy<1?t.timer=setTimeout(m,d):(t.stop(),t.nc.hideCursor(),t.doSnapy(p,f))};m()}else t.doSnapy(t.nc.getScrollLeft(),t.nc.getScrollTop())}},b=e.fn.scrollTop;e.cssHooks.pageYOffset={get:function(e,t,n){var i=a.data(e,"__nicescroll")||!1;return i&&i.ishwscroll?i.getScrollTop():b.call(e)},set:function(e,t){var n=a.data(e,"__nicescroll")||!1;return n&&n.ishwscroll?n.setScrollTop(parseInt(t)):b.call(e,t),this}},e.fn.scrollTop=function(e){if(void 0===e){var t=!!this[0]&&(a.data(this[0],"__nicescroll")||!1);return t&&t.ishwscroll?t.getScrollTop():b.call(this)}return this.each(function(){var t=a.data(this,"__nicescroll")||!1;t&&t.ishwscroll?t.setScrollTop(parseInt(e)):b.call(a(this),e)})};var y=e.fn.scrollLeft;a.cssHooks.pageXOffset={get:function(e,t,n){var i=a.data(e,"__nicescroll")||!1;return i&&i.ishwscroll?i.getScrollLeft():y.call(e)},set:function(e,t){var n=a.data(e,"__nicescroll")||!1;return n&&n.ishwscroll?n.setScrollLeft(parseInt(t)):y.call(e,t),this}},e.fn.scrollLeft=function(e){if(void 0===e){var t=!!this[0]&&(a.data(this[0],"__nicescroll")||!1);return t&&t.ishwscroll?t.getScrollLeft():y.call(this)}return this.each(function(){var t=a.data(this,"__nicescroll")||!1;t&&t.ishwscroll?t.setScrollLeft(parseInt(e)):y.call(a(this),e)})};var w=function(e){var t=this;if(this.length=0,this.name="nicescrollarray",this.each=function(e){for(var n=0,i=0;n<t.length;n++)e.call(t[n],i++);return t},this.push=function(e){t[t.length]=e,t.length++},this.eq=function(e){return t[e]},e)for(var n=0;n<e.length;n++){var i=a.data(e[n],"__nicescroll")||!1;i&&(this[this.length]=i,this.length++)}return this};!function(e,t,n){for(var i=0;i<t.length;i++)n(e,t[i])}(w.prototype,["show","hide","toggle","onResize","resize","remove","stop","doScrollPos"],function(e,t){e[t]=function(){var e=arguments;return this.each(function(){this[t].apply(this,e)})}}),e.fn.getNiceScroll=function(e){return void 0===e?new w(this):this[e]&&a.data(this[e],"__nicescroll")||!1},e.extend(e.expr[":"],{nicescroll:function(e){return!!a.data(e,"__nicescroll")}}),a.fn.niceScroll=function(e,t){void 0===t&&("object"!=typeof e||"jquery"in e||(t=e,e=!1));var n=new w;void 0===t&&(t={}),e&&(t.doc=a(e),t.win=a(this));var i=!("doc"in t);return i||"win"in t||(t.win=a(this)),this.each(function(){var e=a(this).data("__nicescroll")||!1;e||(t.doc=i?a(this):t.doc,e=new g(t,a(this)),a(this).data("__nicescroll",e)),n.push(e)}),1==n.length?n[0]:n},window.NiceScroll={getjQuery:function(){return e}},a.nicescroll||(a.nicescroll=new w,a.nicescroll.options=p)});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/sidebar/dropdown.directive",["require","exports","vendor/text!ts/modules/emailbuilder/sidebar/dropdown.directive.html","angular","underscore","postal","vendor/jquery.nicescroll"],function(e,t,n,i,r,o){"use strict";function a(e){return r.default.isObject(e)}Object.defineProperty(t,"__esModule",{value:!0}),i=__importDefault(i),r=__importDefault(r),o=__importDefault(o);var s=function(){function e(){var e=this;this.restrict="A",this.template=n,this.require="ngModel",this.scope={csDropdown:"=",csDropdownClass:"@"},this.link=function(t,n,o,s){n.data("dropdown",!0);var l=n.find(".emb-js-select-container"),c=n.find(".emb-js-select-wrapper"),u=function(){return!!(t.csDropdown&&t.csDropdown.length>0&&r.default.isObject(t.csDropdown[0]))};t.open=!1,t.mousedown=!1,t.$watch("csDropdown",function(n){if(n){var i=u();t.dropdownType=i?"object":"primitive",e.initialize(l),e.updateCurrentDisplay(t,i)}}),e.channel.subscribe("collapse",function(){t.open&&(t.open=!1)});var d=function(e){i.default.element(e.target).inheritedData("dropdown")||(t.toggleOpen(),i.default.element("body").off("mousedown",d))};t.handleClicksOutside=d,t.toggleOpen=function(){t.open?i.default.element("body").off("mousedown",d):(i.default.element("body").on("mousedown",d),e.channel.publish("collapse")),t.open=!t.open},t.$watch("currentValue",function(e){s.$setViewValue(e)}),t.setValue=function(e){t.currentValue=a(e)?e.value:e,t.currentDisplay=a(e)?e.display:e},t.scrollToCurrentSelection=function(){var e=c.find("[data-value='"+t.currentValue+"']");e.length<1||l.scrollTop(l.scrollTop()+e.position().top)},t.$watch("open",function(){if(t.open&&t.currentValue)t.scrollToCurrentSelection();else if(!t.open){var n=c.find("[data-selected='true']");e.reselectCurrentValue(n,c,t)}}),t.keyDown=function(n){e.handleKeyDown(n,t,c,l)};var h=function(e){t.open&&t.keyDown(e)};try{l.parents("body").keydown(h)}catch(e){}var p=n.attr("cs-dropdown-display-when-empty")||"";s.$render=function(){if(t.currentValue=s.$viewValue,u()){var e=t.csDropdown.filter(function(e){return e.value===t.currentValue});return void(e.length>0?t.currentDisplay=e[0].display:t.currentDisplay=p)}t.currentDisplay=s.$viewValue||p}},this.initialize=function(e){"Win32"===navigator.platform?e.niceScroll({autohidemode:!0,cursoropacitymin:.25,cursoropacitymax:.6,cursorcolor:"#000",cursorwidth:"8px",horizrailenabled:!1,cursorborder:"2px solid transparent",cursorborderradius:"10px",enablekeyboard:!1}):e.css("overflow-y","auto")},this.updateCurrentDisplay=function(e,t){if(t){var n=e.csDropdown.filter(function(t){return t.value===e.currentValue});n.length>0&&(e.currentDisplay=n[0].display)}},this.handleKeyDown=function(t,n,r,o){var a=t.key,s=t.keyCode;if(0!==s){a||(a=String.fromCharCode(s));var l=r.find("[data-selected='true']");if(27===s||9===s)n.open&&n.toggleOpen(),e.reselectCurrentValue(l,r,n);else if(a.match("^[a-zA-Z0-9]$")){var c=r.children().filter(function(e,t){return!!t.textContent.match(new RegExp("^"+a,"i"))});if(c.length>0){var u=e.getNextIndexFromMatchesWithWrap(c,l),d=i.default.element(c[u]);e.selectNewOption(l,d,o),n.open||e.saveToSelectedOption(n,d)}}else if(n.open)if(38===s||40===s){var h=l.attr("data-index"),p=parseInt(h,10)+(38===s?-1:1);if(p>=0&&p<r.children().length){
var d=r.find("[data-index='"+p+"']");e.selectNewOption(l,d,o)}}else 32!==s&&13!==s||(n.toggleOpen(),e.saveToSelectedOption(n,l));else 32!==s&&38!==s&&40!==s||n.toggleOpen();t.stopPropagation()}},this.reselectCurrentValue=function(e,t,n){e.attr("data-selected","false"),t.find("[data-value='"+n.currentValue+"']").attr("data-selected","true")},this.getNextIndexFromMatchesWithWrap=function(e,t){for(var n=-1,i=0;i<e.length;i++)if(e[i].getAttribute("data-value")===t.attr("data-value")){n=i;break}return n++,n>=e.length&&(n=0),n},this.saveToSelectedOption=function(e,t){var n=t.attr("data-value");if(e.currentValue!==n){var i=t.attr("data-display");e.setValue({value:n,display:i})}},this.selectNewOption=function(e,t,n){e.attr("data-selected","false"),t.attr("data-selected","true");var i=t.position().top,r=t.height(),o=n.scrollTop(),a=n.height();if(i<0)n.scrollTop(o+i);else if(i+r>a){var s=i+r,l=s-a+o;n.scrollTop(l)}},this.channel=o.default.channel("DropdownEvents")}return e.factory=function(){return new e},e}();t.Dropdown=s}),define("ts/modules/emailbuilder/sidebar/save-on-model-change.directive",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){var t=this;this.require="ngModel",this.link=function(e,n,i,r){r.$viewChangeListeners.push(t.modelActivityService.contentUpdated)},this.modelActivityService=e}return e.factory=function(t){return new e(t)},e}();t.SaveOnModelChange=n}),define("ts/modules/emailbuilder/sidebar/video-thumbnail.service",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n,i,r){void 0===r&&(r=null),this.videoProvider=e,this.validVideoSelected=t,this.thumbnailUrl=n,this.href=i,this.errorCode=r}return e}();t.VideoResult=n;var i="https://integrationstore-b0c3f53658fe7a75.microservice.createsend.com/files/9392B9D9-F380-42FC-9571-7E109B7A1C26/youtube-play-button-overlay.png",r=function(){function e(e,t){var r=this;this.youtubeGenericThumbnail="https://integrationstore-b0c3f53658fe7a75.microservice.createsend.com/files/A51932BB-F808-4E3E-A836-4DA42666AA0B/youtube-placeholder-image.svg",this.vimeoGenericThumbnail="https://integrationstore-b0c3f53658fe7a75.microservice.createsend.com/files/93328B6D-7FFD-4C31-8C82-D916264F2847/vimeo-placeholder-image.svg",this.getVideoThumbnailUrl=function(e,t){var n=r.$q.defer();if(!t)return n.reject(r.getFailedVideoResult(e,null,null,null)),n.promise;var i=/(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/ ]{11})/i,o=t.match(i);if(o){var a=o[1];return r.getYoutubeThumbnailUrl(t,a,n)}return t.match(/.*vimeo\.com.*/i)?r.getVimeoThumbnailUrl(t,n):(n.reject(r.getFailedVideoResult(e,"videoNotSupportedLink",null,null)),n.promise)},this.getYoutubeThumbnailUrl=function(e,t,n){var o="https://i.vimeocdn.com/filter/overlay?src=http://img.youtube.com/vi/"+t+"/0.jpg&src="+i;return n.resolve(r.getSuccessfulVideoResult("youtube",o,e)),n.promise},this.getVimeoThumbnailUrl=function(e,t){var n=/https?:\/\/(?:www\.|player\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|album\/(\d+)\/video\/|video\/|)(\d+)(?:$|\/|\?)/i,i=e.match(n);if(!i)return t.reject(r.getFailedVideoResult("vimeo","videoNotSupportedLink",r.vimeoGenericThumbnail,"https://www.vimeo.com")),t.promise;var o=i[3];return r.getVimeoVideoResult(o,e,t)},this.getVimeoVideoResult=function(e,t,n){var i="https://vimeo.com/api/oembed.json?width=600&url=https%3A%2F%2Fvimeo.com%2F"+e;return r.$http.get(i).then(function(e){var i=e.data.thumbnail_url_with_play_button;i?(i=r.getCorrectedVimeoThumbnailUrl(e.data,i),n.resolve(r.getSuccessfulVideoResult("vimeo",i,t))):n.reject(r.getFailedVideoResult("vimeo","videoNotFoundLink",null,t))},function(){n.reject(r.getFailedVideoResult("vimeo","videoNotFoundLink",r.vimeoGenericThumbnail,t))}),n.promise},this.getCorrectedVimeoThumbnailUrl=function(e,t){var n=e.width,i=e.height;if(i>480){var r=n/i;n=Math.ceil(480*r),i=480}var o="_"+n+"x"+i,a=/_([0-9]+)(x)?([0-9]+)?/;return t.replace(a,o)},this.getSuccessfulVideoResult=function(e,t,i){return new n(e,!0,t,i)},this.getFailedVideoResult=function(e,t,i,r){return new n(e,!1,i,r,t)},this.$q=e,this.$http=t}return e}();t.VideoThumbnailService=r}),define("vendor/text!ts/modules/emailbuilder/sidebar/image-dimensions.directive.html",[],function(){return"<div>\n    <div class='image-dimensions'>{{master}} &times; {{slave}}</div>\n</div>"}),define("ts/modules/emailbuilder/sidebar/image-dimensions.directive",["require","exports","vendor/text!ts/modules/emailbuilder/sidebar/image-dimensions.directive.html"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){var e=this;this.restrict="A",this.template=n,this.scope={master:"=embImageDimensions",slave:"=embImageDimensionsSlave",numerator:"=embImageDimensionsNumerator",denominator:"=embImageDimensionsDenominator"},this.link=function(t){t.$watch("master",function(){t.slave=e.calculateSlave(t.master,t.numerator,t.denominator)})},this.calculateSlave=function(e,t,n){return Math.round(e*t/n)}}return e.factory=function(){return new e},e}();t.ImageDimensions=i}),define("ts/modules/emailbuilder/sidebar/sync-href.directive",["require","exports","../string-utils"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){var t=this;this.restrict="A",this.scope={embSyncHref:"="},this.priority=100,this.link=function(e,i,r){var o=r.targetmodel||"href",a="temp"+n.upperCaseFirstLetter(o);e.$watch("embSyncHref."+a+".raw",function(t){void 0!==t&&(e.embSyncHref[o]=t)});var s=function(e){void 0!==e[o]&&(e[a]=t.linkModelProviderService.getModelFor(e[o]||""))};e.$watch("embSyncHref",function(e){e&&!e[a]&&s(e)}),e.$on("undo:modelChanged",function(){e.embSyncHref&&s(e.embSyncHref)})},this.linkModelProviderService=e}return e.factory=function(t){return new e(t)},e}();t.SyncHref=i});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/sidebar/select-group.directive",["require","exports","angular"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=__importDefault(n);var i=function(){function e(){this.restrict="A",this.require="ngModel",this.link=function(e,t,i,r){var o,a=t.children("[data-value]");r.$render=function(){o&&o.removeClass("emb-selected"),o=a.filter('[data-value="'+r.$modelValue+'"]').addClass("emb-selected")},a.click(function(e){if(e.preventDefault(),o){if(o.is(e.currentTarget))return;o.removeClass("emb-selected")}o=n.default.element(e.currentTarget).addClass("emb-selected"),r.$setViewValue(o.data("value"))})}}return e.factory=function(){return new e},e}();t.SelectGroup=i}),define("vendor/text!ts/modules/emailbuilder/sidebar/section-spacing-properties.directive.html",[],function(){return'<ul ng-if="$ctrl.layoutspacing" class="l-grid l-grid--inline-block l-grid--vertical-spacing">\n    <li class="l-grid__item" ng-class="$ctrl.isSingleColumn() ? \'l-grid__item--50\' : \'l-grid__item--75\'">\n        <cm-segmented-control\n          group-name="layout"\n          ng-model="$ctrl.layoutMode"\n          ng-class="{ \'c-segmented-control--layout\': true, \'is-single-column\': $ctrl.isSingleColumn() }"\n          group-legend="Layout"\n          group-class-name="c-segmented-control--layout-multi"\n          on-select="$ctrl.selectionChanged()"\n          emb-save-on-model-change>\n            <cm-segmented-control-item\n              item-name="Full width"\n              item-value="fullWidth"\n              segment-id="edgetoedge"\n              class-names="{{$ctrl.isSingleColumn() ? \'c-segmented-control--layout-single-full\' :\'c-segmented-control--layout-multi-full\'}}">\n            </cm-segmented-control-item>\n            <cm-segmented-control-item\n              item-name="Fixed width"\n              item-value="fixedWidth"\n              segment-id="normal"\n              class-names="{{$ctrl.isSingleColumn() ? \'c-segmented-control--layout-single-fixed\' :\'c-segmented-control--layout-multi-fixed\'}}">\n            </cm-segmented-control-item>\n            <cm-segmented-control-item\n              item-name="Separate"\n              ng-hide="$ctrl.isSingleColumn()"\n              item-value="spacing"\n              segment-id="spacing"\n              class-names="c-segmented-control--layout-multi-gutter">\n            </cm-segmented-control-item>\n        </cm-segmented-control>\n    </li>\n\n    <li ng-if="$ctrl.mobileStackingEnabled" class="l-grid__item l-grid__item--100">\n      <div class="u-pos-relative">\n        <label class="c-sidebar__label" aria-label="on mobile">On mobile</label>\n        <div cs-dropdown="$ctrl.mobileStackingOptions" ng-model="$ctrl.mobileStackingSelectedOption" ng-change="$ctrl.onMobileStackingChanged()" emb-save-on-model-change cs-dropdown-class="qa-mobile-stacking-dropdown"></div>\n        <p class="c-sidebar__text l-gap--top-medium">\n          You can see how the mobile view looks in the <a href="#/preview">Preview</a> step.\n        </p>\n      </div>\n    </li>\n\n    <li class="l-grid__item l-grid__item--100">\n      <div class="u-pos-relative">\n        <label class="c-sidebar__label">Bottom spacing</label>\n        <div class="c-sidebar__label c-sidebar__label--slider">\n            <div>{{$ctrl.section.settings.verticalSpacing}}</div>\n        </div>\n\n        <div cs-slider-value="$ctrl.section.settings.verticalSpacing"\n             cs-slider="$ctrl.section.settings.verticalSpacing"\n             cs-slider-min="0" cs-slider-max="$ctrl.maxVerticalSpacingValue"\n             ng-model="$ctrl.section.settings.verticalSpacing"\n             data-steps="1">\n        </div>\n      </div>\n\n    </li>\n</ul>'}),define("ts/modules/emailbuilder/sidebar/section-spacing-properties.controller",["require","exports","../services/analytics.service"],function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.singleColumnIdName="1-col";var r=(i={},i.stackcolumns="Stack Columns",i.stackcolumnsreverse="Stack Columns In Reverse",i.sidebyside="Keep Side By Side",i),o=function(){function e(e,i,o,a){var s=this;this.isMobileStackingEnabled=function(){return s.config.email.isBlueprint&&!s.isSingleColumn()&&s.config.mobileStackingEnabled},this.$onInit=function(){s.mobileStackingEnabled=s.isMobileStackingEnabled(),s.layoutMode=s.sectionIdService.idToProperties(s.section.id),s.mobileStackingSelectedOption=s.sectionStackingService.getMobileStackingType(s.section)},this.selectionChanged=function(){s.section.id=s.sectionIdService.propertiesToId(s.section.id,s.layoutMode),s.section.content.forEach(function(e,t){e.content.forEach(function(e){e.tempContainer&&(e.tempContainer.sectionID=s.section.id)})})},this.isSingleColumn=function(){return!(!s.section||!s.section.id||0!==s.section.id.indexOf(t.singleColumnIdName))},this.onMobileStackingChanged=function(){s.sectionStackingService.setMobileStackingType(s.section,s.mobileStackingSelectedOption);var e=r[s.mobileStackingSelectedOption],t={eventName:n.AnalyticsEventName.UsedSetting,publicProperties:{"Mobile Column Stacking":e}};s.analyticsService.trackClientLevel(t)},this.getMobileStackingDropdownItems=function(){return[{display:"Stack columns",value:"stackcolumns",description:""},{display:"Stack columns in reverse",value:"stackcolumnsreverse",description:""},{display:"Keep side by side",value:"sidebyside",description:""}]},this.sectionIdService=e,this.sectionStackingService=i,this.config=o,this.maxVerticalSpacingValue=o.settings.maxVerticalSpacingValue,this.mobileStackingOptions=this.getMobileStackingDropdownItems(),this.analyticsService=a}return e}();t.SectionSpacingPropertiesController=o}),define("ts/modules/emailbuilder/sidebar/section-spacing-properties.directive",["require","exports","vendor/text!ts/modules/emailbuilder/sidebar/section-spacing-properties.directive.html","./section-spacing-properties.controller"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this.restrict="E",this.template=n,this.scope={section:"=",layoutspacing:"="},this.controller=["SectionIdService","SectionStackingService","EmailBuilderConfig","AnalyticsService",i.SectionSpacingPropertiesController],this.controllerAs="$ctrl",this.bindToController=!0}return e.factory=function(){return new e},e}();t.SectionSpacingProperties=r}),define("vendor/text!ts/modules/emailbuilder/sidebar/image-focal-point-selector.component.html",[],function(){return'<label class="c-sidebar__label">Focal point</label>\r\n<div class="c-focal-point-selector" ng-keydown="$ctrl.handleKeydown($event);" ng-keyup="$ctrl.handleKeyup($event);">\r\n    <div class="js-focal-point-container c-focal-point-selector_stage qa-focal-point-picker" tabindex="0" ng-blur="$ctrl.saveOnBlur()" ng-style="$ctrl.getContainerStyle()" ng-mousedown="$ctrl.handleMousedown($event);" ng-mousemove="$ctrl.handleMousemove($event);">\r\n        <div class="focal-point-selector_select" ng-style="$ctrl.getHandleStyle()"></div>\r\n        <div ng-show="$ctrl.dragging && $ctrl.showCenterX" class="focal-point-selector_xline"></div>\r\n        <div ng-show="$ctrl.dragging && $ctrl.showCenterY" class="focal-point-selector_yline"></div>\r\n    </div>\r\n</div>\r\n<p class="c-sidebar__text l-gap--top-medium">\r\n    Specify the main part of the image so it doesnt get cut out on mobile devices.\r\n</p>'});var __assign=this&&this.__assign||function(){return __assign=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},__assign.apply(this,arguments)};define("ts/modules/emailbuilder/sidebar/image-focal-point-selector.controller",["require","exports","../services/analytics.service"],function(e,t,n){"use strict";function i(e,t,n){return Math.max(Math.min(e,n),t)}function r(e,t){return e>t-1&&e<t+1}function o(e,t){return Math.round(e/t*100)}function a(e,t){return e/100*t}Object.defineProperty(t,"__esModule",{value:!0});var s=260,l=100,c=s/l,u=function(){function e(e,t,n,u,d,h){var p=this;this.updatePosition=function(e,t){var n=p.getThumbnailWidth(),a=p.getThumbnailHeight(),s=i(e,0,n),l=i(t,0,a);p.offsetX=s,p.offsetY=l,p.showCenterX=r(p.offsetX,n/2),p.showCenterY=r(p.offsetY,a/2),p.model.position={xPercent:o(s,n),yPercent:o(l,a)}},this.calculateRelativePosition=function(e){var t=p.$element.find(".js-focal-point-container"),n=t.offset();return{x:e.clientX-n.left,y:e.clientY-n.top}},this.handleMousedown=function(e){p.dragging=!0;var t=p.calculateRelativePosition(e);p.updatePosition(t.x,t.y);var n=$(p.$window),i=function(e){p.$scope.$apply(function(){p.handleMousemove(e)})},r=function(e){n.off("mouseup",r),n.off("mousemove",i),p.dragging=!1};n.on("mouseup",r),n.on("mousemove",i)},this.handleMousemove=function(e){if(p.dragging){var t=p.calculateRelativePosition(e);p.updatePosition(t.x,t.y)}},this.arrowHandling=function(e){switch(e){case"Down":case"ArrowDown":return p.updatePosition(p.offsetX,p.offsetY+1),!0;case"Up":case"ArrowUp":return p.updatePosition(p.offsetX,p.offsetY-1),!0;case"Left":case"ArrowLeft":return p.updatePosition(p.offsetX-1,p.offsetY),!0;case"Right":case"ArrowRight":return p.updatePosition(p.offsetX+1,p.offsetY),!0}return!1},this.handleKeydown=function(e){p.dragging=!0,p.arrowHandling(e.key)&&(e.stopPropagation(),e.preventDefault())},this.handleKeyup=function(e){p.dragging=!1},this.getImageAspectRatio=function(){return p.model.originalWidth/p.model.originalHeight},this.isWidthConstrained=function(){return c<p.getImageAspectRatio()},this.getThumbnailWidth=function(){return p.isWidthConstrained()?s:l*p.getImageAspectRatio()},this.getThumbnailHeight=function(){return p.isWidthConstrained()?s/p.getImageAspectRatio():l},this.getHandleStyle=function(){return{top:p.offsetY,left:p.offsetX}},this.getContainerStyle=function(){return{"background-image":"url("+p.contentBlockService.getBlockSrc(p.model)+")",height:p.getThumbnailHeight(),width:p.getThumbnailWidth()}},this.$onInit=function(){p.model.position&&(p.offsetX=a(p.model.position.xPercent,p.getThumbnailWidth()),p.offsetY=a(p.model.position.yPercent,p.getThumbnailHeight()),p.initialPosition=__assign({},p.model.position))},this.saveOnBlur=function(){var e=p.initialPosition,t=e.xPercent,n=e.yPercent;!p.model.position||t===p.model.position.xPercent&&n===p.model.position.yPercent||(p.modelActivityService.contentUpdated(),p.initialPosition=__assign({},p.model.position),p.trackBackgroundImagePositionSelection())},this.$window=e,this.contentBlockService=t,this.$element=n,this.$scope=u,this.modelActivityService=d,this.analyticsService=h,this.offsetX=0,this.offsetY=0,this.initialPosition={xPercent:0,yPercent:0},this.showCenterX=!1,this.showCenterY=!1,this.dragging=!1}return e.prototype.trackBackgroundImagePositionSelection=function(){var e={eventName:n.AnalyticsEventName.UsedSetting,publicProperties:{"Section Background Position":!0}};this.analyticsService.trackClientLevel(e)},e}();t.ImageFocalPointSelectorController=u}),define("ts/modules/emailbuilder/sidebar/image-focal-point-selector.component",["require","exports","vendor/text!ts/modules/emailbuilder/sidebar/image-focal-point-selector.component.html","./image-focal-point-selector.controller"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this.template=n,this.controller=["$window","ContentBlockService","$element","$scope","ModelActivityService","AnalyticsService",i.ImageFocalPointSelectorController],this.bindings={model:"<"}}return e}();t.ImageFocalPointSelector=r});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/sidebar/sidebar.module",["require","exports","angular","./background-email-image-uploader.directive","./background-layout-image-uploader.directive","./button-properties.directive","./code-properties.directive","./crop-stage.animation","./footer-properties.directive","./general-properties.directive","./header-settings.directive","./image-block-uploader.directive","./image-properties.directive","./image-crop-properties.directive","./section-properties.directive","./segments.directive","./sidebar.directive","./sidebar.animation","./sidebar-settings.directive","./thumbnail.service","./sidebar.controller","./countdown-properties.directive","./countdown-properties-expiry-date.directive","./get-feedback-metrics.service","./text-trim.service","./checkbox.directive","./reverse-checkbox.directive","./sidebar-accordion.animation","./scroll-container-if.directive","./update-style.directive","./video-properties.directive","./video-embedder.directive","./dropdown.directive","./save-on-model-change.directive","./video-thumbnail.service","./image-dimensions.directive","./sync-href.directive","./select-group.directive","./section-spacing-properties.directive","./image-focal-point-selector.component","./section-stacking.service","vendor/angular-animate"],function(e,t,n,i,r,o,a,s,l,c,u,d,h,p,f,m,g,v,b,y,w,_,S,k,x,C,I,P,T,E,M,D,$,B,A,L,O,F,j,R,N){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=__importDefault(n);var z=n.default.module("emailbuilder.sidebar",["ngAnimate"]);t.module=z,z.directive("embBackgroundEmailImageUploader",["$rootScope","ThumbnailService","ImageBuilderService","StyleFactoryService","ContentBlockService",i.BackgroundEmailImageUploader.factory]),z.directive("embBackgroundLayoutImageUploader",["$rootScope","ThumbnailService","StyleFactoryService","EmailService","ContentBlockService","AnalyticsService","EmailBuilderConfig",r.BackgroundLayoutImageUploader.factory]),z.directive("embButtonProperties",["LockLevelService","EmailBuilderConfig",o.ButtonProperties.factory]),z.directive("embCodeProperties",["EmailBuilderConfig",a.CodeProperties.factory]),z.directive("embFooterProperties",["$rootScope","EmailService","LockLevelService","EmailBuilderConfig","TrackingSnapshotCompareService","AnalyticsService","EmailModelComparisonService",l.FooterProperties.factory]),z.animation(".js-crop-area",["$window",s.CropStageAnimation]),z.directive("embGeneralProperties",["LockLevelService","EmailBuilderConfig",c.GeneralProperties.factory]),z.directive("embHeaderSettings",["LockLevelService","AnalyticsService","EmailBuilderConfig",u.HeaderSettings.factory]),z.directive("embImageBlockUploader",["$rootScope","ThumbnailService","ImageBuilderService","ContentBlockService","EmailBuilderConfig",d.ImageBlockUploader.factory]),z.directive("embImageProperties",["$rootScope","EmailService","ItemWidthService","LockLevelService","ContentBlockService","EmailBuilderConfig","FileExtensionService","AnalyticsService",h.ImageProperties.factory]),z.directive("embImageCropProperties",["$rootScope","EmailBuilderConfig","$timeout","$window","CropAreaCalculatorService","FileExtensionService","AnalyticsService",p.ImageCropProperties.factory]),z.directive("embCountdownProperties",["EmailBuilderConfig",_.CountdownProperties.factory]),z.directive("embCountdownPropertiesExpiryDate",["CountdownDateService",S.CountdownPropertiesExpiryDate.factory]),z.directive("embSectionProperties",["$rootScope","EmailBuilderConfig","LockLevelService","ViewPortService",f.SectionProperties.factory]),z.directive("embSegments",["EmailService","TextTrimService","EmailBuilderConfig","ModelActivityService",m.Segments.factory]),z.directive("embSidebar",g.Sidebar.factory),z.animation(".emb-sidebar-anim",v.SidebarAnimation),z.directive("embSidebarSettings",["$rootScope","ContentBlockService","EmailBuilderConfig","AnalyticsService",b.SidebarSettings.factory]),z.directive("csCheckbox",["$rootScope","$timeout",C.Checkbox.factory]),z.directive("csReverseCheckbox",["$rootScope","$timeout",I.ReverseCheckbox.factory]),z.directive("embScrollContainerIf",[T.ScrollContainerIf.factory]),z.directive("embUpdateStyle",["DynamicStylesService","$parse","$timeout","$rootScope","EmailBuilderConfig",E.UpdateStyle.factory]),z.directive("csDropdown",[$.Dropdown.factory]),z.directive("embVideoEmbedder",["ThumbnailService","ContentBlockService","ImageBuilderService","VideoThumbnailService",D.VideoEmbedder.factory]),z.directive("embSectionSpacingProperties",[j.SectionSpacingProperties.factory]),z.directive("embVideoProperties",["EmailService","LockLevelService","AnalyticsService",M.VideoProperties.factory]),z.directive("embSaveOnModelChange",["ModelActivityService",B.SaveOnModelChange.factory]),z.directive("embImageDimensions",[L.ImageDimensions.factory]),z.directive("embSyncHref",["LinkModelProviderService",O.SyncHref.factory]),z.component("embImageFocalPointSelector",new R.ImageFocalPointSelector),z.service("GetFeedbackMetricsService",["$http","EmailBuilderConfig",k.GetFeedbackMetricsService]),z.service("ThumbnailService",["ContentBlockService","EmailBuilderConfig",y.ThumbnailService]),z.service("TextTrimService",[x.TextTrimService]),z.service("VideoThumbnailService",["$q","$http",A.VideoThumbnailService]),z.service("SectionStackingService",[N.SectionStackingService]),z.controller("SidebarController",["$scope","$rootScope","LockLevelService","EmailBuilderConfig",w.SidebarController]),z.animation(".emb-accordion-item",P.SidebarAccordionAnimation),z.directive("embSelectGroup",F.SelectGroup.factory)}),define("vendor/text!ts/modules/emailbuilder/toolbar/content-toolbar.directive.html",[],function(){return'<div class="c-content-toolbar">\n    <div class="c-content-toolbar__inner" ng-if="block.isActive">\n        <div class="c-content-toolbar__item c-toolbar__item-information" ng-show="!isShowingConfirmation">\n            <a href="https://www.campaignmonitor.com/resources/guides/how-to-use-behavioral-code-block-for-developers/" target="_blank" class="c-toolbar__item-information-link">What is this?</a>\n        </div>\n        <div class="c-content-toolbar__item" ng-show="!isShowingConfirmation">\n            <button class="c-toolbar__button qa-view-sample-events-button" type="button" ng-click="viewSampleEvent()">\n                Edit sample event data\n            </button>\n        </div>\n        <emb-toolbar-delete-button button-label="{{deleteButtonLabel}}" block="block" toggle="toggleConfirmation"></emb-toolbar-delete-button>\n    </div>\n</div>'}),define("ts/modules/emailbuilder/toolbar/content-toolbar.directive",["require","exports","vendor/text!ts/modules/emailbuilder/toolbar/content-toolbar.directive.html"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t,i){var r=this;this.deleteButtonLabel="Delete block",this.scope={block:"=block"},this.restrict="E",this.template=n,this.link=function(e,t,n){e.deleteButtonLabel=r.deleteButtonLabel,e.isShowingConfirmation=!1,e.toggleConfirmation=function(){e.isShowingConfirmation=!e.isShowingConfirmation,e.$broadcast("setConfirmation",e.isShowingConfirmation)},e.viewSampleEvent=function(){null!=r.emailBuilderConfig.urls.sampleEventPageUrl&&0!==r.emailBuilderConfig.urls.sampleEventPageUrl.length&&r.$window.open(r.emailBuilderConfig.urls.sampleEventPageUrl,"_blank")},r.$rootScope.$on("content:deactivated",function(t,n){r.reset(e)})},this.reset=function(e){e.isShowingConfirmation=!1,e.$broadcast("setConfirmation",e.isShowingConfirmation)},this.$rootScope=e,this.$window=t,this.emailBuilderConfig=i}return e.factory=function(t,n,i){return new e(t,n,i)},e}();t.ContentToolbar=i}),define("vendor/text!ts/modules/emailbuilder/toolbar/toolbar-delete-button.directive.html",[],function(){return'<div class="c-content-toolbar__item">\n    <div class="c-toolbar__delete-container">\n        <button class="c-toolbar__button qa-toolbar-delete-button" type="button" ng-click="toggleConfirmation()" ng-hide="showingDeleteConfirmation">\n            {{buttonLabel}}\n        </button>\n        <div ng-show="showingDeleteConfirmation">\n            <strong class="c-toolbar__delete-container-text">Do you really want to delete?</strong>\n            <button class="c-toolbar__button qa-confirm-delete" type="button" ng-click="remove(); $event.preventDefault()">Yes</button>\n            <button class="c-toolbar__button" type="button" ng-click="toggleConfirmation(); $event.stopPropagation()">No</button>\n        </div>\n    </div>\n</div>'}),define("ts/modules/emailbuilder/toolbar/toolbar-delete-button.directive",["require","exports","vendor/text!ts/modules/emailbuilder/toolbar/toolbar-delete-button.directive.html"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){var i=this;this.scope={block:"=block",buttonLabel:"@",toggleConfirmation:"=toggle"},this.restrict="E",this.template=n,this.require="^^embDropzone",this.link=function(e,t,n,r){e.showingDeleteConfirmation=!1;var o=r.getLocation();e.$on("setConfirmation",function(t,n){e.showingDeleteConfirmation=n}),e.remove=function(){e.block.isActive&&i.$rootScope.$emit("content:deactivate"),i.emailService.removeContent(o,e.block)}},this.$rootScope=e,this.emailService=t}return e.factory=function(t,n){return new e(t,n)},e}();t.ToolbarDeleteButton=i});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/toolbar/toolbar.module",["require","exports","angular","./content-toolbar.directive","./toolbar-delete-button.directive"],function(e,t,n,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=__importDefault(n);var o=n.default.module("emailbuilder.toolbar",[]);t.module=o,o.directive("embContentToolbar",["$rootScope","$window","EmailBuilderConfig",i.ContentToolbar.factory]),o.directive("embToolbarDeleteButton",["$rootScope","EmailService",r.ToolbarDeleteButton.factory])}),define("ts/modules/emailbuilder/components/focus.directive",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){var t=this;this.restrict="A",this.link=function(e,n,i){var r=i.selectWhen;e.$watch(i.csFocus,function(e){e&&(setTimeout(function(){var e=r&&r===n.val();n[e?"select":"focus"](),t.$rootScope.focusFromOurDirective=!1},200),t.$rootScope.focusFromOurDirective=!0)})},this.$rootScope=e}return e.factory=function(t){return new e(t)},e}();t.Focus=n}),define("ts/modules/emailbuilder/components/prevent-backspace-back.directive",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){var t=this;this.restrict="A",this.link=function(){t.$window.addEventListener("keydown",function(e){var t=e.target;8===e.keyCode&&("true"!==t.contentEditable&&"textarea"!==t.localName&&"input"!==t.localName||"input"===t.localName&&!0===t.readOnly)&&e.preventDefault()})},this.$window=e}return e.factory=function(t){return new e(t)},e}();t.PreventBackspaceBack=n}),define("vendor/text!ts/modules/emailbuilder/components/colorpicker.directive.html",[],function(){return'<div class="c-colorpicker__combined-container ff-recent-colors" ng-class="{\'emb-active\': isOpen, \'emb-upward\': isUpward }">\n    <div class="c-colorpicker__swatch-container js-color-swatch">\n        <div class="c-colorpicker__swatch color-swatch" ng-style="{\'background-color\': swatchColor}"></div>\n    </div>\n    <input aria-label="Input color" class="c-colorpicker__input js-colorpicker-input" spellcheck="false" type="text" maxlength="7" ng-model="selectedColor" ng-change="updateColorFromTextbox(selectedColor);">\n    <div class="c-colorpicker__block-container js-colorpicker-block-container">\n        <div class="c-colorpicker__block emb-color-selector">\n            <div class="c-colorpicker__recent js-recent-colors">\n                <h4 class="c-colorpicker__recent-label">Recent colors</h4>\n                <ul class="c-colorpicker__colors-list">\n                    <li class="c-colorpicker__colors-list-item" ng-repeat="recentColor in recentlyUsedColors | limitTo:8 track by $index">\n                        <button aria-label="Recent color #{{recentColor}}" class="c-colorpicker__saved-color" ng-style="{ \'background-color\': \'#\' + recentColor }" ng-click="$event.preventDefault();updateColorFromTextbox(recentColor);"></button>\n                    </li>\n                    <li class="c-colorpicker__colors-list-item" ng-if="colorpicker-add">\n                        <button aria-label="Saved color" class="c-colorpicker__saved-color" style="background-color: #1366b6;">\n                            <span class="c-colorpicker__add-color">\n                                <svg class="c-icon c-icon--cross" width="8" height="8">\n                                    <g class="c-icon__color">\n                                        <path d="M0 3h8v2H0z" />\n                                        <path d="M3 0h2v8H3z" />\n                                    </g>\n                                </svg>\n                            </span>\n                        </button>\n                    </li>\n                </ul>\n                <button ng-if="colorpicker-edit" class="c-button c-colorpicker__edit">Edit</button>\n            </div>\n            <div class="">\n                <div class="color-swatch" ng-style="{\'background-color\': swatchColor}"></div>\n            </div>\n            <input aria-label="Input color" spellcheck="false" type="text" maxlength="7" class="colorpicker-field qa-colorpicker-text js-colorpicker-text" ng-model="selectedColor" ng-change="updateColorFromTextbox(selectedColor);">\n            <button class="emb-color-reset" ng-click="selectedColor = defaultColor">Revert</button>\n        </div>\n    </div>\n</div>'}),define("ts/modules/emailbuilder/components/color-list",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",
blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};t.COLOR_LIST=n}),function(){function e(e){var t=function(){var t={eventName:"click",onShow:function(){},onBeforeShow:function(){},onHide:function(){},onChange:function(){},onSubmit:function(){},color:"ff0000",livePreview:!0,flat:!1},n=function(t,n){e(n).data("hsb",t)},i=function(t){return e(t).data("hsb")},r=function(t,n){e(n).data("colorpicker").selector.css("backgroundColor","#"+S({h:t.h,s:100,b:100})),e(n).data("colorpicker").selectorIndic.css({left:parseInt(150*t.s/100,10),top:parseInt(150*(100-t.b)/100,10)})},o=function(t,n){e(n).data("colorpicker").hue.css("top",parseInt(150-150*t.h/360,10))},a=function(t){var a,s=e(this);s.data("colorpicker").color=a=g(i(s)),t&&n(a,s.get(0)),r(a,s.get(0)),o(a,s.get(0)),s.data("colorpicker").onChange.apply(s,[S(a)])},s=function(t){var n={cal:e(this).parent(),y:e(this).offset().top};n.preview=n.cal.data("colorpicker").livePreview,e(document).bind("mouseup",n,c),e(document).bind("mousemove",n,l),e(document).bind("mousedown",n,l)},l=function(e){var t=i(e.data.cal);return t.h=parseInt(360*(150-Math.max(0,Math.min(150,e.pageY-e.data.y)))/150,10),n(t,e.data.cal),a.apply(e.data.cal.get(0),[e.data.preview]),!1},c=function(t){return e(document).unbind("mouseup",c),e(document).unbind("mousemove",l),e(document).unbind("mousedown",l),!1},u=function(t){var n={cal:e(this).parent(),pos:e(this).offset()};n.preview=n.cal.data("colorpicker").livePreview,e(document).bind("mouseup",n,h),e(document).bind("mousemove",n,d),e(document).bind("mousedown",n,d)},d=function(e){var t=i(e.data.cal);return t.s=parseInt(100*Math.max(0,Math.min(150,e.pageX-e.data.pos.left))/150,10),t.b=parseInt(100*(150-Math.max(0,Math.min(150,e.pageY-e.data.pos.top)))/150,10),n(t,e.data.cal),a.apply(e.data.cal.get(0),[e.data.preview]),!1},h=function(t){return e(document).unbind("mouseup",h),e(document).unbind("mousemove",d),e(document).unbind("mousedown",d),!1},p=function(t){var n=e("#"+e(this).data("colorpickerId")),i=n.data("lastHide"),r=new Date;return(!i||r.getTime()-i.getTime()>200)&&(n.data("colorpicker").onBeforeShow.apply(this,[n.get(0)]),!1!==n.data("colorpicker").onShow.apply(this,[n.get(0)])&&n.show(),e(document).bind("mousedown",{cal:n},f)),!1},f=function(t){if(!m(t.data.cal.get(0),t.target,t.data.cal.get(0),!0)){var n=S(t.data.cal.data("colorpicker").color);!1!==t.data.cal.data("colorpicker").onHide(t.data.cal.get(0),n)&&t.data.cal.hide(),e(document).unbind("mousedown",f),t.data.cal.data("lastHide",new Date)}},m=function(e,t,n,i){if(e===t)return!i;if(e.contains)return e.contains(t);if(e.compareDocumentPosition)return!!(16&e.compareDocumentPosition(t));for(var r=t.parentNode;r&&r!==n;){if(r===e)return!0;r=r.parentNode}return!1},g=function(e){return{h:Math.min(360,Math.max(0,e.h)),s:Math.min(100,Math.max(0,e.s)),b:Math.min(100,Math.max(0,e.b))}},v=function(e){return e=parseInt(e.indexOf("#")>-1?e.substring(1):e,16),{r:e>>16,g:(65280&e)>>8,b:255&e}},b=function(e){return y(v(e))},y=function(e){var t={h:0,s:0,b:0},n=Math.min(e.r,e.g,e.b),i=Math.max(e.r,e.g,e.b),r=i-n;return t.b=i,t.s=0!==i?255*r/i:0,0!==t.s?e.r===i?t.h=(e.g-e.b)/r:e.g===i?t.h=2+(e.b-e.r)/r:t.h=4+(e.r-e.g)/r:t.h=-1,t.h*=60,t.h<0&&(t.h+=360),t.s*=100/255,t.b*=100/255,t},w=function(e){var t={},n=Math.round(e.h),i=Math.round(255*e.s/100),r=Math.round(255*e.b/100);if(0===i)t.r=t.g=t.b=r;else{var o=r,a=(255-i)*r/255,s=n%60*(o-a)/60;360===n&&(n=0),n<60?(t.r=o,t.b=a,t.g=a+s):n<120?(t.g=o,t.b=a,t.r=o-s):n<180?(t.g=o,t.r=a,t.b=a+s):n<240?(t.b=o,t.r=a,t.g=o-s):n<300?(t.b=o,t.g=a,t.r=a+s):n<360?(t.r=o,t.g=a,t.b=o-s):(t.r=0,t.g=0,t.b=0)}return{r:Math.round(t.r),g:Math.round(t.g),b:Math.round(t.b)}},_=function(t){var n=[t.r.toString(16),t.g.toString(16),t.b.toString(16)];return e.each(n,function(e,t){1===t.length&&(n[e]="0"+t)}),n.join("")},S=function(e){return _(w(e))};return{init:function(i){if(i=e.extend({},t,i||{}),"string"==typeof i.color)i.color=b(i.color);else if(void 0!==i.color.r&&void 0!==i.color.g&&void 0!==i.color.b)i.color=y(i.color);else{if(void 0===i.color.h||void 0===i.color.s||void 0===i.color.b)return this;i.color=g(i.color)}return this.each(function(){if(!e(this).data("colorpickerId")){var t=e.extend({},i);t.origColor=i.color;var a=e("body").data("colorpickerIndex")||0;a++,e("body").data("colorpickerIndex",a);var l="collorpicker_"+a;e(this).data("colorpickerId",l);var c=e('<div class="colorpicker round"><div class="colorpicker_color"><div><div></div></div></div><div class="colorpicker_hue"><div></div></div></div>').attr("id",l);t.flat?c.appendTo(this).show():c.appendTo(document.body),t.selector=c.find("div.colorpicker_color").bind("mousedown",u),t.selectorIndic=t.selector.find("div div"),t.el=this,t.hue=c.find("div.colorpicker_hue div"),c.find("div.colorpicker_hue").bind("mousedown",s),c.data("colorpicker",t),n(t.color,c.get(0)),o(t.color,c.get(0)),r(t.color,c.get(0)),t.flat?c.css({position:"relative",display:"block"}):e(this).bind(t.eventName,p)}})},showPicker:function(){return this.each(function(){e(this).data("colorpickerId")&&p.apply(this)})},hidePicker:function(){return this.each(function(){e(this).data("colorpickerId")&&e("#"+e(this).data("colorpickerId")).hide()})},setColor:function(t){if("string"==typeof t)t=b(t);else if(void 0!==t.r&&void 0!==t.g&&void 0!==t.b)t=y(t);else{if(void 0===t.h||void 0===t.s||void 0===t.b)return this;t=g(t)}return this.each(function(){if(e(this).data("colorpickerId")){var i=e("#"+e(this).data("colorpickerId"));i.data("colorpicker").color=t,i.data("colorpicker").origColor=t,n(t,i.get(0)),o(t,i.get(0)),r(t,i.get(0))}})},rgb2hex:function(e){},hex2hsb:b}}();e.fn.extend({ColorPicker:t.init,ColorPickerHide:t.hidePicker,ColorPickerShow:t.showPicker,ColorPickerSetColor:t.setColor,ColorPickerHex2HSB:t.hex2hsb})}"function"==typeof define?define("vendor/jquery.colorpicker",["jquery"],e):e(jQuery)}();var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/components/colorpicker.directive",["require","exports","vendor/text!ts/modules/emailbuilder/components/colorpicker.directive.html","angular","./color-list","vendor/jquery.colorpicker"],function(e,t,n,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=__importDefault(i);var o=function(e){return"#"===e[0]?e.substring(1):e},a=function(e){return e?"#"===e[0]?e:"#"+e:e},s=function(e,t){var n=e.has(t).length>0,i=e[0]===t;return n||i},l=function(){function e(e,t,l,c,u,d,h){var p=this;this.restrict="A",this.require="ngModel",this.template=n,this.scope={colorChanged:"&csColorPickerColorChanged",validateInputOnBlur:"=csColorPickerValidateOnBlur",alwaysOpen:"=csColorPickerAlwaysOpen"},this.link=function(e,t,n,l){p.preloadImageService.load(["img/emailbuilder/colorpicker/gamut@2x.png","img/emailbuilder/colorpicker/gamut.png","img/emailbuilder/colorpicker/triangle@2x.png","img/emailbuilder/colorpicker/triangle.png","img/emailbuilder/select@2x.png","img/emailbuilder/select.png","img/emailbuilder/colorpicker/hue.png","img/emailbuilder/colorpicker/hue-indicator@2x.png","img/emailbuilder/colorpicker/hue-indicator.png"]);var c=t.find(".js-color-swatch"),u=t.find("input"),d=t.find(".js-colorpicker-text"),h=i.default.element(p.$window[0]),f=function(t,n){if(void 0===t||null===t)return void(e.swatchColor="");t=o(t).toLowerCase(),t=r.COLOR_LIST[t]||t,/(^[0-9A-F]{6}$)|(^[0-9A-F]{3}$)/i.test(t)&&(n&&c.ColorPickerSetColor(t),e.swatchColor=a(t),e.selectedColor=t,l.$setViewValue(t))},m=function(t){return function(n){if(e.isOpen){var i=n||e.defaultColor;u.val(i),e.swatchColor=a(i),f(i,t),e.colorChanged&&e.colorChanged(),p.$timeout(function(){e.$digest()},1)}}};e.updateColorFromTextbox=m(!0);var g=m(!1),v=n.csViewport?i.default.element(n.csViewport):null,b=function(t){if(p.$rootScope.$broadcast("content:popupopened",e.$id),!e.isOpen){var n=u.offset(),r=i.default.element(t),o=r.outerHeight();if(v){var a=v.offset().top,s=a+v.height(),l=n.top+u.outerHeight()+o;e.isUpward=l>s}e.skipFocus?e.skipFocus=!1:(e.skipFocus=!0,u.focus()),e.isOpen=!0,e.$digest()}},y=function(){e.isOpen&&e.$applyAsync(function(){e.skipFocus=!1,p.recentColorService.addRecentColor(e.selectedColor),p.modelActivityService.contentUpdated(),e.isOpen=!1,e.isUpward=!1})};c.ColorPicker({onShow:b,onChange:g,onHide:y,flat:e.alwaysOpen}),u.on("paste",function(){p.$timeout(function(){e.updateColorFromTextbox(u.val())},100)});var w=c.data().colorpickerId;p.$timeout(function(){var n=i.default.element("#"+w),r=n.find(".colorpicker_hue"),o=function(){e.alwaysOpen?e.$emit("colorPicker:confirm"):(n.hide(),y())},a=function(e){e.stopPropagation(),e.preventDefault(),t.trigger("mousedown"),o()};u.on("keydown",function(e){9===e.which?(o(),u.blur()):13===e.which&&(a(e),u.blur())}),r.on("click",function(e){e.stopPropagation(),e.preventDefault()}),u.on("mousedown",function(e){e.stopPropagation()}),t.find(".js-recent-colors").on("mousedown",function(e){e.stopPropagation()});var m=!1;n.on("mousedown",function(){d.focus(),h.on("mousemove",function(){m=!0,p.$window.unbind("mousemove")})}).on("mouseup",function(e){var t=m;m=!1,h.unbind("mousemove");var n=s(r,e.target);t||n||u.blur()}),e.alwaysOpen||(u.on("focus",function(){e.skipFocus?e.skipFocus=!1:(e.skipFocus=!0,c.ColorPickerShow())}),u.on("blur",function(){!1!==e.validateInputOnBlur&&(u.val(l.$viewValue),f(l.$viewValue,!0),e.$apply())}));var g=p.$rootScope.$on("content:deactivated",function(e,t){o()});e.$on("$destroy",function(){g(),t.mousedown()}),e.$on("content:popupopened",function(t,n){n!==e.$id&&o()}),n.detach(),t.find(".c-colorpicker__block").append(n)},0),e.isOpen=e.alwaysOpen,e.isUpward=!1,e.recentlyUsedColors=[],e.$on("recentColors:loaded",function(){e.recentlyUsedColors=p.recentColorService.getRecentColors()});var _=p.$parse(n.csColorPicker)(e);l.$render=function(){e.recentlyUsedColors=p.recentColorService.getRecentColors(),e.defaultColor=_,e.selectedColor=l.$viewValue,f(e.selectedColor||_,!0),u&&u.length>1?u.map(function(t){i.default.element(u[t]).val(e.selectedColor)}):u.val(e.selectedColor)}},this.$rootScope=e,this.$timeout=t,this.$parse=l,this.$window=c,this.preloadImageService=u,this.recentColorService=d,this.modelActivityService=h}return e.factory=function(t,n,i,r,o,a,s){return new e(t,n,i,r,o,a,s)},e}();t.ColorPicker=l}),define("ts/modules/emailbuilder/components/save-on-blur.directive",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){var t=this;this.restrict="A",this.require="ngModel",this.link=function(e,n,i,r){var o="",a=!1;n.on("focus",function(){a||(a=!0,o=r.$modelValue)}),n.on("blur",function(){e.$applyAsync(function(){o!==r.$modelValue&&t.modelActivityService.contentUpdated(),a=!1})})},this.modelActivityService=e}return e.factory=function(t){return new e(t)},e}();t.SaveOnBlur=n}),define("vendor/text!ts/modules/emailbuilder/components/undo.component.html",[],function(){return'<div id="emb-undo" ng-if="$ctrl.undoEnabled" ng-show="$ctrl.embState === \'editor\' && !$ctrl.inCropSession" class="c-undo emb-js-animation-allowed">\r\n    <button class="c-button c-button--grey c-button--large qa-undo-button" ng-click="$ctrl.undo($event)" ng-disabled="!$ctrl.canUndo()">\r\n        <svg class="c-svg-icon">\r\n            <path fill="currentColor" d="M4.707.464l.707.708L3.584 3c.026-.003.053-.004.08-.004h3.333c1.388 0 2.686.57 3.623 1.555a5 5 0 0 1-3.623 8.446h-5a1 1 0 1 1 0-2h5a3 3 0 1 0 0-6H3.664l-.085-.005 1.835 1.835-.707.708a1 1 0 0 1-1.414 0L.464 4.707a1 1 0 0 1 0-1.414L3.293.464a1 1 0 0 1 1.414 0z"/>\r\n        </svg>\r\n        <span class="c-button__text">Undo</span>\r\n    </button>\r\n    <button class="c-button c-button--grey c-button--large qa-redo-button" ng-click="$ctrl.redo($event)" ng-disabled="!$ctrl.canRedo()">\r\n        <svg class="c-svg-icon">\r\n            <path fill="currentColor" d="M7.29.464l-.707.708L8.413 3a1.014 1.014 0 0 0-.08-.004H5c-1.387 0-2.686.57-3.623 1.555A5 5 0 0 0 5 12.998h5a1 1 0 1 0 0-2H5a3 3 0 1 1 0-6h3.333l.086-.005-1.836 1.835.707.708a1 1 0 0 0 1.414 0l2.829-2.829a1 1 0 0 0 0-1.414L8.704.464a1 1 0 0 0-1.414 0z"/>\r\n        </svg>\r\n        <span class="c-button__text">Redo</span>\r\n    </button>\r\n</div>'});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/components/undo.controller",["require","exports","underscore"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=__importDefault(n);var i=function(){function e(e,t,i){var r=this;this.debouncedUndo=n.default.debounce(function(){r.$rootScope.$applyAsync(function(){r.undoService.undo()})},50),this.debouncedRedo=n.default.debounce(function(){r.$rootScope.$applyAsync(function(){r.undoService.redo()})},50),this.undo=function(e){r.debouncedUndo(),e.preventDefault()},this.redo=function(e){r.debouncedRedo(),e.preventDefault()},this.canUndo=function(){return r.undoService.canUndo()},this.canRedo=function(){return r.undoService.canRedo()},this.undoService=t,this.$rootScope=i,this.undoEnabled=e.undoButtonEnabled,this.inCropSession=!1,this.$rootScope.$on("imageBlock:cropStaged",function(){r.inCropSession=!0}),this.$rootScope.$on("imageBlock:closeCropStage",function(){r.inCropSession=!1})}return e}();t.UndoController=i}),define("ts/modules/emailbuilder/components/undo.component",["require","exports","vendor/text!ts/modules/emailbuilder/components/undo.component.html","./undo.controller"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this.template=n,this.controller=["EmailBuilderConfig","UndoService","$rootScope",i.UndoController],this.bindings={embState:"<"}}return e}();t.Undo=r}),define("ts/modules/emailbuilder/components/translate.directive",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n){var i=this;this.restrict="A",this.link=function(e,t,n){var r=function(){var e=i.emailService.model.language,r=i.translationService.getValue(e,n.embTranslate,!0);t.text(r||""),i.$rootScope.$emit("checkbox:value-changed")};e.$watch(function(){return i.emailService.model.language},r),r()},this.$rootScope=e,this.emailService=t,this.translationService=n}return e.factory=function(t,n,i){return new e(t,n,i)},e}();t.Translate=n}),define("vendor/text!ts/modules/emailbuilder/components/tile.directive.html",[],function(){return'<span class="section-tiles__thumbnail-name">{{::name}}</span>'});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/components/tile.directive",["require","exports","vendor/text!ts/modules/emailbuilder/components/tile.directive.html","angular","../constants","jqueryui"],function(e,t,n,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=__importDefault(i);var o="emb-",a=o+"tile",s=function(){function e(e,t,s){var l=this;this.scope={name:"@",type:"@",subtype:"@",item:"="},this.restrict="A",this.transclude=!1,this.template=n,this.link=function(e,t,n){var s=e.subtype||e.type;t.addClass(a);var c=function(){e.$emit(e.type+".add",e.item)};t.on({click:function(e){c(),e.stopPropagation()}}),t.draggable({appendTo:r.EMAIL_BODY_SELECTOR,delay:50,distance:5,drag:function(t){e.$apply(function(){l.draggingService.move({mouseX:t.pageX,mouseY:t.pageY})})},start:function(n){t.addClass("emb-tile-placeholder"),e.$apply(function(){l.draggingService.start({type:e.type,contentType:s,mouseX:n.pageX,mouseY:n.pageY})})},stop:function(n){e.$apply(function(){("content"!==e.type||!l.viewPortService.isIgnoringContentDrop(n.pageX,n.pageY))&&c(),t.removeClass("emb-tile-placeholder"),l.draggingService.stop()})},scroll:!0,scrollSpeed:50,helper:function(){return i.default.element("<span></span>").hide()}}),n.connectTo&&t.draggable("option","connectToSortable",n.connectTo),n.$observe("name",function(e){if(e){var n=o+e.toLowerCase().replace(" ","-");t.addClass(n)}}),l.emailBuilderConfig.surveysEnabled||"survey"!==e.subtype||t.hide()},this.viewPortService=e,this.draggingService=t,this.emailBuilderConfig=s}return e.factory=function(t,n,i){return new e(t,n,i)},e}();t.Tile=s}),define("vendor/text!ts/modules/emailbuilder/components/slider.directive.html",[],function(){return"<div class='slider-container'>\n    <div class='js-slider'></div>\n</div>"}),function(){function e(e){e.widget("ui.slider",e.ui.mouse,{version:"1.10.4",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var t,n,i=this.options,r=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),o=[];for(n=i.values&&i.values.length||1,r.length>n&&(r.slice(n).remove(),r=r.slice(0,n)),t=r.length;t<n;t++)o.push("<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>");this.handles=r.add(e(o.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(t){e(this).data("ui-slider-handle-index",t)})},_createRange:function(){var t=this.options,n="";t.range?(!0===t.range&&(t.values?t.values.length&&2!==t.values.length?t.values=[t.values[0],t.values[0]]:e.isArray(t.values)&&(t.values=t.values.slice(0)):t.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=e("<div></div>").appendTo(this.element),n="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(n+("min"===t.range||"max"===t.range?" ui-slider-range-"+t.range:""))):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){var e=this.handles.add(this.range).filter("a");this._off(e),this._on(e,this._handleEvents),this._hoverable(e),this._focusable(e)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(t){var n,i,r,o,a,s,l,c=this,u=this.options;return!u.disabled&&(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),n={x:t.pageX,y:t.pageY},i=this._normValueFromMouse(n),r=this._valueMax()-this._valueMin()+1,this.handles.each(function(t){var n=Math.abs(i-c.values(t));(r>n||r===n&&(t===c._lastChangedValue||c.values(t)===u.min))&&(r=n,o=e(this),a=t)}),!1!==this._start(t,a)&&(this._mouseSliding=!0,this._handleIndex=a,o.addClass("ui-state-active").focus(),s=o.offset(),l=!e(t.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=l?{left:0,top:0}:{left:t.pageX-s.left-o.width()/2,top:t.pageY-s.top-o.height()/2-(parseInt(o.css("borderTopWidth"),10)||0)-(parseInt(o.css("borderBottomWidth"),10)||0)+(parseInt(o.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(t,a,i),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(e){var t={x:e.pageX,y:e.pageY},n=this._normValueFromMouse(t);return this._slide(e,this._handleIndex,n),!1},_mouseStop:function(e){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(e,this._handleIndex),this._change(e,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(e){var t,n,i,r,o;return"horizontal"===this.orientation?(t=this.elementSize.width,n=e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(t=this.elementSize.height,n=e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),i=n/t,i>1&&(i=1),i<0&&(i=0),"vertical"===this.orientation&&(i=1-i),r=this._valueMax()-this._valueMin(),o=this._valueMin()+i*r,this._trimAlignValue(o)},_start:function(e,t){var n={handle:this.handles[t],value:this.value()};return this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._trigger("start",e,n)},_slide:function(e,t,n){var i,r,o;this.options.values&&this.options.values.length?(i=this.values(t?0:1),2===this.options.values.length&&!0===this.options.range&&(0===t&&n>i||1===t&&n<i)&&(n=i),n!==this.values(t)&&(r=this.values(),r[t]=n,o=this._trigger("slide",e,{handle:this.handles[t],value:n,values:r}),i=this.values(t?0:1),!1!==o&&this.values(t,n))):n!==this.value()&&!1!==(o=this._trigger("slide",e,{handle:this.handles[t],value:n}))&&this.value(n)},_stop:function(e,t){var n={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._trigger("stop",e,n)},_change:function(e,t){if(!this._keySliding&&!this._mouseSliding){var n={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._lastChangedValue=t,this._trigger("change",e,n)}},value:function(e){return arguments.length?(this.options.value=this._trimAlignValue(e),this._refreshValue(),void this._change(null,0)):this._value()},values:function(t,n){var i,r,o;if(arguments.length>1)return this.options.values[t]=this._trimAlignValue(n),this._refreshValue(),void this._change(null,t);if(!arguments.length)return this._values();if(!e.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(t):this.value();for(i=this.options.values,r=arguments[0],o=0;o<i.length;o+=1)i[o]=this._trimAlignValue(r[o]),this._change(null,o);this._refreshValue()},_setOption:function(t,n){var i,r=0;switch("range"===t&&!0===this.options.range&&("min"===n?(this.options.value=this._values(0),this.options.values=null):"max"===n&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),e.isArray(this.options.values)&&(r=this.options.values.length),e.Widget.prototype._setOption.apply(this,arguments),t){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),i=0;i<r;i+=1)this._change(null,i);this._animateOff=!1;break;case"min":case"max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var e=this.options.value;return e=this._trimAlignValue(e)},_values:function(e){var t,n,i;if(arguments.length)return t=this.options.values[e],t=this._trimAlignValue(t);if(this.options.values&&this.options.values.length){for(n=this.options.values.slice(),i=0;i<n.length;i+=1)n[i]=this._trimAlignValue(n[i]);return n}return[]},_trimAlignValue:function(e){if(e<=this._valueMin())return this._valueMin();if(e>=this._valueMax())return this._valueMax();var t=this.options.step>0?this.options.step:1,n=(e-this._valueMin())%t,i=e-n;return 2*Math.abs(n)>=t&&(i+=n>0?t:-t),parseFloat(i.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var t,n,i,r,o,a=this.options.range,s=this.options,l=this,c=!this._animateOff&&s.animate,u={};this.options.values&&this.options.values.length?this.handles.each(function(i){n=(l.values(i)-l._valueMin())/(l._valueMax()-l._valueMin())*100,u["horizontal"===l.orientation?"left":"bottom"]=n+"%",e(this).stop(1,1)[c?"animate":"css"](u,s.animate),!0===l.options.range&&("horizontal"===l.orientation?(0===i&&l.range.stop(1,1)[c?"animate":"css"]({left:n+"%"},s.animate),1===i&&l.range[c?"animate":"css"]({width:n-t+"%"},{queue:!1,duration:s.animate})):(0===i&&l.range.stop(1,1)[c?"animate":"css"]({bottom:n+"%"},s.animate),1===i&&l.range[c?"animate":"css"]({height:n-t+"%"},{queue:!1,duration:s.animate}))),t=n}):(i=this.value(),r=this._valueMin(),o=this._valueMax(),n=o!==r?(i-r)/(o-r)*100:0,u["horizontal"===this.orientation?"left":"bottom"]=n+"%",this.handle.stop(1,1)[c?"animate":"css"](u,s.animate),"min"===a&&"horizontal"===this.orientation&&this.range.stop(1,1)[c?"animate":"css"]({width:n+"%"},s.animate),"max"===a&&"horizontal"===this.orientation&&this.range[c?"animate":"css"]({width:100-n+"%"},{queue:!1,duration:s.animate}),"min"===a&&"vertical"===this.orientation&&this.range.stop(1,1)[c?"animate":"css"]({height:n+"%"},s.animate),"max"===a&&"vertical"===this.orientation&&this.range[c?"animate":"css"]({height:100-n+"%"},{queue:!1,duration:s.animate}))},_handleEvents:{keydown:function(t){var n,i,r,o=e(t.target).data("ui-slider-handle-index");switch(t.keyCode){case e.ui.keyCode.HOME:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(t.preventDefault(),!this._keySliding&&(this._keySliding=!0,e(t.target).addClass("ui-state-active"),!1===this._start(t,o)))return}switch(r=this.options.step,n=i=this.options.values&&this.options.values.length?this.values(o):this.value(),t.keyCode){case e.ui.keyCode.HOME:i=this._valueMin();break;case e.ui.keyCode.END:i=this._valueMax();break;case e.ui.keyCode.PAGE_UP:i=this._trimAlignValue(n+(this._valueMax()-this._valueMin())/5);break;case e.ui.keyCode.PAGE_DOWN:i=this._trimAlignValue(n-(this._valueMax()-this._valueMin())/5);break;case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:if(n===this._valueMax())return;i=this._trimAlignValue(n+r);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(n===this._valueMin())return;i=this._trimAlignValue(n-r)}this._slide(t,o,i)},click:function(e){e.preventDefault()},keyup:function(t){var n=e(t.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(t,n),this._change(t,n),e(t.target).removeClass("ui-state-active"))}}})}"function"==typeof define?define("vendor/jquery.ui.slider",["jquery","jqueryui"],e):e(jQuery)}(),define("ts/modules/emailbuilder/components/slider.directive",["require","exports","vendor/text!ts/modules/emailbuilder/components/slider.directive.html","vendor/jquery.ui.slider","jqueryui"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t,i){var r=this;this.restrict="A",this.template=n,this.require="ngModel",this.scope={initialValue:"=csSlider",max:"=csSliderMax"},this.safariBrokenRenderingFix=function(){/^((?!chrome).)*safari/i.test(navigator.userAgent)&&setTimeout(function(){var e=document.body,t=e.style.display;e.style.display="none";e.offsetHeight;e.style.display=t},1)},this.link=function(e,t,n,i){var o=parseInt(n.csSliderMin,10);e.initialValue>e.max&&(e.initialValue=e.max),isNaN(e.initialValue)&&(e.initialValue=r.config.settings.defaultVerticalSpacingValue),i.$setViewValue(e.initialValue),e.$emit("slider:load",e.initialValue);var a=t.find(".js-slider");e.userSettingTheValue=!1;var s=e.initialValue;a.slider({orientation:"horizontal",range:"min",min:o,max:e.max,value:e.initialValue,change:function(t,n){r.$timeout(function(){i.$setViewValue(n.value)}),i.$setViewValue(n.value),r.safariBrokenRenderingFix(),e.userSettingTheValue=!1},slide:function(t,n){e.$emit("slider:slide",n.value),e.userSettingTheValue=!0,e.$apply(function(){i.$setViewValue(n.value)}),r.safariBrokenRenderingFix()},stop:function(t,n){e.$apply(function(){s!==n.value&&(r.modelActivityService.contentUpdated(),s=n.value)})}}),e.$watch("max",function(e){a.slider("option","max",e);var t=i.$modelValue;t>e?(i.$setViewValue(e),a.slider("option","value",e)):a.slider("option","value",t)}),e.$watch("initialValue",function(t){e.userSettingTheValue||a.slider("option","value")===t||(isNaN(t)&&(t=r.config.settings.defaultVerticalSpacingValue,i.$setViewValue(t)),r.$timeout(function(){a.slider("option","value",t)},200))})},this.$timeout=e,this.config=t,this.modelActivityService=i}return e.factory=function(t,n,i){return new e(t,n,i)},e}();t.Slider=i});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/components/validate-url.directive",["require","exports","underscore"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=__importDefault(n);var i=function(){function e(e){var t=this;this.require="ngModel",this.link=function(e,i,r,o){var a=function(e){if(!e)return!1;var t=e.isValid||!e.raw&&!r.required;return o.$setValidity("url",t),t},s=n.default.debounce(a,250);o.$parsers.push(function(e){var n=t.linkModelProviderService.getModelFor(e||"");return(o.$modelValue?s:a)(n),n}),o.$formatters.push(function(e){return e?(a(e),e.raw):e}),i.on("blur",function(){a(o.$modelValue);var e;e=o.$modelValue&&o.$modelValue.raw?o.$modelValue.raw:"",o.$setViewValue(e)})},this.linkModelProviderService=e}return e.factory=function(t){return new e(t)},e}();t.ValidateUrl=i}),
define("ts/modules/emailbuilder/components/file-upload.directive",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){var t=this;this.restrict="A",this.scope={file:"="},this.link=function(e,n){var i=function(e,n){var i=e[0].files[0];t.imageManagerService.uploadAsync({file:i,block:function(){return n}})},r=function(e){e&&e.tempValidation&&(e.tempValidation=[])};n.on("change",function(){""!==n.val()&&e.$apply(function(){r(e.file),i(n,e.file)})})},this.imageManagerService=e}return e.factory=function(t){return new e(t)},e}();t.FileUpload=n});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/components/warn-before-closing.directive",["require","exports","angular"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=__importDefault(n);var i=function(){function e(e,t,i){var r=this;this.restrict="A",this.link=function(e,t,i){var o=!1,a=!1;r.$rootScope.$on("upload:start",function(){o=!0}),r.$rootScope.$on("upload:end",function(){o=!1}),r.$rootScope.$on("upload:error",function(){o=!1}),n.default.element(r.$window).on("beforeunload",function(e){if(!a&&(r.saveService.isDirty||r.saveService.isSaving||o)){var t="We're still saving your latest changes. Please wait until these changes have been saved";return(e||r.$window.event).returnValue=t,t}}),r.saveService.subscribe("redirect",function(){a=!0})},this.$rootScope=e,this.$window=t,this.saveService=i}return e.factory=function(t,n,i){return new e(t,n,i)},e}();t.WarnBeforeClosing=i}),define("vendor/text!ts/modules/emailbuilder/components/segmented-control.component.html",[],function(){return'<div class="c-segmented-control__container">\r\n    <fieldset class="c-segmented-control__fieldset">\r\n        <legend id="{{::$ctrl.groupClassName}}" class="c-sidebar__label">{{::$ctrl.groupLegend}}</legend>\r\n        <div role="tablist" aria-labelledby="{{::$ctrl.groupClassName}}" class="c-segmented-control {{::$ctrl.groupClassName}}" ng-transclude></div>\r\n    </fieldset>\r\n</div>'}),define("ts/modules/emailbuilder/components/segmented-control.controller",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){var e=this;this.valueSelected=function(t){var n=e.ngModelController.$viewValue;e.ngModelController.$setViewValue(t),e.onSelect({prevValue:n,newValue:t})},this.isSelected=function(t){return e.ngModelController.$modelValue===t}}return e}();t.SegmentedControlController=n}),define("ts/modules/emailbuilder/components/segmented-control.component",["require","exports","vendor/text!ts/modules/emailbuilder/components/segmented-control.component.html","./segmented-control.controller"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this.bindings={groupClassName:"@",groupLegend:"@",groupName:"@",onSelect:"&"},this.transclude=!0,this.template=n,this.controller=[i.SegmentedControlController],this.require={ngModelController:"ngModel"}}return e}();t.SegmentedControl=r}),define("vendor/text!ts/modules/emailbuilder/components/segmented-control-item.component.html",[],function(){return'<div class="{{::$ctrl.classNames}}">\r\n    <input class="c-segmented-control__radio" id="{{::$ctrl.segmentId}}" type="radio" name="{{::$ctrl.parentController.groupName}}" value="{{::$ctrl.itemValue}}" ng-checked="$ctrl.isSelected()" ng-click="$ctrl.valueSelected($ctrl.itemValue)" />\r\n    <label class="c-segmented-control__label" for="{{::$ctrl.segmentId}}">\r\n        <span class="c-segmented-control__icon" ng-class="{\'c-segmented-control__icon_selected\': $ctrl.isSelected() }" ng-transclude></span>\r\n    </label>\r\n</div>\r\n<div class="c-segmented-control__tooltip">{{::$ctrl.itemName}}</div>'}),define("ts/modules/emailbuilder/components/segmented-control-item.controller",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){var t=this;this.valueSelected=function(e){t.parentController.valueSelected(e)},this.isSelected=function(){return t.parentController.isSelected(t.itemValue)},e.addClass("c-segmented-control__list-item")}return e}();t.SegmentedControlItemController=n}),define("ts/modules/emailbuilder/components/segmented-control-item.component",["require","exports","vendor/text!ts/modules/emailbuilder/components/segmented-control-item.component.html","./segmented-control-item.controller"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this.bindings={itemValue:"@",segmentId:"@",classNames:"@",itemName:"@"},this.transclude=!0,this.template=n,this.controller=["$element",i.SegmentedControlItemController],this.require={parentController:"^cmSegmentedControl"}}return e}();t.SegmentedControlItem=r}),define("ts/modules/emailbuilder/components/custom-scroll.directive",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.restrict="A",this.link=function(e,t){if("Win32"===navigator.platform){t.niceScroll({autohidemode:!0,cursoropacitymin:.25,cursoropacitymax:.6,cursorcolor:"#000",cursorwidth:"8px",cursorborder:"2px solid transparent",cursorborderradius:"10px",grabcursorenabled:!1,zindex:998}),t.css("overflow-y","hidden");var n=t.getNiceScroll();e.$watch(function(){return t.is(":visible")},function(){n.resize()}),e.$on("$destroy",function(){t.getNiceScroll().remove()})}else t.css("overflow-y","auto")}}return e.factory=function(){return new e},e}();t.CustomScroll=n}),define("vendor/text!ts/modules/emailbuilder/components/trashcan.directive.html",[],function(){return'<div class="js-delete-controls emb-content-controls emb-reset" ng-show="hovered && canDelete">\n    <div id="content-confirm-optional-text"\n          class="c-button-delete emb-js-animation-allowed"\n          ng-click="showConfirmation(); $event.stopPropagation();"\n          ng-class="{ \'is-selected\' : confirmation,  \'is-active\' : activeNotDragged(), \'is-inactive\' : !(activeNotDragged()) }">\n        <button class="c-button-delete__confirm" ng-click="remove(); $event.stopPropagation();">Delete</button>\n        <button class="c-button-delete__cancel" ng-click="hideConfirmation(); $event.stopPropagation()">Cancel</button>\n    </div>\n</div>\n'}),define("ts/modules/emailbuilder/components/trashcan.directive",["require","exports","vendor/text!ts/modules/emailbuilder/components/trashcan.directive.html"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t,i,r,o){var a=this;this.restrict="A",this.scope={trashcanKey:"@",tagType:"@"},this.template=n,this.link=function(e,t,n){var i=t.parent();e.canDelete=!0;var r=function(t){var n=a.lockLevelService.getLocks(t);e.canDelete=n.canDeleteContentItems};a.emailService.model.footer.permissions&&("webversion"===e.trashcanKey?(r(a.emailService.model.header.permissions),e.$on("permissionsChanged:header",function(e,t){r(t)})):(r(a.emailService.model.footer.permissions),e.$on("permissionsChanged:footer",function(e,t){r(t)}))),"inline"===i.css("display")&&i.css("display","inline-block"),i.on("mouseenter",function(){e.setTrashCanPlace(),e.hovered=!0,e.$apply()}),i.on("mouseleave",function(){e.hovered=!1,e.$apply()}),e.showRelativeSidebar=function(e){a.$timeout(function(){a.$rootScope.$emit("content:activate",{block:{id:(new Date).valueOf(),type:e.type,subType:e.subType}})},0)},e.showConfirmation=function(){e.confirmation=!0,e.$parent.block&&e.showRelativeSidebar(e.$parent.block)},e.setTrashCanPlace=function(){t.parent().offset().top<65&&t.css("top","-10px")},e.remove=function(){e.$parent.block&&e.showRelativeSidebar(e.$parent.block),a.$rootScope.$emit(e.tagType+":removed",e.trashcanKey),a.$rootScope.$emit("checkbox:value-changed"),a.modelActivityService.contentUpdated()}},this.lockLevelService=e,this.emailService=t,this.modelActivityService=i,this.$rootScope=r,this.$timeout=o}return e.factory=function(t,n,i,r,o){return new e(t,n,i,r,o)},e}();t.TrashCan=i});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("ts/modules/emailbuilder/components/components.module",["require","exports","angular","./focus.directive","./prevent-backspace-back.directive","./colorpicker.directive","./save-on-blur.directive","./undo.component","./translate.directive","./tile.directive","./slider.directive","./validate-url.directive","./file-upload.directive","./warn-before-closing.directive","./segmented-control.component","./segmented-control-item.component","./custom-scroll.directive","./trashcan.directive"],function(e,t,n,i,r,o,a,s,l,c,u,d,h,p,f,m,g,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=__importDefault(n);var b=n.default.module("emailbuilder.components",[]);t.module=b,b.directive("csFocus",["$rootScope",i.Focus.factory]),b.directive("embPreventBackspaceBack",["$window",r.PreventBackspaceBack.factory]),b.directive("embTranslate",["$rootScope","EmailService","TranslationService",l.Translate.factory]),b.directive("csColorPicker",["$rootScope","$timeout","$parse","$window","PreloadImageService","RecentColorService","ModelActivityService",o.ColorPicker.factory]),b.directive("csSlider",["$timeout","EmailBuilderConfig","ModelActivityService",u.Slider.factory]),b.directive("embSaveOnBlur",["ModelActivityService",a.SaveOnBlur.factory]),b.directive("embTile",["ViewPortService","DraggingService","EmailBuilderConfig",c.Tile.factory]),b.directive("csValidUrl",["LinkModelProviderService",d.ValidateUrl.factory]),b.directive("embFileUpload",["ImageManagerService",h.FileUpload.factory]),b.directive("embWarnBeforeClosing",["$rootScope","$window","SaveService",p.WarnBeforeClosing.factory]),b.component("cmSegmentedControl",new f.SegmentedControl),b.component("cmSegmentedControlItem",new m.SegmentedControlItem),b.directive("csCustomScroll",[g.CustomScroll.factory]),b.directive("embTrashcan",["LockLevelService","EmailService","ModelActivityService","$rootScope","$timeout",v.TrashCan.factory]),b.component("embUndo",new s.Undo)}),define("modules/emailbuilder/module",["vendor/angular","config","vendor/angular-sanitize","vendor/angular-animate","vendor/angular-route","ts/modules/createsend/createsend.module","ts/modules/emailbuilder/content-blocks/content-blocks.module","ts/modules/emailbuilder/dialogs/dialogs.module","ts/modules/emailbuilder/dragging/dragging.module","ts/modules/emailbuilder/header/header.module","ts/modules/emailbuilder/layout/layout.module","ts/modules/emailbuilder/preview/preview.module","ts/modules/emailbuilder/sections/sections.module","ts/modules/emailbuilder/services/services.module","ts/modules/emailbuilder/sidebar/sidebar.module","ts/modules/emailbuilder/toolbar/toolbar.module","ts/modules/emailbuilder/components/components.module"],function(e,t){var n=e.module("emailbuilder",["ngSanitize","ngAnimate","ngRoute","createsend","emailbuilder.content-blocks","emailbuilder.dialogs","emailbuilder.dragging","emailbuilder.header","emailbuilder.layout","emailbuilder.preview","emailbuilder.sections","emailbuilder.services","emailbuilder.sidebar","emailbuilder.toolbar","emailbuilder.components"]);return n.value("EmailBuilderConfig",t),n.config(["$sceDelegateProvider",function(e){e.resourceUrlWhitelist(["self","https://www.getfeedback.com/oauth/authorize**"])}]),n.config(["$animateProvider",function(e){e.classNameFilter(/emb-js-animation-allowed/)}]),n.config(["$locationProvider",function(e){e.hashPrefix("")}]),n.config(["$qProvider",function(e){e.errorOnUnhandledRejections(!1)}]),n}),define("modules/emailbuilder/config/routeConfig",["config","vendor/angular","modules/emailbuilder/module"],function(e,t,n){function i(e){e.when("/editor",{action:"editor"}).when("/preview",{action:"preview"}).when("/signup",{action:"preview",showSignupForm:!0}).when("/firstrun",{action:"firstrun"}).when("/secondrun",{action:"secondrun"}).when("/sendtest",{action:"editor",showTestEmailForm:!0}).otherwise({action:"editor",redirectTo:"/editor"})}n.config(["$routeProvider",i])}),define("modules/emailbuilder/filters/memoisedTemplateUrl",["modules/emailbuilder/module","underscore","config"],function(e,t,n){function i(e,n,i){var r=["$sce"];return e&&(r=r.concat(e)),r.push(function(e){function r(){var t,i=Array.prototype.slice.call(arguments,0);return i.unshift.apply(i,o),t=n.apply(null,i),e.trustAsResourceUrl(t)}var o=Array.prototype.slice.call(arguments,1);return t.memoize(r,i)}),r}function r(e,t,i,r){for(var o=!1,a=!1,s=0;s<n.template.sectionSeparators.length&&(o=-1!==n.template.sectionSeparators[s].indexOf("location"),a=-1!==n.template.sectionSeparators[s].indexOf("first"),!o);s++);return i||r||a?{type:e.id,location:{first:i,last:!i&&r}}:o?{location:{between:[e.id,t.id]}}:{type:e.id}}var o={imageTemplateUrl:{service:["$templateCache","AvailableSectionSelectorService"],getUrl:function(e,t,n,i){var r=n.isFullWidth?"bleed":"padded",o=["/content/image/",t.fromID(i).id,"/",r,".html"].join("");return e.get(o)||(o=["/content/image/",r,".html"].join("")),o},getHashKey:function(e,t){return[e.isFullWidth+"|"+t].join("")}},sectionSeparatorUrl:{services:["SectionSeparatorSelectorService","AvailableSectionSelectorService"],getUrl:function(e,t,n,i,o){var a=!1===o,s=!i;if(!a){n=t.select(n),i=i&&t.select(i);var l=r(n,i,o,s),c=e.getMatchingIndex(l);return void 0===c?void 0:["/section-separator/",c,".html"].join("")}},getHashKey:function(e,t,n){return[e.id,t&&t.id,n].map(function(e){return""+e}).join()}},sectionTemplateUrl:{services:["AvailableSectionSelectorService"],getUrl:function(e,t){return["/section/",e.select(t).id,".html"].join("")},getHashKey:function(e){return e.id}},topPaddingUrl:{services:["AvailableSectionSelectorService"],getUrl:function(e,t,n){return["/section/",e.fromID(t).id,"/dropzone-top/",n,".html"].join("")},getHashKey:function(e,t){return[e,t].join()}},contentPaddingUrl:{services:["$templateCache","AvailableSectionSelectorService"],getUrl:function(e,t,n,i,r){return"image"!==n.type&&"video"!==n.type||!n.isFullWidth?["/section/",t.fromID(i).id,"/dropzone-padding/",r,".html"].join(""):o.contentTemplateUrl.getUrl(e,t,n,i,r)},getHashKey:function(e,t,n){return"image"!==e.type&&"video"!==e.type||!e.isFullWidth?[t,n].join():o.contentTemplateUrl.getHashKey(e,t,n)}},contentTemplateUrl:{services:["$templateCache","AvailableSectionSelectorService"],getUrl:function(e,t,n,i,r){var o,a,s=n.type;if(i=t.fromID(i).id,"image"===s){if(o=n.isFullWidth?"bleed.html":"padded.html",a=["/content/",i,"/",r,"/image/",o].join(""),e.get(a))return a;if(a=["/content/image/",o].join(""),e.get(a))return a}return a=["/content/",i,"/",r,"/",s,".html"].join(""),e.get(a)||(a=["/content/",s,".html"].join("")),a},getHashKey:function(e,t,n){var i=[e.type,t,n];return"image"===e.type&&i.push(e.isFullWidth),i.join()}}};Object.keys(o).forEach(function(t){var n=o[t],r=i(n.services,n.getUrl,n.getHashKey);e.filter(t,r)})}),define("vendor/text!modules/emailbuilder/templates/sectionContainer.html",[],function(){return'<div ng-repeat="section in sections" class="emb-js-section-and-separator-wrapper emb-js-animation-allowed" emb-disable-drag="true" ng-controller="SectionController">\r\n\r\n    <ng-include ng-if="!useStaticSeparators" src="section | sectionSeparatorUrl : undefined : $first"></ng-include>\r\n\r\n    <div class="emb-section-wrap emb-js-section-outer-wrapper c-section-highlight-container" index="{{$index}}"\r\n         ng-class="{ \'is-hovered\': hovered || section.isHighlighted, \'is-active\': section.isActive,\r\n         \'is-locked\': canvasSectionPermissions && section.permissions.lockLevel === \'full\', \'is-highlighted\': section.isHighlighted,\r\n         \'is-partially-locked\': canvasSectionPermissions && (section.permissions.lockLevel === \'partial\' || section.permissions.lockLevel === \'partial-removable\'),\r\n         \'is-partially-locked--removable\': canvasSectionPermissions && section.permissions.lockLevel === \'partial-removable\',\r\n         \'has-icon\': hasIcon() }"\r\n         ng-mouseover="hovered = !section.readOnly && !$parent.disableHover; $event.stopPropagation();"\r\n         ng-mouseout="hovered = false;">\r\n\r\n        <div class="c-section-highlight" aria-hidden="true" id="section-options-{{section.uiId}}">\r\n            <div emb-item-controls item-type="section" item="section" item-hovered="hovered" confirmation="confirmation"></div>\r\n            <div id="{{section.uiId}}" class="hmb-js-section-wrapper" ng-include="section | sectionTemplateUrl" ng-class="section.cssClasses"></div>\r\n        </div>\r\n    </div>\r\n    <ng-include ng-if="!useStaticSeparators" id="js_section_separator_after_{{section.uiId}}" src="section | sectionSeparatorUrl : sections[$index + 1]"></ng-include>\r\n    <ng-include ng-if="useStaticSeparators" id="js_section_separator_after_{{section.uiId}}" src="\'/section-separator/0.html\'"></ng-include>\r\n</div>\r\n<div class="emb-insertion-bar emb-section-insertion-bar hmb-reset hmb-editor-common" ng-show="sectionDragged()"></div>\r\n'}),define("modules/emailbuilder/directives/sectionContainer",["config","vendor/angular","modules/emailbuilder/module","modules/emailbuilder/filters/memoisedTemplateUrl","vendor/text!modules/emailbuilder/templates/sectionContainer.html"],function(e,t,n,i,r){function o(t,n){return{template:r,link:function(i,r,o){i.droplineActive=!0,i.dragging=!1,i.confirmation=!1,i.options=!1,i.sections=t.model.sections,i.disableHover=!1,i.useStaticSeparators=e.email.isBlueprint,i.sectionDragged=function(){return i.dragging&&i.droplineActive};var a=[],s=n.subscribe("content.start",function(){0===i.email.sections.length&&(i.dragging=!0),i.disableHover=!0});a.push(s),s=n.subscribe("content.stop",function(){i.dragging=!1,i.disableHover=!1}),a.push(s),i.$on("$destroy",function(){a.forEach(function(e){e.unsubscribe()})}),i.lockLevels=e.lockLevels,i.$on("section.highlight",function(e,t){for(var n=!1,i=0;i<t.content.length;i++)t.content[i].isHighlighted&&(n=!0);t.isHighlighted=n,e.currentScope.$digest(),e.stopPropagation()})}}}n.directive("csSectionContainer",["EmailService","DraggingService",o])}),define("vendor/text!modules/emailbuilder/templates/sectionControls.html",[],function(){return'<div>\r\n    <button class="c-section-highlight__label c-section-highlight__label--partially-locked" ng-if="!block.readOnly &&!isPublicCanvas">\r\n        <span class="c-section-highlight__label-text">Edit content only</span>\r\n    </button>\r\n    <button class="c-section-highlight__label c-section-highlight__label--locked" ng-if="!block.readOnly && !isPublicCanvas">\r\n        <span class="c-section-highlight__label-text">Locked</span>\r\n    </button>\r\n\r\n    <div class="c-section-bar-container">\r\n        <div class="c-section-bar">\r\n            <button class="c-section-highlight__label c-section-highlight__label--segments" ng-if="!block.readOnly && !isPublicCanvas && !isTransactional && recipientInfo()" ng-click="chooseSegments($event);">\r\n                <span class="c-section-highlight__label-text">Who should see this?</span>\r\n                <span class="c-section-highlight__label-text-highlight">{{recipientInfo()}}</span>\r\n            </button>\r\n\r\n            <span class="c-section-bar__label c-section-bar__label--locked" ng-if="!block.readOnly && !isPublicCanvas">Locked</span>\r\n            <span class="c-section-bar__label c-section-bar__label--partially-locked" ng-if="!block.readOnly && !isPublicCanvas">Edit content only</span>\r\n            <span class="c-section-bar__label c-section-bar__label--partially-locked-removable" ng-if="!block.readOnly && !isPublicCanvas" ng-hide="confirmation">Edit content</span>\r\n\r\n            <div class="c-section-controls" ng-class="{ \'is-active\': confirmation }" ng-show="block.isActive">\r\n                <a href="#" ng-if="sortable" class="c-section-controls__button c-section-controls__button--move emb-js-section-reorder" ng-hide="confirmation" ng-click="$event.preventDefault();">\r\n                    Move\r\n                </a>\r\n                <button class="c-section-controls__button c-section-controls__button--duplicate" ng-click="duplicateSection(); $event.stopPropagation();" ng-hide="confirmation">\r\n                    Duplicate\r\n                </button>\r\n                <button class="c-section-controls__button c-section-controls__button--delete" ng-click="$event.preventDefault(); $event.stopPropagation(); showConfirmation();" ng-hide="confirmation">\r\n                    Delete\r\n                </button>\r\n\r\n                <div class="c-section-controls__confirm-button-panel" ng-show="confirmation">\r\n                    <strong>Do you really want to delete?</strong>\r\n                    <button class="c-section-controls__button" ng-click="remove(); $event.preventDefault(); $event.stopPropagation()">Yes</button>\r\n                    <button class="c-section-controls__button" ng-click="hideConfirmation(); $event.stopPropagation()">No</button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>'}),define("vendor/text!modules/emailbuilder/templates/contentControls.html",[],function(){return'<div ng-class="{\'emb-content-controls emb-reset\' : !imageControls && !textControls && (!narrowControls || (narrowControls && !active))}">\r\n    <div class="c-button-delete emb-js-animation-allowed"\r\n        ng-if="showDelete()"\r\n        ng-show="active"\r\n        ng-click="showConfirmation()"\r\n        ng-class="{ \'is-selected\' : confirmation, \'is-active\' : active, \'is-inactive\' : !active}">\r\n        <button\r\n            class="c-button-delete__confirm"\r\n            ng-click="remove(); $event.preventDefault()">Delete</button>\r\n        <button class="c-button-delete__cancel" ng-click="hideConfirmation(); $event.stopPropagation()">Cancel</button>\r\n    </div>\r\n\r\n    <div class="c-toolbar__delete-container emb-active"\r\n        ng-if="textControls"\r\n        ng-class="{ \'emb-selected\' : confirmation }">\r\n        <button class="c-toolbar__button" ng-click="showConfirmation()" ng-hide="confirmation">Delete block</button>\r\n        <div class="c-toolbar__delete-confirmation" ng-show="confirmation">\r\n            <strong class="c-toolbar__delete-container-text">Do you really want to delete?</strong>\r\n            <button\r\n                class="c-toolbar__button emb-confirmation"\r\n                ng-click="remove(); $event.preventDefault()">Yes</button>\r\n            <button class="c-toolbar__button emb-confirmation emb-confirmation-cancel"\r\n                ng-click="hideConfirmation(); $event.stopPropagation()">No</button>\r\n        </div>\r\n    </div>\r\n    <div ng-if="imageControls && canDelete"\r\n         class="c-toolbar__delete-container"\r\n         ng-class="{ \'is-active\' : confirmation }">\r\n        <button class="c-toolbar__button c-toolbar__button--delete"\r\n                ng-click="showConfirmation()"\r\n                ng-hide="confirmation">\r\n            Delete\r\n        </button>\r\n        <div ng-show="confirmation">\r\n            <strong class="c-toolbar__delete-container-text">Do you really want to delete?</strong>\r\n            <button class="c-toolbar__button" ng-click="remove(); $event.preventDefault()">Yes</button>\r\n            <button class="c-toolbar__button" ng-click="hideConfirmation(); $event.stopPropagation()">No</button>\r\n        </div>\r\n    </div>\r\n\r\n</div>'}),define("vendor/text!modules/emailbuilder/templates/headerControls.html",[],function(){return'<div ng-show="itemHovered" class="emb-content-controls emb-reset">\r\n    <div id="content-confirm-header"\r\n        class="c-button-delete emb-js-animation-allowed"\r\n        ng-click="showConfirmation(); $event.stopPropagation()"\r\n        ng-class="{ \'is-selected\' : confirmation, \'is-active\' : active, \'is-inactive\' : !active }">\r\n        <button id="content-delete-header"\r\n            class="c-button-delete__confirm"\r\n            ng-click="remove(); $event.preventDefault()">Delete</button>\r\n        <button class="c-button-delete__cancel" ng-click="hideConfirmation(); $event.stopPropagation()">Cancel</button>\r\n    </div>\r\n</div>'}),define("vendor/text!modules/emailbuilder/templates/badgeControls.html",[],function(){return'<div>\r\n    <div ng-show="(block.isActive)">\r\n        <div class="c-section-controls" ng-class="{ \'is-active\': confirmation }">\r\n            <div class="c-section-controls__button-container">\r\n                <button class="c-section-controls__button c-section-controls__button--delete" ng-click="$event.preventDefault(); $event.stopPropagation(); showConfirmation();"></button>\r\n            </div>\r\n            <div class="c-section-controls__confirm-button-panel" ng-show="confirmation">\r\n                <div class="c-section-controls__confirm-button-panel-inner">\r\n                    <button class="c-section-controls__confirm-button c-section-controls__confirm-button--cancel" ng-click="hideConfirmation(); $event.stopPropagation()">\r\n                        <span class="c-section-controls__confirm-button-text">Cancel</span>\r\n                    </button>\r\n                    <button class="c-section-controls__confirm-button c-section-controls__confirm-button--delete" ng-click="remove(); $event.preventDefault(); $event.stopPropagation()">\r\n                        <span class="c-section-controls__confirm-button-text">Delete</span>\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>'}),define("modules/emailbuilder/directives/itemControls",["vendor/angular","config","modules/emailbuilder/module","vendor/text!modules/emailbuilder/templates/sectionControls.html","vendor/text!modules/emailbuilder/templates/contentControls.html","vendor/text!modules/emailbuilder/templates/headerControls.html","vendor/text!modules/emailbuilder/templates/badgeControls.html"],function(e,t,n,i,r,o,a){function s(e,t,n,i,r,o,a){function s(t){var n=a.getLocks(t);e.canDelete=n.canDeleteContentItems}if(e.$watch("item.isActive",function(t){e.active=t}),e.sectionIndex){e.canDelete=!0;var l=n.model.sections[e.sectionIndex()];l&&(s(l.permissions),e.$on("permissionsChanged:section-"+l.uiId,function(e,t){s(t)}))}}function l(e){this.confirmation=!1,e.$broadcast("content:hideConfirmation")}function c(e){this.confirmation=!0,e.$broadcast("content:showConfirmation")}function u(n,i,r,o,a,s,u){return{scope:{item:"=",itemHovered:"=",narrowControls:"=",textControls:"=",imageControls:"=",closer:"=",confirmation:"=?",sectionIndex:"="},require:"?^embDropzone",template:function(e,t){return d[t.itemType].template},link:function(h,p,f,m){var g=(f.itemType,d[f.itemType]),v=g.init;h.sortable=!1,h.confirmation=!!h.confirmation,h.block=h.item,h.hideConfirmation=e.bind(h,l,r),h.showConfirmation=e.bind(h,c,r),h.isPublicCanvas=t.mode.publicCanvas,h.remove=e.bind(h,g.remove,n,r,m,a,u),h.deactivateContent=function(){r.$emit("content:deactivate")};var b=function(e,t){h.confirmation&&h.hideConfirmation()};h.showDelete=function(){var e=h.item;return!h.textControls&&!h.imageControls&&("image"!==e.type&&"video"!==e.type&&"button"!==e.type&&"divider"!==e.type&&"spacer"!==e.type||("image"===e.type||"video"===e.type)&&!u.hasBlockSrc(e)&&h.canDelete||("button"===e.type||"divider"===e.type||"spacer"===e.type)&&h.canDelete)},r.$on("text:command",b),r.$on("content:deactivated",b),r.$on("content:replaced",b),r.$on("content:activated",b),v&&v(h,r,n,i,o,p,s)}}}var d={section:{template:i,init:function(n,i,r,o,a,s,l){n.canvasPredefinedSections=t.canvasPredefinedSections,n.isTransactional=t.mode.isTransactional,n.$watch(function(){return r.sortability.section},function(e){n.sortable=e});var c=function(e,t,n){if(0===e)return null;var i=1<e?"s":"";return(n?"":e+" ")+t+i},u=function(e,t,n){return[c(e,"list",n),c(t,"segment",n)].filter(function(e){return e}).join(" and ")},d=function(n,i){var r;return e.forEach(t.listsAndSegments,function(t){if(i){if(n===t.listId)return void(r=t.title)}else e.forEach(t.segments,function(e){if(n===e.segmentId)return void(r=e.title)})}),o.ellipsis(r,20)},h=function(){var e=n.item.lists&&n.item.lists.length||0,t=n.item.segments&&n.item.segments.length||0;return"Deleted "+u(e,t,!0)};n.recipientInfo=function(){var i,r,o=0,a=0;e.forEach(n.item.lists,function(e){d(e,!0)&&(i=e,o++)}),e.forEach(n.item.segments,function(e){d(e,!1)&&(r=e,a++)});var s=t.mode.autoresponder?t.listsAndSegments[0].title:"All recipients";return(0===o&&0===a&&(n.item.lists&&n.item.lists.length||n.item.segments&&n.item.segments.length)?h():0===o&&0===a||!t.hasMultipleListsOrSegments?s:1===o&&0===a?d(i,!0):0===o&&1===a?d(r,!1):u(o,a))||s},n.chooseSegments=function(e){n.block.subType="segments",i.$emit("content:activated",{block:n.block,tab:n.block.type})},n.duplicateSection=function(){n.deactivateContent(),r.duplicateSection(n.item);var e=s.parent(),t=e.offset().top+e.height();a.scrollStage({offset:t,relative:!0,duration:1e3,delay:200,easing:"easeInOutExpo"})},n.remove=function(){r.removeSection(this.item),n.deactivateContent()},n.item.style.backgroundColor?n.item.style.tempBackgroundColor=n.item.style.backgroundColor:n.item.style.tempBackgroundColor=r.model.styles.section.backgroundColor,n.$watch("item.style.tempBackgroundColor",function(e){null!==r.model.styles.section&&null!==r.model.styles.section.backgroundColor&&e&&e.toLowerCase()===r.model.styles.section.backgroundColor.toLowerCase()?n.item.style.backgroundColor="":n.item.style.backgroundColor=e});var p=function(e,t){if(e.uiId===t.uiId){var n=a.getElementTopRelativeToEmail(s),i=Math.max(0,105-n);s.parent().css("margin-top",i)}},f=i.$on("content:activated",function(e,t,i){p(t.block,n.item)});n.$on("$destroy",f);var m=i.$on("content:deactivated",function(e,t,n){var i=s.parent();i.removeClass("has-extra-padding"),i.outerHeight()>0&&i.outerHeight()<10&&i.addClass("has-extra-padding"),i.css("margin-top",0)});n.$on("$destroy",m)}},content:{template:r,remove:function(e,t,n){this.item.isActive&&t.$emit("content:deactivate"),e.removeContent(n.getLocation(),this.item)},init:s},header:{template:o,remove:function(e,t,n,i,r){var o=e.model.header;r.hasBlockSrc(e.model.header)||(o.displayType="none"),o.tempValidation&&(o.tempValidation=null),t.$emit("content:deactivate"),o.isActive=!1,r.resetBlock(o)},init:s},templateBadge:{template:a,remove:function(e,t,n,i){e.model.templateBadge.displayBadge=!1,i.contentUpdated()},init:s}};n.directive("embItemControls",["EmailService","TextTrimService","$rootScope","ViewPortService","ModelActivityService","LockLevelService","ContentBlockService",u])}),define("vendor/text!modules/emailbuilder/templates/logo.html",[],function(){
return'<div class="emb-content-inner emb-js-content-inner"\r\n     ng-class="{ \'emb-active\' : block.isActive, \'emb-hoverable\' : !block.isActive, \'emb-img-showing-dropzone\' :  !hasImage }"\r\n     ng-mouseenter="hovered = true"\r\n     ng-mouseleave="hovered = false">\r\n    <div emb-item-controls item-type="header" item="block" item-hovered="hovered"></div>\r\n    <div class="emb-content-inner emb-js-content-inner">\r\n        <div ng-if="!hasImage">\r\n            <div \r\n                class="emb-img-dropzone emb-logo-dropzone emb-reset emb-img-container emb-js-logo-dropzone"\r\n                ng-class="{\'emb-error\' : !block.tempIsValid, \'emb-hovered\': hovered }">\r\n                <div class="emb-dropzone-container">\r\n                    <form>\r\n                        <input name="file" class="emb-invisible-input" type="file" accepts="image/*"/>\r\n                    </form>\r\n                    <p class="emb-drop-icon">\r\n                        <span class="emb-image-well"></span>\r\n                        <span class="emb-drop-text">Drag your logo here</span>\r\n                    </p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div ng-if="hasImage">\r\n            <img class="emb-js-header" emb-disable-drag ng-src="{{logoSrc}}" width="{{block.width}}" height="{{block.height}}" ng-style="{ \'max-width\': block.width }" />\r\n        </div>\r\n    </div>\r\n</div>\r\n'}),define("modules/emailbuilder/directives/logo",["vendor/angular","modules/emailbuilder/module","vendor/text!modules/emailbuilder/templates/logo.html"],function(e,t,n){function i(t,i,r){return{restrict:"A",template:n,link:function(n,o,a){if(n.block=t.model.header,n.block.editableTextKey=n.block.editableTextKey||void 0,!n.block.halign){var s=o.closest("[default-align]").attr("default-align");void 0===s&&(s="center"),n.block.halign=s}o.on("change",'input[type="file"]',function(t){if(""!==e.element(this).val()){var r=this.files[0];i.uploadAsync({file:r,block:function(){return n.block}})}});var l=function(){var e=o.find('input[type="file"]');e.length>0&&e.parent()[0].reset()};n.$watch(function(e){return r.getBlockSrc(e.block)},function(e){e&&(n.logoSrc=e),l(),n.hasImage=!!e})}}}t.directive("embLogo",["EmailService","ImageManagerService","ContentBlockService",i])}),define("vendor/text!modules/emailbuilder/templates/headerLogo.html",[],function(){return'<div class="emb-header-logo" ng-if="header.displayType == \'image\' || header.displayType == \'text\'">\r\n    <div ng-if="header.displayType == \'image\'">\r\n        <div style="position:relative">\r\n            <emb-validation-messages clear-on-inactive="1" model="header"></emb-validation-messages>\r\n            <div emb-image-drop-container="header" replace="true">\r\n                <div emb-logo></div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div ng-if="header.displayType == \'text\'" class="emb-content-inner emb-js-content-inner"\r\n         ng-class="{ \'emb-active\' : header.isActive, \'emb-hoverable\' : !header.isActive}"\r\n         ng-mouseenter="hovered = true"\r\n         ng-mouseleave="hovered = false">\r\n            <div emb-item-controls item-type="header" item="header" item-hovered="hovered"></div>\r\n            <div class="emb-js-header" emb-text-block block="header" singleline="1"></div>\r\n    </div>\r\n</div>\r\n'}),define("vendor/text!modules/emailbuilder/templates/staticHeaderLogo.html",[],function(){return'<div class="emb-header-logo" ng-if="(header.displayType == \'image\' && header.src) || (header.displayType == \'text\' && header.contents)">\r\n    <div ng-if="header.displayType == \'image\'">\r\n        <img emb-disable-drag ng-src="{{header.src}}" width="{{header.width}}" height="{{header.height}}" ng-style="{ \'max-width\': header.width }" />\r\n    </div>\r\n    <div ng-if="header.displayType == \'text\'" ng-style="{ width : header.container.width }">\r\n        {{header.contents}}\r\n    </div>\r\n</div>\r\n'}),define("modules/emailbuilder/directives/headerLogo",["config","modules/emailbuilder/module","vendor/text!modules/emailbuilder/templates/headerLogo.html","vendor/text!modules/emailbuilder/templates/staticHeaderLogo.html"],function(e,t,n,i){function r(){return{restrict:"E",template:e.mode.customisable?n:i,scope:{header:"="},link:function(t,n,i){function r(){null!==h&&(t.header.hasHorizontalLogoPadding?h.addClass("header--padded--inline"):h.removeClass("header--padded--inline"))}function o(){var e="image"===t.header.displayType,n=(e?0:l).toString()+"px",i=(e?0:c).toString()+"px";p.forEach(function(e){e.style[u]=t.header.paddingTop.toString()+"px",e.style[d]=t.header.paddingBottom.toString()+"px"}),m.style.fontSize=n,m.style.lineHeight=i}t.header.contents=t.header.contents||"";var u,d,h=n.parents("#emb-email-header-container"),p=h.find(".emb-logo-padding-box").get();p.length?(u="paddingTop",d="paddingBottom"):(p=n.parents(".emb-logo-margin-box").get(),u="marginTop",d="marginBottom");var f=n.closest("#emb-email-header"),m=f.length?f[0]:null;p.length&&(null===t.header.paddingTop&&(t.header.paddingTop=a),null===t.header.paddingBottom&&(t.header.paddingBottom=s),o(),t.$watch("header.paddingTop",o),t.$watch("header.paddingBottom",o),t.$watch("header.displayType",o),e.email.isBlueprint&&(r(),t.$watch("header.hasHorizontalLogoPadding",r),t.$watch("header.displayType",r)))}}}var o=e.email.config.defaultTheme.headerAndFooter.logoContainerStyles,a=o?o.logoPaddingTop:24,s=o?o.logoPaddingBottom:24,l=o?o.textLogoFontSize:32,c=o?o.textLogoLineHeight:40;t.directive("embHeaderLogo",r)}),define("vendor/text!modules/emailbuilder/templates/guidance.html",[],function(){return'<div class="emb-guidance-inner">\r\n    <p class="emb-guidance-content" relation="#emb-js-sidebar" position="right top" offset="5 206" ng-class="::{\'emb-dark-bg\': darkBg, \'emb-light-bg\': !darkBg}">Drag and Drop Content Tiles To Build Your Email</p>\r\n    <p class="emb-guidance-layout" relation="#emb-new-section-btn" position="center bottom" offset="90 25" ng-class="::{\'emb-dark-bg\': darkBg, \'emb-light-bg\': !darkBg}">Layouts Are pre-designed areas where you can drag content</p>\r\n</div>\r\n'}),define("modules/emailbuilder/directives/guidance",["config","jqueryui","vendor/jquery.colorpicker","vendor/angular","modules/emailbuilder/module","vendor/text!modules/emailbuilder/templates/guidance.html"],function(e,t,n,i,r,o){function a(n,r){return{restrict:"A",template:o,link:function(o,a,s){function l(e){var t=e.split(" ");return{xpos:t[0],ypos:t[1]}}function c(e){var t=e.rel.offset(),n=0,i=0;switch(e.pos.xpos){case"right":n=e.rel.width()+t.left;break;case"center":n=t.left+e.rel.height()/2}switch(e.pos.ypos){case"bottom":i=t.top+e.rel.height();break;case"top":i=t.top}return{top:i+e.offset.y,left:n+e.offset.x}}function u(e){var t=c(e),n=e.elem[0];n.style.left=t.left+"px",n.style.top=t.top+"px",n.style.display=t.top>0?"block":"none"}function d(e){var t,n={x:0,y:0};return void 0!==e&&(t=e.split(" "),n.x=parseInt(t[0],10),2==t.length&&(n.y=parseInt(t[1],10))),n}function h(){y.each(function(e,t){var n=i.element(t);u({elem:n,rel:i.element(n.attr("relation")),pos:l(n.attr("position")),offset:d(n.attr("offset"))})})}function p(){y.fadeOut("slow"),f(),m(),g(),v()}var f,m,g,v,b=e.email.styles?e.email.styles.body.backgroundColor:"ffffff",y=a.find("p:visible"),w=t.fn.ColorPickerHex2HSB(b);o.darkBg=w.s>30||w.b<80,r(function(){h(),t(".emb-guidance-content").hide().css("opacity","1").delay(500).fadeIn("slow"),t(".emb-guidance-settings").hide().css("opacity","1").delay(500).fadeIn("slow"),t(".emb-guidance-layout").hide().css("opacity","1").delay(1e3).fadeIn("slow"),t(".emb-guidance-logo").hide().css("opacity","1").delay(1e3).fadeIn("slow")}),g=n.$on("content:activated",p),v=n.$on("content:deactivated",p),f=n.$on("tile.content.pushed",p),m=n.$on("currentPane.switched",p)}}}r.directive("embGuidance",["$rootScope","$timeout",a])}),define("modules/emailbuilder/directives/socialTag",["vendor/angular","config","modules/emailbuilder/module"],function(e,t,n){function i(e,n,i){return{restrict:"A",link:function(r,o,a){switch(o.click(function(e){e.preventDefault()}),a.cmTagType){case"webversion":if(t.canvasSectionPermissions){i.getLocks(r.$parent.block.permissions).anyLocking||o.parent().addClass("emb-hoverable"),r.$on("permissionsChanged:header",function(e,t){i.getLocks(t).anyLocking?o.parent().removeClass("emb-hoverable"):o.parent().addClass("emb-hoverable")})}o.parent().addClass("emb-content-inner"),o.on("click",function(t){n(function(){e.$emit("content:activate",{block:{id:(new Date).valueOf(),type:"header",subType:"logo"}})},0)});break;case"preferences":r&&r.block&&(r.block.subType="otherSettings",r.$parent.block.subType="otherSettings"),o.on("click",function(t){n(function(){e.$emit("content:activate",{block:{id:(new Date).valueOf(),type:"footer",subType:"otherSettings"}})},0)});break;case"tweet":case"fblike":case"forwardtoafriend":r&&r.block&&(r.block.subType="sharingEmail"),o.addClass("emb-content-inner"),o.on("click",function(t){n(function(){e.$emit("content:activate",{block:{id:(new Date).valueOf(),type:"footer",subType:"sharingEmail"}})},0),t.stopPropagation()})}}}}n.directive("cmTagType",["$rootScope","$timeout","LockLevelService",i])}),define("modules/emailbuilder/components/promo/promo.controller",["modules/emailbuilder/module"],function(e){function t(){this.item={classModifier:"getfeedback",heading:"Introducing GetFeedback, our new survey builder.",description:"<p>Easily create engaging, mobile-ready online surveys in minutes.</p>",imageSrc:"/img/emailbuilder/promo/promo-image.png",imageSrc2x:"/img/emailbuilder/promo/promo-image@2x.png",imageAlt:"Get Feedback",buttonText:"Get started now",linkURL:"http://www.google.com"}}e.controller("promoController",t)}),define("vendor/text!modules/emailbuilder/components/promo/promo.html",[],function(){return'<div class="integration-promo" ng-cloak ng-class="\'integration-promo--\' + promoCtrl.item.classModifier">\r\n    <div class="integration-promo__inner" emb-connect-get-feedback-popup emb-connection-started="onStartConnecting()" emb-connection-completed="onCompleteConnecting(cancelled, succeeded, errors, completedCallback)">\r\n        <div class="integration-promo__image-container u-image-shadow">\r\n            <a href="#">\r\n                <img class="integration-promo__image" ng-src="{{ imageDomain }}{{ promoCtrl.item.imageSrc }}" alt="{{ promoCtrl.item.imageAlt }}" ng-srcset="{{ imageDomain }}{{ promoCtrl.item.imageSrc }}, {{ imageDomain }}{{ promoCtrl.item.imageSrc2x }} 2x" />\r\n            </a>\r\n        </div>\r\n        <div class="integration-promo__content">\r\n            <h2 class="integration-promo__heading">{{ promoCtrl.item.heading }}</h2>\r\n            <div class="integration-promo__description" ng-bind-html="promoCtrl.item.description">\r\n            </div>\r\n            <button ng-disabled="connectionInProgress" class="integration-promo__button">{{ connectionInProgress ? \'Connecting...\' : promoCtrl.item.buttonText }}</button>\r\n            <div ng-show="showConnectionErrorMessage" class="c-error c-error--from-top c-error--connection">\r\n                <h2 class="c-error__heading">There was an error</h2>\r\n                <p class="c-error__message">{{connectionErrorMessage}}</p>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n'}),define("modules/emailbuilder/components/promo/promo.directive",["vendor/angular","config","modules/emailbuilder/module","vendor/text!modules/emailbuilder/components/promo/promo.html"],function(e,t,n,i){function r(){function e(e,n,i){e.imageDomain=t.urls.staticResourceBase}return{restrict:"EA",link:e,template:i,controller:"promoController",controllerAs:"promoCtrl"}}n.directive("cmPromo",r)}),define("modules/emailbuilder/components/notification/notification-item.controller",["modules/emailbuilder/module"],function(e){function t(){}e.controller("notificationItemController",t)}),define("vendor/text!modules/emailbuilder/components/notification/notification-item.html",[],function(){return'<div class="notification__item l-contained-notification">\r\n  <div class="notification__image-container">\r\n    <img class="notification__image" ng-src="{{ item.image }}" alt="{{ item.heading }}" />\r\n  </div>\r\n  <div class="notification__content">\r\n    <h2 class="notification__heading">{{ item.heading }}</h2>\r\n    <div class="notification__description" ng-bind-html="item.description"></div>\r\n  </div>\r\n</div>'}),define("modules/emailbuilder/components/notification/notification-item.directive",["modules/emailbuilder/module","vendor/text!modules/emailbuilder/components/notification/notification-item.html"],function(e,t){function n(){function e(e,t,n,i){}return{restrict:"EA",link:e,template:t,controller:"notificationItemController",controllerAs:"notifyItemCtrl",scope:{item:"="}}}e.directive("cmNotifyItem",n)}),define("modules/emailbuilder/components/notification/notification.controller",["config","modules/emailbuilder/module","vendor/angular"],function(e,t,n){function i(e,t,i,r){function o(e){n.element(e.target).inheritedData("notifier")||(u(),n.element("body").off("click",o))}function a(e){var t=100*(e-1);t*=-1,v.position=t,v.transform="translateX("+t+"%)"}function s(e){v.currentItem=e,a(v.currentItem)}function l(e){return v.currentItem===e}function c(){v.isActive=!v.isActive,n.element("body").on("click",o),v.setFocus(),s(v.currentItem?v.currentItem:1)}function u(){v.isActive=!1,e(function(){r.$digest()})}function d(){!1===v.items[v.currentItem-1].read&&(i.markNotificationAsRead(v.items[v.currentItem-1].id),v.numberOfNewNotifications--,v.items[v.currentItem-1].read=!0),v.currentItem=v.currentItem===v.items.length?1:v.currentItem+1,a(v.currentItem),0===v.numberOfNewNotifications&&u()}function h(){v.currentItem=1===v.currentItem?v.items.length:v.currentItem-1,a(v.currentItem)}function p(e){var t={37:function(){h()},39:function(){d()},27:function(){u()}};return"function"==typeof t[e]&&t[e]()}function f(e){p(e.keyCode.toString())}function m(){var t,n;n=v.isActive?".js-notification":".js-notify",t=document.querySelector(n),e(function(){t.focus()})}function g(){e(function(){return i.getNotifications().then(function(t){if(t&&t.length>0)return v.items=t,v.numberOfNewNotifications=v.items.length,a(1),v.items[0].openByDefault&&(v.isActive=!0,e(function(){i.markNotificationAsOpened(v.items[0].id)},5e3)),v.items})},5e3)}var v=this;v.isActive=!1,v.currentItem=1,v.items=[],v.position=0,v.transform="translateX(0%)",v.setPositionX=a,v.isSelected=l,v.selectItem=s,v.toggleActive=c,v.next=d,v.back=h,v.closeNotifications=u,v.navigateKeys=f,v.keyControl=p,v.setFocus=m,v.getItems=g,v.numberOfNewNotifications=0,v.getItems(),t(function(){v.getItems()},18e5)}t.controller("notificationController",i),i.$inject=["$timeout","$interval","NotificationService","$scope"]}),define("vendor/text!modules/emailbuilder/components/notification/notification.html",[],function(){return'<div class="notification-wrapper" ng-hide="notifyCtrl.numberOfNewNotifications === 0" ng-class="{ \'a-reveal-scale\' : notifyCtrl.numberOfNewNotifications >= 1 }" ng-click="$event.stopPropagation();">\r\n\r\n    <button class="c-button-pill js-notify" ng-class="{ \'is-active\' : notifyCtrl.isActive }" ng-click="notifyCtrl.toggleActive(); $event.stopPropagation();">\r\n        <span>{{ notifyCtrl.numberOfNewNotifications }}</span> New Update{{notifyCtrl.numberOfNewNotifications === 1 ? \'\':\'s\'}}\r\n    </button>\r\n    <div aria-hidden="{{ !notifyCtrl.isActive }}" tabindex="{{ notifyCtrl.isActive ? 0 : -1 }}" class="notification-position sibling-toggle js-notification" ng-keyup="notifyCtrl.navigateKeys($event)">\r\n      <div class="notification">\r\n        <div class="arrow-top" aria-hidden="true"></div>\r\n          <div class="notification__inner">\r\n            <ul class="notification__list flex-column-wrap">\r\n                <li ng-repeat="item in notifyCtrl.items | limitTo: 9" class="notification__list-item" ng-style="{ transform : notifyCtrl.transform }" id="{{ \'notification_\' + $index }}">\r\n                  <cm-notify-item item="item"></cm-notify-item>\r\n                </li>\r\n            </ul>\r\n              <div class="notification__navigation-wrapper">\r\n\r\n                    <div class="notification__navigation-inner l-flex l-flex-align-items-center l-flex-justify-space-between">\r\n                        <nav class="notification__navigation l-flex-justify-start l-percentage-100">\r\n\r\n                            <button ng-disabled="notifyCtrl.currentItem === 1" aria-controls="{ \'notification_\' + (notifyCtrl.currentItem - 1) }" class="c-button c-button--grey" ng-click="notifyCtrl.back(); $event.stopPropagation();">Previous</button>\r\n\r\n                            <button aria-controls="{ \'notification_\' + (notifyCtrl.currentItem + 1) }"\r\n                                    ng-show="notifyCtrl.currentItem !== notifyCtrl.items.length"\r\n                                    class="c-button c-button--primary" ng-click="notifyCtrl.next(); $event.stopPropagation();">\r\n                                Next\r\n                            </button>\r\n\r\n                            <button ng-show="notifyCtrl.currentItem === notifyCtrl.items.length"\r\n                                    class="c-button c-button--primary" ng-click="notifyCtrl.next(); $event.stopPropagation();">\r\n                                Close\r\n                            </button>\r\n\r\n                            <span class="text-alternative">or</span>\r\n                            <button class="c-button c-button--link-grey" ng-click="notifyCtrl.closeNotifications(); $event.stopPropagation();">Read later</button>\r\n                        </nav>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>'}),define("modules/emailbuilder/components/notification/notification.directive",["config","vendor/angular","modules/emailbuilder/module","vendor/text!modules/emailbuilder/components/notification/notification.html"],function(e,t,n,i){function r(){function e(e,t,n,i){t.data("notifier",!0)}return{restrict:"EA",link:e,template:i,controller:"notificationController",controllerAs:"notifyCtrl"}}n.directive("cmNotify",r)}),define("modules/emailbuilder/components/popover/popover-item.controller",["modules/emailbuilder/module"],function(e){function t(){}e.controller("popoverItemController",t)}),define("vendor/text!modules/emailbuilder/components/popover/popover-item.html",[],function(){return'<div class="c-popover__content">\r\n    <h2 class="c-popover__title">{{ item.heading }}</h2>\r\n    <div class="c-popover__text" ng-bind-html="item.description"></div>\r\n</div>\r\n'}),define("modules/emailbuilder/components/popover/popover-item.directive",["modules/emailbuilder/module","vendor/text!modules/emailbuilder/components/popover/popover-item.html"],function(e,t){function n(){function e(e,t,n,i){}return{restrict:"EA",link:e,template:t,controller:"popoverItemController",controllerAs:"popoverItemCtrl",scope:{item:"="}}}e.directive("cmPopoverItem",n)}),define("modules/emailbuilder/components/popover/popover.controller",["vendor/angular","modules/emailbuilder/module"],function(e,t){function n(t,n,i){function r(e){var t=100*(e-1);t*=-1,d.position=t,d.transform="translateX("+t+"%)"}function o(t){e.element(t.target).inheritedData("popoverTarget")||(c(),e.element("body").off("click",o))}function a(e){return d.currentItem===e}function s(){d.isActive=!d.isActive,e.element("body").on("click",o)}function l(e){d.currentItem=e,r(d.currentItem)}function c(){d.isActive=!1,l(1),i(function(){n.$digest()})}function u(){d.currentItem=d.currentItem===d.items.length?1:d.currentItem+1,r(d.currentItem)}var d=this;d.isActive=!1,d.currentItem=1,d.items=[],d.position=0,d.transform="translateX(0%)",d.setPositionX=r,d.toggleActive=s,d.isSelected=a,d.selectItem=l,d.next=u,d.closePopover=c,t.$on("displayPopover",function(){d.isActive=!0,e.element("body").on("click",o)}),d.items=[{from_direction:"left",position_top:"160px",position_left:"305px",heading:"Select or create a new survey",description:"<p>Your Campaign Monitor and GetFeedback accounts are connected. Select a survey or create a new survey from here.</p>"}]}t.controller("popoverController",n),n.$inject=["$rootScope","$scope","$timeout"]}),define("vendor/text!modules/emailbuilder/components/popover/popover.html",[],function(){return'<div class="c-popover" ng-show="popoverCtrl.isActive" tabindex="{{ popoverCtrl.isActive ? 0 : -1 }}" ng-style="{ top: popoverCtrl.items[(popoverCtrl.currentItem - 1)].position_top, left: popoverCtrl.items[(popoverCtrl.currentItem - 1)].position_left }">\r\n    <div class="u-arrow" ng-class="{{ \'u-arrow--\' + popoverCtrl.items[(popoverCtrl.currentItem - 1)].from_direction }}"></div>\r\n    <div class="c-popover__inner">\r\n        <ul class="flex-column-wrap">\r\n            <li ng-repeat="item in popoverCtrl.items" class="c-popover__item" ng-style="{ transform : popoverCtrl.transform }" id="{{ \'popover_\' + $index }}">\r\n                <cm-popover-item item="item"></cm-popover-item>\r\n            </li>\r\n        </ul>\r\n        <nav class="c-popover__navigation">\r\n\r\n            <button ng-show="popoverCtrl.currentItem !== popoverCtrl.items.length" aria-controls="{ \'popover_\' + (popoverCtrl.currentItem + 1) }" class="c-button c-button--grey" ng-click="popoverCtrl.next();$event.preventDefault();">Next</button>\r\n\r\n            <button ng-show="popoverCtrl.currentItem === popoverCtrl.items.length" aria-controls="{ \'popover_\' + (popoverCtrl.currentItem + 1) }" class="c-button c-button--grey" ng-click="popoverCtrl.closePopover();$event.preventDefault();">OK, Got it</button>\r\n        </nav>\r\n    </div>\r\n</div>\r\n'}),define("modules/emailbuilder/components/popover/popover.directive",["config","vendor/angular","modules/emailbuilder/module","vendor/text!modules/emailbuilder/components/popover/popover.html"],function(e,t,n,i){function r(){function e(e,t,n,i){t.data("popoverTarget",!0)}return{restrict:"EA",link:e,template:i,controller:"popoverController",controllerAs:"popoverCtrl"}}n.directive("cmPopover",r)}),define("vendor/text!modules/emailbuilder/templates/surveyProperties.html",[],function(){
return'<section class="emb-js-property-pane emb-pane emb-reset emb-button-pane emb-button-properties" ng-show="editor == \'survey\'">\r\n    <form name="contentFormSurvey" novalidate="novalidate" ng-submit="close()">\r\n        <cm-popover></cm-popover>\r\n        <div class="l-sidebar-inner">\r\n            <div class="c-sidebar__intro">\r\n                <h2 class="c-sidebar__heading-primary">Survey settings</h2>\r\n            </div>\r\n            <div class="sidebar__accordion-item">\r\n                <div class="sidebar__form--accordion">\r\n                    <div ng-if="!isConnectedToGetFeedback && !isIFramed">\r\n                        <cm-promo></cm-promo>\r\n                    </div>\r\n                    <div class="c-error c-error--no-arrow" ng-if="!isConnectedToGetFeedback && isIFramed">\r\n                        <h2 class="c-error__heading">Button settings not available</h2>\r\n                        <p class="c-error__message">Please recreate this button to access its settings.</p>\r\n                    </div>\r\n                    <div ng-show="isConnectedToGetFeedback && isPermittedToConnect">\r\n                        <div ng-show="isConnectedToGetFeedback">\r\n                            <p class="c-sidebar__text c-sidebar__text--settings">{{ ConnectedMessage }}<span class="integration__connect-details" title="{{ ConnectedAccountEmail }}">{{ ConnectedAccountName }}</span>. <a class="integration__link" href="#" ng-click="disconnect()">Disconnect</a></p>\r\n                        </div>\r\n                        <div ng-hide="isPermittedToConnect">\r\n                            <p class="c-sidebar__text c-sidebar__text--settings">Connect to GetFeedback to select or create an engaging and mobile-ready survey.</p>\r\n                            <button ng-disabled="true" class="c-button c-button--grey">Connect to GetFeedback</button>\r\n                            <div class="c-error c-error--connection c-error--no-arrow">\r\n                                <h2 class="c-error__heading">There was an error</h2>\r\n                                <p class="c-error__message">{{connectionErrorMessage}}</p>\r\n                            </div>\r\n                        </div>\r\n                        <div ng-class="{ \'is-connected\': isConnectedToGetFeedback, \'has-errors--connection\' : showConnectionErrorMessage }">\r\n                            <ul role="tablist" class="l-grid l-grid--inline-block l-grid--vertical-spacing">\r\n                                <li class="l-grid__item l-grid__item--100" ng-show="isConnectedToGetFeedback">\r\n                                    <input type="hidden" ng-model="active.content.surveyId" emb-save-on-model-change ng-change="setActive(active.content)" />\r\n                                    <label class="c-sidebar__label">Select or create a survey</label>\r\n                                    <div class="integration__select" ng-class="{\'is-inactive\': active.content.surveyId ===\'\', \'is-active\': active.content.surveyId!=\'\' }">\r\n                                        <span class="integration__select__label">\r\n                                            <a target="_blank" ng-href="{{active.content.previewUrl}}" class="integration__link" ng-init="setActive(active.content)">Preview</a> or <a ng-href="{{active.content.editUrl}}" target="_blank" class="integration__link">Edit</a> selected survey\r\n                                        </span>\r\n                                        <button class="integration__select__button" ng-click="openNewSurvey();$event.preventDefault();">New</button>\r\n                                    </div>\r\n                                    <div class="integration__select__gallery">\r\n                                        <div class="loading__inner" ng-show="surveyLoadingInProgress">\r\n                                            <span class="loading__inner__dot"></span>\r\n                                            <span class="loading__inner__dot"></span>\r\n                                            <span class="loading__inner__dot"></span>\r\n                                        </div>\r\n                                        <ul class="integration__select__list" ng-hide="surveyLoadingInProgress">\r\n                                            <li ng-repeat="surveyDetails in availableSurveys">\r\n                                                <div class="integration__select__list-item-container" aria-hidden="true" ng-click="active.content.surveyId !== surveyDetails.value ? setActive(surveyDetails) : setInactive(surveyDetails)" ng-class="{\'is-active\' : active.content.surveyId === surveyDetails.value}"\r\n                                                     emb-scroll-container-if="active.content.surveyId === surveyDetails.value" emb-scroll-container-offset="10" emb-scroll-container-parent="2">\r\n                                                    <div class="integration__select__list-item" ng-style="{ backgroundImage: \'url(\' + surveyDetails.thumbnail + \')\' }">\r\n                                                        <span class="integration__select__list-item-border" aria-hidden="true"></span>\r\n                                                        <span class="integration__select__list-item-icon" aria-hidden="true" ng-if="active.content.surveyId === surveyDetails.value"></span>\r\n                                                        {{surveyDetails.display}}\r\n                                                    </div>\r\n                                                </div>\r\n                                            </li>\r\n                                        </ul>\r\n                                    </div>\r\n                                </li>\r\n                                <li class="l-grid__item l-grid__item--100">\r\n                                    <label class="c-sidebar__label " for="emb-form-survey-btn-text">Button text</label>\r\n                                    <input cs-focus="editor == \'survey\' && !showContent && (active.content.tempIsNew || contentFormSurvey.surveyBtnTxt.$invalid)"\r\n                                           select-when="Text here"\r\n                                           ng-focus="contentFormSurvey.surveyBtnTxt.focused = true"\r\n                                           ng-blur="contentFormSurvey.surveyBtnTxt.focused = false"\r\n                                           ng-model="active.content.text"\r\n                                           emb-save-on-blur\r\n                                           ng-required="true"\r\n                                           id="emb-form-survey-btn-text"\r\n                                           class="c-input"\r\n                                           name="surveyBtnTxt" type="text" />\r\n                                </li>\r\n                                <li class="l-grid__item l-grid__item--100">\r\n                                    <label class="c-sidebar__label">Button color</label>\r\n                                    <div class="c-colorpicker-container">\r\n                                        <div class="c-colorpicker c-colorpicker--light c-colorpicker--input">\r\n                                            <div cs-color-picker cs-viewport="#emb-js-sidebar" ng-model="active.content.tempBackgroundColor"></div>\r\n                                        </div>\r\n                                    </div>\r\n                                </li>\r\n                                <li class="l-grid__item l-grid__item--100">\r\n                                    <label class="c-sidebar__label">Text color</label>\r\n                                    <div class="c-colorpicker-container">\r\n                                        <div class="c-colorpicker c-colorpicker--light c-colorpicker--input">\r\n                                            <div cs-color-picker cs-viewport="#emb-js-sidebar" ng-model="active.content.tempTextColor"></div>\r\n                                        </div>\r\n                                    </div>\r\n                                </li>\r\n                                <li class="l-grid__item l-grid__item--50">\r\n                                    <cm-segmented-control\r\n                                        group-name="survey-alignment"\r\n                                        group-legend="Alignment"\r\n                                        group-class-name="c-segmented-control--alignment"\r\n                                        ng-model="active.content.halign"\r\n                                        emb-save-on-model-change>\r\n                                        <cm-segmented-control-item\r\n                                            item-name="Left"\r\n                                            item-value="left"\r\n                                            segment-id="survey-left"\r\n                                            class-names="c-segmented-control--alignment-left">\r\n                                        </cm-segmented-control-item>\r\n                                        <cm-segmented-control-item\r\n                                            item-name="Center"\r\n                                            item-value="center"\r\n                                            segment-id="survey-center"\r\n                                            class-names="c-segmented-control--alignment-center"\r\n                                            is-default>\r\n                                        </cm-segmented-control-item>\r\n                                        <cm-segmented-control-item\r\n                                            item-name="Right"\r\n                                            item-value="right"\r\n                                            segment-id="survey-right"\r\n                                            class-names="c-segmented-control--alignment-right">\r\n                                        </cm-segmented-control-item>\r\n                                    </cm-segmented-control>\r\n                                </li>\r\n                            </ul>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </form>\r\n    <footer class="hmb-dismiss-container">\r\n        <input type="submit" value="Done editing" class="c-button c-button--primary c-button--large" ng-click="close()">\r\n    </footer>\r\n</section>'}),define("modules/emailbuilder/directives/surveyProperties",["config","vendor/angular","underscore","modules/emailbuilder/module","vendor/text!modules/emailbuilder/templates/surveyProperties.html"],function(e,t,n,i,r){function o(e,t){e.surveyListErrorMessage="The survey that was selected has changed or is no longer available. Please select another one.",e.showSurveyListErrorMessage=!0,e.active.content.href=null,e.active.content.surveyTitle=null,e.active.content.surveyId=null,e.active.content.previewUrl=null,e.active.content.editUrl=null,t.contentUpdated()}function a(e,t){t.display!==e.active.content.surveyTitle&&(e.active.content.surveyTitle=t.display)}function s(e,t){var i,r=e.active&&e.active.content;if(r&&(i=e.active.content.surveyId)){var s=n.find(e.availableSurveys,function(e){return e.value===i});s?a(e,s):o(e,t)}}function l(e){var t;return n.each(y,function(n){n.errorSearchRegex.test(e)&&(t=n.friendlyMessageReplacement)}),t||e}function c(e,t){var n=t.ConnectedAccountName&&t.ConnectedAccountName.length;t.ConnectedAccountEmail&&t.ConnectedAccountEmail.length;e.isConnectedToGetFeedback=!0,e.ConnectedAccountName=t.ConnectedAccountName,e.ConnectedAccountEmail=t.ConnectedAccountEmail,e.ConnectedMessage=n?"Currently connected to the GetFeedback account of ":"Currently connected to your GetFeedback account."}function u(e,t){e.isConnectedToGetFeedback=!1,e.surveyLoadingInProgress=!1,e.currentConnectionTitle="Connection error ",e.connectionErrorMessage=t?l(t[0]):"An error occurred connecting to GetFeedback. Please try again in a few minutes.",e.showConnectionErrorMessage=!0}function d(e,t){e.surveyLoadingInProgress=!1,e.surveyListErrorMessage=t?t[0]:"An error occurred retrieving your list of surveys. We will try again shortly.",e.showSurveyListErrorMessage=!0}function h(e){e.isConnectedToGetFeedback=!1,e.currentConnectionTitle="",e.surveyLoadingInProgress=!1}function p(e){}function f(e){e&&e()}function m(e,n,i,r){function o(n){if(e.connectionInProgress=!1,e.surveyLoadingInProgress=!1,!n.data.Data)return u(e),void f(r);if(n.data.Data.NoTokenAvailable||!e.isConnectedToGetFeedback)return e.surveyLoadingInProgress=!1,void f(r);if(n.data.Data.NotPermitted)return e.isPermittedToConnect=!1,u(e,[n.data.Data.Message]),void f(r);if(!n.data.Data.IsSuccessful)return u(e,[n.data.Data.Message]),void f(r);if(n.data.Data.IsSuccessful&&0===n.data.Data.Surveys.length)return c(e,n.data.Data),e.availableSurveys=[],d(e,["You have not created any surveys in GetFeedback yet."]),void f(r);if(n.data.Data.IsSuccessful){c(e,n.data.Data);var o=[];return t.forEach(n.data.Data.Surveys,function(e){o.push({display:e.display,value:e.value,thumbnail:e.thumbnail,href:e.href,editUrl:e.editUrl,previewUrl:e.previewUrl})}),e.availableSurveys=o,s(e,i),void f(r)}}function a(t){e.connectionInProgress=!1,e.surveyLoadingInProgress=!1,e.isConnectedToGetFeedback&&u(e),f(r)}e.isConnectedToGetFeedback||(e.connectionInProgress=!0),e.surveyLoadingInProgress=!0,e.connectionErrorMessage=null,e.showConnectionErrorMessage=!1,e.surveyListErrorMessage=null,e.showSurveyListErrorMessage=!1,n.loadSurveys().then(o).catch(a)}function g(e){var t=e.active&&e.active.content&&e.active.content.href&&e.active.content.href.length>"https://www.getfeedback.com/".length;e.connectionPrompt=t?"To change the selected survey, first connect to GetFeedback.":"Connect to GetFeedback to select or create an engaging and mobile-ready survey."}function v(n,i,r,o,a,s){i.availableSurveys=[],i.isPermittedToConnect=!0,i.isConnectedToGetFeedback=e.isConnectedToGetFeedback,i.currentConnectionTitle="",i.blurred=!1,i.connectionInProgress=!1,i.surveyLoadingInProgress=!1,i.connectionErrorMessage=null,i.showConnectionErrorMessage=!1,i.surveyListErrorMessage=null,i.showSurveyListErrorMessage=!1,i.clearSurveyListError=function(){i.showSurveyListErrorMessage=!1,i.surveyListErrorMessage=""},i.$watch("isConnectedToGetFeedback",function(){g(i)}),i.$watch("active.content.surveyId",function(){t.forEach(i.availableSurveys,function(e){if(e.value===i.active.content.surveyId)return void i.setActive(e)})}),n.onfocus=function(){!i.blurred||i.firstLoad||!i.isConnectedToGetFeedback||i.showSurveyListErrorMessage||s.focusFromOurDirective||(m(i,r,a),i.blurred=!1)},n.onblur=function(){i.blurred=!0,i.firstLoad=!1},i.onStartConnecting=function(){i.connectionInProgress=!0,i.showConnectionErrorMessage=!1,i.connectionErrorMessage=null,o.trackConnectionStart()},i.onCompleteConnecting=function(e,t,n,s){if(i.connectionInProgress=!1,e)return void f(s);t?(i.showConnectionErrorMessage=!1,i.isConnectedToGetFeedback=!0,o.trackConnectionSuccess(),m(i,r,a,s),i.$emit("displayPopover"),i.firstLoad=!0):(u(i,n),f(s))},i.disconnect=function(){i.showSurveyListErrorMessage=!1,i.surveyListErrorMessage="",r.revokeConnection().then(function(){h(i)}).catch(function(){p(i)})},i.setInactive=function(e){e.isActive=!1,i.active.content.surveyTitle="",i.active.content.href="",i.active.content.surveyId="",i.active.content.previewUrl="",i.active.content.editUrl="",a.contentUpdated(),i.clearSurveyListError()},i.setActive=function(e){t.forEach(i.availableSurveys,function(e){e.isActive=!1}),e.isActive=!0,i.active.content.surveyTitle=e.display,i.active.content.href=e.href,i.active.content.surveyId=e.value,i.active.content.previewUrl=e.previewUrl,i.active.content.editUrl=e.editUrl,a.contentUpdated(),i.clearSurveyListError()},i.openNewSurvey=function(){n.open("https://www.getfeedback.com/campaign_monitor/create","_blank")},g(i),i.isConnectedToGetFeedback&&m(i,r,a)}function b(t,n,i,o,a){return{restrict:"E",template:r,link:function(r,s,l){if(!e.surveysEnabled)return void s.hide();v(t,r,n,i,o,a)}}}var y=[{errorSearchRegex:/denied.*request/,friendlyMessageReplacement:"The connection could not be completed since access to your accounts was not agreed to."}];i.directive("embSurveyProperties",["$window","GetFeedbackConnectorService","GetFeedbackMetricsService","ModelActivityService","$rootScope",b])}),define("modules/emailbuilder/directives/connectGetFeedbackPopup",["config","vendor/angular","modules/emailbuilder/module"],function(e,t,n){function i(){u=!1}function r(e,n){n&&n.close(),t.isDefined(c)&&(e.cancel(c),c=void 0)}function o(e,t){e.embConnectionCompleted({cancelled:!1,succeeded:!1,errors:t||["There was an error connecting to GetFeedback. Please try again in a few minutes."],completedCallback:i})}function a(t){return t===e.urls.apiSecureRootUrl}function s(e,t,n,s){t.addEventListener("message",function(t){if("deliverOauthFinished"===t.data.message&&!u){var l=t.data.result.authorizationCode,c=t.data.result.oauthState,d=t.data.result.errorDescription;if(u=!0,r(n,t.source),d)return void o(e,[d]);if(!a(t.origin))return void o(e);s.completeOauthHandshake(l,c).then(function(t){var n="Success"===t.data.Status;e.embConnectionCompleted({cancelled:!1,succeeded:n,errors:t.data.Errors,completedCallback:i})}).catch(function(t){o(e)})}},!1)}function l(t,n,r){return{restrict:"A",scope:{embConnectionStarted:"&",embConnectionCompleted:"&"},link:function(o,a){function l(e){var t=c+"?oauthApplicationID="+u+"&videoplay="+e;o.$emit("getFeedbackConnectStart",t),o.embConnectionStarted()}var c=e.urls.startOAuthToGetFeedback,u=e.urls.getFeedbackEncryptedOAuthApplicationIDForUrl;s(o,t,n,r),o.$on("getFeedbackConnectEnd",function(e,t){t||o.embConnectionCompleted({cancelled:!0,succeeded:!1,errors:[],completedCallback:i})}),a.find("button").on("click",function(e){e.preventDefault(),l(!1)}),a.find("a").on("click",function(e){e.preventDefault(),l(!0)})}}}var c,u=!1;n.directive("embConnectGetFeedbackPopup",["$window","$interval","GetFeedbackConnectorService",l])}),define("modules/emailbuilder/controllers/email",["config","vendor/angular","jquery","modules/emailbuilder/module","underscore","modules/emailbuilder/directives/sectionContainer","modules/emailbuilder/directives/itemControls","ts/modules/emailbuilder/content-blocks/text-block.directive","modules/emailbuilder/directives/logo","modules/emailbuilder/directives/headerLogo","modules/emailbuilder/directives/guidance","modules/emailbuilder/directives/socialTag","modules/emailbuilder/components/promo/promo.controller","modules/emailbuilder/components/promo/promo.directive","modules/emailbuilder/components/notification/notification-item.controller","modules/emailbuilder/components/notification/notification-item.directive","modules/emailbuilder/components/notification/notification.controller","modules/emailbuilder/components/notification/notification.directive","modules/emailbuilder/components/popover/popover-item.controller","modules/emailbuilder/components/popover/popover-item.directive","modules/emailbuilder/components/popover/popover.controller","modules/emailbuilder/components/popover/popover.directive","modules/emailbuilder/directives/surveyProperties","modules/emailbuilder/directives/connectGetFeedbackPopup"],function(e,t,n,i,r){function o(){try{return window.self!==window.top}catch(e){return!0}}function a(n,i,a,s,l,c,u,d,h,p,f,m,g,v,b){function y(e){t.forEach(e,function(e){var n=t.element(e),i=n.attr("cm-tag-type");s.model.social[i]&&(s.model.social[i].width=n.outerWidth())})}v.configureSentry(),b.configureActivityTracking(),e.isFirstRun&&a.path("/firstrun"),n.email=s.model,n.active=l.active,n.languages=e.languages,n.template=e.template,n.isPublicCanvas=e.mode.publicCanvas,n.mode=e.mode,n.surveysEnabled=e.surveysEnabled,n.canvasFastSection=e.canvasFastSection,n.canvasPredefinedSections=e.canvasPredefinedSections,n.canvasSentryMonitoring=e.canvasSentryMonitoring,n.canvasSectionPermissions=e.canvasSectionPermissions,n.cssMyTemplateCreation=e.myTemplateCreation,n.emailBackgroundStatus={loading:!1,hasSrc:!1,updateRepeat:function(e,t){var i={};e=e.startsWith("@")?e:e="@"+e,i[e]=t,f.update(i),"@body-backgroundLayoutImage-backgroundRepeat"===e&&(n.email.styles.body.backgroundLayoutImage.backgroundRepeat=t)}},n.showSaveTemplateAs=!1,n.showSignupForm=!1,n.showTestEmailForm=!1,n.showMissingBackgroundModal=!1,n.showPermissionValidationModal=!1,n.showFooterValidationModal=!1,n.isIFramed=o(),n.layoutBackgroundStatus={loading:!1,hasSrc:!1},n.$watch("email.header.originalWidth",function(t){var i=e.template.containerMaxWidth;e.email.isBlueprint&&n.email.header.hasHorizontalLogoPadding&&(i-=40),n.maxLogoWidth=Math.min(i||p.maxContainerWidth(),t)}),n.$watch("email.header.hasHorizontalLogoPadding",function(t){var i=e.template.containerMaxWidth;e.email.isBlueprint&&t&&(i-=40),n.maxLogoWidth=Math.min(i||p.maxContainerWidth(),n.email.header.originalWidth)}),n.$on("section.moved",function(e,t,n){s.reorderSection(t,n)}),n.$on("content.moved",function(e,t,n,r,o){var a=s.moveContent(r,t,n,o);a&&g(function(){i.$emit("content:activate",{block:a})})}),i.$on("content.add",function(e,t){var n=s.addContent(t.type);n&&i.$emit("content:activate",{block:n})}),i.$on("optionalText:removed",function(e,t){n.email.editableText[t].isDisabled=!0}),i.$on("socialTag:removed",function(e,t){n.email.social[t].on=!1}),i.$on("weblinkTag:removed",function(e,t){n.email.webLinks[t].on=!1}),i.$on("templateBadge:removed",function(e,t){n.email.templateBadge||(n.email.templateBadge={}),n.email.templateBadge.displayBadge=!1}),i.$on("section.add",function(e,t){s.addSection(t)}),i.$on("checkbox:value-changed",function(n,i,r){if(e.email.isBlueprint){var o=t.element("#emb-js-email-body .footer__share-button");o.length&&y(o),o=t.element("#emb-js-email-body .c-social-tag--alignment > a[cs-button]"),o.length&&y(o)}else{var a=t.element("#emb-js-email-body .footer .sharing");a.length&&y(a.find("[cs-button]"))}"show-a-border-for-this-section"===r&&i&&m.updateBorderForSection(i)}),i.closeMissingBackgroundModal=function(){n.showMissingBackgroundModal=!1},n.closePermissionValidationModal=function(){n.showPermissionValidationModal=!1},n.closeFooterValidationModal=function(){n.showFooterValidationModal=!1},n.hideTestModal=function(e){e.preventDefault(),n.showTestEmailForm=!1,e.stopPropagation()};var w=r.throttle(d.move.bind(d),50);n.handleDragOver=function(e){var t={mouseX:e.originalEvent.pageX,mouseY:e.originalEvent.pageY,type:"content",contentType:"file"};g.cancel(_),d.start(t),w(t)},n.handleDrop=function(e,t){g.cancel(_),c.handleDrop(t),d.stop()},n.email.spacing.verticalSpacing=parseInt(n.email.spacing.verticalSpacing,10);var _,S=d.stop.bind(d);n.dragLeave=function(){g.cancel(_),_=g(S,200)},n.closePreview=function(){"preview"===n.embState&&n.showSaveTemplateAs?n.showSaveTemplateAs=!1:"preview"===n.embState&&n.showSignupForm?n.showSignupForm=!1:"preview"===n.embState&&a.path("#/editor")},n.hasListsSegmentsSelected=function(){if(!n.email.sections||0===n.email.sections.length)return!1;if(!e.listsAndSegments||0===e.listsAndSegments.length)return!1;for(var t=0;t<n.email.sections.length;t++){var i=n.email.sections[t];if(i.lists&&i.lists.length>0)return!0;if(i.segments&&i.segments.length>0)return!0}return!1},h.runCheck(),u.update();var k=[],x=t.element("#emb-js-email-body"),C=d.subscribe("*.start",function(){x.removeClass("emb-highlight-allowed")});k.push(C),C=d.subscribe("*.stop",function(){x.addClass("emb-highlight-allowed")}),k.push(C),x.addClass("emb-highlight-allowed"),n.$on("$destroy",function(){k.forEach(function(e){e.unsubscribe()})})}i.controller("EmailCtrl",["$scope","$rootScope","$location","EmailService","ActiveContentService","ImageFileDraggingService","OnboardingService","DraggingService","CheckOnPreviewService","ImageManagerService","DynamicStylesService","SectionIdService","$timeout","RavenService","ModelActivityTrackerService",a])}),define("modules/emailbuilder/controllers/newAccount",["config","vendor/angular","modules/emailbuilder/module"],function(e,t,n){function i(n,i,r,o,a,s){function l(){s.saveInProgress=!1,s.accountCreated=!1,s.downloadSent=!1,s.newAccountSubmitted=!1,s.downloadSubmitted=!1}s.user={enCampaignId:e.enEntityId,timeZone:i.detect(e.timeZones),enDbId:e.enOverrideDbId,email:e.emailAddress},s.showNewAccount=!0,s.newAccountSubmitted=!1,s.downloadSubmitted=!1,s.downloadStep="idle",s.emailRegex=r.getEmailRegExp(),l(),s.showDownloadPanel=function(){s.showNewAccount=!1,s.downloadSent=!1},s.showAccountPanel=function(){s.showNewAccount=!0},s.$watch("showSignupForm",function(){s.showSignupForm||o(function(){s.showNewAccount=!0},500)}),s.sendDownloadLink=function(e){l(),s.downloadSubmitted=!0,s.downloadStep="sending",n.sendDownloadLink(s.user.email,s.user.subscribeDownload).then(function(){o(function(){s.downloadStep="sent"},2e3)})},s.saveAccount=function(){l(),s.newAccountSubmitted=!0,s.saveInProgress=!0,n.createAccount(s.user).then(function(e){var n=e.data;s.success=!0,n.success?o(function(){a.location.href=n.accountLandingPageUrl},500):(s.saveInProgress=!1,t.forEach(n.data,function(e,t){s.newAccount[e.Key].$error.custom=e.Value,s.newAccount[e.Key].$invalid=!0}))})}}n.controller("NewAccountCtrl",["PublicCanvasService","TimeZoneService","LinkValidationService","$timeout","$window","$scope",i])}),define("modules/emailbuilder/controllers/getFeedback",["modules/emailbuilder/module","vendor/angular"],function(e,t){function n(e,n,i,r,o,a){function s(e,t){u&&(o.cancel(u),u=void 0),u=o(function(){t.postMessage({message:"requestOauthResult"},"*")},500)}function l(e){n.closeGetFeedbackForm(!0),e.data&&e.data.result&&"ephemeral_session_detected"===e.data.result.error&&(c=!0)}var c=!1;/^((?!chrome|android).)*safari/i.test(navigator.userAgent)&&(c=!0,a({data:"",method:"GET",url:"https://www.getfeedback.com/oauth/preflight",headers:{"Content-Type":"application/json; charset=utf-8"},withCredentials:!0}).then(function(e){e.data.has_session&&(c=!1)})),n.showGetFeedbackForm=!1,e.frameUrl="";var u;n.$on("getFeedbackConnectStart",function(a,l){var u=function(){n.showGetFeedbackForm=!0,r(function(){e.frameUrl=l,r(function(){s(e,t.element("#emb-get-feedback-dialog iframe")[0].contentWindow)})})};if(c)var d=i.open("https://www.getfeedback.com/campaign_monitor/start_session","GetFeedback","width=100,height=100,left=0,top=0,menubar=no,location=no,scrollbars=no,status=no"),h=o(function(){d.closed&&(o.cancel(h),c=!1,u())},100);else u()}),n.closeGetFeedbackForm=function(i){e.frameUrl="",t.isDefined(u)&&(o.cancel(u),u=void 0),n.showGetFeedbackForm=!1,n.$broadcast("getFeedbackConnectEnd",!!i)},i.addEventListener("message",l,!1)}e.controller("GetFeedbackCtrl",["$scope","$rootScope","$window","$timeout","$interval","$http",n])}),define("modules/emailbuilder/controllers/sendTestEmail",["config","vendor/angular","modules/emailbuilder/module"],function(e,t,n){function i(t,n,i,r,o){function a(){o.sendInProgress=!1,o.testEmailSent=!1}o.user={enCampaignId:e.enEntityId,enDbId:e.enOverrideDbId,email:t.getTestEmailAddress()},o.emailRegex=n.getEmailRegExp(),a(),o.sendTestEmail=function(e){a(),o.sendInProgress=!0,t.sendTestEmail(o.user,e).then(function(e){"Success"===e.data.Status?(o.testEmailSent=!0,i(function(){o.$parent.showTestEmailForm=!1,a()},2e3)):(o.testEmailSendErrorMessage="Error...unable to send test email.",o.$parent.showTestEmailForm=!1,a())})}}n.controller("SendTestEmailCtrl",["TestEmailService","LinkValidationService","$timeout","$window","$scope",i])}),define("modules/emailbuilder/main",["vendor/angular","vendor/domReady!","modules/emailbuilder/config/routeConfig","ts/modules/emailbuilder/sections/dropzone.directive","modules/emailbuilder/controllers/email","modules/emailbuilder/controllers/newAccount","modules/emailbuilder/controllers/getFeedback","modules/emailbuilder/controllers/sendTestEmail"],function(e,t){e.bootstrap(t,["emailbuilder"],{strictDi:!0})});